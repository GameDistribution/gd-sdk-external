NAMESPACE=CLIENT=Object.create(null);NAMESPACE.Manipulators=Object.create(null);if(typeof window!=="undefined"){window.COMMON=Object.create(null);}else{global.COMMON=Object.create(null);}
COMMON.BORDER=300;COMMON.POINT=1;COMMON.CIRCLE=2;COMMON.RECT=4;COMMON.MAX_LEVEL=9;COMMON.MAX_POPULATION=6;COMMON.TRIBE_RADIUS=40;COMMON.SHARE_INTERVAL=1/10;COMMON.LATENCY=0.05;COMMON.TWEEN_DURATION=COMMON.SHARE_INTERVAL*1.5;COMMON.REMOVE_DEFAULT=1;COMMON.REMOVE_INSTANT=2;COMMON.CLEAR_ORDER_INTERVAL=5.0;COMMON.MOBILE_CURSOR_OFFSET=-32;COMMON.FLAG_GUN=1;COMMON.FLAG_TURBO=2;COMMON.FLAG_MOVING=4;COMMON.FLAG_LEFT=1;COMMON.FLAG_UP=2;COMMON.FLAG_RIGHT=4;COMMON.FLAG_DOWN=8;COMMON.ANIMAL_PALETTE=18;COMMON.TWIST_DURATION=1.0;COMMON.distanceDurationFormula=function(distance){return 0.1+ distance*0.003;}
COMMON.VOCATIONS={};COMMON.items=COMMON.itemsByKey={"nothing":{none:true},"axe":{level:0,melee:true,lumber:true,cost:2,resource:"wood",slot:"weapon",tooltip:"Axe | Lumberjack",subtip:"Fight / Cut trees",attackCooldown:[2.0,5.0],tags:["invention","equipment"],scaleCost:true},"hammer":{level:1,melee:true,cost:2,resource:"wood",slot:"weapon",mine:1,tooltip:"Hammer | Miner",subtip:"Fight / Mine",attackCooldown:[2.0,5.0],tags:["invention","equipment"],scaleCost:true},"sword":{order:1,level:1,melee:true,cost:2,resource:"gold",slot:"weapon",tooltip:"Sword | Knight",subtip:"Fight / Faster attack",attackCooldown:[1.5,3.0],tags:["invention","equipment"],scaleCost:true},"wizard_staff":{order:1,level:1,melee:true,cost:2,resource:"gold",slot:"weapon",tooltip:"Sword | Knight",subtip:"Fight / Faster attack",attackCooldown:[1.5,3.0],scaleCost:true},"scythe":{level:1,melee:true,cost:2,resource:"wood",slot:"weapon",tooltip:"Scythe | Farmer",harvest:true,subtip:"Fight / Cut grass",attackCooldown:[2.0,5.0],tags:["invention","equipment"],scaleCost:true},"bow":{level:0,ranged:true,hunt:true,backrow:true,cost:2,resource:"wood",slot:"weapon",tooltip:"Bow | Hunter",subtip:"Fight / Hunt animals",tags:["invention","equipment"],scaleCost:true},"dagger":{level:0,cost:2,melee:true,backstab:true,backrow:true,defend:true,resource:"gold",slot:"weapon",tooltip:"Dagger | Rogue",subtip:"Stab enemies with 1HP robbing their gold.\nOtherwise can only attack hunters and other rogues.",tags:["invention","equipment"],attackCooldown:[2.0,4.0],scaleCost:true},"backpack":{level:0,cost:2,backstab:true,defend:true,tooltip:"Backpack",subtip:"Increase each resource limit to 40",tags:["invention"],scaleCost:true,icon:[191,202,11,11]},"wooden_shield":{tier:0,cost:1,blockChance:0.2,resource:"gold",slot:"shield",tooltip:"Wooden Shield | 20%🛡",subtip:"Block chance",tags:["invention","equipment"]},"reinforced_shield":{tier:1,cost:3,blockChance:0.4,resource:"gold",slot:"shield",tooltip:"Reinforced Shield | 40%🛡",subtip:"Block chance",require:"wooden_shield",tags:["invention","equipment"]},"steel_shield":{tier:2,cost:5,blockChance:0.5,resource:"gold",slot:"shield",tooltip:"Steel Shield | 50%🛡",subtip:"Block chance",require:"reinforced_shield",tags:["invention","equipment"]},"hood":{tier:0,cost:1,health:1,resource:"gold",slot:"helmet",tooltip:"Hood | +1❤",subtip:"Extra health",tags:["invention","equipment"]},"wizard_hat":{tier:0,cost:1,health:1,resource:"gold",slot:"helmet",tooltip:"Wizard Hat | +1❤",subtip:"Extra health"},"viking_helmet":{tier:1,cost:2,health:2,resource:"gold",slot:"helmet",tooltip:"Viking Helmet | +2❤",subtip:"Extra health",require:"hood",tags:["invention","equipment"]},"legion_helmet":{tier:2,cost:3,health:3,resource:"gold",slot:"helmet",tooltip:"Legion Helmet | +3❤",subtip:"Extra health",require:"viking_helmet",tags:["invention","equipment"]},"crown":{health:0,slot:"Helmet"},"noble_cape":{},"wood":{sprite:[26,10,6,7],token:[35,20,2,2],wood:1,},"stone":{sprite:[18,11,6,7],token:[37,20,2,2],gold:1,},"chest":{sprite:[82,77,11,12]},"gold":{sprite:[26,1,7,7],token:[39,20,2,2],gold:1,},"food":{sprite:[19,1,6,7],token:[31,20,2,2],food:1,},"iron_stone":{sprite:[1,29,6,7],gold:1},"copper_stone":{sprite:[8,29,6,7],gold:2},"gold_stone":{sprite:[15,29,6,7],gold:3},"mushroom_1":{sprite:[22,96,6,7],edible:false},"mushroom_2":{sprite:[29,93,6,10],edible:false},"mushroom_3":{sprite:[37,92,6,11],edible:true},"mushroom_4":{sprite:[22,104,6,7],edible:false},"mushroom_5":{sprite:[29,104,7,10],edible:true},"mushroom_6":{sprite:[38,104,5,10],edible:true},"mushroom_7":{sprite:[44,104,5,7],edible:false},"mushroom_8":{sprite:[22,112,7,9],edible:true},"mushroom_9":{sprite:[30,115,6,7],edible:true},"mushroom_10":{sprite:[44,112,7,10],edible:true},"lumberjack":{trade:["wood",1,"gold",1]},"windmill":{trade:["gold",1,"food",1]},"shock_arrow":{icon:[206,202,9,9],tags:["invention","technology"],require:"bow",tooltip:"Shock Arrow",subtip:"Deals 2 damage to minions without shield"},"butchery":{icon:[150,187,13,13],tags:["invention","technology"],require:"bow",tooltip:"Butchery",subtip:"Get extra food from animals"},"cannibalism":{icon:[231,202,9,10],tags:["invention","technology"],tooltip:"Cannibalism",subtip:"Get extra food from humans"},"mycology":{icon:[174,189,11,10],tags:["invention","technology"],tooltip:"Mycology",subtip:"You can eat all mushrooms",require:"scythe"},"farming":{icon:[207,188,11,12],tags:["invention","technology"],require:"scythe",tooltip:"Farming",subtip:"Cutting grass provides food",},"shoes":{icon:[189,189,13,11],tags:[],require:"butchery",tooltip:"Shoes",subtip:"Faster tribe movement"},"saw":{icon:[163,171,15,15],tags:["invention","technology"],require:"axe",tooltip:"Saw",subtip:"Get extra wood from trees"},"missionary":{icon:[224,187,8,12],tags:["invention","technology"],tooltip:"Missionary",subtip:"Barbarians will not attack you but you cannot gather resources near their meadows anymore",require:"axe"},};COMMON.itemsByIndex=[];{let index=0;for(let key in COMMON.itemsByKey){COMMON.itemsByKey[key].index=index;COMMON.itemsByKey[key].key=key;COMMON.itemsByIndex[index]=COMMON.itemsByKey[key];COMMON["ITEM_"+ key.toUpperCase()]=index;index++;}}
COMMON.tags={};{for(let key in COMMON.items){let def=COMMON.items[key];if(!def.tags)continue;for(let tag of def.tags){if(!COMMON.tags[tag])COMMON.tags[tag]=[];COMMON.tags[tag].push(def);}}}
COMMON.TASKS={IDLE:0,FIGHT:1,LOOT:2,RECOVER:3,CAMP:4,HUNT:5,LEAD:6,COLLECT:7,READY:8,LUMBER:9,BIRTH:10,MINE:11,RUN:12,EAT:13,HARVEST:14,DIE:15,PANIC:16}
COMMON.DEATH_NORMAL=2;COMMON.STATUS={DEAD:0,LOOTED:1};COMMON.TREE_OK=0;COMMON.TREE_FALLING=1;COMMON.TREE_FALLEN=2;COMMON.TREE_DEAD=3;COMMON.canEquip=function(who,what){if(who.isKing)return false;let def=COMMON.items[what];if(def.slot==="weapon"&&who.weapon)return false;if(def.slot==="shield"&&who.weapon==COMMON.ITEM_BOW)return false;if(def.tier!==undefined){let def2=COMMON.itemsByIndex[who[def.slot]];if(def2.tier>=def.tier)return false;}
    return true;};COMMON.getMaxHealth=function(who){let maxHealth=4;if(who.helmet){let helmet=COMMON.itemsByIndex[who.helmet];maxHealth+=helmet.health;}
    return maxHealth;};COMMON.getTribeScore=function(tribe){let score=0;for(let m of tribe.members)score+=this.getTribesmanScore(m);return score;};COMMON.getTribesmanScore=function(who){let score=1;score+=who.weaponDef.cost|0;score+=who.helmetDef.cost|0;score+=who.shieldDef.cost|0;return Math.max(1,score);};COMMON.levelTable=[];{let current=0;for(let i=0;i<100;i++){COMMON.levelTable.push(i*(2+ i*0.25)|0);}}
COMMON.levelToExp=function(level){return COMMON.levelTable[level]};COMMON.validateChatCharacters=function(val){val=val.replace(/[^a-zA-Z0-9_\s\.,:/\?\)\(\]\[\!']/g,'');return val;}
NAMESPACE.Sharer=function(descriptors){this.descriptors=descriptors;this.keyToIndex=new Map;this.indexToKey=new Map;this.keys=[];this.keysQueue=[];this.symbol_last_update=Symbol.for("last_update");this.symbol_last_share=Symbol.for("last_share");this.getKeyIndex("snapshot");};NAMESPACE.Sharer.prototype={keyIndex:0,emptyKey:"the_key_was_empty",DONT_ENCODE:1,setKey:function(index,key){this.keyToIndex.set(key,index);this.indexToKey.set(index,key);this.keys.push(index,key);this.keysQueue.push(index,key);},setKeys:function(array){if(!array)return;for(var i=0;i<array.length;i+=2){this.setKey(array[i],array[i+ 1]);}},getKey:function(index){return this.indexToKey.get(index);},getKeyIndex:function(key){if(!this.keyToIndex.has(key)){this.setKey(++this.keyIndex,key);}
        return this.keyToIndex.get(key);},serialize:function(object){var result=[];for(var key in object){result.push(this.getKeyIndex(key),object[key]);}
        return result;},unserialize:function(array){var object={};for(var i=0;i<array.length;i+=2){var key=this.getKey(array[i]);object[key]=array[i+ 1];}
        return object;},encode:function(code,source,full,partial){var symbol_last_update=Symbol.for("last_update");var symbol_last_share=Symbol.for("last_share");if(!full)full=[];var changes=0;var changesCount=0;var desc=this.descriptors[code];if(partial)partial.length=desc.length+ 1;for(var i=0;i<desc.length;i++){var property=desc[i][0];var type=desc[i][1];var val=desc[i][2]?source[desc[i][2]]:source[property];var skip=false;var force=false;switch(type){case"key":val=this.getKeyIndex(val);break;case"queue":if(val.length){val=[].concat(val);source[property].length=0;}else{skip=true;}
        break;case"bool":val=Boolean(val);break;case"int":val=val|0;break;case"float":val=val*100|0;break;case"sfloat":val=val*10|0;break;case"object":if((val[symbol_last_update]|0)!==val[symbol_last_share]){val[symbol_last_update]=val[symbol_last_update]|0;val[symbol_last_share]=val[symbol_last_update];force=true;}else{skip=true;}
        break;default:break;}
        if(!skip&&(force||(full[i]!==val||type==="always"))){full[i]=val;if(partial)partial[changesCount+ 1]=val;changes=changes|Math.pow(2,i);changesCount++;}}
        if(partial){partial[0]=changes;partial.length=changesCount+ 1;}
        return full;},decode:function(code,data,partial){var properties=this.descriptors[code];var result={};if(partial){var changes=data[0];var index=1;for(var i=0;i<properties.length;i++){if(changes>=0&&!(changes&Math.pow(2,i)))continue;var property=properties[i][0];var type=properties[i][1];var value=data[index];switch(type){case"key":value=this.getKey(value);break;case"float":value/=100;break;case"sfloat":value/=10;break;}
        result[property]=value;index++;if(index>=data.length)break;}}else{for(var i=0;i<data.length;i++){var property=properties[i][0];var type=properties[i][1];var value=data[i];switch(type){case"key":value=this.getKey(value);break;case"float":value/=100;break;case"sfloat":value/=10;break;}
        result[property]=value;}}
        return result;},defaultValues:{"float":0,"sfloat":0,"int":0,"string":"","key":"","always":0,"bool":false},defaults:function(key){var result={};var properties=this.descriptors[key];for(var i=0;i<properties.length;i++){var name=properties[i][0];var type=properties[i][1];result[name]=this.defaultValues[type];}
        return result;},markUpdate(object){object[this.symbol_last_update]=object[this.symbol_last_update]+ 1|0;},poke(object){object[this.symbol_last_update]=object[this.symbol_last_update]+ 1|0;},getUpdateMark(object){return object[this.symbol_last_update]|0;}};var JSONS={"images/sprites/diver1_move.json":"{\"width\":64,\"height\":64,\"frames\":20,\"rows\":16,\"markers\":{},\"trim\":[12,20,11,19,11,20,10,20,10,21,10,22,10,21,10,20,11,18,12,18,13,17,12,18,11,19,10,20,10,21,10,22,10,21,10,20,11,20,11,19,11,15,11,16,11,18,11,20,11,19,11,18,10,17,10,15,10,15,11,14,11,14,11,14,10,15,10,15,10,17,11,19,11,19,11,19,11,18,11,16,14,13,14,13,15,14,15,15,14,13,13,12,11,11,11,11,12,11,12,12,12,13,12,12,12,11,11,11,11,11,13,12,14,13,15,15,15,14,14,13,19,11,20,11,21,11,20,10,17,9,14,9,12,9,11,10,11,10,11,12,12,14,11,12,11,10,11,10,12,9,14,9,17,9,20,10,21,11,20,11,21,12,19,11,16,11,14,10,11,10,11,10,10,10,11,10,13,11,15,12,18,13,15,12,13,11,11,10,10,10,11,10,11,10,14,10,16,11,19,11,16,12,14,11,13,10,11,9,11,9,12,9,14,10,17,11,19,11,19,12,19,12,19,12,19,11,17,11,14,10,12,9,11,9,11,9,13,10,14,11,14,13,13,11,13,11,14,11,15,11,15,12,16,14,16,14,16,13,16,12,16,12,16,12,16,13,16,14,16,14,15,12,15,11,14,11,13,11,13,11,14,15,13,14,13,15,13,16,13,18,13,18,14,19,14,19,14,17,14,15,14,14,14,15,14,17,14,19,14,19,13,18,13,18,13,16,13,15,13,14,14,20,14,19,14,20,14,20,14,21,14,22,14,21,14,20,14,18,14,18,14,17,14,18,14,19,14,20,14,21,14,22,14,21,14,20,14,20,14,19,13,20,14,20,14,20,14,19,13,18,13,16,13,15,13,15,13,15,13,15,14,15,13,15,13,15,13,15,13,15,13,17,13,18,14,19,14,20,14,20,16,16,16,16,16,16,16,15,15,15,15,15,15,14,15,15,15,15,15,16,16,16,15,16,15,15,15,15,15,14,15,15,15,15,16,15,16,16,16,16,18,14,18,13,16,13,14,14,13,14,12,14,12,14,13,14,15,14,18,14,18,14,17,14,15,14,13,14,12,14,12,14,13,14,14,14,16,14,18,13,21,14,19,14,16,14,14,14,11,14,11,14,10,14,11,14,13,14,15,14,18,14,15,14,13,14,11,14,10,14,11,14,11,14,14,14,16,14,19,14,20,14,18,14,17,14,16,14,15,14,14,14,14,13,15,13,16,13,18,13,17,13,18,13,16,13,15,13,14,13,14,14,15,14,16,14,17,14,18,14,13,14,11,13,11,13,11,14,11,15,12,15,14,16,14,16,13,16,12,16,12,16,12,16,13,16,14,16,14,16,12,15,11,15,11,14,11,13,11,13,10,16,9,15,9,15,9,16,10,18,10,19,11,20,10,20,10,19,10,18,11,17,10,18,10,19,10,20,11,20,10,19,10,18,9,16,9,15,9,15],\"regions\":[0,0,38,23,39,0,39,23,79,0,39,21,119,0,40,21,160,0,40,19,201,0,40,18,242,0,40,20,283,0,40,21,324,0,39,26,364,0,38,27,403,0,37,29,441,0,38,27,0,29,39,25,40,29,40,21,81,29,40,20,122,29,40,18,163,29,40,19,204,29,40,21,245,29,39,21,285,29,39,23,325,29,40,30,366,29,39,29,406,29,39,26,446,29,39,25,0,59,39,26,40,59,39,27,80,59,41,29,122,59,40,31,163,59,40,31,204,59,39,32,244,59,39,32,284,59,39,32,324,59,40,31,365,59,40,31,406,59,41,29,448,59,39,26,0,91,39,26,40,91,39,25,80,91,39,26,120,91,39,29,160,91,34,35,195,91,34,35,230,91,33,34,264,91,34,33,299,91,35,36,335,91,36,37,372,91,39,38,412,91,38,38,451,91,37,38,0,129,36,37,37,129,36,35,74,129,36,37,111,129,37,38,149,129,38,38,188,129,39,38,228,129,36,37,265,129,35,36,301,129,34,33,336,129,33,34,370,129,34,35,405,129,29,40,435,129,29,40,465,129,28,40,0,169,29,41,30,169,34,42,65,169,38,41,104,169,39,41,144,169,38,40,183,169,37,40,221,169,35,38,257,169,34,36,292,169,35,38,328,169,37,40,366,169,38,40,405,169,39,41,445,169,38,41,0,211,34,42,35,211,29,41,65,211,28,40,94,211,29,40,124,211,26,38,151,211,28,39,180,211,31,39,212,211,36,40,249,211,41,40,291,211,42,40,334,211,43,40,378,211,41,40,420,211,37,39,458,211,32,38,0,253,27,37,28,253,32,38,61,253,37,39,99,253,41,40,141,253,43,40,185,253,42,40,228,253,41,40,270,253,36,40,307,253,31,39,339,253,28,39,368,253,29,38,398,253,31,39,430,253,34,40,465,253,36,41,0,294,37,41,38,294,38,41,77,294,36,40,114,294,32,40,147,294,29,40,177,294,27,39,205,294,25,39,231,294,27,39,259,294,29,40,289,294,32,40,322,294,36,40,359,294,38,41,398,294,37,41,436,294,36,41,473,294,34,40,0,335,31,39,32,335,37,36,70,335,39,39,110,335,39,40,150,335,39,39,190,335,37,38,228,335,36,36,265,335,33,34,299,335,33,34,333,335,33,35,367,335,34,36,402,335,34,36,437,335,34,36,472,335,33,35,0,375,33,34,34,375,33,34,68,375,36,37,105,375,37,38,143,375,39,39,183,375,39,40,223,375,39,39,263,375,39,32,303,375,41,34,345,375,42,33,388,375,42,31,431,375,41,27,0,415,40,27,41,415,39,26,81,415,39,25,121,415,39,28,161,415,39,30,201,415,38,31,240,415,39,30,280,415,39,27,320,415,39,25,360,415,39,26,400,415,40,27,441,415,41,27,0,446,42,31,43,446,42,33,86,446,41,34,128,446,38,23,167,446,39,23,207,446,39,21,247,446,40,21,288,446,40,19,329,446,40,18,370,446,40,20,411,446,40,21,452,446,39,26,0,480,38,27,39,480,37,29,77,480,38,27,116,480,39,25,156,480,40,21,197,480,40,20,238,480,40,18,279,480,40,19,320,480,40,21,361,480,39,21,401,480,39,23,441,480,41,28,0,509,40,27,41,509,40,25,82,509,40,24,123,509,40,24,164,509,41,28,206,509,42,31,249,509,42,33,292,509,42,35,335,509,41,36,377,509,39,37,417,509,41,36,459,509,42,35,0,546,42,33,43,546,42,31,86,546,41,27,128,546,40,24,169,546,40,24,210,546,40,25,251,546,40,27,292,546,35,34,328,546,35,34,364,546,34,33,399,546,33,34,433,546,36,35,470,546,37,36,0,582,38,39,39,582,38,38,78,582,38,37,117,582,37,36,155,582,35,36,191,582,37,36,229,582,38,37,268,582,38,38,307,582,38,39,346,582,37,36,384,582,36,35,421,582,33,34,455,582,34,33,0,621,35,34,36,621,28,38,65,621,28,39,94,621,30,39,125,621,31,40,157,621,34,40,192,621,38,41,231,621,40,41,272,621,40,40,313,621,38,40,352,621,34,38,387,621,32,37,420,621,35,38,456,621,38,40,0,662,40,40,41,662,40,41,82,662,38,41,121,662,34,40,156,662,31,40,188,662,30,38,219,662,28,39,248,662,26,38,275,662,28,39,304,662,31,39,336,662,36,40,373,662,41,40,415,662,42,40,458,662,43,40,0,703,41,40,42,703,37,39,80,703,32,38,113,703,27,37,141,703,32,38,174,703,37,39,212,703,41,40,254,703,43,40,298,703,42,40,341,703,41,40,383,703,36,40,420,703,31,39,452,703,28,39,481,703,29,38,0,743,31,39,32,743,34,40,67,743,36,41,104,743,37,41,142,743,37,41,180,743,35,41,216,743,31,40,248,743,29,39,278,743,27,38,306,743,28,38,335,743,27,38,363,743,29,39,393,743,31,40,425,743,35,41,461,743,37,41,0,784,37,41,38,784,36,41,75,784,34,40,110,784,31,39,142,784,36,37,179,784,39,39,219,784,40,39,260,784,39,39,300,784,38,37,339,784,36,36,376,784,34,33,411,784,34,33,446,784,35,33,0,825,36,34,37,825,36,34,74,825,36,34,111,825,35,33,147,825,34,33,182,825,34,33,217,825,37,36,255,825,38,37,294,825,39,39,334,825,40,39,375,825,39,39,415,825,40,32,456,825,41,33,0,864,42,33,43,864,42,31,86,864,41,27,128,864,41,24,170,864,39,22,210,864,40,24,251,864,40,27,292,864,41,29,334,864,40,31,375,864,41,29,417,864,40,27,458,864,40,24,0,897,39,22,40,897,41,24,82,897,41,27,124,897,42,31,167,897,42,33,210,897,41,33]}","images/sprites/fish1_move.json":"{\"width\":64,\"height\":64,\"frames\":20,\"rows\":16,\"markers\":{},\"trim\":[19,28,19,28,20,28,21,28,22,28,24,28,22,28,21,28,20,28,19,29,19,29,20,28,20,28,21,28,22,27,23,26,22,27,21,28,20,28,20,28,20,25,20,25,21,25,22,25,23,26,25,27,23,26,22,25,21,25,20,25,20,26,20,27,20,27,20,26,20,26,21,25,20,26,20,26,20,27,20,27,22,22,23,21,24,21,26,21,27,21,28,23,27,21,26,21,24,21,23,21,21,22,21,24,20,26,20,27,20,27,20,27,20,27,20,27,20,26,21,24,25,20,25,19,25,19,25,19,25,20,25,21,25,20,25,19,25,19,25,19,25,20,24,21,23,23,21,24,20,25,20,26,20,25,21,24,23,23,24,21,24,19,24,19,24,20,24,21,24,22,24,24,24,22,24,21,24,20,24,19,24,19,23,20,24,20,24,21,22,22,22,23,22,22,24,21,24,20,23,20,24,20,24,21,24,22,24,24,24,26,24,26,24,26,24,24,24,22,24,21,24,20,24,19,24,19,24,20,24,21,24,22,24,21,24,20,24,19,24,19,22,22,22,23,22,25,22,27,22,27,21,28,22,27,22,27,22,25,22,23,22,22,22,21,22,21,22,21,22,22,22,24,22,22,22,21,22,21,22,21,20,25,20,26,20,28,20,29,20,29,20,30,20,29,20,29,20,28,20,27,20,26,21,25,21,25,21,26,21,27,21,28,21,27,21,25,21,25,20,25,21,28,20,28,20,28,20,28,20,28,20,28,20,28,20,28,20,28,20,29,20,29,20,28,20,28,20,28,20,27,20,26,20,27,20,28,20,28,20,28,20,26,20,26,20,26,20,26,20,25,20,25,20,25,20,26,20,26,20,26,20,26,20,26,20,26,21,26,21,26,21,26,21,26,21,26,21,26,20,26,22,22,22,22,22,22,22,22,22,22,22,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,24,20,24,20,24,20,24,20,24,20,24,20,24,20,24,20,24,20,24,20,24,20,24,20,24,20,25,20,25,20,25,20,25,20,25,20,25,20,24,20,24,20,24,20,24,20,24,20,23,20,22,20,23,20,24,20,24,20,24,20,24,20,23,20,24,20,24,20,25,20,26,20,25,20,24,20,24,20,23,20,25,20,25,20,23,20,22,20,21,20,21,20,22,20,22,20,23,20,25,20,25,20,24,20,24,20,24,20,24,20,25,20,24,20,24,20,24,20,24,20,22,22,21,22,21,22,21,22,21,22,23,22,21,22,21,22,21,22,21,22,22,22,24,22,26,22,27,22,27,22,27,21,27,22,27,22,26,22,24,22,20,26,19,26,20,26,21,26,22,26,24,26,22,26,21,26,20,26,20,26,20,26,20,26,22,26,24,25,25,24,26,24,25,24,23,25,22,26,20,26],\"regions\":[0,0,24,8,25,0,25,9,51,0,24,9,76,0,23,10,100,0,22,10,123,0,20,11,144,0,22,10,167,0,23,10,191,0,24,9,216,0,25,8,242,0,25,8,268,0,24,9,293,0,24,9,318,0,23,9,342,0,22,11,365,0,21,12,387,0,22,11,410,0,23,9,434,0,24,9,459,0,24,9,484,0,24,13,0,13,24,13,25,13,22,13,48,13,21,13,70,13,20,12,91,13,18,10,110,13,20,12,131,13,21,13,153,13,22,13,176,13,23,13,200,13,24,12,225,13,24,11,250,13,24,11,275,13,24,12,300,13,24,13,325,13,23,14,349,13,24,12,374,13,24,12,399,13,24,11,424,13,24,11,449,13,20,20,470,13,19,21,490,13,18,21,0,34,16,21,17,34,15,21,33,34,14,19,48,34,15,21,64,34,16,21,81,34,18,21,100,34,19,21,120,34,21,20,142,34,21,18,164,34,22,16,187,34,22,15,210,34,22,15,233,34,23,15,257,34,22,15,280,34,22,15,303,34,22,16,326,34,21,18,348,34,15,24,364,34,15,25,380,34,14,25,395,34,14,25,410,34,14,24,425,34,14,23,440,34,14,24,455,34,14,25,470,34,14,25,485,34,15,25,0,59,15,24,16,59,16,23,33,59,18,21,52,59,20,20,73,59,20,19,94,59,20,18,115,59,20,19,136,59,20,20,157,59,18,21,176,59,16,23,193,59,16,25,210,59,16,25,227,59,16,24,244,59,16,23,261,59,17,22,279,59,18,20,298,59,17,22,316,59,16,23,333,59,16,24,350,59,16,25,367,59,16,25,384,59,18,24,403,59,16,24,420,59,16,23,437,59,17,22,455,59,16,21,472,59,17,22,490,59,16,23,0,84,16,24,17,84,18,24,36,84,15,24,52,84,16,23,69,84,17,22,87,84,18,20,106,84,19,18,126,84,20,18,147,84,19,18,167,84,18,20,186,84,18,22,205,84,16,23,222,84,15,24,238,84,15,25,254,84,14,25,269,84,13,24,283,84,12,23,296,84,11,22,308,84,12,23,321,84,13,24,335,84,14,25,350,84,15,25,366,84,20,20,387,84,21,19,409,84,21,17,431,84,21,15,453,84,22,15,476,84,23,14,0,109,22,15,23,109,22,15,46,109,22,17,69,109,21,19,91,109,21,20,113,109,20,21,134,109,19,21,154,109,18,21,173,109,17,20,191,109,16,18,208,109,17,20,226,109,18,21,245,109,19,21,265,109,20,21,286,109,24,13,311,109,24,12,336,109,24,10,361,109,24,9,386,109,23,9,410,109,22,9,433,109,23,9,457,109,24,9,482,109,24,10,0,130,24,11,25,130,24,12,50,130,23,13,74,130,23,13,98,130,22,12,121,130,21,11,143,130,20,9,164,130,21,11,186,130,22,13,209,130,22,13,232,130,24,13,257,130,24,8,282,130,25,9,308,130,24,9,333,130,23,10,357,130,22,10,380,130,20,11,401,130,22,10,424,130,23,10,448,130,24,9,473,130,25,8,0,143,25,8,26,143,24,9,51,143,24,9,76,143,23,9,100,143,22,11,123,143,21,12,145,143,22,11,168,143,23,9,192,143,24,9,217,143,24,9,242,143,24,14,267,143,24,15,292,143,23,16,316,143,22,16,339,143,20,17,360,143,18,17,379,143,20,17,400,143,22,16,423,143,23,16,447,143,24,15,472,143,24,15,0,160,24,14,25,160,24,14,50,160,21,13,72,160,20,13,93,160,18,12,112,160,20,13,133,160,22,13,156,160,23,13,180,160,24,14,205,160,20,20,226,160,19,21,246,160,17,21,264,160,15,21,280,160,15,22,296,160,14,23,311,160,15,22,327,160,15,22,343,160,17,22,361,160,19,21,381,160,20,21,402,160,21,20,424,160,21,19,446,160,21,18,468,160,20,17,489,160,18,16,0,183,20,17,21,183,21,18,43,183,21,19,65,183,21,20,87,183,15,24,103,183,15,24,119,183,15,25,135,183,15,25,151,183,15,24,167,183,14,23,182,183,15,24,198,183,15,25,214,183,15,25,230,183,15,24,246,183,15,24,262,183,16,23,279,183,17,22,297,183,17,21,315,183,18,20,334,183,17,19,352,183,18,20,371,183,17,21,389,183,16,22,406,183,16,23,423,183,16,25,440,183,16,25,457,183,16,24,474,183,16,23,491,183,17,22,0,208,18,20,19,208,17,22,37,208,16,23,54,208,16,24,71,208,16,25,88,208,16,25,105,208,18,24,124,208,16,24,141,208,16,23,158,208,17,22,176,208,16,21,193,208,17,22,211,208,16,23,228,208,16,24,245,208,18,24,264,208,15,24,280,208,15,23,296,208,17,22,314,208,18,20,333,208,19,19,353,208,19,18,373,208,18,19,392,208,18,20,411,208,17,22,429,208,15,23,445,208,15,24,461,208,16,24,478,208,16,24,495,208,16,24,0,233,16,24,17,233,15,23,33,233,16,24,50,233,16,24,67,233,16,24,84,233,16,24,101,233,20,20,122,233,21,19,144,233,21,18,166,233,21,16,188,233,21,15,210,233,19,14,230,233,21,15,252,233,21,16,274,233,21,18,296,233,21,19,318,233,20,21,339,233,18,21,358,233,16,22,375,233,15,22,391,233,15,22,407,233,15,23,423,233,15,22,439,233,15,22,455,233,16,22,472,233,18,21,0,257,24,14,25,257,25,14,51,257,24,13,76,257,22,12,99,257,21,11,121,257,19,11,141,257,21,11,163,257,23,12,187,257,24,13,212,257,24,14,237,257,24,14,262,257,24,15,287,257,22,15,310,257,20,17,331,257,19,18,351,257,18,18,370,257,19,18,390,257,21,17,412,257,22,15,435,257,24,15]}","data/debris.json":"[\n  [146, 73, 7, 15],\n  [159, 76, 14, 10],\n  [144, 92, 13, 11],\n  [159, 88, 17, 12],\n  [162, 103, 13, 12]\n]"}
var VERSION=242;console.log('version',VERSION)
var REWRITE_URL={"images/displacement.png":"images/displacement.png?1492633563000","images/noise32x32.png":"images/noise32x32.png?1492633776000","images/rabbit.png":"images/rabbit.png?1502666540000","images/sprites/diver1_move.json":"images/sprites/diver1_move.json?1502628857000","images/sprites/diver1_move.png":"images/sprites/diver1_move.png?1502629897000","images/sprites/fish1_move.json":"images/sprites/fish1_move.json?1502628830000","images/sprites/fish1_move.png":"images/sprites/fish1_move.png?1502629912000","images/spritesheet.png":"images/spritesheet.png?1509696690000","sprites/arrow.json":"sprites/arrow.json?1512138822000","sprites/arrow.png":"sprites/arrow.png?1509629300000","sprites/basic.json":"sprites/basic.json?1503405249000","sprites/basic.png":"sprites/basic.png?1503423598000","sprites/bird.json":"sprites/bird.json?1511958336000","sprites/bird.png":"sprites/bird.png?1511958336000","sprites/blood_1.json":"sprites/blood_1.json?1496224181000","sprites/blood_1.png":"sprites/blood_1.png?1496223035000","sprites/building/lumberjack.json":"sprites/building/lumberjack.json?1513030026000","sprites/building/lumberjack.png":"sprites/building/lumberjack.png?1513030026000","sprites/building/windmill.json":"sprites/building/windmill.json?1513029698000","sprites/building/windmill.png":"sprites/building/windmill.png?1513029698000","sprites/building/windmill_flour.json":"sprites/building/windmill_flour.json?1513031377000","sprites/building/windmill_flour.png":"sprites/building/windmill_flour.png?1513031377000","sprites/campfire (copy).png":"sprites/campfire (copy).png?1509395853000","sprites/campfire.json":"sprites/campfire.json?1509395853000","sprites/campfire.png":"sprites/campfire.png?1509461741000","sprites/cloud (copy).png":"sprites/cloud (copy).png?1418584341000","sprites/cloud.json":"sprites/cloud.json?1511726726000","sprites/cloud.png":"sprites/cloud.png?1511726618000","sprites/cursor/grip.json":"sprites/cursor/grip.json?1512332117000","sprites/cursor/grip.png":"sprites/cursor/grip.png?1512332117000","sprites/cursor/interact.json":"sprites/cursor/interact.json?1512331951000","sprites/cursor/interact.png":"sprites/cursor/interact.png?1512331951000","sprites/cursor/place.json":"sprites/cursor/place.json?1512331935000","sprites/cursor/place.png":"sprites/cursor/place.png?1512331935000","sprites/cursor/point.json":"sprites/cursor/point.json?1512331914000","sprites/cursor/point.png":"sprites/cursor/point.png?1512331914000","sprites/cursor/press.json":"sprites/cursor/press.json?1512331918000","sprites/cursor/press.png":"sprites/cursor/press.png?1512331918000","sprites/cursor/snap.json":"sprites/cursor/snap.json?1512331899000","sprites/cursor/snap.png":"sprites/cursor/snap.png?1512331899000","sprites/cursor/thump.json":"sprites/cursor/thump.json?1512331912000","sprites/cursor/thump.png":"sprites/cursor/thump.png?1512331912000","sprites/deer/corpse.json":"sprites/deer/corpse.json?1509354208000","sprites/deer/corpse.png":"sprites/deer/corpse.png?1509354208000","sprites/deer/death.json":"sprites/deer/death.json?1509352446000","sprites/deer/death.png":"sprites/deer/death.png?1509352446000","sprites/deer/run.json":"sprites/deer/run.json?1509315309000","sprites/deer/run.png":"sprites/deer/run.png?1509315309000","sprites/divers/diver1_move.json":"sprites/divers/diver1_move.json?1503431306000","sprites/divers/diver1_move.png":"sprites/divers/diver1_move.png?1503431306000","sprites/divers/diver1_twist.json":"sprites/divers/diver1_twist.json?1504683274000","sprites/divers/diver1_twist.png":"sprites/divers/diver1_twist.png?1504683274000","sprites/divers/diver2_move.json":"sprites/divers/diver2_move.json?1504540043000","sprites/divers/diver2_move.png":"sprites/divers/diver2_move.png?1504540043000","sprites/divers/diver2_twist.json":"sprites/divers/diver2_twist.json?1504683286000","sprites/divers/diver2_twist.png":"sprites/divers/diver2_twist.png?1504683286000","sprites/divers/diver3_move.json":"sprites/divers/diver3_move.json?1504546997000","sprites/divers/diver3_move.png":"sprites/divers/diver3_move.png?1504546997000","sprites/divers/diver3_twist.json":"sprites/divers/diver3_twist.json?1504683298000","sprites/divers/diver3_twist.png":"sprites/divers/diver3_twist.png?1504683298000","sprites/dizzy.json":"sprites/dizzy.json?1490794022000","sprites/dizzy.png":"sprites/dizzy.png?1490793906000","sprites/explosion/blast.json":"sprites/explosion/blast.json?1508507069000","sprites/explosion/blast.png":"sprites/explosion/blast.png?1508507140000","sprites/explosion/small.json":"sprites/explosion/small.json?1508449161000","sprites/explosion/small.png":"sprites/explosion/small.png?1508449946000","sprites/explosion/small_4color.png":"sprites/explosion/small_4color.png?1508449912000","sprites/fx/blink.json":"sprites/fx/blink.json?1503073730000","sprites/fx/blink.png":"sprites/fx/blink.png?1503073719000","sprites/fx/blood_1.json":"sprites/fx/blood_1.json?1496224181000","sprites/fx/blood_1.png":"sprites/fx/blood_1.png?1496223035000","sprites/fx/bubble.json":"sprites/fx/bubble.json?1502962395000","sprites/fx/bubble.png":"sprites/fx/bubble.png?1502962360000","sprites/fx/coin.json":"sprites/fx/coin.json?1513167333000","sprites/fx/coin.png":"sprites/fx/coin.png?1513167333000","sprites/fx/debris.json":"sprites/fx/debris.json?1508505528000","sprites/fx/debris.png":"sprites/fx/debris.png?1508505528000","sprites/fx/dust.json":"sprites/fx/dust.json?1484941774000","sprites/fx/dust.png":"sprites/fx/dust.png?1484941774000","sprites/fx/earthline.json":"sprites/fx/earthline.json?1511811341000","sprites/fx/earthline.png":"sprites/fx/earthline.png?1511812246000","sprites/fx/leaves (copy).png":"sprites/fx/leaves (copy).png?1510663696000","sprites/fx/leaves.json":"sprites/fx/leaves.json?1510663793000","sprites/fx/leaves.png":"sprites/fx/leaves.png?1510663834000","sprites/fx/muzzle.json":"sprites/fx/muzzle.json?1508505779000","sprites/fx/muzzle.png":"sprites/fx/muzzle.png?1508505779000","sprites/fx/poison.json":"sprites/fx/poison.json?1511556432000","sprites/fx/poison.png":"sprites/fx/poison.png?1511556432000","sprites/fx/raindrop.json":"sprites/fx/raindrop.json?1511728733000","sprites/fx/raindrop.png":"sprites/fx/raindrop.png?1511728733000","sprites/fx/shield_hit.json":"sprites/fx/shield_hit.json?1508360005000","sprites/fx/shield_hit.png":"sprites/fx/shield_hit.png?1508360005000","sprites/fx/smoke_column.json":"sprites/fx/smoke_column.json?1512992253000","sprites/fx/smoke_column.png":"sprites/fx/smoke_column.png?1512992253000","sprites/fx/stone.json":"sprites/fx/stone.json?1511701084000","sprites/fx/stone.png":"sprites/fx/stone.png?1494251542000","sprites/fx/surface_wave1.json":"sprites/fx/surface_wave1.json?1503347289000","sprites/fx/surface_wave1.png":"sprites/fx/surface_wave1.png?1503347285000","sprites/fx/surface_wave2.json":"sprites/fx/surface_wave2.json?1503350934000","sprites/fx/surface_wave2.png":"sprites/fx/surface_wave2.png?1503350228000","sprites/fx/swirl.json":"sprites/fx/swirl.json?1503070723000","sprites/fx/swirl.png":"sprites/fx/swirl.png?1503073704000","sprites/fx/xraindrop.json":"sprites/fx/xraindrop.json?1511727030000","sprites/fx/xraindrop.png":"sprites/fx/xraindrop.png?1511727030000","sprites/fx/zraindrop.json":"sprites/fx/zraindrop.json?1511728141000","sprites/fx/zraindrop.png":"sprites/fx/zraindrop.png?1511728141000","sprites/gui/exp_coord.json":"sprites/gui/exp_coord.json?1513525347000","sprites/gui/exp_coord.png":"sprites/gui/exp_coord.png?1513525347000","sprites/gun.json":"sprites/gun.json?1503560356000","sprites/gun.png":"sprites/gun.png?1503560371000","sprites/jellyfish.json":"sprites/jellyfish.json?1504535754000","sprites/jellyfish.png":"sprites/jellyfish.png?1504535754000","sprites/ogre/attack.json":"sprites/ogre/attack.json?1512388042000","sprites/ogre/attack.png":"sprites/ogre/attack.png?1512388042000","sprites/ogre/death.json":"sprites/ogre/death.json?1512388040000","sprites/ogre/death.png":"sprites/ogre/death.png?1512388040000","sprites/ogre/run.json":"sprites/ogre/run.json?1512388044000","sprites/ogre/run.png":"sprites/ogre/run.png?1512388044000","sprites/piranha.json":"sprites/piranha.json?1503928876000","sprites/piranha.png":"sprites/piranha.png?1503928876000","sprites/rabbit/alert.json":"sprites/rabbit/alert.json?1509568027000","sprites/rabbit/alert.png":"sprites/rabbit/alert.png?1509568027000","sprites/rabbit/death.json":"sprites/rabbit/death.json?1509568024000","sprites/rabbit/death.png":"sprites/rabbit/death.png?1509568024000","sprites/rabbit/idle.json":"sprites/rabbit/idle.json?1511555319000","sprites/rabbit/idle.png":"sprites/rabbit/idle.png?1511555319000","sprites/rabbit/run.json":"sprites/rabbit/run.json?1509568025000","sprites/rabbit/run.png":"sprites/rabbit/run.png?1509568025000","sprites/slash/horizontal.json":"sprites/slash/horizontal.json?1510247162000","sprites/slash/horizontal.png":"sprites/slash/horizontal.png?1510247162000","sprites/slash/spin.json":"sprites/slash/spin.json?1510247744000","sprites/slash/spin.png":"sprites/slash/spin.png?1510247744000","sprites/slash/vertical.json":"sprites/slash/vertical.json?1510247163000","sprites/slash/vertical.png":"sprites/slash/vertical.png?1510247163000","sprites/spark/electric.json":"sprites/spark/electric.json?1508483284000","sprites/spark/electric.png":"sprites/spark/electric.png?1508483284000","sprites/spark/flame.json":"sprites/spark/flame.json?1508483284000","sprites/spark/flame.png":"sprites/spark/flame.png?1508483284000","sprites/temp/diver-novel.png":"sprites/temp/diver-novel.png?1502915976000","sprites/temp/diver2.json":"sprites/temp/diver2.json?1502628857000","sprites/temp/diver2.png":"sprites/temp/diver2.png?1502828355000","sprites/temp/diver3.json":"sprites/temp/diver3.json?1502955887000","sprites/temp/diver3.png":"sprites/temp/diver3.png?1502955943000","sprites/temp/diver5.png":"sprites/temp/diver5.png?1502916144000","sprites/temp/diverx.json":"sprites/temp/diverx.json?1502628857000","sprites/temp/diverx.png":"sprites/temp/diverx.png?1502916279000","sprites/totem.json":"sprites/totem.json?1512341386000","sprites/totem.png":"sprites/totem.png?1515107732000","sprites/tree/1.json":"sprites/tree/1.json?1510236676000","sprites/tree/1.png":"sprites/tree/1.png?1510236676000","sprites/tree/2.json":"sprites/tree/2.json?1510236676000","sprites/tree/2.png":"sprites/tree/2.png?1510236676000","sprites/tree/3.json":"sprites/tree/3.json?1510236677000","sprites/tree/3.png":"sprites/tree/3.png?1510236677000","sprites/tree/4.json":"sprites/tree/4.json?1510236678000","sprites/tree/4.png":"sprites/tree/4.png?1510236678000","sprites/tree/5.json":"sprites/tree/5.json?1510236679000","sprites/tree/5.png":"sprites/tree/5.png?1510236679000","sprites/tribesman/angel_wings/sit.json":"sprites/tribesman/angel_wings/sit.json?1509399338000","sprites/tribesman/angel_wings/sit.png":"sprites/tribesman/angel_wings/sit.png?1509393846000","sprites/tribesman/angel_wings/spin.json":"sprites/tribesman/angel_wings/spin.json?1510762441000","sprites/tribesman/angel_wings/spin.png":"sprites/tribesman/angel_wings/spin.png?1510762441000","sprites/tribesman/angel_wings/still.json":"sprites/tribesman/angel_wings/still.json?1510762449000","sprites/tribesman/angel_wings/still.png":"sprites/tribesman/angel_wings/still.png?1510762449000","sprites/tribesman/angel_wings/turntable.json":"sprites/tribesman/angel_wings/turntable.json?1510762452000","sprites/tribesman/angel_wings/turntable.png":"sprites/tribesman/angel_wings/turntable.png?1510762452000","sprites/tribesman/axe/attack_bow.json":"sprites/tribesman/axe/attack_bow.json?1509884933000","sprites/tribesman/axe/attack_bow.png":"sprites/tribesman/axe/attack_bow.png?1509884933000","sprites/tribesman/axe/attack_horizontal.json":"sprites/tribesman/axe/attack_horizontal.json?1509884918000","sprites/tribesman/axe/attack_horizontal.png":"sprites/tribesman/axe/attack_horizontal.png?1509884918000","sprites/tribesman/axe/attack_vertical.json":"sprites/tribesman/axe/attack_vertical.json?1509884900000","sprites/tribesman/axe/attack_vertical.png":"sprites/tribesman/axe/attack_vertical.png?1509884900000","sprites/tribesman/axe/block.json":"sprites/tribesman/axe/block.json?1509884930000","sprites/tribesman/axe/block.png":"sprites/tribesman/axe/block.png?1509884930000","sprites/tribesman/axe/cast.json":"sprites/tribesman/axe/cast.json?1509884887000","sprites/tribesman/axe/cast.png":"sprites/tribesman/axe/cast.png?1509884887000","sprites/tribesman/axe/charge_bow.json":"sprites/tribesman/axe/charge_bow.json?1509884912000","sprites/tribesman/axe/charge_bow.png":"sprites/tribesman/axe/charge_bow.png?1509884912000","sprites/tribesman/axe/charge_meele.json":"sprites/tribesman/axe/charge_meele.json?1509884910000","sprites/tribesman/axe/charge_meele.png":"sprites/tribesman/axe/charge_meele.png?1509884910000","sprites/tribesman/axe/charge_spell.json":"sprites/tribesman/axe/charge_spell.json?1509884856000","sprites/tribesman/axe/charge_spell.png":"sprites/tribesman/axe/charge_spell.png?1509884856000","sprites/tribesman/axe/fall_back.json":"sprites/tribesman/axe/fall_back.json?1509884884000","sprites/tribesman/axe/fall_back.png":"sprites/tribesman/axe/fall_back.png?1509884884000","sprites/tribesman/axe/fall_front.json":"sprites/tribesman/axe/fall_front.json?1509884954000","sprites/tribesman/axe/fall_front.png":"sprites/tribesman/axe/fall_front.png?1509884954000","sprites/tribesman/axe/growl.json":"sprites/tribesman/axe/growl.json?1509884892000","sprites/tribesman/axe/growl.png":"sprites/tribesman/axe/growl.png?1509884892000","sprites/tribesman/axe/kick.json":"sprites/tribesman/axe/kick.json?1509884908000","sprites/tribesman/axe/kick.png":"sprites/tribesman/axe/kick.png?1509884908000","sprites/tribesman/axe/legs_run.json":"sprites/tribesman/axe/legs_run.json?1509884927000","sprites/tribesman/axe/legs_run.png":"sprites/tribesman/axe/legs_run.png?1509884927000","sprites/tribesman/axe/operate_ground.json":"sprites/tribesman/axe/operate_ground.json?1509884946000","sprites/tribesman/axe/operate_ground.png":"sprites/tribesman/axe/operate_ground.png?1509884946000","sprites/tribesman/axe/punch1.json":"sprites/tribesman/axe/punch1.json?1509884971000","sprites/tribesman/axe/punch1.png":"sprites/tribesman/axe/punch1.png?1509884971000","sprites/tribesman/axe/punch2.json":"sprites/tribesman/axe/punch2.json?1509884895000","sprites/tribesman/axe/punch2.png":"sprites/tribesman/axe/punch2.png?1509884895000","sprites/tribesman/axe/reach.json":"sprites/tribesman/axe/reach.json?1510821720000","sprites/tribesman/axe/reach.png":"sprites/tribesman/axe/reach.png?1510821721000","sprites/tribesman/axe/roll.json":"sprites/tribesman/axe/roll.json?1509884968000","sprites/tribesman/axe/roll.png":"sprites/tribesman/axe/roll.png?1509884968000","sprites/tribesman/axe/run.json":"sprites/tribesman/axe/run.json?1509884876000","sprites/tribesman/axe/run.png":"sprites/tribesman/axe/run.png?1509884876000","sprites/tribesman/axe/sit.json":"sprites/tribesman/axe/sit.json?1509884868000","sprites/tribesman/axe/sit.png":"sprites/tribesman/axe/sit.png?1509884868000","sprites/tribesman/axe/spear_attack.json":"sprites/tribesman/axe/spear_attack.json?1509884920000","sprites/tribesman/axe/spear_attack.png":"sprites/tribesman/axe/spear_attack.png?1509884920000","sprites/tribesman/axe/spear_jump.json":"sprites/tribesman/axe/spear_jump.json?1509884960000","sprites/tribesman/axe/spear_jump.png":"sprites/tribesman/axe/spear_jump.png?1509884960000","sprites/tribesman/axe/spear_throw.json":"sprites/tribesman/axe/spear_throw.json?1509884903000","sprites/tribesman/axe/spear_throw.png":"sprites/tribesman/axe/spear_throw.png?1509884903000","sprites/tribesman/axe/spin.json":"sprites/tribesman/axe/spin.json?1509884941000","sprites/tribesman/axe/spin.png":"sprites/tribesman/axe/spin.png?1509884941000","sprites/tribesman/axe/still.json":"sprites/tribesman/axe/still.json?1510761970000","sprites/tribesman/axe/still.png":"sprites/tribesman/axe/still.png?1510761970000","sprites/tribesman/axe/stunned.json":"sprites/tribesman/axe/stunned.json?1509884863000","sprites/tribesman/axe/stunned.png":"sprites/tribesman/axe/stunned.png?1509884863000","sprites/tribesman/axe/tear.json":"sprites/tribesman/axe/tear.json?1509884978000","sprites/tribesman/axe/tear.png":"sprites/tribesman/axe/tear.png?1509884978000","sprites/tribesman/axe/throw.json":"sprites/tribesman/axe/throw.json?1509884974000","sprites/tribesman/axe/throw.png":"sprites/tribesman/axe/throw.png?1509884974000","sprites/tribesman/axe/turntable.json":"sprites/tribesman/axe/turntable.json?1510761971000","sprites/tribesman/axe/turntable.png":"sprites/tribesman/axe/turntable.png?1510761971000","sprites/tribesman/barbarian_cape/sit.json":"sprites/tribesman/barbarian_cape/sit.json?1509393819000","sprites/tribesman/barbarian_cape/sit.png":"sprites/tribesman/barbarian_cape/sit.png?1509393819000","sprites/tribesman/barbarian_cape/spin.json":"sprites/tribesman/barbarian_cape/spin.json?1510762322000","sprites/tribesman/barbarian_cape/spin.png":"sprites/tribesman/barbarian_cape/spin.png?1510762322000","sprites/tribesman/barbarian_cape/still.json":"sprites/tribesman/barbarian_cape/still.json?1510762325000","sprites/tribesman/barbarian_cape/still.png":"sprites/tribesman/barbarian_cape/still.png?1510762325000","sprites/tribesman/barbarian_cape/turntable.json":"sprites/tribesman/barbarian_cape/turntable.json?1510762326000","sprites/tribesman/barbarian_cape/turntable.png":"sprites/tribesman/barbarian_cape/turntable.png?1510762326000","sprites/tribesman/bow/attack_bow.json":"sprites/tribesman/bow/attack_bow.json?1509886048000","sprites/tribesman/bow/attack_bow.png":"sprites/tribesman/bow/attack_bow.png?1509886048000","sprites/tribesman/bow/attack_horizontal.json":"sprites/tribesman/bow/attack_horizontal.json?1509886030000","sprites/tribesman/bow/attack_horizontal.png":"sprites/tribesman/bow/attack_horizontal.png?1509886030000","sprites/tribesman/bow/attack_vertical.json":"sprites/tribesman/bow/attack_vertical.json?1509886012000","sprites/tribesman/bow/attack_vertical.png":"sprites/tribesman/bow/attack_vertical.png?1509886012000","sprites/tribesman/bow/block.json":"sprites/tribesman/bow/block.json?1509886045000","sprites/tribesman/bow/block.png":"sprites/tribesman/bow/block.png?1509886045000","sprites/tribesman/bow/cast.json":"sprites/tribesman/bow/cast.json?1509885997000","sprites/tribesman/bow/cast.png":"sprites/tribesman/bow/cast.png?1509885997000","sprites/tribesman/bow/charge_bow.json":"sprites/tribesman/bow/charge_bow.json?1509886025000","sprites/tribesman/bow/charge_bow.png":"sprites/tribesman/bow/charge_bow.png?1509886025000","sprites/tribesman/bow/charge_meele.json":"sprites/tribesman/bow/charge_meele.json?1509886023000","sprites/tribesman/bow/charge_meele.png":"sprites/tribesman/bow/charge_meele.png?1509886023000","sprites/tribesman/bow/charge_spell.json":"sprites/tribesman/bow/charge_spell.json?1509885964000","sprites/tribesman/bow/charge_spell.png":"sprites/tribesman/bow/charge_spell.png?1509885964000","sprites/tribesman/bow/fall_back.json":"sprites/tribesman/bow/fall_back.json?1509885993000","sprites/tribesman/bow/fall_back.png":"sprites/tribesman/bow/fall_back.png?1509885993000","sprites/tribesman/bow/fall_front.json":"sprites/tribesman/bow/fall_front.json?1509886072000","sprites/tribesman/bow/fall_front.png":"sprites/tribesman/bow/fall_front.png?1509886072000","sprites/tribesman/bow/growl.json":"sprites/tribesman/bow/growl.json?1509886003000","sprites/tribesman/bow/growl.png":"sprites/tribesman/bow/growl.png?1509886004000","sprites/tribesman/bow/kick.json":"sprites/tribesman/bow/kick.json?1509886020000","sprites/tribesman/bow/kick.png":"sprites/tribesman/bow/kick.png?1509886020000","sprites/tribesman/bow/legs_run.json":"sprites/tribesman/bow/legs_run.json?1509886040000","sprites/tribesman/bow/legs_run.png":"sprites/tribesman/bow/legs_run.png?1509886041000","sprites/tribesman/bow/operate_ground.json":"sprites/tribesman/bow/operate_ground.json?1509886062000","sprites/tribesman/bow/operate_ground.png":"sprites/tribesman/bow/operate_ground.png?1509886062000","sprites/tribesman/bow/punch1.json":"sprites/tribesman/bow/punch1.json?1509886090000","sprites/tribesman/bow/punch1.png":"sprites/tribesman/bow/punch1.png?1509886090000","sprites/tribesman/bow/punch2.json":"sprites/tribesman/bow/punch2.json?1509886007000","sprites/tribesman/bow/punch2.png":"sprites/tribesman/bow/punch2.png?1509886007000","sprites/tribesman/bow/reach.json":"sprites/tribesman/bow/reach.json?1510821736000","sprites/tribesman/bow/reach.png":"sprites/tribesman/bow/reach.png?1510821736000","sprites/tribesman/bow/roll.json":"sprites/tribesman/bow/roll.json?1509886086000","sprites/tribesman/bow/roll.png":"sprites/tribesman/bow/roll.png?1509886086000","sprites/tribesman/bow/run.json":"sprites/tribesman/bow/run.json?1509885985000","sprites/tribesman/bow/run.png":"sprites/tribesman/bow/run.png?1509885985000","sprites/tribesman/bow/sit.json":"sprites/tribesman/bow/sit.json?1509885977000","sprites/tribesman/bow/sit.png":"sprites/tribesman/bow/sit.png?1509885977000","sprites/tribesman/bow/spear_attack.json":"sprites/tribesman/bow/spear_attack.json?1509886033000","sprites/tribesman/bow/spear_attack.png":"sprites/tribesman/bow/spear_attack.png?1509886033000","sprites/tribesman/bow/spear_jump.json":"sprites/tribesman/bow/spear_jump.json?1509886078000","sprites/tribesman/bow/spear_jump.png":"sprites/tribesman/bow/spear_jump.png?1509886078000","sprites/tribesman/bow/spear_throw.json":"sprites/tribesman/bow/spear_throw.json?1509886015000","sprites/tribesman/bow/spear_throw.png":"sprites/tribesman/bow/spear_throw.png?1509886015000","sprites/tribesman/bow/spin.json":"sprites/tribesman/bow/spin.json?1509886057000","sprites/tribesman/bow/spin.png":"sprites/tribesman/bow/spin.png?1509886057000","sprites/tribesman/bow/still.json":"sprites/tribesman/bow/still.json?1510762150000","sprites/tribesman/bow/still.png":"sprites/tribesman/bow/still.png?1510762150000","sprites/tribesman/bow/stunned.json":"sprites/tribesman/bow/stunned.json?1509885971000","sprites/tribesman/bow/stunned.png":"sprites/tribesman/bow/stunned.png?1509885972000","sprites/tribesman/bow/tear.json":"sprites/tribesman/bow/tear.json?1509886099000","sprites/tribesman/bow/tear.png":"sprites/tribesman/bow/tear.png?1509886099000","sprites/tribesman/bow/throw.json":"sprites/tribesman/bow/throw.json?1509886094000","sprites/tribesman/bow/throw.png":"sprites/tribesman/bow/throw.png?1509886094000","sprites/tribesman/bow/turntable.json":"sprites/tribesman/bow/turntable.json?1510762152000","sprites/tribesman/bow/turntable.png":"sprites/tribesman/bow/turntable.png?1510762152000","sprites/tribesman/child/attack_bow.json":"sprites/tribesman/child/attack_bow.json?1509883509000","sprites/tribesman/child/attack_bow.png":"sprites/tribesman/child/attack_bow.png?1509883509000","sprites/tribesman/child/attack_horizontal.json":"sprites/tribesman/child/attack_horizontal.json?1509883490000","sprites/tribesman/child/attack_horizontal.png":"sprites/tribesman/child/attack_horizontal.png?1509883490000","sprites/tribesman/child/attack_vertical.json":"sprites/tribesman/child/attack_vertical.json?1509883469000","sprites/tribesman/child/attack_vertical.png":"sprites/tribesman/child/attack_vertical.png?1509883469000","sprites/tribesman/child/block.json":"sprites/tribesman/child/block.json?1509883504000","sprites/tribesman/child/block.png":"sprites/tribesman/child/block.png?1509883504000","sprites/tribesman/child/cast.json":"sprites/tribesman/child/cast.json?1509883455000","sprites/tribesman/child/cast.png":"sprites/tribesman/child/cast.png?1509883455000","sprites/tribesman/child/charge_bow.json":"sprites/tribesman/child/charge_bow.json?1509883484000","sprites/tribesman/child/charge_bow.png":"sprites/tribesman/child/charge_bow.png?1509883484000","sprites/tribesman/child/charge_meele.json":"sprites/tribesman/child/charge_meele.json?1509883482000","sprites/tribesman/child/charge_meele.png":"sprites/tribesman/child/charge_meele.png?1509883482000","sprites/tribesman/child/charge_spell.json":"sprites/tribesman/child/charge_spell.json?1509883421000","sprites/tribesman/child/charge_spell.png":"sprites/tribesman/child/charge_spell.png?1509883421000","sprites/tribesman/child/fall_back.json":"sprites/tribesman/child/fall_back.json?1509883452000","sprites/tribesman/child/fall_back.png":"sprites/tribesman/child/fall_back.png?1509883452000","sprites/tribesman/child/fall_front.json":"sprites/tribesman/child/fall_front.json?1509883533000","sprites/tribesman/child/fall_front.png":"sprites/tribesman/child/fall_front.png?1509883533000","sprites/tribesman/child/growl.json":"sprites/tribesman/child/growl.json?1509883461000","sprites/tribesman/child/growl.png":"sprites/tribesman/child/growl.png?1509883461000","sprites/tribesman/child/kick.json":"sprites/tribesman/child/kick.json?1509883480000","sprites/tribesman/child/kick.png":"sprites/tribesman/child/kick.png?1509883480000","sprites/tribesman/child/legs_run.json":"sprites/tribesman/child/legs_run.json?1509883500000","sprites/tribesman/child/legs_run.png":"sprites/tribesman/child/legs_run.png?1509883500000","sprites/tribesman/child/operate_ground.json":"sprites/tribesman/child/operate_ground.json?1509883523000","sprites/tribesman/child/operate_ground.png":"sprites/tribesman/child/operate_ground.png?1509883523000","sprites/tribesman/child/punch1.json":"sprites/tribesman/child/punch1.json?1509883551000","sprites/tribesman/child/punch1.png":"sprites/tribesman/child/punch1.png?1509883551000","sprites/tribesman/child/punch2.json":"sprites/tribesman/child/punch2.json?1509883464000","sprites/tribesman/child/punch2.png":"sprites/tribesman/child/punch2.png?1509883464000","sprites/tribesman/child/reach.json":"sprites/tribesman/child/reach.json?1510821719000","sprites/tribesman/child/reach.png":"sprites/tribesman/child/reach.png?1510821719000","sprites/tribesman/child/roll.json":"sprites/tribesman/child/roll.json?1509883548000","sprites/tribesman/child/roll.png":"sprites/tribesman/child/roll.png?1509883548000","sprites/tribesman/child/run.json":"sprites/tribesman/child/run.json?1509883443000","sprites/tribesman/child/run.png":"sprites/tribesman/child/run.png?1509883443000","sprites/tribesman/child/sit.json":"sprites/tribesman/child/sit.json?1509883433000","sprites/tribesman/child/sit.png":"sprites/tribesman/child/sit.png?1509883433000","sprites/tribesman/child/spear_attack.json":"sprites/tribesman/child/spear_attack.json?1509883493000","sprites/tribesman/child/spear_attack.png":"sprites/tribesman/child/spear_attack.png?1509883493000","sprites/tribesman/child/spear_jump.json":"sprites/tribesman/child/spear_jump.json?1509883540000","sprites/tribesman/child/spear_jump.png":"sprites/tribesman/child/spear_jump.png?1509883540000","sprites/tribesman/child/spear_throw.json":"sprites/tribesman/child/spear_throw.json?1509883473000","sprites/tribesman/child/spear_throw.png":"sprites/tribesman/child/spear_throw.png?1509883473000","sprites/tribesman/child/spin.json":"sprites/tribesman/child/spin.json?1509883519000","sprites/tribesman/child/spin.png":"sprites/tribesman/child/spin.png?1509883519000","sprites/tribesman/child/stunned.json":"sprites/tribesman/child/stunned.json?1509883429000","sprites/tribesman/child/stunned.png":"sprites/tribesman/child/stunned.png?1509883429000","sprites/tribesman/child/tear.json":"sprites/tribesman/child/tear.json?1509883560000","sprites/tribesman/child/tear.png":"sprites/tribesman/child/tear.png?1509883560000","sprites/tribesman/child/throw.json":"sprites/tribesman/child/throw.json?1509883555000","sprites/tribesman/child/throw.png":"sprites/tribesman/child/throw.png?1509883555000","sprites/tribesman/claws/attack_bow.json":"sprites/tribesman/claws/attack_bow.json?1509886738000","sprites/tribesman/claws/attack_bow.png":"sprites/tribesman/claws/attack_bow.png?1509886738000","sprites/tribesman/claws/attack_horizontal.json":"sprites/tribesman/claws/attack_horizontal.json?1509886721000","sprites/tribesman/claws/attack_horizontal.png":"sprites/tribesman/claws/attack_horizontal.png?1509886721000","sprites/tribesman/claws/attack_vertical.json":"sprites/tribesman/claws/attack_vertical.json?1509886702000","sprites/tribesman/claws/attack_vertical.png":"sprites/tribesman/claws/attack_vertical.png?1509886702000","sprites/tribesman/claws/block.json":"sprites/tribesman/claws/block.json?1509886735000","sprites/tribesman/claws/block.png":"sprites/tribesman/claws/block.png?1509886735000","sprites/tribesman/claws/cast.json":"sprites/tribesman/claws/cast.json?1509886686000","sprites/tribesman/claws/cast.png":"sprites/tribesman/claws/cast.png?1509886687000","sprites/tribesman/claws/charge_bow.json":"sprites/tribesman/claws/charge_bow.json?1509886715000","sprites/tribesman/claws/charge_bow.png":"sprites/tribesman/claws/charge_bow.png?1509886715000","sprites/tribesman/claws/charge_meele.json":"sprites/tribesman/claws/charge_meele.json?1509886713000","sprites/tribesman/claws/charge_meele.png":"sprites/tribesman/claws/charge_meele.png?1509886713000","sprites/tribesman/claws/charge_spell.json":"sprites/tribesman/claws/charge_spell.json?1509886656000","sprites/tribesman/claws/charge_spell.png":"sprites/tribesman/claws/charge_spell.png?1509886656000","sprites/tribesman/claws/fall_back.json":"sprites/tribesman/claws/fall_back.json?1509886683000","sprites/tribesman/claws/fall_back.png":"sprites/tribesman/claws/fall_back.png?1509886684000","sprites/tribesman/claws/fall_front.json":"sprites/tribesman/claws/fall_front.json?1509886761000","sprites/tribesman/claws/fall_front.png":"sprites/tribesman/claws/fall_front.png?1509886761000","sprites/tribesman/claws/growl.json":"sprites/tribesman/claws/growl.json?1509886692000","sprites/tribesman/claws/growl.png":"sprites/tribesman/claws/growl.png?1509886692000","sprites/tribesman/claws/kick.json":"sprites/tribesman/claws/kick.json?1509886711000","sprites/tribesman/claws/kick.png":"sprites/tribesman/claws/kick.png?1509886711000","sprites/tribesman/claws/legs_run.json":"sprites/tribesman/claws/legs_run.json?1509886732000","sprites/tribesman/claws/legs_run.png":"sprites/tribesman/claws/legs_run.png?1509886732000","sprites/tribesman/claws/operate_ground.json":"sprites/tribesman/claws/operate_ground.json?1509886753000","sprites/tribesman/claws/operate_ground.png":"sprites/tribesman/claws/operate_ground.png?1509886753000","sprites/tribesman/claws/punch1.json":"sprites/tribesman/claws/punch1.json?1509886780000","sprites/tribesman/claws/punch1.png":"sprites/tribesman/claws/punch1.png?1509886780000","sprites/tribesman/claws/punch2.json":"sprites/tribesman/claws/punch2.json?1509886696000","sprites/tribesman/claws/punch2.png":"sprites/tribesman/claws/punch2.png?1509886697000","sprites/tribesman/claws/reach.json":"sprites/tribesman/claws/reach.json?1510821746000","sprites/tribesman/claws/reach.png":"sprites/tribesman/claws/reach.png?1510821746000","sprites/tribesman/claws/roll.json":"sprites/tribesman/claws/roll.json?1509886777000","sprites/tribesman/claws/roll.png":"sprites/tribesman/claws/roll.png?1509886777000","sprites/tribesman/claws/run.json":"sprites/tribesman/claws/run.json?1509886675000","sprites/tribesman/claws/run.png":"sprites/tribesman/claws/run.png?1509886675000","sprites/tribesman/claws/sit.json":"sprites/tribesman/claws/sit.json?1509886668000","sprites/tribesman/claws/sit.png":"sprites/tribesman/claws/sit.png?1509886668000","sprites/tribesman/claws/spear_attack.json":"sprites/tribesman/claws/spear_attack.json?1509886725000","sprites/tribesman/claws/spear_attack.png":"sprites/tribesman/claws/spear_attack.png?1509886725000","sprites/tribesman/claws/spear_jump.json":"sprites/tribesman/claws/spear_jump.json?1509886768000","sprites/tribesman/claws/spear_jump.png":"sprites/tribesman/claws/spear_jump.png?1509886768000","sprites/tribesman/claws/spear_throw.json":"sprites/tribesman/claws/spear_throw.json?1509886705000","sprites/tribesman/claws/spear_throw.png":"sprites/tribesman/claws/spear_throw.png?1509886705000","sprites/tribesman/claws/spin.json":"sprites/tribesman/claws/spin.json?1509886748000","sprites/tribesman/claws/spin.png":"sprites/tribesman/claws/spin.png?1509886748000","sprites/tribesman/claws/still.json":"sprites/tribesman/claws/still.json?1510762247000","sprites/tribesman/claws/still.png":"sprites/tribesman/claws/still.png?1510762247000","sprites/tribesman/claws/stunned.json":"sprites/tribesman/claws/stunned.json?1509886663000","sprites/tribesman/claws/stunned.png":"sprites/tribesman/claws/stunned.png?1509886663000","sprites/tribesman/claws/tear.json":"sprites/tribesman/claws/tear.json?1509886788000","sprites/tribesman/claws/tear.png":"sprites/tribesman/claws/tear.png?1509886788000","sprites/tribesman/claws/throw.json":"sprites/tribesman/claws/throw.json?1509886784000","sprites/tribesman/claws/throw.png":"sprites/tribesman/claws/throw.png?1509886784000","sprites/tribesman/claws/turntable.json":"sprites/tribesman/claws/turntable.json?1510762249000","sprites/tribesman/claws/turntable.png":"sprites/tribesman/claws/turntable.png?1510762249000","sprites/tribesman/corpse/fall_back.json":"sprites/tribesman/corpse/fall_back.json?1509203218000","sprites/tribesman/corpse/fall_back.png":"sprites/tribesman/corpse/fall_back.png?1509203219000","sprites/tribesman/corpse/fall_front.json":"sprites/tribesman/corpse/fall_front.json?1509203212000","sprites/tribesman/corpse/fall_front.png":"sprites/tribesman/corpse/fall_front.png?1509203213000","sprites/tribesman/crown/attack_bow.json":"sprites/tribesman/crown/attack_bow.json?1509887141000","sprites/tribesman/crown/attack_bow.png":"sprites/tribesman/crown/attack_bow.png?1509887141000","sprites/tribesman/crown/attack_horizontal.json":"sprites/tribesman/crown/attack_horizontal.json?1509887124000","sprites/tribesman/crown/attack_horizontal.png":"sprites/tribesman/crown/attack_horizontal.png?1509887124000","sprites/tribesman/crown/attack_vertical.json":"sprites/tribesman/crown/attack_vertical.json?1509887104000","sprites/tribesman/crown/attack_vertical.png":"sprites/tribesman/crown/attack_vertical.png?1509887104000","sprites/tribesman/crown/block.json":"sprites/tribesman/crown/block.json?1509887138000","sprites/tribesman/crown/block.png":"sprites/tribesman/crown/block.png?1509887138000","sprites/tribesman/crown/cast.json":"sprites/tribesman/crown/cast.json?1509887090000","sprites/tribesman/crown/cast.png":"sprites/tribesman/crown/cast.png?1509887090000","sprites/tribesman/crown/charge_bow.json":"sprites/tribesman/crown/charge_bow.json?1509887118000","sprites/tribesman/crown/charge_bow.png":"sprites/tribesman/crown/charge_bow.png?1509887118000","sprites/tribesman/crown/charge_meele.json":"sprites/tribesman/crown/charge_meele.json?1509887116000","sprites/tribesman/crown/charge_meele.png":"sprites/tribesman/crown/charge_meele.png?1509887116000","sprites/tribesman/crown/charge_spell.json":"sprites/tribesman/crown/charge_spell.json?1509887057000","sprites/tribesman/crown/charge_spell.png":"sprites/tribesman/crown/charge_spell.png?1509887057000","sprites/tribesman/crown/fall_back.json":"sprites/tribesman/crown/fall_back.json?1509887086000","sprites/tribesman/crown/fall_back.png":"sprites/tribesman/crown/fall_back.png?1509887086000","sprites/tribesman/crown/fall_front.json":"sprites/tribesman/crown/fall_front.json?1509887162000","sprites/tribesman/crown/fall_front.png":"sprites/tribesman/crown/fall_front.png?1509887162000","sprites/tribesman/crown/growl.json":"sprites/tribesman/crown/growl.json?1509887095000","sprites/tribesman/crown/growl.png":"sprites/tribesman/crown/growl.png?1509887095000","sprites/tribesman/crown/kick.json":"sprites/tribesman/crown/kick.json?1509887112000","sprites/tribesman/crown/kick.png":"sprites/tribesman/crown/kick.png?1509887112000","sprites/tribesman/crown/legs_run.json":"sprites/tribesman/crown/legs_run.json?1509887133000","sprites/tribesman/crown/legs_run.png":"sprites/tribesman/crown/legs_run.png?1509887134000","sprites/tribesman/crown/operate_ground.json":"sprites/tribesman/crown/operate_ground.json?1509887154000","sprites/tribesman/crown/operate_ground.png":"sprites/tribesman/crown/operate_ground.png?1509887154000","sprites/tribesman/crown/punch1.json":"sprites/tribesman/crown/punch1.json?1509887181000","sprites/tribesman/crown/punch1.png":"sprites/tribesman/crown/punch1.png?1509887181000","sprites/tribesman/crown/punch2.json":"sprites/tribesman/crown/punch2.json?1509887098000","sprites/tribesman/crown/punch2.png":"sprites/tribesman/crown/punch2.png?1509887099000","sprites/tribesman/crown/reach.json":"sprites/tribesman/crown/reach.json?1510821751000","sprites/tribesman/crown/reach.png":"sprites/tribesman/crown/reach.png?1510821751000","sprites/tribesman/crown/roll.json":"sprites/tribesman/crown/roll.json?1509887178000","sprites/tribesman/crown/roll.png":"sprites/tribesman/crown/roll.png?1509887178000","sprites/tribesman/crown/run.json":"sprites/tribesman/crown/run.json?1509887077000","sprites/tribesman/crown/run.png":"sprites/tribesman/crown/run.png?1509887077000","sprites/tribesman/crown/sit.json":"sprites/tribesman/crown/sit.json?1509887069000","sprites/tribesman/crown/sit.png":"sprites/tribesman/crown/sit.png?1509887069000","sprites/tribesman/crown/spear_attack.json":"sprites/tribesman/crown/spear_attack.json?1509887126000","sprites/tribesman/crown/spear_attack.png":"sprites/tribesman/crown/spear_attack.png?1509887126000","sprites/tribesman/crown/spear_jump.json":"sprites/tribesman/crown/spear_jump.json?1509887168000","sprites/tribesman/crown/spear_jump.png":"sprites/tribesman/crown/spear_jump.png?1509887169000","sprites/tribesman/crown/spear_throw.json":"sprites/tribesman/crown/spear_throw.json?1509887107000","sprites/tribesman/crown/spear_throw.png":"sprites/tribesman/crown/spear_throw.png?1509887107000","sprites/tribesman/crown/spin.json":"sprites/tribesman/crown/spin.json?1509887150000","sprites/tribesman/crown/spin.png":"sprites/tribesman/crown/spin.png?1509887150000","sprites/tribesman/crown/still.json":"sprites/tribesman/crown/still.json?1510762306000","sprites/tribesman/crown/still.png":"sprites/tribesman/crown/still.png?1510762306000","sprites/tribesman/crown/stunned.json":"sprites/tribesman/crown/stunned.json?1509887064000","sprites/tribesman/crown/stunned.png":"sprites/tribesman/crown/stunned.png?1509887064000","sprites/tribesman/crown/tear.json":"sprites/tribesman/crown/tear.json?1509887189000","sprites/tribesman/crown/tear.png":"sprites/tribesman/crown/tear.png?1509887189000","sprites/tribesman/crown/throw.json":"sprites/tribesman/crown/throw.json?1509887185000","sprites/tribesman/crown/throw.png":"sprites/tribesman/crown/throw.png?1509887185000","sprites/tribesman/crown/turntable.json":"sprites/tribesman/crown/turntable.json?1510762307000","sprites/tribesman/crown/turntable.png":"sprites/tribesman/crown/turntable.png?1510762307000","sprites/tribesman/crusader_helmet/attack_bow.json":"sprites/tribesman/crusader_helmet/attack_bow.json?1509887272000","sprites/tribesman/crusader_helmet/attack_bow.png":"sprites/tribesman/crusader_helmet/attack_bow.png?1509887272000","sprites/tribesman/crusader_helmet/attack_horizontal.json":"sprites/tribesman/crusader_helmet/attack_horizontal.json?1509887254000","sprites/tribesman/crusader_helmet/attack_horizontal.png":"sprites/tribesman/crusader_helmet/attack_horizontal.png?1509887254000","sprites/tribesman/crusader_helmet/attack_vertical.json":"sprites/tribesman/crusader_helmet/attack_vertical.json?1509887237000","sprites/tribesman/crusader_helmet/attack_vertical.png":"sprites/tribesman/crusader_helmet/attack_vertical.png?1509887237000","sprites/tribesman/crusader_helmet/block.json":"sprites/tribesman/crusader_helmet/block.json?1509887269000","sprites/tribesman/crusader_helmet/block.png":"sprites/tribesman/crusader_helmet/block.png?1509887269000","sprites/tribesman/crusader_helmet/cast.json":"sprites/tribesman/crusader_helmet/cast.json?1509887222000","sprites/tribesman/crusader_helmet/cast.png":"sprites/tribesman/crusader_helmet/cast.png?1509887222000","sprites/tribesman/crusader_helmet/charge_bow.json":"sprites/tribesman/crusader_helmet/charge_bow.json?1509887249000","sprites/tribesman/crusader_helmet/charge_bow.png":"sprites/tribesman/crusader_helmet/charge_bow.png?1509887249000","sprites/tribesman/crusader_helmet/charge_meele.json":"sprites/tribesman/crusader_helmet/charge_meele.json?1509887247000","sprites/tribesman/crusader_helmet/charge_meele.png":"sprites/tribesman/crusader_helmet/charge_meele.png?1509887247000","sprites/tribesman/crusader_helmet/charge_spell.json":"sprites/tribesman/crusader_helmet/charge_spell.json?1509887191000","sprites/tribesman/crusader_helmet/charge_spell.png":"sprites/tribesman/crusader_helmet/charge_spell.png?1509887191000","sprites/tribesman/crusader_helmet/fall_back.json":"sprites/tribesman/crusader_helmet/fall_back.json?1509887219000","sprites/tribesman/crusader_helmet/fall_back.png":"sprites/tribesman/crusader_helmet/fall_back.png?1509887219000","sprites/tribesman/crusader_helmet/fall_front.json":"sprites/tribesman/crusader_helmet/fall_front.json?1509887294000","sprites/tribesman/crusader_helmet/fall_front.png":"sprites/tribesman/crusader_helmet/fall_front.png?1509887294000","sprites/tribesman/crusader_helmet/growl.json":"sprites/tribesman/crusader_helmet/growl.json?1509887227000","sprites/tribesman/crusader_helmet/growl.png":"sprites/tribesman/crusader_helmet/growl.png?1509887227000","sprites/tribesman/crusader_helmet/kick.json":"sprites/tribesman/crusader_helmet/kick.json?1509887245000","sprites/tribesman/crusader_helmet/kick.png":"sprites/tribesman/crusader_helmet/kick.png?1509887245000","sprites/tribesman/crusader_helmet/legs_run.json":"sprites/tribesman/crusader_helmet/legs_run.json?1509887265000","sprites/tribesman/crusader_helmet/legs_run.png":"sprites/tribesman/crusader_helmet/legs_run.png?1509887265000","sprites/tribesman/crusader_helmet/operate_ground.json":"sprites/tribesman/crusader_helmet/operate_ground.json?1509887285000","sprites/tribesman/crusader_helmet/operate_ground.png":"sprites/tribesman/crusader_helmet/operate_ground.png?1509887285000","sprites/tribesman/crusader_helmet/punch1.json":"sprites/tribesman/crusader_helmet/punch1.json?1509887310000","sprites/tribesman/crusader_helmet/punch1.png":"sprites/tribesman/crusader_helmet/punch1.png?1509887310000","sprites/tribesman/crusader_helmet/punch2.json":"sprites/tribesman/crusader_helmet/punch2.json?1509887232000","sprites/tribesman/crusader_helmet/punch2.png":"sprites/tribesman/crusader_helmet/punch2.png?1509887232000","sprites/tribesman/crusader_helmet/reach.json":"sprites/tribesman/crusader_helmet/reach.json?1510821753000","sprites/tribesman/crusader_helmet/reach.png":"sprites/tribesman/crusader_helmet/reach.png?1510821753000","sprites/tribesman/crusader_helmet/roll.json":"sprites/tribesman/crusader_helmet/roll.json?1509887307000","sprites/tribesman/crusader_helmet/roll.png":"sprites/tribesman/crusader_helmet/roll.png?1509887307000","sprites/tribesman/crusader_helmet/run.json":"sprites/tribesman/crusader_helmet/run.json?1509887211000","sprites/tribesman/crusader_helmet/run.png":"sprites/tribesman/crusader_helmet/run.png?1509887211000","sprites/tribesman/crusader_helmet/sit.json":"sprites/tribesman/crusader_helmet/sit.json?1509887203000","sprites/tribesman/crusader_helmet/sit.png":"sprites/tribesman/crusader_helmet/sit.png?1509887203000","sprites/tribesman/crusader_helmet/spear_attack.json":"sprites/tribesman/crusader_helmet/spear_attack.json?1509887258000","sprites/tribesman/crusader_helmet/spear_attack.png":"sprites/tribesman/crusader_helmet/spear_attack.png?1509887258000","sprites/tribesman/crusader_helmet/spear_jump.json":"sprites/tribesman/crusader_helmet/spear_jump.json?1509887300000","sprites/tribesman/crusader_helmet/spear_jump.png":"sprites/tribesman/crusader_helmet/spear_jump.png?1509887300000","sprites/tribesman/crusader_helmet/spear_throw.json":"sprites/tribesman/crusader_helmet/spear_throw.json?1509887240000","sprites/tribesman/crusader_helmet/spear_throw.png":"sprites/tribesman/crusader_helmet/spear_throw.png?1509887240000","sprites/tribesman/crusader_helmet/spin.json":"sprites/tribesman/crusader_helmet/spin.json?1509887280000","sprites/tribesman/crusader_helmet/spin.png":"sprites/tribesman/crusader_helmet/spin.png?1509887281000","sprites/tribesman/crusader_helmet/still.json":"sprites/tribesman/crusader_helmet/still.json?1510762506000","sprites/tribesman/crusader_helmet/still.png":"sprites/tribesman/crusader_helmet/still.png?1510762506000","sprites/tribesman/crusader_helmet/stunned.json":"sprites/tribesman/crusader_helmet/stunned.json?1509887198000","sprites/tribesman/crusader_helmet/stunned.png":"sprites/tribesman/crusader_helmet/stunned.png?1509887198000","sprites/tribesman/crusader_helmet/tear.json":"sprites/tribesman/crusader_helmet/tear.json?1509887319000","sprites/tribesman/crusader_helmet/tear.png":"sprites/tribesman/crusader_helmet/tear.png?1509887319000","sprites/tribesman/crusader_helmet/throw.json":"sprites/tribesman/crusader_helmet/throw.json?1509887313000","sprites/tribesman/crusader_helmet/throw.png":"sprites/tribesman/crusader_helmet/throw.png?1509887313000","sprites/tribesman/crusader_helmet/turntable.json":"sprites/tribesman/crusader_helmet/turntable.json?1510762507000","sprites/tribesman/crusader_helmet/turntable.png":"sprites/tribesman/crusader_helmet/turntable.png?1510762507000","sprites/tribesman/dagger/attack_bow.json":"sprites/tribesman/dagger/attack_bow.json?1513963975000","sprites/tribesman/dagger/attack_bow.png":"sprites/tribesman/dagger/attack_bow.png?1513963976000","sprites/tribesman/dagger/attack_horizontal.json":"sprites/tribesman/dagger/attack_horizontal.json?1513963868000","sprites/tribesman/dagger/attack_horizontal.png":"sprites/tribesman/dagger/attack_horizontal.png?1513963869000","sprites/tribesman/dagger/attack_vertical.json":"sprites/tribesman/dagger/attack_vertical.json?1513963934000","sprites/tribesman/dagger/attack_vertical.png":"sprites/tribesman/dagger/attack_vertical.png?1513963935000","sprites/tribesman/dagger/block.json":"sprites/tribesman/dagger/block.json?1513963878000","sprites/tribesman/dagger/block.png":"sprites/tribesman/dagger/block.png?1513963878000","sprites/tribesman/dagger/cast.json":"sprites/tribesman/dagger/cast.json?1513963979000","sprites/tribesman/dagger/cast.png":"sprites/tribesman/dagger/cast.png?1513963981000","sprites/tribesman/dagger/charge_bow.json":"sprites/tribesman/dagger/charge_bow.json?1513963952000","sprites/tribesman/dagger/charge_bow.png":"sprites/tribesman/dagger/charge_bow.png?1513963953000","sprites/tribesman/dagger/charge_meele.json":"sprites/tribesman/dagger/charge_meele.json?1513963852000","sprites/tribesman/dagger/charge_meele.png":"sprites/tribesman/dagger/charge_meele.png?1513963853000","sprites/tribesman/dagger/charge_spell.json":"sprites/tribesman/dagger/charge_spell.json?1513963907000","sprites/tribesman/dagger/charge_spell.png":"sprites/tribesman/dagger/charge_spell.png?1513963908000","sprites/tribesman/dagger/fall_back.json":"sprites/tribesman/dagger/fall_back.json?1513963923000","sprites/tribesman/dagger/fall_back.png":"sprites/tribesman/dagger/fall_back.png?1513963925000","sprites/tribesman/dagger/fall_front.json":"sprites/tribesman/dagger/fall_front.json?1513963900000","sprites/tribesman/dagger/fall_front.png":"sprites/tribesman/dagger/fall_front.png?1513963901000","sprites/tribesman/dagger/growl.json":"sprites/tribesman/dagger/growl.json?1513963964000","sprites/tribesman/dagger/growl.png":"sprites/tribesman/dagger/growl.png?1513963965000","sprites/tribesman/dagger/kick.json":"sprites/tribesman/dagger/kick.json?1513963958000","sprites/tribesman/dagger/kick.png":"sprites/tribesman/dagger/kick.png?1513963959000","sprites/tribesman/dagger/legs_run.json":"sprites/tribesman/dagger/legs_run.json?1513963885000","sprites/tribesman/dagger/legs_run.png":"sprites/tribesman/dagger/legs_run.png?1513963886000","sprites/tribesman/dagger/operate_ground.json":"sprites/tribesman/dagger/operate_ground.json?1513963940000","sprites/tribesman/dagger/operate_ground.png":"sprites/tribesman/dagger/operate_ground.png?1513963941000","sprites/tribesman/dagger/punch1.json":"sprites/tribesman/dagger/punch1.json?1513963849000","sprites/tribesman/dagger/punch1.png":"sprites/tribesman/dagger/punch1.png?1513963850000","sprites/tribesman/dagger/punch2.json":"sprites/tribesman/dagger/punch2.json?1513963890000","sprites/tribesman/dagger/punch2.png":"sprites/tribesman/dagger/punch2.png?1513963891000","sprites/tribesman/dagger/reach.json":"sprites/tribesman/dagger/reach.json?1513963903000","sprites/tribesman/dagger/reach.png":"sprites/tribesman/dagger/reach.png?1513963904000","sprites/tribesman/dagger/roll.json":"sprites/tribesman/dagger/roll.json?1513963948000","sprites/tribesman/dagger/roll.png":"sprites/tribesman/dagger/roll.png?1513963950000","sprites/tribesman/dagger/run.json":"sprites/tribesman/dagger/run.json?1513963861000","sprites/tribesman/dagger/run.png":"sprites/tribesman/dagger/run.png?1513963862000","sprites/tribesman/dagger/sit.json":"sprites/tribesman/dagger/sit.json?1513963970000","sprites/tribesman/dagger/sit.png":"sprites/tribesman/dagger/sit.png?1513963972000","sprites/tribesman/dagger/spear_attack.json":"sprites/tribesman/dagger/spear_attack.json?1513963927000","sprites/tribesman/dagger/spear_attack.png":"sprites/tribesman/dagger/spear_attack.png?1513963929000","sprites/tribesman/dagger/spear_jump.json":"sprites/tribesman/dagger/spear_jump.json?1513963914000","sprites/tribesman/dagger/spear_jump.png":"sprites/tribesman/dagger/spear_jump.png?1513963915000","sprites/tribesman/dagger/spear_throw.json":"sprites/tribesman/dagger/spear_throw.json?1513963984000","sprites/tribesman/dagger/spear_throw.png":"sprites/tribesman/dagger/spear_throw.png?1513963985000","sprites/tribesman/dagger/spin.json":"sprites/tribesman/dagger/spin.json?1513963832000","sprites/tribesman/dagger/spin.png":"sprites/tribesman/dagger/spin.png?1513963832000","sprites/tribesman/dagger/stunned.json":"sprites/tribesman/dagger/stunned.json?1513963840000","sprites/tribesman/dagger/stunned.png":"sprites/tribesman/dagger/stunned.png?1513963841000","sprites/tribesman/dagger/tear.json":"sprites/tribesman/dagger/tear.json?1513963873000","sprites/tribesman/dagger/tear.png":"sprites/tribesman/dagger/tear.png?1513963874000","sprites/tribesman/dagger/throw.json":"sprites/tribesman/dagger/throw.json?1513963844000","sprites/tribesman/dagger/throw.png":"sprites/tribesman/dagger/throw.png?1513963845000","sprites/tribesman/dagger/turntable.json":"sprites/tribesman/dagger/turntable.json?1513963732000","sprites/tribesman/dagger/turntable.png":"sprites/tribesman/dagger/turntable.png?1513963732000","sprites/tribesman/dagger/zombie_run.json":"sprites/tribesman/dagger/zombie_run.json?1513963994000","sprites/tribesman/dagger/zombie_run.png":"sprites/tribesman/dagger/zombie_run.png?1513963994000","sprites/tribesman/demon_horns/sit.json":"sprites/tribesman/demon_horns/sit.json?1509393835000","sprites/tribesman/demon_horns/sit.png":"sprites/tribesman/demon_horns/sit.png?1509393835000","sprites/tribesman/demon_horns/spin.json":"sprites/tribesman/demon_horns/spin.json?1510762487000","sprites/tribesman/demon_horns/spin.png":"sprites/tribesman/demon_horns/spin.png?1510762487000","sprites/tribesman/demon_horns/still.json":"sprites/tribesman/demon_horns/still.json?1510762489000","sprites/tribesman/demon_horns/still.png":"sprites/tribesman/demon_horns/still.png?1510762489000","sprites/tribesman/demon_horns/turntable.json":"sprites/tribesman/demon_horns/turntable.json?1510762490000","sprites/tribesman/demon_horns/turntable.png":"sprites/tribesman/demon_horns/turntable.png?1510762490000","sprites/tribesman/demon_wings/sit.json":"sprites/tribesman/demon_wings/sit.json?1509393851000","sprites/tribesman/demon_wings/sit.png":"sprites/tribesman/demon_wings/sit.png?1509393851000","sprites/tribesman/demon_wings/spin.json":"sprites/tribesman/demon_wings/spin.json?1510762469000","sprites/tribesman/demon_wings/spin.png":"sprites/tribesman/demon_wings/spin.png?1510762469000","sprites/tribesman/demon_wings/still.json":"sprites/tribesman/demon_wings/still.json?1510762472000","sprites/tribesman/demon_wings/still.png":"sprites/tribesman/demon_wings/still.png?1510762472000","sprites/tribesman/demon_wings/turntable.json":"sprites/tribesman/demon_wings/turntable.json?1510762474000","sprites/tribesman/demon_wings/turntable.png":"sprites/tribesman/demon_wings/turntable.png?1510762474000","sprites/tribesman/elf_ears/attack_bow.json":"sprites/tribesman/elf_ears/attack_bow.json?1512721525000","sprites/tribesman/elf_ears/attack_bow.png":"sprites/tribesman/elf_ears/attack_bow.png?1512721525000","sprites/tribesman/elf_ears/attack_horizontal.json":"sprites/tribesman/elf_ears/attack_horizontal.json?1512721595000","sprites/tribesman/elf_ears/attack_horizontal.png":"sprites/tribesman/elf_ears/attack_horizontal.png?1512721595000","sprites/tribesman/elf_ears/attack_vertical.json":"sprites/tribesman/elf_ears/attack_vertical.json?1512721584000","sprites/tribesman/elf_ears/attack_vertical.png":"sprites/tribesman/elf_ears/attack_vertical.png?1512721584000","sprites/tribesman/elf_ears/block.json":"sprites/tribesman/elf_ears/block.json?1512721642000","sprites/tribesman/elf_ears/block.png":"sprites/tribesman/elf_ears/block.png?1512721642000","sprites/tribesman/elf_ears/cast.json":"sprites/tribesman/elf_ears/cast.json?1512721679000","sprites/tribesman/elf_ears/cast.png":"sprites/tribesman/elf_ears/cast.png?1512721679000","sprites/tribesman/elf_ears/charge_bow.json":"sprites/tribesman/elf_ears/charge_bow.json?1512721543000","sprites/tribesman/elf_ears/charge_bow.png":"sprites/tribesman/elf_ears/charge_bow.png?1512721543000","sprites/tribesman/elf_ears/charge_meele.json":"sprites/tribesman/elf_ears/charge_meele.json?1512721576000","sprites/tribesman/elf_ears/charge_meele.png":"sprites/tribesman/elf_ears/charge_meele.png?1512721577000","sprites/tribesman/elf_ears/charge_spell.json":"sprites/tribesman/elf_ears/charge_spell.json?1512721586000","sprites/tribesman/elf_ears/charge_spell.png":"sprites/tribesman/elf_ears/charge_spell.png?1512721586000","sprites/tribesman/elf_ears/fall_back.json":"sprites/tribesman/elf_ears/fall_back.json?1512721660000","sprites/tribesman/elf_ears/fall_back.png":"sprites/tribesman/elf_ears/fall_back.png?1512721660000","sprites/tribesman/elf_ears/fall_front.json":"sprites/tribesman/elf_ears/fall_front.json?1512721632000","sprites/tribesman/elf_ears/fall_front.png":"sprites/tribesman/elf_ears/fall_front.png?1512721632000","sprites/tribesman/elf_ears/growl.json":"sprites/tribesman/elf_ears/growl.json?1512721666000","sprites/tribesman/elf_ears/growl.png":"sprites/tribesman/elf_ears/growl.png?1512721666000","sprites/tribesman/elf_ears/kick.json":"sprites/tribesman/elf_ears/kick.json?1512721520000","sprites/tribesman/elf_ears/kick.png":"sprites/tribesman/elf_ears/kick.png?1512721520000","sprites/tribesman/elf_ears/legs_run.json":"sprites/tribesman/elf_ears/legs_run.json?1512721551000","sprites/tribesman/elf_ears/legs_run.png":"sprites/tribesman/elf_ears/legs_run.png?1512721551000","sprites/tribesman/elf_ears/operate_ground.json":"sprites/tribesman/elf_ears/operate_ground.json?1512721676000","sprites/tribesman/elf_ears/operate_ground.png":"sprites/tribesman/elf_ears/operate_ground.png?1512721676000","sprites/tribesman/elf_ears/punch1.json":"sprites/tribesman/elf_ears/punch1.json?1512721529000","sprites/tribesman/elf_ears/punch1.png":"sprites/tribesman/elf_ears/punch1.png?1512721529000","sprites/tribesman/elf_ears/punch2.json":"sprites/tribesman/elf_ears/punch2.json?1512721637000","sprites/tribesman/elf_ears/punch2.png":"sprites/tribesman/elf_ears/punch2.png?1512721637000","sprites/tribesman/elf_ears/reach.json":"sprites/tribesman/elf_ears/reach.json?1512721540000","sprites/tribesman/elf_ears/reach.png":"sprites/tribesman/elf_ears/reach.png?1512721540000","sprites/tribesman/elf_ears/roll.json":"sprites/tribesman/elf_ears/roll.json?1512721573000","sprites/tribesman/elf_ears/roll.png":"sprites/tribesman/elf_ears/roll.png?1512721573000","sprites/tribesman/elf_ears/run.json":"sprites/tribesman/elf_ears/run.json?1512721613000","sprites/tribesman/elf_ears/run.png":"sprites/tribesman/elf_ears/run.png?1512721613000","sprites/tribesman/elf_ears/sit.json":"sprites/tribesman/elf_ears/sit.json?1512721620000","sprites/tribesman/elf_ears/sit.png":"sprites/tribesman/elf_ears/sit.png?1512721620000","sprites/tribesman/elf_ears/spear_attack.json":"sprites/tribesman/elf_ears/spear_attack.json?1512721503000","sprites/tribesman/elf_ears/spear_attack.png":"sprites/tribesman/elf_ears/spear_attack.png?1512721503000","sprites/tribesman/elf_ears/spear_jump.json":"sprites/tribesman/elf_ears/spear_jump.json?1512721537000","sprites/tribesman/elf_ears/spear_jump.png":"sprites/tribesman/elf_ears/spear_jump.png?1512721537000","sprites/tribesman/elf_ears/spear_throw.json":"sprites/tribesman/elf_ears/spear_throw.json?1512721599000","sprites/tribesman/elf_ears/spear_throw.png":"sprites/tribesman/elf_ears/spear_throw.png?1512721599000","sprites/tribesman/elf_ears/spin.json":"sprites/tribesman/elf_ears/spin.json?1512721562000","sprites/tribesman/elf_ears/spin.png":"sprites/tribesman/elf_ears/spin.png?1512721562000","sprites/tribesman/elf_ears/stunned.json":"sprites/tribesman/elf_ears/stunned.json?1512721513000","sprites/tribesman/elf_ears/stunned.png":"sprites/tribesman/elf_ears/stunned.png?1512721513000","sprites/tribesman/elf_ears/tear.json":"sprites/tribesman/elf_ears/tear.json?1512721648000","sprites/tribesman/elf_ears/tear.png":"sprites/tribesman/elf_ears/tear.png?1512721648000","sprites/tribesman/elf_ears/throw.json":"sprites/tribesman/elf_ears/throw.json?1512721671000","sprites/tribesman/elf_ears/throw.png":"sprites/tribesman/elf_ears/throw.png?1512721671000","sprites/tribesman/fedora/sit.json":"sprites/tribesman/fedora/sit.json?1509393723000","sprites/tribesman/fedora/sit.png":"sprites/tribesman/fedora/sit.png?1509393723000","sprites/tribesman/fedora/spin.json":"sprites/tribesman/fedora/spin.json?1510762038000","sprites/tribesman/fedora/spin.png":"sprites/tribesman/fedora/spin.png?1510762038000","sprites/tribesman/fedora/still.json":"sprites/tribesman/fedora/still.json?1510762040000","sprites/tribesman/fedora/still.png":"sprites/tribesman/fedora/still.png?1510762040000","sprites/tribesman/fedora/turntable.json":"sprites/tribesman/fedora/turntable.json?1510762041000","sprites/tribesman/fedora/turntable.png":"sprites/tribesman/fedora/turntable.png?1510762041000","sprites/tribesman/female/attack_bow.json":"sprites/tribesman/female/attack_bow.json?1509883246000","sprites/tribesman/female/attack_bow.png":"sprites/tribesman/female/attack_bow.png?1509883246000","sprites/tribesman/female/attack_horizontal.json":"sprites/tribesman/female/attack_horizontal.json?1509883219000","sprites/tribesman/female/attack_horizontal.png":"sprites/tribesman/female/attack_horizontal.png?1509883219000","sprites/tribesman/female/attack_vertical.json":"sprites/tribesman/female/attack_vertical.json?1509883197000","sprites/tribesman/female/attack_vertical.png":"sprites/tribesman/female/attack_vertical.png?1509883197000","sprites/tribesman/female/block.json":"sprites/tribesman/female/block.json?1509883243000","sprites/tribesman/female/block.png":"sprites/tribesman/female/block.png?1509883243000","sprites/tribesman/female/cast.json":"sprites/tribesman/female/cast.json?1509883180000","sprites/tribesman/female/cast.png":"sprites/tribesman/female/cast.png?1509883180000","sprites/tribesman/female/charge_bow.json":"sprites/tribesman/female/charge_bow.json?1509883213000","sprites/tribesman/female/charge_bow.png":"sprites/tribesman/female/charge_bow.png?1509883213000","sprites/tribesman/female/charge_meele.json":"sprites/tribesman/female/charge_meele.json?1509883211000","sprites/tribesman/female/charge_meele.png":"sprites/tribesman/female/charge_meele.png?1509883211000","sprites/tribesman/female/charge_spell.json":"sprites/tribesman/female/charge_spell.json?1509883132000","sprites/tribesman/female/charge_spell.png":"sprites/tribesman/female/charge_spell.png?1509883132000","sprites/tribesman/female/fall_back.json":"sprites/tribesman/female/fall_back.json?1509883176000","sprites/tribesman/female/fall_back.png":"sprites/tribesman/female/fall_back.png?1509883176000","sprites/tribesman/female/fall_front.json":"sprites/tribesman/female/fall_front.json?1509883267000","sprites/tribesman/female/fall_front.png":"sprites/tribesman/female/fall_front.png?1509883267000","sprites/tribesman/female/growl.json":"sprites/tribesman/female/growl.json?1509883187000","sprites/tribesman/female/growl.png":"sprites/tribesman/female/growl.png?1509883187000","sprites/tribesman/female/kick.json":"sprites/tribesman/female/kick.json?1509883209000","sprites/tribesman/female/kick.png":"sprites/tribesman/female/kick.png?1509883209000","sprites/tribesman/female/legs_run.json":"sprites/tribesman/female/legs_run.json?1509883238000","sprites/tribesman/female/legs_run.png":"sprites/tribesman/female/legs_run.png?1509883238000","sprites/tribesman/female/operate_ground.json":"sprites/tribesman/female/operate_ground.json?1509883258000","sprites/tribesman/female/operate_ground.png":"sprites/tribesman/female/operate_ground.png?1509883259000","sprites/tribesman/female/punch1.json":"sprites/tribesman/female/punch1.json?1509883287000","sprites/tribesman/female/punch1.png":"sprites/tribesman/female/punch1.png?1509883287000","sprites/tribesman/female/punch2.json":"sprites/tribesman/female/punch2.json?1509883191000","sprites/tribesman/female/punch2.png":"sprites/tribesman/female/punch2.png?1509883191000","sprites/tribesman/female/reach.json":"sprites/tribesman/female/reach.json?1510821715000","sprites/tribesman/female/reach.png":"sprites/tribesman/female/reach.png?1510821715000","sprites/tribesman/female/roll.json":"sprites/tribesman/female/roll.json?1509883283000","sprites/tribesman/female/roll.png":"sprites/tribesman/female/roll.png?1509883284000","sprites/tribesman/female/run.json":"sprites/tribesman/female/run.json?1509883161000","sprites/tribesman/female/run.png":"sprites/tribesman/female/run.png?1509883161000","sprites/tribesman/female/sit.json":"sprites/tribesman/female/sit.json?1509883150000","sprites/tribesman/female/sit.png":"sprites/tribesman/female/sit.png?1509883150000","sprites/tribesman/female/spear_attack.json":"sprites/tribesman/female/spear_attack.json?1509883222000","sprites/tribesman/female/spear_attack.png":"sprites/tribesman/female/spear_attack.png?1509883222000","sprites/tribesman/female/spear_jump.json":"sprites/tribesman/female/spear_jump.json?1509883276000","sprites/tribesman/female/spear_jump.png":"sprites/tribesman/female/spear_jump.png?1509883276000","sprites/tribesman/female/spear_throw.json":"sprites/tribesman/female/spear_throw.json?1509883201000","sprites/tribesman/female/spear_throw.png":"sprites/tribesman/female/spear_throw.png?1509883201000","sprites/tribesman/female/spin.json":"sprites/tribesman/female/spin.json?1509883254000","sprites/tribesman/female/spin.png":"sprites/tribesman/female/spin.png?1509883254000","sprites/tribesman/female/stunned.json":"sprites/tribesman/female/stunned.json?1509883142000","sprites/tribesman/female/stunned.png":"sprites/tribesman/female/stunned.png?1509883142000","sprites/tribesman/female/tear.json":"sprites/tribesman/female/tear.json?1509883294000","sprites/tribesman/female/tear.png":"sprites/tribesman/female/tear.png?1509883294000","sprites/tribesman/female/throw.json":"sprites/tribesman/female/throw.json?1509883290000","sprites/tribesman/female/throw.png":"sprites/tribesman/female/throw.png?1509883290000","sprites/tribesman/fire_staff/sit.json":"sprites/tribesman/fire_staff/sit.json?1509393765000","sprites/tribesman/fire_staff/sit.png":"sprites/tribesman/fire_staff/sit.png?1509393766000","sprites/tribesman/flag/attack_bow.json":"sprites/tribesman/flag/attack_bow.json?1509886190000","sprites/tribesman/flag/attack_bow.png":"sprites/tribesman/flag/attack_bow.png?1509886190000","sprites/tribesman/flag/attack_horizontal.json":"sprites/tribesman/flag/attack_horizontal.json?1509886169000","sprites/tribesman/flag/attack_horizontal.png":"sprites/tribesman/flag/attack_horizontal.png?1509886169000","sprites/tribesman/flag/attack_vertical.json":"sprites/tribesman/flag/attack_vertical.json?1509886148000","sprites/tribesman/flag/attack_vertical.png":"sprites/tribesman/flag/attack_vertical.png?1509886148000","sprites/tribesman/flag/block.json":"sprites/tribesman/flag/block.json?1509886186000","sprites/tribesman/flag/block.png":"sprites/tribesman/flag/block.png?1509886186000","sprites/tribesman/flag/cast.json":"sprites/tribesman/flag/cast.json?1509886134000","sprites/tribesman/flag/cast.png":"sprites/tribesman/flag/cast.png?1509886134000","sprites/tribesman/flag/charge_bow.json":"sprites/tribesman/flag/charge_bow.json?1509886163000","sprites/tribesman/flag/charge_bow.png":"sprites/tribesman/flag/charge_bow.png?1509886163000","sprites/tribesman/flag/charge_meele.json":"sprites/tribesman/flag/charge_meele.json?1509886161000","sprites/tribesman/flag/charge_meele.png":"sprites/tribesman/flag/charge_meele.png?1509886161000","sprites/tribesman/flag/charge_spell.json":"sprites/tribesman/flag/charge_spell.json?1509886101000","sprites/tribesman/flag/charge_spell.png":"sprites/tribesman/flag/charge_spell.png?1509886101000","sprites/tribesman/flag/fall_back.json":"sprites/tribesman/flag/fall_back.json?1509886131000","sprites/tribesman/flag/fall_back.png":"sprites/tribesman/flag/fall_back.png?1509886131000","sprites/tribesman/flag/fall_front.json":"sprites/tribesman/flag/fall_front.json?1509886211000","sprites/tribesman/flag/fall_front.png":"sprites/tribesman/flag/fall_front.png?1509886211000","sprites/tribesman/flag/growl.json":"sprites/tribesman/flag/growl.json?1509886139000","sprites/tribesman/flag/growl.png":"sprites/tribesman/flag/growl.png?1509886139000","sprites/tribesman/flag/kick.json":"sprites/tribesman/flag/kick.json?1509886158000","sprites/tribesman/flag/kick.png":"sprites/tribesman/flag/kick.png?1509886158000","sprites/tribesman/flag/legs_run.json":"sprites/tribesman/flag/legs_run.json?1509886182000","sprites/tribesman/flag/legs_run.png":"sprites/tribesman/flag/legs_run.png?1509886183000","sprites/tribesman/flag/operate_ground.json":"sprites/tribesman/flag/operate_ground.json?1509886203000","sprites/tribesman/flag/operate_ground.png":"sprites/tribesman/flag/operate_ground.png?1509886203000","sprites/tribesman/flag/punch1.json":"sprites/tribesman/flag/punch1.json?1509886230000","sprites/tribesman/flag/punch1.png":"sprites/tribesman/flag/punch1.png?1509886230000","sprites/tribesman/flag/punch2.json":"sprites/tribesman/flag/punch2.json?1509886142000","sprites/tribesman/flag/punch2.png":"sprites/tribesman/flag/punch2.png?1509886142000","sprites/tribesman/flag/reach.json":"sprites/tribesman/flag/reach.json?1510821738000","sprites/tribesman/flag/reach.png":"sprites/tribesman/flag/reach.png?1510821738000","sprites/tribesman/flag/roll.json":"sprites/tribesman/flag/roll.json?1509886227000","sprites/tribesman/flag/roll.png":"sprites/tribesman/flag/roll.png?1509886227000","sprites/tribesman/flag/run.json":"sprites/tribesman/flag/run.json?1509886122000","sprites/tribesman/flag/run.png":"sprites/tribesman/flag/run.png?1509886122000","sprites/tribesman/flag/sit.json":"sprites/tribesman/flag/sit.json?1509886113000","sprites/tribesman/flag/sit.png":"sprites/tribesman/flag/sit.png?1509886113000","sprites/tribesman/flag/spear_attack.json":"sprites/tribesman/flag/spear_attack.json?1509886173000","sprites/tribesman/flag/spear_attack.png":"sprites/tribesman/flag/spear_attack.png?1509886173000","sprites/tribesman/flag/spear_jump.json":"sprites/tribesman/flag/spear_jump.json?1509886217000","sprites/tribesman/flag/spear_jump.png":"sprites/tribesman/flag/spear_jump.png?1509886217000","sprites/tribesman/flag/spear_throw.json":"sprites/tribesman/flag/spear_throw.json?1509886153000","sprites/tribesman/flag/spear_throw.png":"sprites/tribesman/flag/spear_throw.png?1509886153000","sprites/tribesman/flag/spin.json":"sprites/tribesman/flag/spin.json?1509886198000","sprites/tribesman/flag/spin.png":"sprites/tribesman/flag/spin.png?1509886198000","sprites/tribesman/flag/still.json":"sprites/tribesman/flag/still.json?1510762169000","sprites/tribesman/flag/still.png":"sprites/tribesman/flag/still.png?1510762169000","sprites/tribesman/flag/stunned.json":"sprites/tribesman/flag/stunned.json?1509886108000","sprites/tribesman/flag/stunned.png":"sprites/tribesman/flag/stunned.png?1509886108000","sprites/tribesman/flag/tear.json":"sprites/tribesman/flag/tear.json?1509886238000","sprites/tribesman/flag/tear.png":"sprites/tribesman/flag/tear.png?1509886238000","sprites/tribesman/flag/throw.json":"sprites/tribesman/flag/throw.json?1509886234000","sprites/tribesman/flag/throw.png":"sprites/tribesman/flag/throw.png?1509886234000","sprites/tribesman/flag/turntable.json":"sprites/tribesman/flag/turntable.json?1510762171000","sprites/tribesman/flag/turntable.png":"sprites/tribesman/flag/turntable.png?1510762171000","sprites/tribesman/fox_head/sit.json":"sprites/tribesman/fox_head/sit.json?1509393755000","sprites/tribesman/fox_head/sit.png":"sprites/tribesman/fox_head/sit.png?1509393755000","sprites/tribesman/fox_head/spin.json":"sprites/tribesman/fox_head/spin.json?1510762127000","sprites/tribesman/fox_head/spin.png":"sprites/tribesman/fox_head/spin.png?1510762127000","sprites/tribesman/fox_head/still.json":"sprites/tribesman/fox_head/still.json?1510762130000","sprites/tribesman/fox_head/still.png":"sprites/tribesman/fox_head/still.png?1510762130000","sprites/tribesman/fox_head/turntable.json":"sprites/tribesman/fox_head/turntable.json?1510762131000","sprites/tribesman/fox_head/turntable.png":"sprites/tribesman/fox_head/turntable.png?1510762131000","sprites/tribesman/hammer/attack_bow.json":"sprites/tribesman/hammer/attack_bow.json?1509885059000","sprites/tribesman/hammer/attack_bow.png":"sprites/tribesman/hammer/attack_bow.png?1509885059000","sprites/tribesman/hammer/attack_horizontal.json":"sprites/tribesman/hammer/attack_horizontal.json?1509885043000","sprites/tribesman/hammer/attack_horizontal.png":"sprites/tribesman/hammer/attack_horizontal.png?1509885043000","sprites/tribesman/hammer/attack_vertical.json":"sprites/tribesman/hammer/attack_vertical.json?1509885025000","sprites/tribesman/hammer/attack_vertical.png":"sprites/tribesman/hammer/attack_vertical.png?1509885025000","sprites/tribesman/hammer/block.json":"sprites/tribesman/hammer/block.json?1509885056000","sprites/tribesman/hammer/block.png":"sprites/tribesman/hammer/block.png?1509885056000","sprites/tribesman/hammer/cast.json":"sprites/tribesman/hammer/cast.json?1509885011000","sprites/tribesman/hammer/cast.png":"sprites/tribesman/hammer/cast.png?1509885011000","sprites/tribesman/hammer/charge_bow.json":"sprites/tribesman/hammer/charge_bow.json?1509885038000","sprites/tribesman/hammer/charge_bow.png":"sprites/tribesman/hammer/charge_bow.png?1509885038000","sprites/tribesman/hammer/charge_meele.json":"sprites/tribesman/hammer/charge_meele.json?1509885036000","sprites/tribesman/hammer/charge_meele.png":"sprites/tribesman/hammer/charge_meele.png?1509885036000","sprites/tribesman/hammer/charge_spell.json":"sprites/tribesman/hammer/charge_spell.json?1509884980000","sprites/tribesman/hammer/charge_spell.png":"sprites/tribesman/hammer/charge_spell.png?1509884981000","sprites/tribesman/hammer/fall_back.json":"sprites/tribesman/hammer/fall_back.json?1509885008000","sprites/tribesman/hammer/fall_back.png":"sprites/tribesman/hammer/fall_back.png?1509885008000","sprites/tribesman/hammer/fall_front.json":"sprites/tribesman/hammer/fall_front.json?1509885080000","sprites/tribesman/hammer/fall_front.png":"sprites/tribesman/hammer/fall_front.png?1509885081000","sprites/tribesman/hammer/growl.json":"sprites/tribesman/hammer/growl.json?1509885016000","sprites/tribesman/hammer/growl.png":"sprites/tribesman/hammer/growl.png?1509885017000","sprites/tribesman/hammer/kick.json":"sprites/tribesman/hammer/kick.json?1509885033000","sprites/tribesman/hammer/kick.png":"sprites/tribesman/hammer/kick.png?1509885034000","sprites/tribesman/hammer/legs_run.json":"sprites/tribesman/hammer/legs_run.json?1509885052000","sprites/tribesman/hammer/legs_run.png":"sprites/tribesman/hammer/legs_run.png?1509885052000","sprites/tribesman/hammer/operate_ground.json":"sprites/tribesman/hammer/operate_ground.json?1509885072000","sprites/tribesman/hammer/operate_ground.png":"sprites/tribesman/hammer/operate_ground.png?1509885072000","sprites/tribesman/hammer/punch1.json":"sprites/tribesman/hammer/punch1.json?1509885097000","sprites/tribesman/hammer/punch1.png":"sprites/tribesman/hammer/punch1.png?1509885097000","sprites/tribesman/hammer/punch2.json":"sprites/tribesman/hammer/punch2.json?1509885020000","sprites/tribesman/hammer/punch2.png":"sprites/tribesman/hammer/punch2.png?1509885020000","sprites/tribesman/hammer/reach.json":"sprites/tribesman/hammer/reach.json?1510821723000","sprites/tribesman/hammer/reach.png":"sprites/tribesman/hammer/reach.png?1510821723000","sprites/tribesman/hammer/roll.json":"sprites/tribesman/hammer/roll.json?1509885094000","sprites/tribesman/hammer/roll.png":"sprites/tribesman/hammer/roll.png?1509885094000","sprites/tribesman/hammer/run.json":"sprites/tribesman/hammer/run.json?1509885000000","sprites/tribesman/hammer/run.png":"sprites/tribesman/hammer/run.png?1509885000000","sprites/tribesman/hammer/sit.json":"sprites/tribesman/hammer/sit.json?1509884992000","sprites/tribesman/hammer/sit.png":"sprites/tribesman/hammer/sit.png?1509884992000","sprites/tribesman/hammer/spear_attack.json":"sprites/tribesman/hammer/spear_attack.json?1509885046000","sprites/tribesman/hammer/spear_attack.png":"sprites/tribesman/hammer/spear_attack.png?1509885046000","sprites/tribesman/hammer/spear_jump.json":"sprites/tribesman/hammer/spear_jump.json?1509885086000","sprites/tribesman/hammer/spear_jump.png":"sprites/tribesman/hammer/spear_jump.png?1509885087000","sprites/tribesman/hammer/spear_throw.json":"sprites/tribesman/hammer/spear_throw.json?1509885028000","sprites/tribesman/hammer/spear_throw.png":"sprites/tribesman/hammer/spear_throw.png?1509885028000","sprites/tribesman/hammer/spin.json":"sprites/tribesman/hammer/spin.json?1509885067000","sprites/tribesman/hammer/spin.png":"sprites/tribesman/hammer/spin.png?1509885067000","sprites/tribesman/hammer/still.json":"sprites/tribesman/hammer/still.json?1510762006000","sprites/tribesman/hammer/still.png":"sprites/tribesman/hammer/still.png?1510762006000","sprites/tribesman/hammer/stunned.json":"sprites/tribesman/hammer/stunned.json?1509884987000","sprites/tribesman/hammer/stunned.png":"sprites/tribesman/hammer/stunned.png?1509884988000","sprites/tribesman/hammer/tear.json":"sprites/tribesman/hammer/tear.json?1509885105000","sprites/tribesman/hammer/tear.png":"sprites/tribesman/hammer/tear.png?1509885105000","sprites/tribesman/hammer/throw.json":"sprites/tribesman/hammer/throw.json?1509885101000","sprites/tribesman/hammer/throw.png":"sprites/tribesman/hammer/throw.png?1509885101000","sprites/tribesman/hammer/turntable.json":"sprites/tribesman/hammer/turntable.json?1510762008000","sprites/tribesman/hammer/turntable.png":"sprites/tribesman/hammer/turntable.png?1510762008000","sprites/tribesman/hood/attack_bow.json":"sprites/tribesman/hood/attack_bow.json?1509885641000","sprites/tribesman/hood/attack_bow.png":"sprites/tribesman/hood/attack_bow.png?1509885641000","sprites/tribesman/hood/attack_horizontal.json":"sprites/tribesman/hood/attack_horizontal.json?1509885623000","sprites/tribesman/hood/attack_horizontal.png":"sprites/tribesman/hood/attack_horizontal.png?1509885624000","sprites/tribesman/hood/attack_vertical.json":"sprites/tribesman/hood/attack_vertical.json?1509885604000","sprites/tribesman/hood/attack_vertical.png":"sprites/tribesman/hood/attack_vertical.png?1509885604000","sprites/tribesman/hood/block.json":"sprites/tribesman/hood/block.json?1509885638000","sprites/tribesman/hood/block.png":"sprites/tribesman/hood/block.png?1509885638000","sprites/tribesman/hood/cast.json":"sprites/tribesman/hood/cast.json?1509885590000","sprites/tribesman/hood/cast.png":"sprites/tribesman/hood/cast.png?1509885590000","sprites/tribesman/hood/charge_bow.json":"sprites/tribesman/hood/charge_bow.json?1509885618000","sprites/tribesman/hood/charge_bow.png":"sprites/tribesman/hood/charge_bow.png?1509885618000","sprites/tribesman/hood/charge_meele.json":"sprites/tribesman/hood/charge_meele.json?1509885616000","sprites/tribesman/hood/charge_meele.png":"sprites/tribesman/hood/charge_meele.png?1509885616000","sprites/tribesman/hood/charge_spell.json":"sprites/tribesman/hood/charge_spell.json?1509885553000","sprites/tribesman/hood/charge_spell.png":"sprites/tribesman/hood/charge_spell.png?1509885553000","sprites/tribesman/hood/fall_back.json":"sprites/tribesman/hood/fall_back.json?1509885586000","sprites/tribesman/hood/fall_back.png":"sprites/tribesman/hood/fall_back.png?1509885587000","sprites/tribesman/hood/fall_front.json":"sprites/tribesman/hood/fall_front.json?1509885662000","sprites/tribesman/hood/fall_front.png":"sprites/tribesman/hood/fall_front.png?1509885663000","sprites/tribesman/hood/growl.json":"sprites/tribesman/hood/growl.json?1509885595000","sprites/tribesman/hood/growl.png":"sprites/tribesman/hood/growl.png?1509885595000","sprites/tribesman/hood/kick.json":"sprites/tribesman/hood/kick.json?1509885614000","sprites/tribesman/hood/kick.png":"sprites/tribesman/hood/kick.png?1509885614000","sprites/tribesman/hood/legs_run.json":"sprites/tribesman/hood/legs_run.json?1509885633000","sprites/tribesman/hood/legs_run.png":"sprites/tribesman/hood/legs_run.png?1509885633000","sprites/tribesman/hood/operate_ground.json":"sprites/tribesman/hood/operate_ground.json?1509885654000","sprites/tribesman/hood/operate_ground.png":"sprites/tribesman/hood/operate_ground.png?1509885654000","sprites/tribesman/hood/punch1.json":"sprites/tribesman/hood/punch1.json?1509885680000","sprites/tribesman/hood/punch1.png":"sprites/tribesman/hood/punch1.png?1509885680000","sprites/tribesman/hood/punch2.json":"sprites/tribesman/hood/punch2.json?1509885598000","sprites/tribesman/hood/punch2.png":"sprites/tribesman/hood/punch2.png?1509885598000","sprites/tribesman/hood/reach.json":"sprites/tribesman/hood/reach.json?1510821730000","sprites/tribesman/hood/reach.png":"sprites/tribesman/hood/reach.png?1510821730000","sprites/tribesman/hood/roll.json":"sprites/tribesman/hood/roll.json?1509885676000","sprites/tribesman/hood/roll.png":"sprites/tribesman/hood/roll.png?1509885676000","sprites/tribesman/hood/run.json":"sprites/tribesman/hood/run.json?1509885578000","sprites/tribesman/hood/run.png":"sprites/tribesman/hood/run.png?1509885578000","sprites/tribesman/hood/sit.json":"sprites/tribesman/hood/sit.json?1509885569000","sprites/tribesman/hood/sit.png":"sprites/tribesman/hood/sit.png?1509885569000","sprites/tribesman/hood/spear_attack.json":"sprites/tribesman/hood/spear_attack.json?1509885626000","sprites/tribesman/hood/spear_attack.png":"sprites/tribesman/hood/spear_attack.png?1509885626000","sprites/tribesman/hood/spear_jump.json":"sprites/tribesman/hood/spear_jump.json?1509885668000","sprites/tribesman/hood/spear_jump.png":"sprites/tribesman/hood/spear_jump.png?1509885668000","sprites/tribesman/hood/spear_throw.json":"sprites/tribesman/hood/spear_throw.json?1509885608000","sprites/tribesman/hood/spear_throw.png":"sprites/tribesman/hood/spear_throw.png?1509885608000","sprites/tribesman/hood/spin.json":"sprites/tribesman/hood/spin.json?1509885650000","sprites/tribesman/hood/spin.png":"sprites/tribesman/hood/spin.png?1509885650000","sprites/tribesman/hood/still.json":"sprites/tribesman/hood/still.json?1510762068000","sprites/tribesman/hood/still.png":"sprites/tribesman/hood/still.png?1510762068000","sprites/tribesman/hood/stunned.json":"sprites/tribesman/hood/stunned.json?1509885564000","sprites/tribesman/hood/stunned.png":"sprites/tribesman/hood/stunned.png?1509885564000","sprites/tribesman/hood/tear.json":"sprites/tribesman/hood/tear.json?1509885689000","sprites/tribesman/hood/tear.png":"sprites/tribesman/hood/tear.png?1509885689000","sprites/tribesman/hood/throw.json":"sprites/tribesman/hood/throw.json?1509885684000","sprites/tribesman/hood/throw.png":"sprites/tribesman/hood/throw.png?1509885685000","sprites/tribesman/hood/turntable.json":"sprites/tribesman/hood/turntable.json?1510762069000","sprites/tribesman/hood/turntable.png":"sprites/tribesman/hood/turntable.png?1510762069000","sprites/tribesman/ice_staff/attack_bow.json":"sprites/tribesman/ice_staff/attack_bow.json?1509886464000","sprites/tribesman/ice_staff/attack_bow.png":"sprites/tribesman/ice_staff/attack_bow.png?1509886464000","sprites/tribesman/ice_staff/attack_horizontal.json":"sprites/tribesman/ice_staff/attack_horizontal.json?1509886447000","sprites/tribesman/ice_staff/attack_horizontal.png":"sprites/tribesman/ice_staff/attack_horizontal.png?1509886447000","sprites/tribesman/ice_staff/attack_vertical.json":"sprites/tribesman/ice_staff/attack_vertical.json?1509886426000","sprites/tribesman/ice_staff/attack_vertical.png":"sprites/tribesman/ice_staff/attack_vertical.png?1509886426000","sprites/tribesman/ice_staff/block.json":"sprites/tribesman/ice_staff/block.json?1509886461000","sprites/tribesman/ice_staff/block.png":"sprites/tribesman/ice_staff/block.png?1509886461000","sprites/tribesman/ice_staff/cast.json":"sprites/tribesman/ice_staff/cast.json?1509886412000","sprites/tribesman/ice_staff/cast.png":"sprites/tribesman/ice_staff/cast.png?1509886412000","sprites/tribesman/ice_staff/charge_bow.json":"sprites/tribesman/ice_staff/charge_bow.json?1509886441000","sprites/tribesman/ice_staff/charge_bow.png":"sprites/tribesman/ice_staff/charge_bow.png?1509886441000","sprites/tribesman/ice_staff/charge_meele.json":"sprites/tribesman/ice_staff/charge_meele.json?1509886438000","sprites/tribesman/ice_staff/charge_meele.png":"sprites/tribesman/ice_staff/charge_meele.png?1509886438000","sprites/tribesman/ice_staff/charge_spell.json":"sprites/tribesman/ice_staff/charge_spell.json?1509886377000","sprites/tribesman/ice_staff/charge_spell.png":"sprites/tribesman/ice_staff/charge_spell.png?1509886377000","sprites/tribesman/ice_staff/fall_back.json":"sprites/tribesman/ice_staff/fall_back.json?1509886408000","sprites/tribesman/ice_staff/fall_back.png":"sprites/tribesman/ice_staff/fall_back.png?1509886408000","sprites/tribesman/ice_staff/fall_front.json":"sprites/tribesman/ice_staff/fall_front.json?1509886486000","sprites/tribesman/ice_staff/fall_front.png":"sprites/tribesman/ice_staff/fall_front.png?1509886487000","sprites/tribesman/ice_staff/growl.json":"sprites/tribesman/ice_staff/growl.json?1509886417000","sprites/tribesman/ice_staff/growl.png":"sprites/tribesman/ice_staff/growl.png?1509886417000","sprites/tribesman/ice_staff/kick.json":"sprites/tribesman/ice_staff/kick.json?1509886436000","sprites/tribesman/ice_staff/kick.png":"sprites/tribesman/ice_staff/kick.png?1509886436000","sprites/tribesman/ice_staff/legs_run.json":"sprites/tribesman/ice_staff/legs_run.json?1509886457000","sprites/tribesman/ice_staff/legs_run.png":"sprites/tribesman/ice_staff/legs_run.png?1509886457000","sprites/tribesman/ice_staff/operate_ground.json":"sprites/tribesman/ice_staff/operate_ground.json?1509886477000","sprites/tribesman/ice_staff/operate_ground.png":"sprites/tribesman/ice_staff/operate_ground.png?1509886478000","sprites/tribesman/ice_staff/punch1.json":"sprites/tribesman/ice_staff/punch1.json?1509886504000","sprites/tribesman/ice_staff/punch1.png":"sprites/tribesman/ice_staff/punch1.png?1509886504000","sprites/tribesman/ice_staff/punch2.json":"sprites/tribesman/ice_staff/punch2.json?1509886421000","sprites/tribesman/ice_staff/punch2.png":"sprites/tribesman/ice_staff/punch2.png?1509886421000","sprites/tribesman/ice_staff/reach.json":"sprites/tribesman/ice_staff/reach.json?1510821742000","sprites/tribesman/ice_staff/reach.png":"sprites/tribesman/ice_staff/reach.png?1510821742000","sprites/tribesman/ice_staff/roll.json":"sprites/tribesman/ice_staff/roll.json?1509886501000","sprites/tribesman/ice_staff/roll.png":"sprites/tribesman/ice_staff/roll.png?1509886501000","sprites/tribesman/ice_staff/run.json":"sprites/tribesman/ice_staff/run.json?1509886398000","sprites/tribesman/ice_staff/run.png":"sprites/tribesman/ice_staff/run.png?1509886398000","sprites/tribesman/ice_staff/sit.json":"sprites/tribesman/ice_staff/sit.json?1509886390000","sprites/tribesman/ice_staff/sit.png":"sprites/tribesman/ice_staff/sit.png?1509886391000","sprites/tribesman/ice_staff/spear_attack.json":"sprites/tribesman/ice_staff/spear_attack.json?1509886449000","sprites/tribesman/ice_staff/spear_attack.png":"sprites/tribesman/ice_staff/spear_attack.png?1509886449000","sprites/tribesman/ice_staff/spear_jump.json":"sprites/tribesman/ice_staff/spear_jump.json?1509886493000","sprites/tribesman/ice_staff/spear_jump.png":"sprites/tribesman/ice_staff/spear_jump.png?1509886493000","sprites/tribesman/ice_staff/spear_throw.json":"sprites/tribesman/ice_staff/spear_throw.json?1509886429000","sprites/tribesman/ice_staff/spear_throw.png":"sprites/tribesman/ice_staff/spear_throw.png?1509886429000","sprites/tribesman/ice_staff/spin.json":"sprites/tribesman/ice_staff/spin.json?1509886473000","sprites/tribesman/ice_staff/spin.png":"sprites/tribesman/ice_staff/spin.png?1509886473000","sprites/tribesman/ice_staff/still.json":"sprites/tribesman/ice_staff/still.json?1510762205000","sprites/tribesman/ice_staff/still.png":"sprites/tribesman/ice_staff/still.png?1510762205000","sprites/tribesman/ice_staff/stunned.json":"sprites/tribesman/ice_staff/stunned.json?1509886384000","sprites/tribesman/ice_staff/stunned.png":"sprites/tribesman/ice_staff/stunned.png?1509886384000","sprites/tribesman/ice_staff/tear.json":"sprites/tribesman/ice_staff/tear.json?1509886512000","sprites/tribesman/ice_staff/tear.png":"sprites/tribesman/ice_staff/tear.png?1509886513000","sprites/tribesman/ice_staff/throw.json":"sprites/tribesman/ice_staff/throw.json?1509886508000","sprites/tribesman/ice_staff/throw.png":"sprites/tribesman/ice_staff/throw.png?1509886508000","sprites/tribesman/ice_staff/turntable.json":"sprites/tribesman/ice_staff/turntable.json?1510762206000","sprites/tribesman/ice_staff/turntable.png":"sprites/tribesman/ice_staff/turntable.png?1510762206000","sprites/tribesman/legion_helmet/attack_bow.json":"sprites/tribesman/legion_helmet/attack_bow.json?1509885491000","sprites/tribesman/legion_helmet/attack_bow.png":"sprites/tribesman/legion_helmet/attack_bow.png?1509885491000","sprites/tribesman/legion_helmet/attack_horizontal.json":"sprites/tribesman/legion_helmet/attack_horizontal.json?1509885466000","sprites/tribesman/legion_helmet/attack_horizontal.png":"sprites/tribesman/legion_helmet/attack_horizontal.png?1509885466000","sprites/tribesman/legion_helmet/attack_vertical.json":"sprites/tribesman/legion_helmet/attack_vertical.json?1509885444000","sprites/tribesman/legion_helmet/attack_vertical.png":"sprites/tribesman/legion_helmet/attack_vertical.png?1509885444000","sprites/tribesman/legion_helmet/block.json":"sprites/tribesman/legion_helmet/block.json?1509885486000","sprites/tribesman/legion_helmet/block.png":"sprites/tribesman/legion_helmet/block.png?1509885486000","sprites/tribesman/legion_helmet/cast.json":"sprites/tribesman/legion_helmet/cast.json?1509885426000","sprites/tribesman/legion_helmet/cast.png":"sprites/tribesman/legion_helmet/cast.png?1509885426000","sprites/tribesman/legion_helmet/charge_bow.json":"sprites/tribesman/legion_helmet/charge_bow.json?1509885459000","sprites/tribesman/legion_helmet/charge_bow.png":"sprites/tribesman/legion_helmet/charge_bow.png?1509885460000","sprites/tribesman/legion_helmet/charge_meele.json":"sprites/tribesman/legion_helmet/charge_meele.json?1509885456000","sprites/tribesman/legion_helmet/charge_meele.png":"sprites/tribesman/legion_helmet/charge_meele.png?1509885456000","sprites/tribesman/legion_helmet/charge_spell.json":"sprites/tribesman/legion_helmet/charge_spell.json?1509885391000","sprites/tribesman/legion_helmet/charge_spell.png":"sprites/tribesman/legion_helmet/charge_spell.png?1509885391000","sprites/tribesman/legion_helmet/fall_back.json":"sprites/tribesman/legion_helmet/fall_back.json?1509885422000","sprites/tribesman/legion_helmet/fall_back.png":"sprites/tribesman/legion_helmet/fall_back.png?1509885422000","sprites/tribesman/legion_helmet/fall_front.json":"sprites/tribesman/legion_helmet/fall_front.json?1509885517000","sprites/tribesman/legion_helmet/fall_front.png":"sprites/tribesman/legion_helmet/fall_front.png?1509885517000","sprites/tribesman/legion_helmet/growl.json":"sprites/tribesman/legion_helmet/growl.json?1509885432000","sprites/tribesman/legion_helmet/growl.png":"sprites/tribesman/legion_helmet/growl.png?1509885432000","sprites/tribesman/legion_helmet/kick.json":"sprites/tribesman/legion_helmet/kick.json?1509885454000","sprites/tribesman/legion_helmet/kick.png":"sprites/tribesman/legion_helmet/kick.png?1509885454000","sprites/tribesman/legion_helmet/legs_run.json":"sprites/tribesman/legion_helmet/legs_run.json?1509885481000","sprites/tribesman/legion_helmet/legs_run.png":"sprites/tribesman/legion_helmet/legs_run.png?1509885481000","sprites/tribesman/legion_helmet/operate_ground.json":"sprites/tribesman/legion_helmet/operate_ground.json?1509885508000","sprites/tribesman/legion_helmet/operate_ground.png":"sprites/tribesman/legion_helmet/operate_ground.png?1509885508000","sprites/tribesman/legion_helmet/punch1.json":"sprites/tribesman/legion_helmet/punch1.json?1509885535000","sprites/tribesman/legion_helmet/punch1.png":"sprites/tribesman/legion_helmet/punch1.png?1509885536000","sprites/tribesman/legion_helmet/punch2.json":"sprites/tribesman/legion_helmet/punch2.json?1509885437000","sprites/tribesman/legion_helmet/punch2.png":"sprites/tribesman/legion_helmet/punch2.png?1509885437000","sprites/tribesman/legion_helmet/reach.json":"sprites/tribesman/legion_helmet/reach.json?1510821729000","sprites/tribesman/legion_helmet/reach.png":"sprites/tribesman/legion_helmet/reach.png?1510821729000","sprites/tribesman/legion_helmet/roll.json":"sprites/tribesman/legion_helmet/roll.json?1509885532000","sprites/tribesman/legion_helmet/roll.png":"sprites/tribesman/legion_helmet/roll.png?1509885532000","sprites/tribesman/legion_helmet/run.json":"sprites/tribesman/legion_helmet/run.json?1509885414000","sprites/tribesman/legion_helmet/run.png":"sprites/tribesman/legion_helmet/run.png?1509885414000","sprites/tribesman/legion_helmet/sit.json":"sprites/tribesman/legion_helmet/sit.json?1509885404000","sprites/tribesman/legion_helmet/sit.png":"sprites/tribesman/legion_helmet/sit.png?1509885404000","sprites/tribesman/legion_helmet/spear_attack.json":"sprites/tribesman/legion_helmet/spear_attack.json?1509885471000","sprites/tribesman/legion_helmet/spear_attack.png":"sprites/tribesman/legion_helmet/spear_attack.png?1509885471000","sprites/tribesman/legion_helmet/spear_jump.json":"sprites/tribesman/legion_helmet/spear_jump.json?1509885524000","sprites/tribesman/legion_helmet/spear_jump.png":"sprites/tribesman/legion_helmet/spear_jump.png?1509885524000","sprites/tribesman/legion_helmet/spear_throw.json":"sprites/tribesman/legion_helmet/spear_throw.json?1509885447000","sprites/tribesman/legion_helmet/spear_throw.png":"sprites/tribesman/legion_helmet/spear_throw.png?1509885447000","sprites/tribesman/legion_helmet/spin.json":"sprites/tribesman/legion_helmet/spin.json?1509885503000","sprites/tribesman/legion_helmet/spin.png":"sprites/tribesman/legion_helmet/spin.png?1509885503000","sprites/tribesman/legion_helmet/still.json":"sprites/tribesman/legion_helmet/still.json?1510762055000","sprites/tribesman/legion_helmet/still.png":"sprites/tribesman/legion_helmet/still.png?1510762055000","sprites/tribesman/legion_helmet/stunned.json":"sprites/tribesman/legion_helmet/stunned.json?1509885399000","sprites/tribesman/legion_helmet/stunned.png":"sprites/tribesman/legion_helmet/stunned.png?1509885399000","sprites/tribesman/legion_helmet/tear.json":"sprites/tribesman/legion_helmet/tear.json?1509885549000","sprites/tribesman/legion_helmet/tear.png":"sprites/tribesman/legion_helmet/tear.png?1509885549000","sprites/tribesman/legion_helmet/throw.json":"sprites/tribesman/legion_helmet/throw.json?1509885543000","sprites/tribesman/legion_helmet/throw.png":"sprites/tribesman/legion_helmet/throw.png?1509885543000","sprites/tribesman/legion_helmet/turntable.json":"sprites/tribesman/legion_helmet/turntable.json?1510762056000","sprites/tribesman/legion_helmet/turntable.png":"sprites/tribesman/legion_helmet/turntable.png?1510762056000","sprites/tribesman/male/attack_bow.json":"sprites/tribesman/male/attack_bow.json?1509883064000","sprites/tribesman/male/attack_bow.png":"sprites/tribesman/male/attack_bow.png?1509883064000","sprites/tribesman/male/attack_horizontal.json":"sprites/tribesman/male/attack_horizontal.json?1509883045000","sprites/tribesman/male/attack_horizontal.png":"sprites/tribesman/male/attack_horizontal.png?1509883045000","sprites/tribesman/male/attack_vertical.json":"sprites/tribesman/male/attack_vertical.json?1509883018000","sprites/tribesman/male/attack_vertical.png":"sprites/tribesman/male/attack_vertical.png?1509883018000","sprites/tribesman/male/block.json":"sprites/tribesman/male/block.json?1509883059000","sprites/tribesman/male/block.png":"sprites/tribesman/male/block.png?1509883059000","sprites/tribesman/male/cast.json":"sprites/tribesman/male/cast.json?1509882998000","sprites/tribesman/male/cast.png":"sprites/tribesman/male/cast.png?1509882998000","sprites/tribesman/male/charge_bow.json":"sprites/tribesman/male/charge_bow.json?1509883038000","sprites/tribesman/male/charge_bow.png":"sprites/tribesman/male/charge_bow.png?1509883038000","sprites/tribesman/male/charge_meele.json":"sprites/tribesman/male/charge_meele.json?1509883036000","sprites/tribesman/male/charge_meele.png":"sprites/tribesman/male/charge_meele.png?1509883036000","sprites/tribesman/male/charge_spell.json":"sprites/tribesman/male/charge_spell.json?1509882965000","sprites/tribesman/male/charge_spell.png":"sprites/tribesman/male/charge_spell.png?1509882965000","sprites/tribesman/male/fall_back.json":"sprites/tribesman/male/fall_back.json?1509882994000","sprites/tribesman/male/fall_back.png":"sprites/tribesman/male/fall_back.png?1509882994000","sprites/tribesman/male/fall_front.json":"sprites/tribesman/male/fall_front.json?1509883096000","sprites/tribesman/male/fall_front.png":"sprites/tribesman/male/fall_front.png?1509883096000","sprites/tribesman/male/growl.json":"sprites/tribesman/male/growl.json?1509883004000","sprites/tribesman/male/growl.png":"sprites/tribesman/male/growl.png?1509883004000","sprites/tribesman/male/kick.json":"sprites/tribesman/male/kick.json?1509883032000","sprites/tribesman/male/kick.png":"sprites/tribesman/male/kick.png?1509883032000","sprites/tribesman/male/legs_run.json":"sprites/tribesman/male/legs_run.json?1509883055000","sprites/tribesman/male/legs_run.png":"sprites/tribesman/male/legs_run.png?1509883055000","sprites/tribesman/male/operate_ground.json":"sprites/tribesman/male/operate_ground.json?1509883086000","sprites/tribesman/male/operate_ground.png":"sprites/tribesman/male/operate_ground.png?1509883086000","sprites/tribesman/male/punch1.json":"sprites/tribesman/male/punch1.json?1509883121000","sprites/tribesman/male/punch1.png":"sprites/tribesman/male/punch1.png?1509883121000","sprites/tribesman/male/punch2.json":"sprites/tribesman/male/punch2.json?1509883009000","sprites/tribesman/male/punch2.png":"sprites/tribesman/male/punch2.png?1509883009000","sprites/tribesman/male/reach.json":"sprites/tribesman/male/reach.json?1510821713000","sprites/tribesman/male/reach.png":"sprites/tribesman/male/reach.png?1510821713000","sprites/tribesman/male/roll.json":"sprites/tribesman/male/roll.json?1509883115000","sprites/tribesman/male/roll.png":"sprites/tribesman/male/roll.png?1509883115000","sprites/tribesman/male/run.json":"sprites/tribesman/male/run.json?1509882986000","sprites/tribesman/male/run.png":"sprites/tribesman/male/run.png?1509882986000","sprites/tribesman/male/sit.json":"sprites/tribesman/male/sit.json?1509882976000","sprites/tribesman/male/sit.png":"sprites/tribesman/male/sit.png?1509882976000","sprites/tribesman/male/spear_attack.json":"sprites/tribesman/male/spear_attack.json?1509883047000","sprites/tribesman/male/spear_attack.png":"sprites/tribesman/male/spear_attack.png?1509883048000","sprites/tribesman/male/spear_jump.json":"sprites/tribesman/male/spear_jump.json?1509883104000","sprites/tribesman/male/spear_jump.png":"sprites/tribesman/male/spear_jump.png?1509883104000","sprites/tribesman/male/spear_throw.json":"sprites/tribesman/male/spear_throw.json?1509883022000","sprites/tribesman/male/spear_throw.png":"sprites/tribesman/male/spear_throw.png?1509883022000","sprites/tribesman/male/spin.json":"sprites/tribesman/male/spin.json?1509883079000","sprites/tribesman/male/spin.png":"sprites/tribesman/male/spin.png?1509883079000","sprites/tribesman/male/stunned.json":"sprites/tribesman/male/stunned.json?1509882972000","sprites/tribesman/male/stunned.png":"sprites/tribesman/male/stunned.png?1509882972000","sprites/tribesman/male/tear.json":"sprites/tribesman/male/tear.json?1509883130000","sprites/tribesman/male/tear.png":"sprites/tribesman/male/tear.png?1509883130000","sprites/tribesman/male/throw.json":"sprites/tribesman/male/throw.json?1509883125000","sprites/tribesman/male/throw.png":"sprites/tribesman/male/throw.png?1509883125000","sprites/tribesman/noble_cape/attack_bow.json":"sprites/tribesman/noble_cape/attack_bow.json?1509698760000","sprites/tribesman/noble_cape/attack_bow.png":"sprites/tribesman/noble_cape/attack_bow.png?1509698761000","sprites/tribesman/noble_cape/attack_horizontal.json":"sprites/tribesman/noble_cape/attack_horizontal.json?1509698777000","sprites/tribesman/noble_cape/attack_horizontal.png":"sprites/tribesman/noble_cape/attack_horizontal.png?1509698777000","sprites/tribesman/noble_cape/attack_vertical.json":"sprites/tribesman/noble_cape/attack_vertical.json?1509698698000","sprites/tribesman/noble_cape/attack_vertical.png":"sprites/tribesman/noble_cape/attack_vertical.png?1509698698000","sprites/tribesman/noble_cape/block.json":"sprites/tribesman/noble_cape/block.json?1509698674000","sprites/tribesman/noble_cape/block.png":"sprites/tribesman/noble_cape/block.png?1509698674000","sprites/tribesman/noble_cape/cast.json":"sprites/tribesman/noble_cape/cast.json?1509698764000","sprites/tribesman/noble_cape/cast.png":"sprites/tribesman/noble_cape/cast.png?1509698764000","sprites/tribesman/noble_cape/charge_bow.json":"sprites/tribesman/noble_cape/charge_bow.json?1509698721000","sprites/tribesman/noble_cape/charge_bow.png":"sprites/tribesman/noble_cape/charge_bow.png?1509698721000","sprites/tribesman/noble_cape/charge_meele.json":"sprites/tribesman/noble_cape/charge_meele.json?1509698734000","sprites/tribesman/noble_cape/charge_meele.png":"sprites/tribesman/noble_cape/charge_meele.png?1509698734000","sprites/tribesman/noble_cape/charge_spell.json":"sprites/tribesman/noble_cape/charge_spell.json?1509698677000","sprites/tribesman/noble_cape/charge_spell.png":"sprites/tribesman/noble_cape/charge_spell.png?1509698677000","sprites/tribesman/noble_cape/fall_back.json":"sprites/tribesman/noble_cape/fall_back.json?1509698787000","sprites/tribesman/noble_cape/fall_back.png":"sprites/tribesman/noble_cape/fall_back.png?1509698787000","sprites/tribesman/noble_cape/fall_front.json":"sprites/tribesman/noble_cape/fall_front.json?1509698690000","sprites/tribesman/noble_cape/fall_front.png":"sprites/tribesman/noble_cape/fall_front.png?1509698690000","sprites/tribesman/noble_cape/growl.json":"sprites/tribesman/noble_cape/growl.json?1509698800000","sprites/tribesman/noble_cape/growl.png":"sprites/tribesman/noble_cape/growl.png?1509698800000","sprites/tribesman/noble_cape/kick.json":"sprites/tribesman/noble_cape/kick.json?1509698747000","sprites/tribesman/noble_cape/kick.png":"sprites/tribesman/noble_cape/kick.png?1509698747000","sprites/tribesman/noble_cape/legs_run.json":"sprites/tribesman/noble_cape/legs_run.json?1509698706000","sprites/tribesman/noble_cape/legs_run.png":"sprites/tribesman/noble_cape/legs_run.png?1509698706000","sprites/tribesman/noble_cape/operate_ground.json":"sprites/tribesman/noble_cape/operate_ground.json?1509698792000","sprites/tribesman/noble_cape/operate_ground.png":"sprites/tribesman/noble_cape/operate_ground.png?1509698793000","sprites/tribesman/noble_cape/punch1.json":"sprites/tribesman/noble_cape/punch1.json?1509698771000","sprites/tribesman/noble_cape/punch1.png":"sprites/tribesman/noble_cape/punch1.png?1509698771000","sprites/tribesman/noble_cape/punch2.json":"sprites/tribesman/noble_cape/punch2.json?1509698710000","sprites/tribesman/noble_cape/punch2.png":"sprites/tribesman/noble_cape/punch2.png?1509698710000","sprites/tribesman/noble_cape/roll.json":"sprites/tribesman/noble_cape/roll.json?1509698815000","sprites/tribesman/noble_cape/roll.png":"sprites/tribesman/noble_cape/roll.png?1509698815000","sprites/tribesman/noble_cape/run.json":"sprites/tribesman/noble_cape/run.json?1509698755000","sprites/tribesman/noble_cape/run.png":"sprites/tribesman/noble_cape/run.png?1509698755000","sprites/tribesman/noble_cape/sit.json":"sprites/tribesman/noble_cape/sit.json?1509698806000","sprites/tribesman/noble_cape/sit.png":"sprites/tribesman/noble_cape/sit.png?1509698806000","sprites/tribesman/noble_cape/spear_attack.json":"sprites/tribesman/noble_cape/spear_attack.json?1509698669000","sprites/tribesman/noble_cape/spear_attack.png":"sprites/tribesman/noble_cape/spear_attack.png?1509698670000","sprites/tribesman/noble_cape/spear_jump.json":"sprites/tribesman/noble_cape/spear_jump.json?1509698741000","sprites/tribesman/noble_cape/spear_jump.png":"sprites/tribesman/noble_cape/spear_jump.png?1509698741000","sprites/tribesman/noble_cape/spear_throw.json":"sprites/tribesman/noble_cape/spear_throw.json?1509698767000","sprites/tribesman/noble_cape/spear_throw.png":"sprites/tribesman/noble_cape/spear_throw.png?1509698768000","sprites/tribesman/noble_cape/spin.json":"sprites/tribesman/noble_cape/spin.json?1510762344000","sprites/tribesman/noble_cape/spin.png":"sprites/tribesman/noble_cape/spin.png?1510762344000","sprites/tribesman/noble_cape/still.json":"sprites/tribesman/noble_cape/still.json?1510762347000","sprites/tribesman/noble_cape/still.png":"sprites/tribesman/noble_cape/still.png?1510762347000","sprites/tribesman/noble_cape/stunned.json":"sprites/tribesman/noble_cape/stunned.json?1509698718000","sprites/tribesman/noble_cape/stunned.png":"sprites/tribesman/noble_cape/stunned.png?1509698718000","sprites/tribesman/noble_cape/tear.json":"sprites/tribesman/noble_cape/tear.json?1509698823000","sprites/tribesman/noble_cape/tear.png":"sprites/tribesman/noble_cape/tear.png?1509698823000","sprites/tribesman/noble_cape/throw.json":"sprites/tribesman/noble_cape/throw.json?1509698680000","sprites/tribesman/noble_cape/throw.png":"sprites/tribesman/noble_cape/throw.png?1509698680000","sprites/tribesman/noble_cape/turntable.json":"sprites/tribesman/noble_cape/turntable.json?1510762348000","sprites/tribesman/noble_cape/turntable.png":"sprites/tribesman/noble_cape/turntable.png?1510762348000","sprites/tribesman/reinforced_shield/attack_bow.json":"sprites/tribesman/reinforced_shield/attack_bow.json?1509887007000","sprites/tribesman/reinforced_shield/attack_bow.png":"sprites/tribesman/reinforced_shield/attack_bow.png?1509887007000","sprites/tribesman/reinforced_shield/attack_horizontal.json":"sprites/tribesman/reinforced_shield/attack_horizontal.json?1509886990000","sprites/tribesman/reinforced_shield/attack_horizontal.png":"sprites/tribesman/reinforced_shield/attack_horizontal.png?1509886990000","sprites/tribesman/reinforced_shield/attack_vertical.json":"sprites/tribesman/reinforced_shield/attack_vertical.json?1509886971000","sprites/tribesman/reinforced_shield/attack_vertical.png":"sprites/tribesman/reinforced_shield/attack_vertical.png?1509886971000","sprites/tribesman/reinforced_shield/block.json":"sprites/tribesman/reinforced_shield/block.json?1509887004000","sprites/tribesman/reinforced_shield/block.png":"sprites/tribesman/reinforced_shield/block.png?1509887004000","sprites/tribesman/reinforced_shield/cast.json":"sprites/tribesman/reinforced_shield/cast.json?1509886956000","sprites/tribesman/reinforced_shield/cast.png":"sprites/tribesman/reinforced_shield/cast.png?1509886956000","sprites/tribesman/reinforced_shield/charge_bow.json":"sprites/tribesman/reinforced_shield/charge_bow.json?1509886983000","sprites/tribesman/reinforced_shield/charge_bow.png":"sprites/tribesman/reinforced_shield/charge_bow.png?1509886984000","sprites/tribesman/reinforced_shield/charge_meele.json":"sprites/tribesman/reinforced_shield/charge_meele.json?1509886981000","sprites/tribesman/reinforced_shield/charge_meele.png":"sprites/tribesman/reinforced_shield/charge_meele.png?1509886981000","sprites/tribesman/reinforced_shield/charge_spell.json":"sprites/tribesman/reinforced_shield/charge_spell.json?1509886923000","sprites/tribesman/reinforced_shield/charge_spell.png":"sprites/tribesman/reinforced_shield/charge_spell.png?1509886923000","sprites/tribesman/reinforced_shield/fall_back.json":"sprites/tribesman/reinforced_shield/fall_back.json?1509886953000","sprites/tribesman/reinforced_shield/fall_back.png":"sprites/tribesman/reinforced_shield/fall_back.png?1509886953000","sprites/tribesman/reinforced_shield/fall_front.json":"sprites/tribesman/reinforced_shield/fall_front.json?1509887028000","sprites/tribesman/reinforced_shield/fall_front.png":"sprites/tribesman/reinforced_shield/fall_front.png?1509887028000","sprites/tribesman/reinforced_shield/growl.json":"sprites/tribesman/reinforced_shield/growl.json?1509886962000","sprites/tribesman/reinforced_shield/growl.png":"sprites/tribesman/reinforced_shield/growl.png?1509886962000","sprites/tribesman/reinforced_shield/kick.json":"sprites/tribesman/reinforced_shield/kick.json?1509886979000","sprites/tribesman/reinforced_shield/kick.png":"sprites/tribesman/reinforced_shield/kick.png?1509886979000","sprites/tribesman/reinforced_shield/legs_run.json":"sprites/tribesman/reinforced_shield/legs_run.json?1509887000000","sprites/tribesman/reinforced_shield/legs_run.png":"sprites/tribesman/reinforced_shield/legs_run.png?1509887000000","sprites/tribesman/reinforced_shield/operate_ground.json":"sprites/tribesman/reinforced_shield/operate_ground.json?1509887020000","sprites/tribesman/reinforced_shield/operate_ground.png":"sprites/tribesman/reinforced_shield/operate_ground.png?1509887020000","sprites/tribesman/reinforced_shield/punch1.json":"sprites/tribesman/reinforced_shield/punch1.json?1509887046000","sprites/tribesman/reinforced_shield/punch1.png":"sprites/tribesman/reinforced_shield/punch1.png?1509887046000","sprites/tribesman/reinforced_shield/punch2.json":"sprites/tribesman/reinforced_shield/punch2.json?1509886966000","sprites/tribesman/reinforced_shield/punch2.png":"sprites/tribesman/reinforced_shield/punch2.png?1509886966000","sprites/tribesman/reinforced_shield/reach.json":"sprites/tribesman/reinforced_shield/reach.json?1510821749000","sprites/tribesman/reinforced_shield/reach.png":"sprites/tribesman/reinforced_shield/reach.png?1510821749000","sprites/tribesman/reinforced_shield/roll.json":"sprites/tribesman/reinforced_shield/roll.json?1509887043000","sprites/tribesman/reinforced_shield/roll.png":"sprites/tribesman/reinforced_shield/roll.png?1509887043000","sprites/tribesman/reinforced_shield/run.json":"sprites/tribesman/reinforced_shield/run.json?1509886944000","sprites/tribesman/reinforced_shield/run.png":"sprites/tribesman/reinforced_shield/run.png?1509886944000","sprites/tribesman/reinforced_shield/sit.json":"sprites/tribesman/reinforced_shield/sit.json?1509886935000","sprites/tribesman/reinforced_shield/sit.png":"sprites/tribesman/reinforced_shield/sit.png?1509886935000","sprites/tribesman/reinforced_shield/spear_attack.json":"sprites/tribesman/reinforced_shield/spear_attack.json?1509886993000","sprites/tribesman/reinforced_shield/spear_attack.png":"sprites/tribesman/reinforced_shield/spear_attack.png?1509886993000","sprites/tribesman/reinforced_shield/spear_jump.json":"sprites/tribesman/reinforced_shield/spear_jump.json?1509887033000","sprites/tribesman/reinforced_shield/spear_jump.png":"sprites/tribesman/reinforced_shield/spear_jump.png?1509887033000","sprites/tribesman/reinforced_shield/spear_throw.json":"sprites/tribesman/reinforced_shield/spear_throw.json?1509886974000","sprites/tribesman/reinforced_shield/spear_throw.png":"sprites/tribesman/reinforced_shield/spear_throw.png?1509886974000","sprites/tribesman/reinforced_shield/spin.json":"sprites/tribesman/reinforced_shield/spin.json?1509887015000","sprites/tribesman/reinforced_shield/spin.png":"sprites/tribesman/reinforced_shield/spin.png?1509887015000","sprites/tribesman/reinforced_shield/still.json":"sprites/tribesman/reinforced_shield/still.json?1510762096000","sprites/tribesman/reinforced_shield/still.png":"sprites/tribesman/reinforced_shield/still.png?1510762096000","sprites/tribesman/reinforced_shield/stunned.json":"sprites/tribesman/reinforced_shield/stunned.json?1509886930000","sprites/tribesman/reinforced_shield/stunned.png":"sprites/tribesman/reinforced_shield/stunned.png?1509886930000","sprites/tribesman/reinforced_shield/tear.json":"sprites/tribesman/reinforced_shield/tear.json?1509887054000","sprites/tribesman/reinforced_shield/tear.png":"sprites/tribesman/reinforced_shield/tear.png?1509887054000","sprites/tribesman/reinforced_shield/throw.json":"sprites/tribesman/reinforced_shield/throw.json?1509887050000","sprites/tribesman/reinforced_shield/throw.png":"sprites/tribesman/reinforced_shield/throw.png?1509887050000","sprites/tribesman/reinforced_shield/turntable.json":"sprites/tribesman/reinforced_shield/turntable.json?1510762097000","sprites/tribesman/reinforced_shield/turntable.png":"sprites/tribesman/reinforced_shield/turntable.png?1510762097000","sprites/tribesman/santa_hat/attack_bow.json":"sprites/tribesman/santa_hat/attack_bow.json?1509886326000","sprites/tribesman/santa_hat/attack_bow.png":"sprites/tribesman/santa_hat/attack_bow.png?1509886326000","sprites/tribesman/santa_hat/attack_horizontal.json":"sprites/tribesman/santa_hat/attack_horizontal.json?1509886309000","sprites/tribesman/santa_hat/attack_horizontal.png":"sprites/tribesman/santa_hat/attack_horizontal.png?1509886309000","sprites/tribesman/santa_hat/attack_vertical.json":"sprites/tribesman/santa_hat/attack_vertical.json?1509886288000","sprites/tribesman/santa_hat/attack_vertical.png":"sprites/tribesman/santa_hat/attack_vertical.png?1509886288000","sprites/tribesman/santa_hat/block.json":"sprites/tribesman/santa_hat/block.json?1509886322000","sprites/tribesman/santa_hat/block.png":"sprites/tribesman/santa_hat/block.png?1509886322000","sprites/tribesman/santa_hat/cast.json":"sprites/tribesman/santa_hat/cast.json?1509886274000","sprites/tribesman/santa_hat/cast.png":"sprites/tribesman/santa_hat/cast.png?1509886274000","sprites/tribesman/santa_hat/charge_bow.json":"sprites/tribesman/santa_hat/charge_bow.json?1509886303000","sprites/tribesman/santa_hat/charge_bow.png":"sprites/tribesman/santa_hat/charge_bow.png?1509886303000","sprites/tribesman/santa_hat/charge_meele.json":"sprites/tribesman/santa_hat/charge_meele.json?1509886301000","sprites/tribesman/santa_hat/charge_meele.png":"sprites/tribesman/santa_hat/charge_meele.png?1509886301000","sprites/tribesman/santa_hat/charge_spell.json":"sprites/tribesman/santa_hat/charge_spell.json?1509886240000","sprites/tribesman/santa_hat/charge_spell.png":"sprites/tribesman/santa_hat/charge_spell.png?1509886240000","sprites/tribesman/santa_hat/fall_back.json":"sprites/tribesman/santa_hat/fall_back.json?1509886271000","sprites/tribesman/santa_hat/fall_back.png":"sprites/tribesman/santa_hat/fall_back.png?1509886271000","sprites/tribesman/santa_hat/fall_front.json":"sprites/tribesman/santa_hat/fall_front.json?1509886349000","sprites/tribesman/santa_hat/fall_front.png":"sprites/tribesman/santa_hat/fall_front.png?1509886349000","sprites/tribesman/santa_hat/growl.json":"sprites/tribesman/santa_hat/growl.json?1509886280000","sprites/tribesman/santa_hat/growl.png":"sprites/tribesman/santa_hat/growl.png?1509886280000","sprites/tribesman/santa_hat/kick.json":"sprites/tribesman/santa_hat/kick.json?1509886299000","sprites/tribesman/santa_hat/kick.png":"sprites/tribesman/santa_hat/kick.png?1509886299000","sprites/tribesman/santa_hat/legs_run.json":"sprites/tribesman/santa_hat/legs_run.json?1509886319000","sprites/tribesman/santa_hat/legs_run.png":"sprites/tribesman/santa_hat/legs_run.png?1509886319000","sprites/tribesman/santa_hat/operate_ground.json":"sprites/tribesman/santa_hat/operate_ground.json?1509886340000","sprites/tribesman/santa_hat/operate_ground.png":"sprites/tribesman/santa_hat/operate_ground.png?1509886341000","sprites/tribesman/santa_hat/punch1.json":"sprites/tribesman/santa_hat/punch1.json?1509886367000","sprites/tribesman/santa_hat/punch1.png":"sprites/tribesman/santa_hat/punch1.png?1509886367000","sprites/tribesman/santa_hat/punch2.json":"sprites/tribesman/santa_hat/punch2.json?1509886283000","sprites/tribesman/santa_hat/punch2.png":"sprites/tribesman/santa_hat/punch2.png?1509886283000","sprites/tribesman/santa_hat/reach.json":"sprites/tribesman/santa_hat/reach.json?1510821740000","sprites/tribesman/santa_hat/reach.png":"sprites/tribesman/santa_hat/reach.png?1510821740000","sprites/tribesman/santa_hat/roll.json":"sprites/tribesman/santa_hat/roll.json?1509886362000","sprites/tribesman/santa_hat/roll.png":"sprites/tribesman/santa_hat/roll.png?1509886362000","sprites/tribesman/santa_hat/run.json":"sprites/tribesman/santa_hat/run.json?1509886262000","sprites/tribesman/santa_hat/run.png":"sprites/tribesman/santa_hat/run.png?1509886262000","sprites/tribesman/santa_hat/sit.json":"sprites/tribesman/santa_hat/sit.json?1509886254000","sprites/tribesman/santa_hat/sit.png":"sprites/tribesman/santa_hat/sit.png?1509886254000","sprites/tribesman/santa_hat/spear_attack.json":"sprites/tribesman/santa_hat/spear_attack.json?1509886312000","sprites/tribesman/santa_hat/spear_attack.png":"sprites/tribesman/santa_hat/spear_attack.png?1509886312000","sprites/tribesman/santa_hat/spear_jump.json":"sprites/tribesman/santa_hat/spear_jump.json?1509886355000","sprites/tribesman/santa_hat/spear_jump.png":"sprites/tribesman/santa_hat/spear_jump.png?1509886355000","sprites/tribesman/santa_hat/spear_throw.json":"sprites/tribesman/santa_hat/spear_throw.json?1509886292000","sprites/tribesman/santa_hat/spear_throw.png":"sprites/tribesman/santa_hat/spear_throw.png?1509886292000","sprites/tribesman/santa_hat/spin.json":"sprites/tribesman/santa_hat/spin.json?1509886336000","sprites/tribesman/santa_hat/spin.png":"sprites/tribesman/santa_hat/spin.png?1509886336000","sprites/tribesman/santa_hat/still.json":"sprites/tribesman/santa_hat/still.json?1510762189000","sprites/tribesman/santa_hat/still.png":"sprites/tribesman/santa_hat/still.png?1510762189000","sprites/tribesman/santa_hat/stunned.json":"sprites/tribesman/santa_hat/stunned.json?1509886248000","sprites/tribesman/santa_hat/stunned.png":"sprites/tribesman/santa_hat/stunned.png?1509886248000","sprites/tribesman/santa_hat/tear.json":"sprites/tribesman/santa_hat/tear.json?1509886375000","sprites/tribesman/santa_hat/tear.png":"sprites/tribesman/santa_hat/tear.png?1509886375000","sprites/tribesman/santa_hat/throw.json":"sprites/tribesman/santa_hat/throw.json?1509886370000","sprites/tribesman/santa_hat/throw.png":"sprites/tribesman/santa_hat/throw.png?1509886370000","sprites/tribesman/santa_hat/turntable.json":"sprites/tribesman/santa_hat/turntable.json?1510762190000","sprites/tribesman/santa_hat/turntable.png":"sprites/tribesman/santa_hat/turntable.png?1510762190000","sprites/tribesman/scythe/attack_bow.json":"sprites/tribesman/scythe/attack_bow.json?1511876380000","sprites/tribesman/scythe/attack_bow.png":"sprites/tribesman/scythe/attack_bow.png?1511876380000","sprites/tribesman/scythe/attack_horizontal.json":"sprites/tribesman/scythe/attack_horizontal.json?1511876258000","sprites/tribesman/scythe/attack_horizontal.png":"sprites/tribesman/scythe/attack_horizontal.png?1511876258000","sprites/tribesman/scythe/attack_vertical.json":"sprites/tribesman/scythe/attack_vertical.json?1511876339000","sprites/tribesman/scythe/attack_vertical.png":"sprites/tribesman/scythe/attack_vertical.png?1511876339000","sprites/tribesman/scythe/block.json":"sprites/tribesman/scythe/block.json?1511876377000","sprites/tribesman/scythe/block.png":"sprites/tribesman/scythe/block.png?1511876377000","sprites/tribesman/scythe/cast.json":"sprites/tribesman/scythe/cast.json?1511876349000","sprites/tribesman/scythe/cast.png":"sprites/tribesman/scythe/cast.png?1511876349000","sprites/tribesman/scythe/charge_bow.json":"sprites/tribesman/scythe/charge_bow.json?1511876366000","sprites/tribesman/scythe/charge_bow.png":"sprites/tribesman/scythe/charge_bow.png?1511876366000","sprites/tribesman/scythe/charge_meele.json":"sprites/tribesman/scythe/charge_meele.json?1511876292000","sprites/tribesman/scythe/charge_meele.png":"sprites/tribesman/scythe/charge_meele.png?1511876292000","sprites/tribesman/scythe/charge_spell.json":"sprites/tribesman/scythe/charge_spell.json?1511876323000","sprites/tribesman/scythe/charge_spell.png":"sprites/tribesman/scythe/charge_spell.png?1511876323000","sprites/tribesman/scythe/fall_back.json":"sprites/tribesman/scythe/fall_back.json?1511876358000","sprites/tribesman/scythe/fall_back.png":"sprites/tribesman/scythe/fall_back.png?1511876358000","sprites/tribesman/scythe/fall_front.json":"sprites/tribesman/scythe/fall_front.json?1511876301000","sprites/tribesman/scythe/fall_front.png":"sprites/tribesman/scythe/fall_front.png?1511876301000","sprites/tribesman/scythe/growl.json":"sprites/tribesman/scythe/growl.json?1511876307000","sprites/tribesman/scythe/growl.png":"sprites/tribesman/scythe/growl.png?1511876307000","sprites/tribesman/scythe/kick.json":"sprites/tribesman/scythe/kick.json?1511876345000","sprites/tribesman/scythe/kick.png":"sprites/tribesman/scythe/kick.png?1511876345000","sprites/tribesman/scythe/legs_run.json":"sprites/tribesman/scythe/legs_run.json?1511876388000","sprites/tribesman/scythe/legs_run.png":"sprites/tribesman/scythe/legs_run.png?1511876388000","sprites/tribesman/scythe/operate_ground.json":"sprites/tribesman/scythe/operate_ground.json?1511876276000","sprites/tribesman/scythe/operate_ground.png":"sprites/tribesman/scythe/operate_ground.png?1511876276000","sprites/tribesman/scythe/punch1.json":"sprites/tribesman/scythe/punch1.json?1511876262000","sprites/tribesman/scythe/punch1.png":"sprites/tribesman/scythe/punch1.png?1511876262000","sprites/tribesman/scythe/punch2.json":"sprites/tribesman/scythe/punch2.json?1511876328000","sprites/tribesman/scythe/punch2.png":"sprites/tribesman/scythe/punch2.png?1511876328000","sprites/tribesman/scythe/reach.json":"sprites/tribesman/scythe/reach.json?1511876390000","sprites/tribesman/scythe/reach.png":"sprites/tribesman/scythe/reach.png?1511876390000","sprites/tribesman/scythe/roll.json":"sprites/tribesman/scythe/roll.json?1511876284000","sprites/tribesman/scythe/roll.png":"sprites/tribesman/scythe/roll.png?1511876284000","sprites/tribesman/scythe/run.json":"sprites/tribesman/scythe/run.json?1511876253000","sprites/tribesman/scythe/run.png":"sprites/tribesman/scythe/run.png?1511876253000","sprites/tribesman/scythe/sit.json":"sprites/tribesman/scythe/sit.json?1511876364000","sprites/tribesman/scythe/sit.png":"sprites/tribesman/scythe/sit.png?1511876364000","sprites/tribesman/scythe/spear_attack.json":"sprites/tribesman/scythe/spear_attack.json?1511876331000","sprites/tribesman/scythe/spear_attack.png":"sprites/tribesman/scythe/spear_attack.png?1511876331000","sprites/tribesman/scythe/spear_jump.json":"sprites/tribesman/scythe/spear_jump.json?1511876373000","sprites/tribesman/scythe/spear_jump.png":"sprites/tribesman/scythe/spear_jump.png?1511876373000","sprites/tribesman/scythe/spear_throw.json":"sprites/tribesman/scythe/spear_throw.json?1511876265000","sprites/tribesman/scythe/spear_throw.png":"sprites/tribesman/scythe/spear_throw.png?1511876265000","sprites/tribesman/scythe/spin.json":"sprites/tribesman/scythe/spin.json?1511876319000","sprites/tribesman/scythe/spin.png":"sprites/tribesman/scythe/spin.png?1511876320000","sprites/tribesman/scythe/stunned.json":"sprites/tribesman/scythe/stunned.json?1511876272000","sprites/tribesman/scythe/stunned.png":"sprites/tribesman/scythe/stunned.png?1511876272000","sprites/tribesman/scythe/tear.json":"sprites/tribesman/scythe/tear.json?1511876290000","sprites/tribesman/scythe/tear.png":"sprites/tribesman/scythe/tear.png?1511876290000","sprites/tribesman/scythe/throw.json":"sprites/tribesman/scythe/throw.json?1511876310000","sprites/tribesman/scythe/throw.png":"sprites/tribesman/scythe/throw.png?1511876310000","sprites/tribesman/scythe/turntable.json":"sprites/tribesman/scythe/turntable.json?1511877200000","sprites/tribesman/scythe/turntable.png":"sprites/tribesman/scythe/turntable.png?1511877200000","sprites/tribesman/skeleton/attack_bow.json":"sprites/tribesman/skeleton/attack_bow.json?1509883379000","sprites/tribesman/skeleton/attack_bow.png":"sprites/tribesman/skeleton/attack_bow.png?1509883379000","sprites/tribesman/skeleton/attack_horizontal.json":"sprites/tribesman/skeleton/attack_horizontal.json?1509883360000","sprites/tribesman/skeleton/attack_horizontal.png":"sprites/tribesman/skeleton/attack_horizontal.png?1509883361000","sprites/tribesman/skeleton/attack_vertical.json":"sprites/tribesman/skeleton/attack_vertical.json?1509883344000","sprites/tribesman/skeleton/attack_vertical.png":"sprites/tribesman/skeleton/attack_vertical.png?1509883344000","sprites/tribesman/skeleton/block.json":"sprites/tribesman/skeleton/block.json?1509883376000","sprites/tribesman/skeleton/block.png":"sprites/tribesman/skeleton/block.png?1509883376000","sprites/tribesman/skeleton/cast.json":"sprites/tribesman/skeleton/cast.json?1509883331000","sprites/tribesman/skeleton/cast.png":"sprites/tribesman/skeleton/cast.png?1509883331000","sprites/tribesman/skeleton/charge_bow.json":"sprites/tribesman/skeleton/charge_bow.json?1509883355000","sprites/tribesman/skeleton/charge_bow.png":"sprites/tribesman/skeleton/charge_bow.png?1509883355000","sprites/tribesman/skeleton/charge_meele.json":"sprites/tribesman/skeleton/charge_meele.json?1509883353000","sprites/tribesman/skeleton/charge_meele.png":"sprites/tribesman/skeleton/charge_meele.png?1509883353000","sprites/tribesman/skeleton/charge_spell.json":"sprites/tribesman/skeleton/charge_spell.json?1509883297000","sprites/tribesman/skeleton/charge_spell.png":"sprites/tribesman/skeleton/charge_spell.png?1509883297000","sprites/tribesman/skeleton/fall_back.json":"sprites/tribesman/skeleton/fall_back.json?1509883327000","sprites/tribesman/skeleton/fall_back.png":"sprites/tribesman/skeleton/fall_back.png?1509883327000","sprites/tribesman/skeleton/fall_front.json":"sprites/tribesman/skeleton/fall_front.json?1509883397000","sprites/tribesman/skeleton/fall_front.png":"sprites/tribesman/skeleton/fall_front.png?1509883397000","sprites/tribesman/skeleton/growl.json":"sprites/tribesman/skeleton/growl.json?1509883336000","sprites/tribesman/skeleton/growl.png":"sprites/tribesman/skeleton/growl.png?1509883337000","sprites/tribesman/skeleton/kick.json":"sprites/tribesman/skeleton/kick.json?1509883351000","sprites/tribesman/skeleton/kick.png":"sprites/tribesman/skeleton/kick.png?1509883351000","sprites/tribesman/skeleton/legs_run.json":"sprites/tribesman/skeleton/legs_run.json?1509883370000","sprites/tribesman/skeleton/legs_run.png":"sprites/tribesman/skeleton/legs_run.png?1509883371000","sprites/tribesman/skeleton/operate_ground.json":"sprites/tribesman/skeleton/operate_ground.json?1509883390000","sprites/tribesman/skeleton/operate_ground.png":"sprites/tribesman/skeleton/operate_ground.png?1509883390000","sprites/tribesman/skeleton/punch1.json":"sprites/tribesman/skeleton/punch1.json?1509883411000","sprites/tribesman/skeleton/punch1.png":"sprites/tribesman/skeleton/punch1.png?1509883411000","sprites/tribesman/skeleton/punch2.json":"sprites/tribesman/skeleton/punch2.json?1509883339000","sprites/tribesman/skeleton/punch2.png":"sprites/tribesman/skeleton/punch2.png?1509883339000","sprites/tribesman/skeleton/reach.json":"sprites/tribesman/skeleton/reach.json?1510821717000","sprites/tribesman/skeleton/reach.png":"sprites/tribesman/skeleton/reach.png?1510821717000","sprites/tribesman/skeleton/roll.json":"sprites/tribesman/skeleton/roll.json?1509883408000","sprites/tribesman/skeleton/roll.png":"sprites/tribesman/skeleton/roll.png?1509883408000","sprites/tribesman/skeleton/run.json":"sprites/tribesman/skeleton/run.json?1509883318000","sprites/tribesman/skeleton/run.png":"sprites/tribesman/skeleton/run.png?1509883319000","sprites/tribesman/skeleton/sit.json":"sprites/tribesman/skeleton/sit.json?1509883311000","sprites/tribesman/skeleton/sit.png":"sprites/tribesman/skeleton/sit.png?1509883311000","sprites/tribesman/skeleton/spear_attack.json":"sprites/tribesman/skeleton/spear_attack.json?1509883363000","sprites/tribesman/skeleton/spear_attack.png":"sprites/tribesman/skeleton/spear_attack.png?1509883363000","sprites/tribesman/skeleton/spear_jump.json":"sprites/tribesman/skeleton/spear_jump.json?1509883402000","sprites/tribesman/skeleton/spear_jump.png":"sprites/tribesman/skeleton/spear_jump.png?1509883402000","sprites/tribesman/skeleton/spear_throw.json":"sprites/tribesman/skeleton/spear_throw.json?1509883347000","sprites/tribesman/skeleton/spear_throw.png":"sprites/tribesman/skeleton/spear_throw.png?1509883347000","sprites/tribesman/skeleton/spin.json":"sprites/tribesman/skeleton/spin.json?1509883386000","sprites/tribesman/skeleton/spin.png":"sprites/tribesman/skeleton/spin.png?1509883386000","sprites/tribesman/skeleton/stunned.json":"sprites/tribesman/skeleton/stunned.json?1509883306000","sprites/tribesman/skeleton/stunned.png":"sprites/tribesman/skeleton/stunned.png?1509883306000","sprites/tribesman/skeleton/tear.json":"sprites/tribesman/skeleton/tear.json?1509883418000","sprites/tribesman/skeleton/tear.png":"sprites/tribesman/skeleton/tear.png?1509883418000","sprites/tribesman/skeleton/throw.json":"sprites/tribesman/skeleton/throw.json?1509883414000","sprites/tribesman/skeleton/throw.png":"sprites/tribesman/skeleton/throw.png?1509883414000","sprites/tribesman/skull/sit.json":"sprites/tribesman/skull/sit.json?1509393739000","sprites/tribesman/skull/sit.png":"sprites/tribesman/skull/sit.png?1509393739000","sprites/tribesman/skull/spin.json":"sprites/tribesman/skull/spin.json?1510762079000","sprites/tribesman/skull/spin.png":"sprites/tribesman/skull/spin.png?1510762079000","sprites/tribesman/skull/still.json":"sprites/tribesman/skull/still.json?1510762081000","sprites/tribesman/skull/still.png":"sprites/tribesman/skull/still.png?1510762081000","sprites/tribesman/skull/turntable.json":"sprites/tribesman/skull/turntable.json?1510762082000","sprites/tribesman/skull/turntable.png":"sprites/tribesman/skull/turntable.png?1510762082000","sprites/tribesman/spear/attack_bow.json":"sprites/tribesman/spear/attack_bow.json?1509886603000","sprites/tribesman/spear/attack_bow.png":"sprites/tribesman/spear/attack_bow.png?1509886603000","sprites/tribesman/spear/attack_horizontal.json":"sprites/tribesman/spear/attack_horizontal.json?1509886585000","sprites/tribesman/spear/attack_horizontal.png":"sprites/tribesman/spear/attack_horizontal.png?1509886585000","sprites/tribesman/spear/attack_vertical.json":"sprites/tribesman/spear/attack_vertical.json?1509886566000","sprites/tribesman/spear/attack_vertical.png":"sprites/tribesman/spear/attack_vertical.png?1509886566000","sprites/tribesman/spear/block.json":"sprites/tribesman/spear/block.json?1509886600000","sprites/tribesman/spear/block.png":"sprites/tribesman/spear/block.png?1509886600000","sprites/tribesman/spear/cast.json":"sprites/tribesman/spear/cast.json?1509886550000","sprites/tribesman/spear/cast.png":"sprites/tribesman/spear/cast.png?1509886550000","sprites/tribesman/spear/charge_bow.json":"sprites/tribesman/spear/charge_bow.json?1509886579000","sprites/tribesman/spear/charge_bow.png":"sprites/tribesman/spear/charge_bow.png?1509886579000","sprites/tribesman/spear/charge_meele.json":"sprites/tribesman/spear/charge_meele.json?1509886577000","sprites/tribesman/spear/charge_meele.png":"sprites/tribesman/spear/charge_meele.png?1509886577000","sprites/tribesman/spear/charge_spell.json":"sprites/tribesman/spear/charge_spell.json?1509886515000","sprites/tribesman/spear/charge_spell.png":"sprites/tribesman/spear/charge_spell.png?1509886515000","sprites/tribesman/spear/fall_back.json":"sprites/tribesman/spear/fall_back.json?1509886547000","sprites/tribesman/spear/fall_back.png":"sprites/tribesman/spear/fall_back.png?1509886547000","sprites/tribesman/spear/fall_front.json":"sprites/tribesman/spear/fall_front.json?1509886627000","sprites/tribesman/spear/fall_front.png":"sprites/tribesman/spear/fall_front.png?1509886627000","sprites/tribesman/spear/growl.json":"sprites/tribesman/spear/growl.json?1509886556000","sprites/tribesman/spear/growl.png":"sprites/tribesman/spear/growl.png?1509886556000","sprites/tribesman/spear/kick.json":"sprites/tribesman/spear/kick.json?1509886574000","sprites/tribesman/spear/kick.png":"sprites/tribesman/spear/kick.png?1509886575000","sprites/tribesman/spear/legs_run.json":"sprites/tribesman/spear/legs_run.json?1509886596000","sprites/tribesman/spear/legs_run.png":"sprites/tribesman/spear/legs_run.png?1509886596000","sprites/tribesman/spear/operate_ground.json":"sprites/tribesman/spear/operate_ground.json?1509886616000","sprites/tribesman/spear/operate_ground.png":"sprites/tribesman/spear/operate_ground.png?1509886616000","sprites/tribesman/spear/punch1.json":"sprites/tribesman/spear/punch1.json?1509886646000","sprites/tribesman/spear/punch1.png":"sprites/tribesman/spear/punch1.png?1509886646000","sprites/tribesman/spear/punch2.json":"sprites/tribesman/spear/punch2.json?1509886560000","sprites/tribesman/spear/punch2.png":"sprites/tribesman/spear/punch2.png?1509886560000","sprites/tribesman/spear/reach.json":"sprites/tribesman/spear/reach.json?1510821744000","sprites/tribesman/spear/reach.png":"sprites/tribesman/spear/reach.png?1510821744000","sprites/tribesman/spear/roll.json":"sprites/tribesman/spear/roll.json?1509886642000","sprites/tribesman/spear/roll.png":"sprites/tribesman/spear/roll.png?1509886642000","sprites/tribesman/spear/run.json":"sprites/tribesman/spear/run.json?1509886537000","sprites/tribesman/spear/run.png":"sprites/tribesman/spear/run.png?1509886538000","sprites/tribesman/spear/sit.json":"sprites/tribesman/spear/sit.json?1509886529000","sprites/tribesman/spear/sit.png":"sprites/tribesman/spear/sit.png?1509886529000","sprites/tribesman/spear/spear_attack.json":"sprites/tribesman/spear/spear_attack.json?1509886587000","sprites/tribesman/spear/spear_attack.png":"sprites/tribesman/spear/spear_attack.png?1509886587000","sprites/tribesman/spear/spear_jump.json":"sprites/tribesman/spear/spear_jump.json?1509886633000","sprites/tribesman/spear/spear_jump.png":"sprites/tribesman/spear/spear_jump.png?1509886633000","sprites/tribesman/spear/spear_throw.json":"sprites/tribesman/spear/spear_throw.json?1509886569000","sprites/tribesman/spear/spear_throw.png":"sprites/tribesman/spear/spear_throw.png?1509886569000","sprites/tribesman/spear/spin.json":"sprites/tribesman/spear/spin.json?1509886612000","sprites/tribesman/spear/spin.png":"sprites/tribesman/spear/spin.png?1509886612000","sprites/tribesman/spear/still.json":"sprites/tribesman/spear/still.json?1510762227000","sprites/tribesman/spear/still.png":"sprites/tribesman/spear/still.png?1510762227000","sprites/tribesman/spear/stunned.json":"sprites/tribesman/spear/stunned.json?1509886522000","sprites/tribesman/spear/stunned.png":"sprites/tribesman/spear/stunned.png?1509886522000","sprites/tribesman/spear/tear.json":"sprites/tribesman/spear/tear.json?1509886654000","sprites/tribesman/spear/tear.png":"sprites/tribesman/spear/tear.png?1509886654000","sprites/tribesman/spear/throw.json":"sprites/tribesman/spear/throw.json?1509886650000","sprites/tribesman/spear/throw.png":"sprites/tribesman/spear/throw.png?1509886650000","sprites/tribesman/spear/turntable.json":"sprites/tribesman/spear/turntable.json?1510762229000","sprites/tribesman/spear/turntable.png":"sprites/tribesman/spear/turntable.png?1510762229000","sprites/tribesman/steel_shield/attack_bow.json":"sprites/tribesman/steel_shield/attack_bow.json?1509885914000","sprites/tribesman/steel_shield/attack_bow.png":"sprites/tribesman/steel_shield/attack_bow.png?1509885914000","sprites/tribesman/steel_shield/attack_horizontal.json":"sprites/tribesman/steel_shield/attack_horizontal.json?1509885896000","sprites/tribesman/steel_shield/attack_horizontal.png":"sprites/tribesman/steel_shield/attack_horizontal.png?1509885896000","sprites/tribesman/steel_shield/attack_vertical.json":"sprites/tribesman/steel_shield/attack_vertical.json?1509885876000","sprites/tribesman/steel_shield/attack_vertical.png":"sprites/tribesman/steel_shield/attack_vertical.png?1509885876000","sprites/tribesman/steel_shield/block.json":"sprites/tribesman/steel_shield/block.json?1509885910000","sprites/tribesman/steel_shield/block.png":"sprites/tribesman/steel_shield/block.png?1509885910000","sprites/tribesman/steel_shield/cast.json":"sprites/tribesman/steel_shield/cast.json?1509885860000","sprites/tribesman/steel_shield/cast.png":"sprites/tribesman/steel_shield/cast.png?1509885860000","sprites/tribesman/steel_shield/charge_bow.json":"sprites/tribesman/steel_shield/charge_bow.json?1509885890000","sprites/tribesman/steel_shield/charge_bow.png":"sprites/tribesman/steel_shield/charge_bow.png?1509885890000","sprites/tribesman/steel_shield/charge_meele.json":"sprites/tribesman/steel_shield/charge_meele.json?1509885888000","sprites/tribesman/steel_shield/charge_meele.png":"sprites/tribesman/steel_shield/charge_meele.png?1509885888000","sprites/tribesman/steel_shield/charge_spell.json":"sprites/tribesman/steel_shield/charge_spell.json?1509885827000","sprites/tribesman/steel_shield/charge_spell.png":"sprites/tribesman/steel_shield/charge_spell.png?1509885827000","sprites/tribesman/steel_shield/fall_back.json":"sprites/tribesman/steel_shield/fall_back.json?1509885857000","sprites/tribesman/steel_shield/fall_back.png":"sprites/tribesman/steel_shield/fall_back.png?1509885857000","sprites/tribesman/steel_shield/fall_front.json":"sprites/tribesman/steel_shield/fall_front.json?1509885935000","sprites/tribesman/steel_shield/fall_front.png":"sprites/tribesman/steel_shield/fall_front.png?1509885935000","sprites/tribesman/steel_shield/growl.json":"sprites/tribesman/steel_shield/growl.json?1509885867000","sprites/tribesman/steel_shield/growl.png":"sprites/tribesman/steel_shield/growl.png?1509885867000","sprites/tribesman/steel_shield/kick.json":"sprites/tribesman/steel_shield/kick.json?1509885885000","sprites/tribesman/steel_shield/kick.png":"sprites/tribesman/steel_shield/kick.png?1509885885000","sprites/tribesman/steel_shield/legs_run.json":"sprites/tribesman/steel_shield/legs_run.json?1509885905000","sprites/tribesman/steel_shield/legs_run.png":"sprites/tribesman/steel_shield/legs_run.png?1509885905000","sprites/tribesman/steel_shield/operate_ground.json":"sprites/tribesman/steel_shield/operate_ground.json?1509885926000","sprites/tribesman/steel_shield/operate_ground.png":"sprites/tribesman/steel_shield/operate_ground.png?1509885927000","sprites/tribesman/steel_shield/punch1.json":"sprites/tribesman/steel_shield/punch1.json?1509885953000","sprites/tribesman/steel_shield/punch1.png":"sprites/tribesman/steel_shield/punch1.png?1509885953000","sprites/tribesman/steel_shield/punch2.json":"sprites/tribesman/steel_shield/punch2.json?1509885871000","sprites/tribesman/steel_shield/punch2.png":"sprites/tribesman/steel_shield/punch2.png?1509885871000","sprites/tribesman/steel_shield/reach.json":"sprites/tribesman/steel_shield/reach.json?1510821734000","sprites/tribesman/steel_shield/reach.png":"sprites/tribesman/steel_shield/reach.png?1510821734000","sprites/tribesman/steel_shield/roll.json":"sprites/tribesman/steel_shield/roll.json?1509885950000","sprites/tribesman/steel_shield/roll.png":"sprites/tribesman/steel_shield/roll.png?1509885950000","sprites/tribesman/steel_shield/run.json":"sprites/tribesman/steel_shield/run.json?1509885848000","sprites/tribesman/steel_shield/run.png":"sprites/tribesman/steel_shield/run.png?1509885848000","sprites/tribesman/steel_shield/sit.json":"sprites/tribesman/steel_shield/sit.json?1509885839000","sprites/tribesman/steel_shield/sit.png":"sprites/tribesman/steel_shield/sit.png?1509885839000","sprites/tribesman/steel_shield/spear_attack.json":"sprites/tribesman/steel_shield/spear_attack.json?1509885898000","sprites/tribesman/steel_shield/spear_attack.png":"sprites/tribesman/steel_shield/spear_attack.png?1509885898000","sprites/tribesman/steel_shield/spear_jump.json":"sprites/tribesman/steel_shield/spear_jump.json?1509885941000","sprites/tribesman/steel_shield/spear_jump.png":"sprites/tribesman/steel_shield/spear_jump.png?1509885941000","sprites/tribesman/steel_shield/spear_throw.json":"sprites/tribesman/steel_shield/spear_throw.json?1509885880000","sprites/tribesman/steel_shield/spear_throw.png":"sprites/tribesman/steel_shield/spear_throw.png?1509885880000","sprites/tribesman/steel_shield/spin.json":"sprites/tribesman/steel_shield/spin.json?1509885922000","sprites/tribesman/steel_shield/spin.png":"sprites/tribesman/steel_shield/spin.png?1509885922000","sprites/tribesman/steel_shield/still.json":"sprites/tribesman/steel_shield/still.json?1510762289000","sprites/tribesman/steel_shield/still.png":"sprites/tribesman/steel_shield/still.png?1510762289000","sprites/tribesman/steel_shield/stunned.json":"sprites/tribesman/steel_shield/stunned.json?1509885834000","sprites/tribesman/steel_shield/stunned.png":"sprites/tribesman/steel_shield/stunned.png?1509885834000","sprites/tribesman/steel_shield/tear.json":"sprites/tribesman/steel_shield/tear.json?1509885962000","sprites/tribesman/steel_shield/tear.png":"sprites/tribesman/steel_shield/tear.png?1509885962000","sprites/tribesman/steel_shield/throw.json":"sprites/tribesman/steel_shield/throw.json?1509885957000","sprites/tribesman/steel_shield/throw.png":"sprites/tribesman/steel_shield/throw.png?1509885957000","sprites/tribesman/steel_shield/turntable.json":"sprites/tribesman/steel_shield/turntable.json?1510762290000","sprites/tribesman/steel_shield/turntable.png":"sprites/tribesman/steel_shield/turntable.png?1510762290000","sprites/tribesman/sword/attack_bow.json":"sprites/tribesman/sword/attack_bow.json?1509885201000","sprites/tribesman/sword/attack_bow.png":"sprites/tribesman/sword/attack_bow.png?1509885201000","sprites/tribesman/sword/attack_horizontal.json":"sprites/tribesman/sword/attack_horizontal.json?1509885183000","sprites/tribesman/sword/attack_horizontal.png":"sprites/tribesman/sword/attack_horizontal.png?1509885183000","sprites/tribesman/sword/attack_vertical.json":"sprites/tribesman/sword/attack_vertical.json?1509885159000","sprites/tribesman/sword/attack_vertical.png":"sprites/tribesman/sword/attack_vertical.png?1509885159000","sprites/tribesman/sword/block.json":"sprites/tribesman/sword/block.json?1509885197000","sprites/tribesman/sword/block.png":"sprites/tribesman/sword/block.png?1509885197000","sprites/tribesman/sword/cast.json":"sprites/tribesman/sword/cast.json?1509885142000","sprites/tribesman/sword/cast.png":"sprites/tribesman/sword/cast.png?1509885142000","sprites/tribesman/sword/charge_bow.json":"sprites/tribesman/sword/charge_bow.json?1509885174000","sprites/tribesman/sword/charge_bow.png":"sprites/tribesman/sword/charge_bow.png?1509885175000","sprites/tribesman/sword/charge_meele.json":"sprites/tribesman/sword/charge_meele.json?1509885172000","sprites/tribesman/sword/charge_meele.png":"sprites/tribesman/sword/charge_meele.png?1509885172000","sprites/tribesman/sword/charge_spell.json":"sprites/tribesman/sword/charge_spell.json?1509885107000","sprites/tribesman/sword/charge_spell.png":"sprites/tribesman/sword/charge_spell.png?1509885107000","sprites/tribesman/sword/fall_back.json":"sprites/tribesman/sword/fall_back.json?1509885138000","sprites/tribesman/sword/fall_back.png":"sprites/tribesman/sword/fall_back.png?1509885138000","sprites/tribesman/sword/fall_front.json":"sprites/tribesman/sword/fall_front.json?1509885224000","sprites/tribesman/sword/fall_front.png":"sprites/tribesman/sword/fall_front.png?1509885224000","sprites/tribesman/sword/growl.json":"sprites/tribesman/sword/growl.json?1509885147000","sprites/tribesman/sword/growl.png":"sprites/tribesman/sword/growl.png?1509885147000","sprites/tribesman/sword/kick.json":"sprites/tribesman/sword/kick.json?1509885170000","sprites/tribesman/sword/kick.png":"sprites/tribesman/sword/kick.png?1509885170000","sprites/tribesman/sword/legs_run.json":"sprites/tribesman/sword/legs_run.json?1509885193000","sprites/tribesman/sword/legs_run.png":"sprites/tribesman/sword/legs_run.png?1509885193000","sprites/tribesman/sword/operate_ground.json":"sprites/tribesman/sword/operate_ground.json?1509885215000","sprites/tribesman/sword/operate_ground.png":"sprites/tribesman/sword/operate_ground.png?1509885215000","sprites/tribesman/sword/punch1.json":"sprites/tribesman/sword/punch1.json?1509885241000","sprites/tribesman/sword/punch1.png":"sprites/tribesman/sword/punch1.png?1509885241000","sprites/tribesman/sword/punch2.json":"sprites/tribesman/sword/punch2.json?1509885152000","sprites/tribesman/sword/punch2.png":"sprites/tribesman/sword/punch2.png?1509885152000","sprites/tribesman/sword/reach.json":"sprites/tribesman/sword/reach.json?1510821725000","sprites/tribesman/sword/reach.png":"sprites/tribesman/sword/reach.png?1510821725000","sprites/tribesman/sword/roll.json":"sprites/tribesman/sword/roll.json?1509885237000","sprites/tribesman/sword/roll.png":"sprites/tribesman/sword/roll.png?1509885238000","sprites/tribesman/sword/run.json":"sprites/tribesman/sword/run.json?1509885128000","sprites/tribesman/sword/run.png":"sprites/tribesman/sword/run.png?1509885128000","sprites/tribesman/sword/sit.json":"sprites/tribesman/sword/sit.json?1509885119000","sprites/tribesman/sword/sit.png":"sprites/tribesman/sword/sit.png?1509885119000","sprites/tribesman/sword/spear_attack.json":"sprites/tribesman/sword/spear_attack.json?1509885186000","sprites/tribesman/sword/spear_attack.png":"sprites/tribesman/sword/spear_attack.png?1509885186000","sprites/tribesman/sword/spear_jump.json":"sprites/tribesman/sword/spear_jump.json?1509885230000","sprites/tribesman/sword/spear_jump.png":"sprites/tribesman/sword/spear_jump.png?1509885230000","sprites/tribesman/sword/spear_throw.json":"sprites/tribesman/sword/spear_throw.json?1509885164000","sprites/tribesman/sword/spear_throw.png":"sprites/tribesman/sword/spear_throw.png?1509885164000","sprites/tribesman/sword/spin.json":"sprites/tribesman/sword/spin.json?1509885210000","sprites/tribesman/sword/spin.png":"sprites/tribesman/sword/spin.png?1509885210000","sprites/tribesman/sword/still.json":"sprites/tribesman/sword/still.json?1510762023000","sprites/tribesman/sword/still.png":"sprites/tribesman/sword/still.png?1510762022000","sprites/tribesman/sword/stunned.json":"sprites/tribesman/sword/stunned.json?1509885114000","sprites/tribesman/sword/stunned.png":"sprites/tribesman/sword/stunned.png?1509885114000","sprites/tribesman/sword/tear.json":"sprites/tribesman/sword/tear.json?1509885250000","sprites/tribesman/sword/tear.png":"sprites/tribesman/sword/tear.png?1509885250000","sprites/tribesman/sword/throw.json":"sprites/tribesman/sword/throw.json?1509885244000","sprites/tribesman/sword/throw.png":"sprites/tribesman/sword/throw.png?1509885244000","sprites/tribesman/sword/turntable.json":"sprites/tribesman/sword/turntable.json?1510762024000","sprites/tribesman/sword/turntable.png":"sprites/tribesman/sword/turntable.png?1510762024000","sprites/tribesman/tribesman.json":"sprites/tribesman/tribesman.json?1510870564000","sprites/tribesman/tribesman.png":"sprites/tribesman/tribesman.png?1510870565000","sprites/tribesman/viking_helmet/attack_bow.json":"sprites/tribesman/viking_helmet/attack_bow.json?1509885336000","sprites/tribesman/viking_helmet/attack_bow.png":"sprites/tribesman/viking_helmet/attack_bow.png?1509885336000","sprites/tribesman/viking_helmet/attack_horizontal.json":"sprites/tribesman/viking_helmet/attack_horizontal.json?1509885319000","sprites/tribesman/viking_helmet/attack_horizontal.png":"sprites/tribesman/viking_helmet/attack_horizontal.png?1509885320000","sprites/tribesman/viking_helmet/attack_vertical.json":"sprites/tribesman/viking_helmet/attack_vertical.json?1509885301000","sprites/tribesman/viking_helmet/attack_vertical.png":"sprites/tribesman/viking_helmet/attack_vertical.png?1509885301000","sprites/tribesman/viking_helmet/block.json":"sprites/tribesman/viking_helmet/block.json?1509885333000","sprites/tribesman/viking_helmet/block.png":"sprites/tribesman/viking_helmet/block.png?1509885333000","sprites/tribesman/viking_helmet/cast.json":"sprites/tribesman/viking_helmet/cast.json?1509885285000","sprites/tribesman/viking_helmet/cast.png":"sprites/tribesman/viking_helmet/cast.png?1509885285000","sprites/tribesman/viking_helmet/charge_bow.json":"sprites/tribesman/viking_helmet/charge_bow.json?1509885314000","sprites/tribesman/viking_helmet/charge_bow.png":"sprites/tribesman/viking_helmet/charge_bow.png?1509885314000","sprites/tribesman/viking_helmet/charge_meele.json":"sprites/tribesman/viking_helmet/charge_meele.json?1509885312000","sprites/tribesman/viking_helmet/charge_meele.png":"sprites/tribesman/viking_helmet/charge_meele.png?1509885312000","sprites/tribesman/viking_helmet/charge_spell.json":"sprites/tribesman/viking_helmet/charge_spell.json?1509885253000","sprites/tribesman/viking_helmet/charge_spell.png":"sprites/tribesman/viking_helmet/charge_spell.png?1509885253000","sprites/tribesman/viking_helmet/fall_back.json":"sprites/tribesman/viking_helmet/fall_back.json?1509885282000","sprites/tribesman/viking_helmet/fall_back.png":"sprites/tribesman/viking_helmet/fall_back.png?1509885282000","sprites/tribesman/viking_helmet/fall_front.json":"sprites/tribesman/viking_helmet/fall_front.json?1509885360000","sprites/tribesman/viking_helmet/fall_front.png":"sprites/tribesman/viking_helmet/fall_front.png?1509885360000","sprites/tribesman/viking_helmet/growl.json":"sprites/tribesman/viking_helmet/growl.json?1509885290000","sprites/tribesman/viking_helmet/growl.png":"sprites/tribesman/viking_helmet/growl.png?1509885291000","sprites/tribesman/viking_helmet/kick.json":"sprites/tribesman/viking_helmet/kick.json?1509885309000","sprites/tribesman/viking_helmet/kick.png":"sprites/tribesman/viking_helmet/kick.png?1509885309000","sprites/tribesman/viking_helmet/legs_run.json":"sprites/tribesman/viking_helmet/legs_run.json?1509885329000","sprites/tribesman/viking_helmet/legs_run.png":"sprites/tribesman/viking_helmet/legs_run.png?1509885329000","sprites/tribesman/viking_helmet/operate_ground.json":"sprites/tribesman/viking_helmet/operate_ground.json?1509885351000","sprites/tribesman/viking_helmet/operate_ground.png":"sprites/tribesman/viking_helmet/operate_ground.png?1509885351000","sprites/tribesman/viking_helmet/punch1.json":"sprites/tribesman/viking_helmet/punch1.json?1509885377000","sprites/tribesman/viking_helmet/punch1.png":"sprites/tribesman/viking_helmet/punch1.png?1509885377000","sprites/tribesman/viking_helmet/punch2.json":"sprites/tribesman/viking_helmet/punch2.json?1509885295000","sprites/tribesman/viking_helmet/punch2.png":"sprites/tribesman/viking_helmet/punch2.png?1509885295000","sprites/tribesman/viking_helmet/reach.json":"sprites/tribesman/viking_helmet/reach.json?1510821727000","sprites/tribesman/viking_helmet/reach.png":"sprites/tribesman/viking_helmet/reach.png?1510821727000","sprites/tribesman/viking_helmet/roll.json":"sprites/tribesman/viking_helmet/roll.json?1509885373000","sprites/tribesman/viking_helmet/roll.png":"sprites/tribesman/viking_helmet/roll.png?1509885374000","sprites/tribesman/viking_helmet/run.json":"sprites/tribesman/viking_helmet/run.json?1509885273000","sprites/tribesman/viking_helmet/run.png":"sprites/tribesman/viking_helmet/run.png?1509885273000","sprites/tribesman/viking_helmet/sit.json":"sprites/tribesman/viking_helmet/sit.json?1509885265000","sprites/tribesman/viking_helmet/sit.png":"sprites/tribesman/viking_helmet/sit.png?1509885265000","sprites/tribesman/viking_helmet/spear_attack.json":"sprites/tribesman/viking_helmet/spear_attack.json?1509885322000","sprites/tribesman/viking_helmet/spear_attack.png":"sprites/tribesman/viking_helmet/spear_attack.png?1509885322000","sprites/tribesman/viking_helmet/spear_jump.json":"sprites/tribesman/viking_helmet/spear_jump.json?1509885366000","sprites/tribesman/viking_helmet/spear_jump.png":"sprites/tribesman/viking_helmet/spear_jump.png?1509885366000","sprites/tribesman/viking_helmet/spear_throw.json":"sprites/tribesman/viking_helmet/spear_throw.json?1509885304000","sprites/tribesman/viking_helmet/spear_throw.png":"sprites/tribesman/viking_helmet/spear_throw.png?1509885304000","sprites/tribesman/viking_helmet/spin.json":"sprites/tribesman/viking_helmet/spin.json?1509885344000","sprites/tribesman/viking_helmet/spin.png":"sprites/tribesman/viking_helmet/spin.png?1509885344000","sprites/tribesman/viking_helmet/still.json":"sprites/tribesman/viking_helmet/still.json?1510761989000","sprites/tribesman/viking_helmet/still.png":"sprites/tribesman/viking_helmet/still.png?1510761989000","sprites/tribesman/viking_helmet/stunned.json":"sprites/tribesman/viking_helmet/stunned.json?1509885260000","sprites/tribesman/viking_helmet/stunned.png":"sprites/tribesman/viking_helmet/stunned.png?1509885260000","sprites/tribesman/viking_helmet/tear.json":"sprites/tribesman/viking_helmet/tear.json?1509885388000","sprites/tribesman/viking_helmet/tear.png":"sprites/tribesman/viking_helmet/tear.png?1509885388000","sprites/tribesman/viking_helmet/throw.json":"sprites/tribesman/viking_helmet/throw.json?1509885381000","sprites/tribesman/viking_helmet/throw.png":"sprites/tribesman/viking_helmet/throw.png?1509885381000","sprites/tribesman/viking_helmet/turntable.json":"sprites/tribesman/viking_helmet/turntable.json?1510761990000","sprites/tribesman/viking_helmet/turntable.png":"sprites/tribesman/viking_helmet/turntable.png?1510761990000","sprites/tribesman/white_cape/sit.json":"sprites/tribesman/white_cape/sit.json?1509393861000","sprites/tribesman/white_cape/sit.png":"sprites/tribesman/white_cape/sit.png?1509393861000","sprites/tribesman/white_cape/spin.json":"sprites/tribesman/white_cape/spin.json?1510762363000","sprites/tribesman/white_cape/spin.png":"sprites/tribesman/white_cape/spin.png?1510762363000","sprites/tribesman/white_cape/still.json":"sprites/tribesman/white_cape/still.json?1510762368000","sprites/tribesman/white_cape/still.png":"sprites/tribesman/white_cape/still.png?1510762368000","sprites/tribesman/white_cape/turntable.json":"sprites/tribesman/white_cape/turntable.json?1510762371000","sprites/tribesman/white_cape/turntable.png":"sprites/tribesman/white_cape/turntable.png?1510762371000","sprites/tribesman/wizard_hat/attack_bow.json":"sprites/tribesman/wizard_hat/attack_bow.json?1509886874000","sprites/tribesman/wizard_hat/attack_bow.png":"sprites/tribesman/wizard_hat/attack_bow.png?1509886874000","sprites/tribesman/wizard_hat/attack_horizontal.json":"sprites/tribesman/wizard_hat/attack_horizontal.json?1509886857000","sprites/tribesman/wizard_hat/attack_horizontal.png":"sprites/tribesman/wizard_hat/attack_horizontal.png?1509886857000","sprites/tribesman/wizard_hat/attack_vertical.json":"sprites/tribesman/wizard_hat/attack_vertical.json?1509886836000","sprites/tribesman/wizard_hat/attack_vertical.png":"sprites/tribesman/wizard_hat/attack_vertical.png?1509886836000","sprites/tribesman/wizard_hat/block.json":"sprites/tribesman/wizard_hat/block.json?1509886870000","sprites/tribesman/wizard_hat/block.png":"sprites/tribesman/wizard_hat/block.png?1509886870000","sprites/tribesman/wizard_hat/cast.json":"sprites/tribesman/wizard_hat/cast.json?1509886822000","sprites/tribesman/wizard_hat/cast.png":"sprites/tribesman/wizard_hat/cast.png?1509886822000","sprites/tribesman/wizard_hat/charge_bow.json":"sprites/tribesman/wizard_hat/charge_bow.json?1509886851000","sprites/tribesman/wizard_hat/charge_bow.png":"sprites/tribesman/wizard_hat/charge_bow.png?1509886851000","sprites/tribesman/wizard_hat/charge_meele.json":"sprites/tribesman/wizard_hat/charge_meele.json?1509886848000","sprites/tribesman/wizard_hat/charge_meele.png":"sprites/tribesman/wizard_hat/charge_meele.png?1509886848000","sprites/tribesman/wizard_hat/charge_spell.json":"sprites/tribesman/wizard_hat/charge_spell.json?1509886791000","sprites/tribesman/wizard_hat/charge_spell.png":"sprites/tribesman/wizard_hat/charge_spell.png?1509886791000","sprites/tribesman/wizard_hat/fall_back.json":"sprites/tribesman/wizard_hat/fall_back.json?1509886819000","sprites/tribesman/wizard_hat/fall_back.png":"sprites/tribesman/wizard_hat/fall_back.png?1509886819000","sprites/tribesman/wizard_hat/fall_front.json":"sprites/tribesman/wizard_hat/fall_front.json?1509886895000","sprites/tribesman/wizard_hat/fall_front.png":"sprites/tribesman/wizard_hat/fall_front.png?1509886895000","sprites/tribesman/wizard_hat/growl.json":"sprites/tribesman/wizard_hat/growl.json?1509886827000","sprites/tribesman/wizard_hat/growl.png":"sprites/tribesman/wizard_hat/growl.png?1509886827000","sprites/tribesman/wizard_hat/kick.json":"sprites/tribesman/wizard_hat/kick.json?1509886846000","sprites/tribesman/wizard_hat/kick.png":"sprites/tribesman/wizard_hat/kick.png?1509886846000","sprites/tribesman/wizard_hat/legs_run.json":"sprites/tribesman/wizard_hat/legs_run.json?1509886867000","sprites/tribesman/wizard_hat/legs_run.png":"sprites/tribesman/wizard_hat/legs_run.png?1509886867000","sprites/tribesman/wizard_hat/operate_ground.json":"sprites/tribesman/wizard_hat/operate_ground.json?1509886887000","sprites/tribesman/wizard_hat/operate_ground.png":"sprites/tribesman/wizard_hat/operate_ground.png?1509886887000","sprites/tribesman/wizard_hat/punch1.json":"sprites/tribesman/wizard_hat/punch1.json?1509886912000","sprites/tribesman/wizard_hat/punch1.png":"sprites/tribesman/wizard_hat/punch1.png?1509886912000","sprites/tribesman/wizard_hat/punch2.json":"sprites/tribesman/wizard_hat/punch2.json?1509886830000","sprites/tribesman/wizard_hat/punch2.png":"sprites/tribesman/wizard_hat/punch2.png?1509886831000","sprites/tribesman/wizard_hat/reach.json":"sprites/tribesman/wizard_hat/reach.json?1510821747000","sprites/tribesman/wizard_hat/reach.png":"sprites/tribesman/wizard_hat/reach.png?1510821747000","sprites/tribesman/wizard_hat/roll.json":"sprites/tribesman/wizard_hat/roll.json?1509886908000","sprites/tribesman/wizard_hat/roll.png":"sprites/tribesman/wizard_hat/roll.png?1509886909000","sprites/tribesman/wizard_hat/run.json":"sprites/tribesman/wizard_hat/run.json?1509886811000","sprites/tribesman/wizard_hat/run.png":"sprites/tribesman/wizard_hat/run.png?1509886811000","sprites/tribesman/wizard_hat/sit.json":"sprites/tribesman/wizard_hat/sit.json?1509886803000","sprites/tribesman/wizard_hat/sit.png":"sprites/tribesman/wizard_hat/sit.png?1509886803000","sprites/tribesman/wizard_hat/spear_attack.json":"sprites/tribesman/wizard_hat/spear_attack.json?1509886859000","sprites/tribesman/wizard_hat/spear_attack.png":"sprites/tribesman/wizard_hat/spear_attack.png?1509886859000","sprites/tribesman/wizard_hat/spear_jump.json":"sprites/tribesman/wizard_hat/spear_jump.json?1509886901000","sprites/tribesman/wizard_hat/spear_jump.png":"sprites/tribesman/wizard_hat/spear_jump.png?1509886901000","sprites/tribesman/wizard_hat/spear_throw.json":"sprites/tribesman/wizard_hat/spear_throw.json?1509886841000","sprites/tribesman/wizard_hat/spear_throw.png":"sprites/tribesman/wizard_hat/spear_throw.png?1509886841000","sprites/tribesman/wizard_hat/spin.json":"sprites/tribesman/wizard_hat/spin.json?1509886882000","sprites/tribesman/wizard_hat/spin.png":"sprites/tribesman/wizard_hat/spin.png?1509886882000","sprites/tribesman/wizard_hat/still.json":"sprites/tribesman/wizard_hat/still.json?1510762268000","sprites/tribesman/wizard_hat/still.png":"sprites/tribesman/wizard_hat/still.png?1510762268000","sprites/tribesman/wizard_hat/stunned.json":"sprites/tribesman/wizard_hat/stunned.json?1509886798000","sprites/tribesman/wizard_hat/stunned.png":"sprites/tribesman/wizard_hat/stunned.png?1509886798000","sprites/tribesman/wizard_hat/tear.json":"sprites/tribesman/wizard_hat/tear.json?1509886921000","sprites/tribesman/wizard_hat/tear.png":"sprites/tribesman/wizard_hat/tear.png?1509886921000","sprites/tribesman/wizard_hat/throw.json":"sprites/tribesman/wizard_hat/throw.json?1509886917000","sprites/tribesman/wizard_hat/throw.png":"sprites/tribesman/wizard_hat/throw.png?1509886917000","sprites/tribesman/wizard_hat/turntable.json":"sprites/tribesman/wizard_hat/turntable.json?1510762270000","sprites/tribesman/wizard_hat/turntable.png":"sprites/tribesman/wizard_hat/turntable.png?1510762270000","sprites/tribesman/wizard_staff/attack_bow.json":"sprites/tribesman/wizard_staff/attack_bow.json?1514848919000","sprites/tribesman/wizard_staff/attack_bow.png":"sprites/tribesman/wizard_staff/attack_bow.png?1514848919000","sprites/tribesman/wizard_staff/attack_horizontal.json":"sprites/tribesman/wizard_staff/attack_horizontal.json?1514848861000","sprites/tribesman/wizard_staff/attack_horizontal.png":"sprites/tribesman/wizard_staff/attack_horizontal.png?1514848861000","sprites/tribesman/wizard_staff/attack_vertical.json":"sprites/tribesman/wizard_staff/attack_vertical.json?1514848838000","sprites/tribesman/wizard_staff/attack_vertical.png":"sprites/tribesman/wizard_staff/attack_vertical.png?1514848838000","sprites/tribesman/wizard_staff/block.json":"sprites/tribesman/wizard_staff/block.json?1514848842000","sprites/tribesman/wizard_staff/block.png":"sprites/tribesman/wizard_staff/block.png?1514848842000","sprites/tribesman/wizard_staff/cast.json":"sprites/tribesman/wizard_staff/cast.json?1514848828000","sprites/tribesman/wizard_staff/cast.png":"sprites/tribesman/wizard_staff/cast.png?1514848828000","sprites/tribesman/wizard_staff/charge_bow.json":"sprites/tribesman/wizard_staff/charge_bow.json?1514848781000","sprites/tribesman/wizard_staff/charge_bow.png":"sprites/tribesman/wizard_staff/charge_bow.png?1514848781000","sprites/tribesman/wizard_staff/charge_meele.json":"sprites/tribesman/wizard_staff/charge_meele.json?1514848894000","sprites/tribesman/wizard_staff/charge_meele.png":"sprites/tribesman/wizard_staff/charge_meele.png?1514848894000","sprites/tribesman/wizard_staff/charge_spell.json":"sprites/tribesman/wizard_staff/charge_spell.json?1514848794000","sprites/tribesman/wizard_staff/charge_spell.png":"sprites/tribesman/wizard_staff/charge_spell.png?1514848794000","sprites/tribesman/wizard_staff/fall_back.json":"sprites/tribesman/wizard_staff/fall_back.json?1514848812000","sprites/tribesman/wizard_staff/fall_back.png":"sprites/tribesman/wizard_staff/fall_back.png?1514848812000","sprites/tribesman/wizard_staff/fall_front.json":"sprites/tribesman/wizard_staff/fall_front.json?1514848914000","sprites/tribesman/wizard_staff/fall_front.png":"sprites/tribesman/wizard_staff/fall_front.png?1514848914000","sprites/tribesman/wizard_staff/growl.json":"sprites/tribesman/wizard_staff/growl.json?1514848856000","sprites/tribesman/wizard_staff/growl.png":"sprites/tribesman/wizard_staff/growl.png?1514848856000","sprites/tribesman/wizard_staff/kick.json":"sprites/tribesman/wizard_staff/kick.json?1514848772000","sprites/tribesman/wizard_staff/kick.png":"sprites/tribesman/wizard_staff/kick.png?1514848772000","sprites/tribesman/wizard_staff/legs_run.json":"sprites/tribesman/wizard_staff/legs_run.json?1514848876000","sprites/tribesman/wizard_staff/legs_run.png":"sprites/tribesman/wizard_staff/legs_run.png?1514848876000","sprites/tribesman/wizard_staff/operate_ground.json":"sprites/tribesman/wizard_staff/operate_ground.json?1514848925000","sprites/tribesman/wizard_staff/operate_ground.png":"sprites/tribesman/wizard_staff/operate_ground.png?1514848925000","sprites/tribesman/wizard_staff/punch1.json":"sprites/tribesman/wizard_staff/punch1.json?1514848822000","sprites/tribesman/wizard_staff/punch1.png":"sprites/tribesman/wizard_staff/punch1.png?1514848822000","sprites/tribesman/wizard_staff/punch2.json":"sprites/tribesman/wizard_staff/punch2.json?1514848775000","sprites/tribesman/wizard_staff/punch2.png":"sprites/tribesman/wizard_staff/punch2.png?1514848775000","sprites/tribesman/wizard_staff/reach.json":"sprites/tribesman/wizard_staff/reach.json?1514848803000","sprites/tribesman/wizard_staff/reach.png":"sprites/tribesman/wizard_staff/reach.png?1514848803000","sprites/tribesman/wizard_staff/roll.json":"sprites/tribesman/wizard_staff/roll.json?1514848869000","sprites/tribesman/wizard_staff/roll.png":"sprites/tribesman/wizard_staff/roll.png?1514848869000","sprites/tribesman/wizard_staff/run.json":"sprites/tribesman/wizard_staff/run.json?1514848851000","sprites/tribesman/wizard_staff/run.png":"sprites/tribesman/wizard_staff/run.png?1514848851000","sprites/tribesman/wizard_staff/sit.json":"sprites/tribesman/wizard_staff/sit.json?1514848901000","sprites/tribesman/wizard_staff/sit.png":"sprites/tribesman/wizard_staff/sit.png?1514848901000","sprites/tribesman/wizard_staff/spear_attack.json":"sprites/tribesman/wizard_staff/spear_attack.json?1514848824000","sprites/tribesman/wizard_staff/spear_attack.png":"sprites/tribesman/wizard_staff/spear_attack.png?1514848824000","sprites/tribesman/wizard_staff/spear_jump.json":"sprites/tribesman/wizard_staff/spear_jump.json?1514848819000","sprites/tribesman/wizard_staff/spear_jump.png":"sprites/tribesman/wizard_staff/spear_jump.png?1514848819000","sprites/tribesman/wizard_staff/spear_throw.json":"sprites/tribesman/wizard_staff/spear_throw.json?1514848779000","sprites/tribesman/wizard_staff/spear_throw.png":"sprites/tribesman/wizard_staff/spear_throw.png?1514848779000","sprites/tribesman/wizard_staff/spin.json":"sprites/tribesman/wizard_staff/spin.json?1514848885000","sprites/tribesman/wizard_staff/spin.png":"sprites/tribesman/wizard_staff/spin.png?1514848885000","sprites/tribesman/wizard_staff/stunned.json":"sprites/tribesman/wizard_staff/stunned.json?1514848801000","sprites/tribesman/wizard_staff/stunned.png":"sprites/tribesman/wizard_staff/stunned.png?1514848801000","sprites/tribesman/wizard_staff/tear.json":"sprites/tribesman/wizard_staff/tear.json?1514848832000","sprites/tribesman/wizard_staff/tear.png":"sprites/tribesman/wizard_staff/tear.png?1514848832000","sprites/tribesman/wizard_staff/throw.json":"sprites/tribesman/wizard_staff/throw.json?1514848890000","sprites/tribesman/wizard_staff/throw.png":"sprites/tribesman/wizard_staff/throw.png?1514848891000","sprites/tribesman/wizard_staff/zombie_run.json":"sprites/tribesman/wizard_staff/zombie_run.json?1514848791000","sprites/tribesman/wizard_staff/zombie_run.png":"sprites/tribesman/wizard_staff/zombie_run.png?1514848791000","sprites/tribesman/wooden_shield/attack_bow.json":"sprites/tribesman/wooden_shield/attack_bow.json?1509885776000","sprites/tribesman/wooden_shield/attack_bow.png":"sprites/tribesman/wooden_shield/attack_bow.png?1509885776000","sprites/tribesman/wooden_shield/attack_horizontal.json":"sprites/tribesman/wooden_shield/attack_horizontal.json?1509885759000","sprites/tribesman/wooden_shield/attack_horizontal.png":"sprites/tribesman/wooden_shield/attack_horizontal.png?1509885759000","sprites/tribesman/wooden_shield/attack_vertical.json":"sprites/tribesman/wooden_shield/attack_vertical.json?1509885738000","sprites/tribesman/wooden_shield/attack_vertical.png":"sprites/tribesman/wooden_shield/attack_vertical.png?1509885738000","sprites/tribesman/wooden_shield/block.json":"sprites/tribesman/wooden_shield/block.json?1509885772000","sprites/tribesman/wooden_shield/block.png":"sprites/tribesman/wooden_shield/block.png?1509885773000","sprites/tribesman/wooden_shield/cast.json":"sprites/tribesman/wooden_shield/cast.json?1509885725000","sprites/tribesman/wooden_shield/cast.png":"sprites/tribesman/wooden_shield/cast.png?1509885725000","sprites/tribesman/wooden_shield/charge_bow.json":"sprites/tribesman/wooden_shield/charge_bow.json?1509885753000","sprites/tribesman/wooden_shield/charge_bow.png":"sprites/tribesman/wooden_shield/charge_bow.png?1509885753000","sprites/tribesman/wooden_shield/charge_meele.json":"sprites/tribesman/wooden_shield/charge_meele.json?1509885751000","sprites/tribesman/wooden_shield/charge_meele.png":"sprites/tribesman/wooden_shield/charge_meele.png?1509885751000","sprites/tribesman/wooden_shield/charge_spell.json":"sprites/tribesman/wooden_shield/charge_spell.json?1509885691000","sprites/tribesman/wooden_shield/charge_spell.png":"sprites/tribesman/wooden_shield/charge_spell.png?1509885691000","sprites/tribesman/wooden_shield/fall_back.json":"sprites/tribesman/wooden_shield/fall_back.json?1509885722000","sprites/tribesman/wooden_shield/fall_back.png":"sprites/tribesman/wooden_shield/fall_back.png?1509885722000","sprites/tribesman/wooden_shield/fall_front.json":"sprites/tribesman/wooden_shield/fall_front.json?1509885798000","sprites/tribesman/wooden_shield/fall_front.png":"sprites/tribesman/wooden_shield/fall_front.png?1509885798000","sprites/tribesman/wooden_shield/growl.json":"sprites/tribesman/wooden_shield/growl.json?1509885730000","sprites/tribesman/wooden_shield/growl.png":"sprites/tribesman/wooden_shield/growl.png?1509885730000","sprites/tribesman/wooden_shield/kick.json":"sprites/tribesman/wooden_shield/kick.json?1509885747000","sprites/tribesman/wooden_shield/kick.png":"sprites/tribesman/wooden_shield/kick.png?1509885747000","sprites/tribesman/wooden_shield/legs_run.json":"sprites/tribesman/wooden_shield/legs_run.json?1509885769000","sprites/tribesman/wooden_shield/legs_run.png":"sprites/tribesman/wooden_shield/legs_run.png?1509885769000","sprites/tribesman/wooden_shield/operate_ground.json":"sprites/tribesman/wooden_shield/operate_ground.json?1509885789000","sprites/tribesman/wooden_shield/operate_ground.png":"sprites/tribesman/wooden_shield/operate_ground.png?1509885789000","sprites/tribesman/wooden_shield/punch1.json":"sprites/tribesman/wooden_shield/punch1.json?1509885815000","sprites/tribesman/wooden_shield/punch1.png":"sprites/tribesman/wooden_shield/punch1.png?1509885815000","sprites/tribesman/wooden_shield/punch2.json":"sprites/tribesman/wooden_shield/punch2.json?1509885733000","sprites/tribesman/wooden_shield/punch2.png":"sprites/tribesman/wooden_shield/punch2.png?1509885733000","sprites/tribesman/wooden_shield/reach.json":"sprites/tribesman/wooden_shield/reach.json?1510821732000","sprites/tribesman/wooden_shield/reach.png":"sprites/tribesman/wooden_shield/reach.png?1510821732000","sprites/tribesman/wooden_shield/roll.json":"sprites/tribesman/wooden_shield/roll.json?1509885812000","sprites/tribesman/wooden_shield/roll.png":"sprites/tribesman/wooden_shield/roll.png?1509885812000","sprites/tribesman/wooden_shield/run.json":"sprites/tribesman/wooden_shield/run.json?1509885713000","sprites/tribesman/wooden_shield/run.png":"sprites/tribesman/wooden_shield/run.png?1509885713000","sprites/tribesman/wooden_shield/sit.json":"sprites/tribesman/wooden_shield/sit.json?1509885703000","sprites/tribesman/wooden_shield/sit.png":"sprites/tribesman/wooden_shield/sit.png?1509885703000","sprites/tribesman/wooden_shield/spear_attack.json":"sprites/tribesman/wooden_shield/spear_attack.json?1509885762000","sprites/tribesman/wooden_shield/spear_attack.png":"sprites/tribesman/wooden_shield/spear_attack.png?1509885762000","sprites/tribesman/wooden_shield/spear_jump.json":"sprites/tribesman/wooden_shield/spear_jump.json?1509885804000","sprites/tribesman/wooden_shield/spear_jump.png":"sprites/tribesman/wooden_shield/spear_jump.png?1509885804000","sprites/tribesman/wooden_shield/spear_throw.json":"sprites/tribesman/wooden_shield/spear_throw.json?1509885742000","sprites/tribesman/wooden_shield/spear_throw.png":"sprites/tribesman/wooden_shield/spear_throw.png?1509885742000","sprites/tribesman/wooden_shield/spin.json":"sprites/tribesman/wooden_shield/spin.json?1509885785000","sprites/tribesman/wooden_shield/spin.png":"sprites/tribesman/wooden_shield/spin.png?1509885785000","sprites/tribesman/wooden_shield/still.json":"sprites/tribesman/wooden_shield/still.json?1510762113000","sprites/tribesman/wooden_shield/still.png":"sprites/tribesman/wooden_shield/still.png?1510762113000","sprites/tribesman/wooden_shield/stunned.json":"sprites/tribesman/wooden_shield/stunned.json?1509885698000","sprites/tribesman/wooden_shield/stunned.png":"sprites/tribesman/wooden_shield/stunned.png?1509885699000","sprites/tribesman/wooden_shield/tear.json":"sprites/tribesman/wooden_shield/tear.json?1509885824000","sprites/tribesman/wooden_shield/tear.png":"sprites/tribesman/wooden_shield/tear.png?1509885825000","sprites/tribesman/wooden_shield/throw.json":"sprites/tribesman/wooden_shield/throw.json?1509885820000","sprites/tribesman/wooden_shield/throw.png":"sprites/tribesman/wooden_shield/throw.png?1509885820000","sprites/tribesman/wooden_shield/turntable.json":"sprites/tribesman/wooden_shield/turntable.json?1510762114000","sprites/tribesman/wooden_shield/turntable.png":"sprites/tribesman/wooden_shield/turntable.png?1510762114000","sprites/waterfall.json":"sprites/waterfall.json?1514475022000","sprites/waterfall.png":"sprites/waterfall.png?1514475022000","data/debris.js":"data/debris.js?1508445829000","data/debris.json":"data/debris.json?1508445835000","shaders/atmosphere_fragment.glsl":"shaders/atmosphere_fragment.glsl?1507836009000","shaders/atmosphere_vertex.glsl":"shaders/atmosphere_vertex.glsl?1507834838000","shaders/background_fragment.glsl":"shaders/background_fragment.glsl?1510652091000","shaders/background_vertex.glsl":"shaders/background_vertex.glsl?1503007363000","shaders/circle_fragment.glsl":"shaders/circle_fragment.glsl?1512664324000","shaders/circle_vertex.glsl":"shaders/circle_vertex.glsl?1510912919000","shaders/citcle_vertex.glsl":"shaders/citcle_vertex.glsl?1510264477000","shaders/foreground.glsl":"shaders/foreground.glsl?1504482955000","shaders/foreground_fragment.glsl":"shaders/foreground_fragment.glsl?1504725847000","shaders/foreground_vertex.glsl":"shaders/foreground_vertex.glsl?1504482960000","shaders/grass_fragment.glsl":"shaders/grass_fragment.glsl?1510912975000","shaders/gui_fragment.glsl":"shaders/gui_fragment.glsl?1512722773000","shaders/gui_vertex.glsl":"shaders/gui_vertex.glsl?1513105311000","shaders/image_fragment.glsl":"shaders/image_fragment.glsl?1512341332000","shaders/image_vertex.glsl":"shaders/image_vertex.glsl?1510652118000","shaders/map_edge_fragment.glsl":"shaders/map_edge_fragment.glsl?1504482485000","shaders/map_edge_vertex.glsl":"shaders/map_edge_vertex.glsl?1504177682000","shaders/meadow_fragment.glsl":"shaders/meadow_fragment.glsl?1514578867000","shaders/planet_fragment.glsl":"shaders/planet_fragment.glsl?1508334379000","shaders/planet_vertex.glsl":"shaders/planet_vertex.glsl?1507825382000","shaders/polygon_fragment.glsl":"shaders/polygon_fragment.glsl?1502919306000","shaders/polygon_vertex.glsl":"shaders/polygon_vertex.glsl?1503006935000","shaders/rect_fragment.glsl":"shaders/rect_fragment.glsl?1514063484000","shaders/rect_vertex.glsl":"shaders/rect_vertex.glsl?1514063654000","shaders/ship_fragment.glsl":"shaders/ship_fragment.glsl?1508426862000","shaders/ship_vertex.glsl":"shaders/ship_vertex.glsl?1507893564000","shaders/sprite_fragment.glsl":"shaders/sprite_fragment.glsl?1512334390000","shaders/sprite_vertex.glsl":"shaders/sprite_vertex.glsl?1511352724000","shaders/surface_fragment.glsl":"shaders/surface_fragment.glsl?1504460829000","shaders/surface_vertex.glsl":"shaders/surface_vertex.glsl?1504432849000","shaders/text_fragment.glsl":"shaders/text_fragment.glsl?1512723129000","shaders/tiling_image_fragment.glsl":"shaders/tiling_image_fragment.glsl?1504482489000","shaders/tiling_image_vertex.glsl":"shaders/tiling_image_vertex.glsl?1504177380000","textures/bg.png":"textures/bg.png?1504091354000","textures/bg1.png":"textures/bg1.png?1503005646000","textures/bg2.jpg":"textures/bg2.jpg?1503008375000","textures/bg3.png":"textures/bg3.png?1503008547000","textures/bg4.png":"textures/bg4.png?1503008631000","textures/bg5.png":"textures/bg5.png?1503263205000","textures/boom.png":"textures/boom.png?1502712006000","textures/bubble.png":"textures/bubble.png?1503489913000","textures/cargo.png":"textures/cargo.png?1493994562000","textures/checkerboard.png":"textures/checkerboard.png?1508194306000","textures/circle.png":"textures/circle.png?1493136201000","textures/crate.png":"textures/crate.png?1493913883000","textures/crate_metal.png":"textures/crate_metal.png?1493913678000","textures/crate_wood.png":"textures/crate_wood.png?1493913687000","textures/cylinder.png":"textures/cylinder.png?1493917141000","textures/displacement.png":"textures/displacement.png?1492633783000","textures/earth.png":"textures/earth.png?1492675988000","textures/earth2.png":"textures/earth2.png?1492675952000","textures/foreground.png":"textures/foreground.png?1504484864000","textures/grid.png":"textures/grid.png?1503353391000","textures/heightmap.png":"textures/heightmap.png?1493319626000","textures/leaderboards.png":"textures/leaderboards.png?1514570920000","textures/map_edge.png":"textures/map_edge.png?1504175780000","textures/map_edge_vegetation.png":"textures/map_edge_vegetation.png?1504278108000","textures/net.png":"textures/net.png?1503054693000","textures/noise32x32.png":"textures/noise32x32.png?1492633816000","textures/palette.png":"textures/palette.png?1514839738000","textures/planet1.png":"textures/planet1.png?1508195430000","textures/position.png":"textures/position.png?1514567153000","textures/rabbit.png":"textures/rabbit.png?1502666540000","textures/sky.png":"textures/sky.png?1503336673000","textures/skybox.png":"textures/skybox.png?1492704145000","textures/smile.png":"textures/smile.png?1502655230000","textures/spritesheet-mandala.png":"textures/spritesheet-mandala.png?1510676181000","textures/spritesheet.png":"textures/spritesheet.png?1514852672000","textures/spritesheet_backup.png":"textures/spritesheet_backup.png?1513030842000","textures/spritesheet_p.png":"textures/spritesheet_p.png?1512334146000","textures/surface.png":"textures/surface.png?1503353423000","textures/vignette.png":"textures/vignette.png?1504092134000","textures/water/b/0.png":"textures/water/b/0.png?1504089246000","textures/water/b/1.png":"textures/water/b/1.png?1504089303000","textures/water/b/2.png":"textures/water/b/2.png?1504089347000","textures/water/b/3.png":"textures/water/b/3.png?1504089459000","textures/water/b/4.png":"textures/water/b/4.png?1504089538000","textures/water/b/5.png":"textures/water/b/5.png?1504089689000","textures/water/temp/water1.png":"textures/water/temp/water1.png?1504088474000","textures/water/temp/water2.png":"textures/water/temp/water2.png?1504088493000","textures/water/temp/water3.png":"textures/water/temp/water3.png?1504088501000","textures/water/temp/water4.png":"textures/water/temp/water4.png?1504088510000","textures/water/temp/water5.png":"textures/water/temp/water5.png?1504088517000","textures/water/temp/water6.png":"textures/water/temp/water6.png?1504088527000","textures/water/temp/water7.png":"textures/water/temp/water7.png?1504088535000","textures/water/temp/water8.png":"textures/water/temp/water8.png?1504088546000","textures/water/temp/water9.png":"textures/water/temp/water9.png?1504088554000","textures/water/water0.png":"textures/water/water0.png?1504088501000","textures/water/water1.png":"textures/water/water1.png?1504088510000","textures/water/water2.png":"textures/water/water2.png?1504088517000","textures/water/water3.png":"textures/water/water3.png?1504088527000","textures/water/water4.png":"textures/water/water4.png?1504088535000","textures/water/water5.png":"textures/water/water5.png?1504088546000","textures/water/water6.png":"textures/water/water6.png?1504088554000","textures/water/xxx.gif":"textures/water/xxx.gif?1504090445000","textures/water.png":"textures/water.png?1504088215000","common/data/shared.json":"common/data/shared.json?1514576363000","common/data/ships.json":"common/data/ships.json?1508424874000","common/data/units.json":"common/data/units.json?1508857195000"};(function(){var COCOONJS=false;var Canvas=window.HTMLCanvasElement;var orgImage=window.Image;var Image=window.HTMLImageElement;var ImageBitmap=window.ImageBitmap||window.HTMLImageElement;var COCOONJS=navigator.isCocoonJS;var cq=function(selector){if(arguments.length===0){var canvas=cq.pool();canvas.width=window.innerWidth;canvas.height=window.innerHeight;}else if(typeof selector==="string"){var canvas=document.querySelector(selector);}else if(typeof selector==="number"){var canvas=cq.pool();canvas.width=arguments[0];canvas.height=arguments[1];}else if(selector instanceof Image){var canvas=cq.pool();canvas.width=selector.width;canvas.height=selector.height;canvas.getContext("2d").drawImage(selector,0,0);}else if(selector instanceof ImageBitmap){var canvas=cq.pool();canvas.width=selector.width;canvas.height=selector.height;canvas.getContext("2d").drawImage(selector,0,0);}else if(selector instanceof cq.Layer){return selector;}else{var canvas=selector;}
    return new cq.Layer(canvas);};cq.lineSpacing=1.0;cq.defaultFont="";cq.textBaseline="alphabetic";cq.matchPalettePrecision=10;cq.strokeStyle=false;cq.fillStyle=false;cq.palettes={db16:["#140c1c","#442434","#30346d","#4e4a4e","#854c30","#346524","#d04648","#757161","#597dce","#d27d2c","#8595a1","#6daa2c","#d2aa99","#6dc2ca","#dad45e","#deeed6"],db32:["#000000","#222034","#45283c","#663931","#8f563b","#df7126","#d9a066","#eec39a","#fbf236","#99e550","#6abe30","#37946e","#4b692f","#524b24","#323c39","#3f3f74","#306082","#5b6ee1","#639bff","#5fcde4","#cbdbfc","#ffffff","#9badb7","#847e87","#696a6a","#595652","#76428a","#ac3232","#d95763","#d77bba","#8f974a","#8a6f30"],c64:["#000000","#6a5400","#68ae5c","#8a8a8a","#adadad","#636363","#c37b75","#c9d684","#ffffff","#984b43","#a3e599","#79c1c8","#9b6739","#9b51a5","#52429d","#8a7bce"],gameboy:["#0f380f","#306230","#8bac0f","#9bbc0f"],sega:["#000000","#555500","#005500","#555555","#55aa00","#550000","#aaffaa","#aaaaaa","#ff5555","#005555","#550055","#aaaa55","#ffffaa","#aa5555","#ffaa55","#ffff55","#ffffff","#ffaaaa","#000055","#55aaaa","#aa0000","#ff5500","#ffaa00","#aa5500","#ff0000","#ffaaff","#aa55aa","#aaaa00","#aaff00","#aaaaff","#5555aa","#aaffff"],cga:["#000000","#ff5555","#55ff55","#ffff55"],nes:["#7C7C7C","#0000FC","#0000BC","#4428BC","#940084","#A80020","#A81000","#881400","#503000","#007800","#006800","#005800","#004058","#000000","#000000","#000000","#BCBCBC","#0078F8","#0058F8","#6844FC","#D800CC","#E40058","#F83800","#E45C10","#AC7C00","#00B800","#00A800","#00A844","#008888","#000000","#000000","#000000","#F8F8F8","#3CBCFC","#6888FC","#9878F8","#F878F8","#F85898","#F87858","#FCA044","#F8B800","#B8F818","#58D854","#58F898","#00E8D8","#787878","#000000","#000000","#FCFCFC","#A4E4FC","#B8B8F8","#D8B8F8","#F8B8F8","#F8A4C0","#F0D0B0","#FCE0A8","#F8D878","#D8F878","#B8F8B8","#B8F8D8","#00FCFC","#F8D8F8","#000000"],};cq.cocoon=function(selector){if(arguments.length===0){var canvas=cq.createCocoonCanvas(window.innerWidth,window.innerHeight);window.addEventListener("resize",function(){});}else if(typeof selector==="string"){var canvas=document.querySelector(selector);}else if(typeof selector==="number"){var canvas=cq.createCocoonCanvas(arguments[0],arguments[1]);}else if(selector instanceof Image){var canvas=cq.createCocoonCanvas(selector);}else if(selector instanceof cq.Layer){return selector;}else{var canvas=selector;}
    return new cq.Layer(canvas);}
    cq.extend=function(){for(var i=1;i<arguments.length;i++){for(var j in arguments[i]){arguments[0][j]=arguments[i][j];}}
        return arguments[0];};cq.augment=function(){for(var i=1;i<arguments.length;i++){_.extend(arguments[0],arguments[i]);arguments[i](arguments[0]);}};cq.distance=function(x1,y1,x2,y2){if(arguments.length>2){var dx=x1- x2;var dy=y1- y2;return Math.sqrt(dx*dx+ dy*dy);}else{return Math.abs(x1- y1);}};cq.fastApply=function(subject,thisContext,args){switch(args.length){case 0:return subject.call(thisContext);case 1:return subject.call(thisContext,args[0]);case 2:return subject.call(thisContext,args[0],args[1]);case 3:return subject.call(thisContext,args[0],args[1],args[2]);case 4:return subject.call(thisContext,args[0],args[1],args[2],args[3]);case 5:return subject.call(thisContext,args[0],args[1],args[2],args[3],args[4]);case 6:return subject.call(thisContext,args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return subject.call(thisContext,args[0],args[1],args[2],args[3],args[4],args[5],args[6]);case 8:return subject.call(thisContext,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);case 9:return subject.call(thisContext,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8]);default:return subject.apply(thisContext,args);}};cq.extend(cq,{smoothing:true,blend:function(below,above,mode,mix){if(typeof mix==="undefined")mix=1;var below=cq(below);var mask=below.clone();var above=cq(above);below.save();below.globalAlpha(mix);below.globalCompositeOperation(mode);below.drawImage(above.canvas,0,0);below.restore();mask.save();mask.globalCompositeOperation("source-in");mask.drawImage(below.canvas,0,0);mask.restore();return mask;},matchColor:function(color,palette){var rgbPalette=[];for(var i=0;i<palette.length;i++){rgbPalette.push(cq.color(palette[i]));}
            var imgData=cq.color(color);var difList=[];for(var j=0;j<rgbPalette.length;j++){var rgbVal=rgbPalette[j];var rDif=Math.abs(imgData[0]- rgbVal[0]),gDif=Math.abs(imgData[1]- rgbVal[1]),bDif=Math.abs(imgData[2]- rgbVal[2]);difList.push(rDif+ gDif+ bDif);}
            var closestMatch=0;for(var j=0;j<palette.length;j++){if(difList[j]<difList[closestMatch]){closestMatch=j;}}
            return palette[closestMatch];},temp:function(width,height){if(!this.tempLayer){this.tempLayer=cq(1,1);}
            if(width instanceof Image||width instanceof ImageBitmap){this.tempLayer.width=width.width;this.tempLayer.height=width.height;this.tempLayer.context.drawImage(width,0,0);}else if(width instanceof Canvas){this.tempLayer.width=width.width;this.tempLayer.height=width.height;this.tempLayer.context.drawImage(width,0,0);}else if(width instanceof CanvasQuery.Layer){this.tempLayer.width=width.width;this.tempLayer.height=width.height;this.tempLayer.context.drawImage(width.canvas,0,0);}else{this.tempLayer.width=width;this.tempLayer.height=height;}
            return this.tempLayer;},wrapValue:function(value,min,max){if(value<min)return max+(value%max);if(value>=max)return value%max;return value;},limitValue:function(value,min,max){return value<min?min:value>max?max:value;},mix:function(a,b,amount){return a+(b- a)*amount;},hexToRgb:function(hex){if(hex.length===7)return['0x'+ hex[1]+ hex[2]|0,'0x'+ hex[3]+ hex[4]|0,'0x'+ hex[5]+ hex[6]|0];else return['0x'+ hex[1]+ hex[1]|0,'0x'+ hex[2]+ hex[2]|0,'0x'+ hex[3]+ hex[3]|0];},rgbToHex:function(r,g,b){return"#"+((1<<24)+(r<<16)+(g<<8)+ b).toString(16).slice(1,7);},extractCanvas:function(o){if(o.canvas)return o.canvas;else return o;},compare:function(a,b){a=this.extractCanvas(a);b=this.extractCanvas(b);a=a.getContext("2d").getImageData(0,0,a.width,a.height).data;b=b.getContext("2d").getImageData(0,0,b.width,b.height).data;if(a.length!==b.length)return false;for(var i=0;i<a.length;i++){if(a[i]!==b[i])return false;}
            return true;},rgbToHsl:function(r,g,b){if(r instanceof Array){b=r[2];g=r[1];r=r[0];}
            r/=255,g/=255,b/=255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h,s,l=(max+ min)/ 2;
            if(max==min){h=s=0;}else{var d=max- min;s=l>0.5?d/(2- max- min):d/(max+ min);switch(max){case r:h=(g- b)/ d + (g < b ? 6 : 0);
                break;case g:h=(b- r)/ d + 2;
                break;case b:h=(r- g)/ d + 4;
                break;}
                h/=6;}
            return[h,s,l];},hue2rgb:function(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q- p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q- p)*(2/3- t)*6;return p;},hslToRgb:function(h,s,l){var r,g,b;if(s==0){r=g=b=l;}else{var q=l<0.5?l*(1+ s):l+ s- l*s;var p=2*l- q;r=this.hue2rgb(p,q,h+ 1/3);g=this.hue2rgb(p,q,h);b=this.hue2rgb(p,q,h- 1/3);}
            return[r*255|0,g*255|0,b*255|0];},rgbToHsv:function(r,g,b){if(r instanceof Array){b=r[2];g=r[1];r=r[0];}
            r=r/255,g=g/255,b=b/255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h,s,v=max;var d=max- min;s=max==0?0:d/max;if(max==min){h=0;}else{switch(max){case r:h=(g- b)/ d + (g < b ? 6 : 0);
                break;case g:h=(b- r)/ d + 2;
                break;case b:h=(r- g)/ d + 4;
                break;}
                h/=6;}
            return[h,s,v];},hsvToRgb:function(h,s,v){var r,g,b;var i=Math.floor(h*6);var f=h*6- i;var p=v*(1- s);var q=v*(1- f*s);var t=v*(1-(1- f)*s);switch(i%6){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;case 5:r=v,g=p,b=q;break;}
            return[r*255,g*255,b*255];},color:function(){var result=new cq.Color();result.parse(arguments[0],arguments[1]);return result;},poolArray:[],pool:function(){if(!this.poolArray.length){for(var i=0;i<100;i++){this.poolArray.push(this.createCanvas(1,1));}}
            return this.poolArray.pop();},reuse:function(object){return this.recycle(object);},recycle:function(object){if(object instanceof CanvasQuery.Layer){this.poolArray.push(object.canvas);}else{this.poolArray.push(object);}},setContextSmoothing:function(context,smoothing){context.mozImageSmoothingEnabled=smoothing;context.msImageSmoothingEnabled=smoothing;context.webkitImageSmoothingEnabled=smoothing;context.imageSmoothingEnabled=smoothing;},createCanvas:function(width,height){var result=document.createElement("canvas");if(arguments[0]instanceof Image||arguments[0]instanceof Canvas||arguments[0]instanceof ImageBitmap){var image=arguments[0];result.width=image.width;result.height=image.height;result.getContext("2d").drawImage(image,0,0);}else{result.width=width;result.height=height;}
            return result;},createCocoonCanvas:function(width,height){var result=document.createElement("screencanvas");if(arguments[0]instanceof Image){var image=arguments[0];result.width=image.width;result.height=image.height;result.getContext("2d").drawImage(image,0,0);}else{result.width=width;result.height=height;}
            return result;},createImageData:function(width,height){return cq.createCanvas(width,height).getContext("2d").createImageData(width,height);}});cq.Layer=function(canvas){this.useAlpha=true;this.canvas=canvas;this.prevAlignX=[];this.prevAlignY=[];this.alignX=0;this.alignY=0;this.aligned=false;this.update();};cq.Layer.prototype={constructor:cq.Layer,update:function(){var smoothing=cq.smoothing;if(typeof this.smoothing!=="undefined")smoothing=this.smoothing;this.context=this.canvas.getContext("2d",{alpha:Boolean(this.useAlpha)});this.context.mozImageSmoothingEnabled=smoothing;this.context.msImageSmoothingEnabled=smoothing;this.context.webkitImageSmoothingEnabled=smoothing;this.context.imageSmoothingEnabled=smoothing;if(cq.defaultFont)this.context.font=cq.defaultFont;this.context.textBaseline=cq.textBaseline;if(COCOONJS)Cocoon.Utils.setAntialias(smoothing);if(cq.strokeStyle)this.context.strokeStyle=cq.strokeStyle;if(cq.fillStyle)this.context.fillStyle=cq.fillStyle;},appendTo:function(selector){if(typeof selector==="object"){var element=selector;}else{var element=document.querySelector(selector);}
            element.appendChild(this.canvas);return this;},a:function(a){if(arguments.length){this.previousAlpha=this.globalAlpha();return this.globalAlpha(a);}else{return this.globalAlpha();}},ra:function(){return this.a(this.previousAlpha);},realign:function(){this.alignX=this.prevAlignX[this.prevAlignX.length- 1];this.alignY=this.prevAlignY[this.prevAlignY.length- 1];return this;},align:function(x,y){if(typeof y==="undefined")y=x;this.alignX=x;this.alignY=y;return this;},stars:function(x,y,alignX,alignY,rotation,scaleX,scaleY){if(typeof alignX==="undefined")alignX=0.5;if(typeof alignY==="undefined")alignY=0.5;if(typeof rotation==="undefined")rotation=0;if(typeof scaleX==="undefined")scaleX=1.0;if(typeof scaleY==="undefined")scaleY=scaleX;this.save();this.translate(x,y);this.align(alignX,alignY);this.rotate(rotation);this.scale(scaleX,scaleY);return this;},tars:function(x,y,alignX,alignY,rotation,scaleX,scaleY){if(typeof alignX==="undefined")alignX=0.5;if(typeof alignY==="undefined")alignY=0.5;if(typeof rotation==="undefined")rotation=0;if(typeof scaleX==="undefined")scaleX=1.0;if(typeof scaleY==="undefined")scaleY=scaleX;this.translate(x,y);this.align(alignX,alignY);this.rotate(rotation);this.scale(scaleX,scaleY);return this;},webkit:('WebkitAppearance'in document.documentElement.style),fillText:function(text,x,y,gap){text=String(text);if(!text.length)return;var webkitHack=!cq.smoothing&&(this.fontHeight()<=64)&&('WebkitAppearance'in document.documentElement.style);if(webkitHack){var scale=this.webkit?4:5;var canvas=cq.pool();var context=canvas.getContext("2d");context.font=this.context.font;var realWidth=context.measureText(text).width;var width=Math.ceil(realWidth);var gap=gap||(width- realWidth);var height=this.fontHeight();canvas.width=width*scale;canvas.height=height*scale;cq.setContextSmoothing(context,false);context.font=this.context.font;context.fillStyle=this.context.fillStyle;context.textBaseline="top";context.scale(scale,scale);context.fillText(text,gap,-this.fontTop());if(this.context.textAlign==="center")x-=width*0.5;else if(this.context.textAlign==="right")x-=width;this.drawImage(canvas,0,0,canvas.width,canvas.height,x,y,canvas.width/scale,canvas.height/scale);}else{this.context.fillText(text,x,y- this.fontTop());}
            return this;},fillRect:function(){if(this.alignX||this.alignY){this.context.fillRect(arguments[0]- arguments[2]*this.alignX|0,arguments[1]- arguments[3]*this.alignY|0,arguments[2],arguments[3]);}else{this.context.fillRect(arguments[0],arguments[1],arguments[2],arguments[3]);}
            return this;},strokeRect:function(){if(this.alignX||this.alignY){this.context.strokeRect(arguments[0]- arguments[2]*this.alignX|0,arguments[1]- arguments[3]*this.alignY|0,arguments[2],arguments[3]);}else{this.context.strokeRect(arguments[0],arguments[1],arguments[2],arguments[3]);}
            return this;},drawImage:function(image,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight){if(this.alignX||this.alignY){if(typeof sWidth==="undefined"){sx-=image.width*this.alignX|0;sy-=image.height*this.alignY|0;}else{dx-=dWidth*this.alignX|0;dy-=dHeight*this.alignY|0;}}
            if(typeof sWidth==="undefined"){this.context.drawImage(image,sx,sy);}else if(typeof dx==="undefined"){this.context.drawImage(image,sx,sy,sWidth,sHeight);}else{this.context.drawImage(image,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight);}
            return this;},drawImageCentered:function(image,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight){if(sWidth==null){sx-=image.width*0.5|0;sy-=image.height*0.5|0;}else{dx-=dWidth*0.5|0;dy-=dHeight*0.5|0;}
            if(sWidth==null){this.context.drawImage(image,sx,sy);}else if(dx==null){this.context.drawImage(image,sx,sy,sWidth,sHeight);}else{this.context.drawImage(image,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight);}
            return this;},save:function(){this.prevAlignX.push(this.alignX);this.prevAlignY.push(this.alignY);this.context.save();return this;},restore:function(){this.realign();this.alignX=this.prevAlignX.pop();this.alignY=this.prevAlignY.pop();this.context.restore();return this;},drawTile:function(image,x,y,frameX,frameY,frameWidth,frameHeight,frames,frame){},checkerboard:function(x,y,w,h,grid,colorA,colorB){var tx=w/grid|0;var ty=h/grid|0;this.save();this.rect(x,y,w,h).clip();for(var i=0;i<=tx;i++){for(var j=0;j<=ty;j++){if(j%2)var color=i%2?colorA:colorB;else var color=i%2?colorB:colorA;this.fillStyle(color);this.fillRect(x+ i*grid,y+ j*grid,grid,grid);}}
            this.restore();},drawAtlasFrame:function(atlas,frame,x,y){var frame=atlas.frames[frame];this.drawRegion(atlas.image,frame.region,x- frame.width*this.alignX+ frame.offset[0]+ frame.region[2]*this.alignX,y- frame.height*this.alignY+ frame.offset[1]+ frame.region[3]*this.alignY);return this;},coverImage:function(image,width,height){if(typeof width==="undefined")width=this.width;if(typeof height==="undefined")height=this.height;var scale=Math.max(width/image.width,height/image.height);this.save();this.scale(scale,scale);this.drawImage(image,0,0);this.restore();},fitImage:function(image,width,height){if(typeof width==="undefined")width=this.width;if(typeof height==="undefined")height=this.height;var scale=Math.min(width/image.width,height/image.height);this.save();this.scale(scale,scale);this.drawImage(image,0,0);this.restore();},drawRegion:function(image,region,x,y,scale){scale=scale||1;return this.drawImage(image,region[0],region[1],region[2],region[3],x|0,y|0,region[2]*scale|0,region[3]*scale|0);},drawRegionCentered:function(image,region,x,y,scale){scale=scale||1;return this.drawImageCentered(image,region[0],region[1],region[2],region[3],x|0,y|0,region[2]*scale|0,region[3]*scale|0);},cache:function(){return this.clone().canvas;},popup:function(){window.open(this.canvas.toDataURL());return this;},blendOn:function(what,mode,mix){cq.blend(what,this,mode,mix);return this;},posterize:function(pc,inc){pc=pc||32;inc=inc||4;var imgdata=this.getImageData(0,0,this.width,this.height);var data=imgdata.data;for(var i=0;i<data.length;i+=inc){data[i]-=data[i]%pc;data[i+ 1]-=data[i+ 1]%pc;data[i+ 2]-=data[i+ 2]%pc;}
            this.putImageData(imgdata,0,0);return this;},posterizeAlpha:function(pc,inc){pc=pc||32;inc=inc||4;var imgdata=this.getImageData(0,0,this.width,this.height);var data=imgdata.data;for(var i=0;i<data.length;i+=inc){data[i+ 3]-=data[i+ 3]%pc;}
            this.putImageData(imgdata,0,0);return this;},bw:function(pc){pc=128;var imgdata=this.getImageData(0,0,this.width,this.height);var data=imgdata.data;for(var i=0;i<data.length;i+=4){var v=((data[i]+ data[i+ 1]+ data[i+ 2])/ 3);
            v=(v/128|0)*128;data[i+ 2]=(v/255)*data[i];}
            this.putImageData(imgdata,0,0);},blend:function(what,mode,mix){if(typeof what==="string"){var color=what;what=cq(this.canvas.width,this.canvas.height);what.fillStyle(color).fillRect(0,0,this.canvas.width,this.canvas.height);}
            var result=cq.blend(this,what,mode,mix);this.canvas=result.canvas;this.context=result.context;return this;},textWithBackground:function(text,x,y,background,padding){var w=this.measureText(text).width;var h=this.fontHeight()*0.8;var f=this.fillStyle();var padding=padding||2;var a=this.context.textAlign;this.fillStyle(background).fillRect(x- padding*2,y- padding,w+ padding*4,h+ padding*2)
            this.fillStyle(f).textAlign("left").textBaseline("top").fillText(text,x,y);return this;},fillCircle:function(x,y,r){this.context.beginPath();this.context.arc(x,y,r,0,Math.PI*2);this.context.fill();return this;},strokeCircle:function(x,y,r){this.context.beginPath();this.context.arc(x,y,r,0,Math.PI*2);this.context.stroke();return this;},circle:function(x,y,r){this.context.arc(x,y,r,0,Math.PI*2);return this;},crop:function(x,y,w,h){if(arguments.length===1){var y=arguments[0][1];var w=arguments[0][2];var h=arguments[0][3];var x=arguments[0][0];}
            var canvas=cq.createCanvas(w,h);var context=canvas.getContext("2d");context.drawImage(this.canvas,x,y,w,h,0,0,w,h);this.canvas.width=w;this.canvas.height=h;cq.setContextSmoothing(this.context,false);this.clear();this.context.drawImage(canvas,0,0);return this;},set:function(properties){cq.extend(this.context,properties);},resize:function(width,height){var w=width,h=height;if(arguments.length===1){w=arguments[0]*this.canvas.width|0;h=arguments[0]*this.canvas.height|0;}else{if(height===false){if(this.canvas.width>width){h=this.canvas.height*(width/this.canvas.width)|0;w=width;}else{w=this.canvas.width;h=this.canvas.height;}}else if(width===false){if(this.canvas.width>width){w=this.canvas.width*(height/this.canvas.height)|0;h=height;}else{w=this.canvas.width;h=this.canvas.height;}}}
            var cqresized=cq(w,h).drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,w,h);this.canvas=cqresized.canvas;this.context=cqresized.context;return this;},resizeBounds:function(width,height){var temp=cq(width,height);temp.drawImage(this.canvas,0,0);this.canvas=temp.canvas;this.context=temp.context;return this;},imageLine:function(image,region,x,y,ex,ey,scale){if(!region)region=[0,0,image.width,image.height];var distance=cq.distance(x,y,ex,ey);var count=distance/region[3]+ 0.5|0;var angle=Math.atan2(ey- y,ex- x)+ Math.PI/2;this.save();this.translate(x,y);this.rotate(angle);if(scale)this.scale(scale,1.0);for(var i=0;i<=count;i++){this.drawRegion(image,region,-region[2]/2|0,-region[3]*(i+ 1));}
            this.restore();return this;},trim:function(color,changes){var transparent;if(color){color=cq.color(color).toArray();transparent=!color[3];}else transparent=true;var sourceData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var sourcePixels=sourceData.data;var bound=[this.canvas.width,this.canvas.height,0,0];var width=this.canvas.width;var height=this.canvas.height;for(var i=0,len=sourcePixels.length;i<len;i+=4){if(transparent){if(!sourcePixels[i+ 3])continue;}else if(sourcePixels[i+ 0]===color[0]&&sourcePixels[i+ 1]===color[1]&&sourcePixels[i+ 2]===color[2])continue;var x=(i/4|0)%this.canvas.width|0;var y=(i/4|0)/ this.canvas.width | 0;
            if(x<bound[0])bound[0]=x;if(x>bound[2])bound[2]=x;if(y<bound[1])bound[1]=y;if(y>bound[3])bound[3]=y;}
            if(bound[2]===0&&bound[3]===0){if(changes)changes.none=true;}else{if(changes){changes.left=bound[0];changes.top=bound[1];changes.bottom=height- bound[3]- bound[1];changes.right=width- bound[2]- bound[0];changes.width=bound[2]- bound[0];changes.height=bound[3]- bound[1];}
                this.crop(bound[0],bound[1],bound[2]- bound[0]+ 1,bound[3]- bound[1]+ 1);}
            return this;},matchPalette:function(palette){if(!palette.matches)palette.matches=new Map;if(!palette.colors){palette.colors=[];for(var i=0;i<palette.length;i++){palette.colors.push(cq.color(palette[i]));}}
            var imageData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var pixels=imageData.data;for(var i=0;i<pixels.length;i+=4){var difList=[];if(!pixels[i+ 3])continue;var key=(pixels[i+ 0]/cq.matchPalettePrecision|0)*cq.matchPalettePrecision+
                (pixels[i+ 1]/cq.matchPalettePrecision|0)*cq.matchPalettePrecision*1000+
                (pixels[i+ 2]/cq.matchPalettePrecision|0)*cq.matchPalettePrecision*1000000;if(!palette.matches.has(key)){for(var j=0;j<palette.colors.length;j++){var rgb=palette.colors[j];var rDif=Math.abs(pixels[i]- rgb[0]);var gDif=Math.abs(pixels[i+ 1]- rgb[1])
                var bDif=Math.abs(pixels[i+ 2]- rgb[2]);difList.push(rDif+ gDif+ bDif);}
                var closestMatch=0;for(var j=0;j<palette.length;j++){if(difList[j]<difList[closestMatch]){closestMatch=j;}}
                palette.matches.set(key,palette.colors[closestMatch]);}
                var matchedColor=palette.matches.get(key);pixels[i]=matchedColor[0];pixels[i+ 1]=matchedColor[1];pixels[i+ 2]=matchedColor[2];}
            this.context.putImageData(imageData,0,0);return this;},swapColors:function(colors){var colormap={};for(var key in colors){var color=cq.color(key);var index=color[0]+ color[1]*1000+ color[2]*1000000;colormap[index]=cq.color(colors[key]);}
            var imageData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var pixels=imageData.data;for(var i=0;i<pixels.length;i+=4){if(!pixels[i+ 3])continue;var index=pixels[i]+ pixels[i+ 1]*1000+ pixels[i+ 2]*1000000;if(colormap[index]){pixels[i]=colormap[index][0];pixels[i+ 1]=colormap[index][1];pixels[i+ 2]=colormap[index][2];}}
            this.context.putImageData(imageData,0,0);return this;},getPalette:function(){var palette=[];var sourceData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var sourcePixels=sourceData.data;for(var i=0,len=sourcePixels.length;i<len;i+=4){if(sourcePixels[i+ 3]){var hex=cq.rgbToHex(sourcePixels[i+ 0],sourcePixels[i+ 1],sourcePixels[i+ 2]);if(palette.indexOf(hex)===-1)palette.push(hex);}}
            return palette;},mapPalette:function(){},lines:function(){for(var i=0;i<arguments.length;i+=2){this.lineTo(arguments[i],arguments[i+ 1]);}
            return this;},polygon:function(array,x,y){if(x===undefined){x=0;}
            if(y===undefined){y=0;}
            this.beginPath();this.moveTo(array[0][0]+ x,array[0][1]+ y);for(var i=1;i<array.length;i++){this.lineTo(array[i][0]+ x,array[i][1]+ y);}
            this.closePath();return this;},fillPolygon:function(polygon){this.polygon(polygon);this.fill();},strokePolygon:function(polygon){this.polygon(polygon);this.stroke();},rotate:function(angle){this.context.rotate(angle);return this;},scale:function(x,y){this.context.scale(x,y);return this;},translate:function(x,y){this.context.translate(x,y);return this;},colorToMask:function(color,inverted){color=cq.color(color).toArray();var sourceData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var sourcePixels=sourceData.data;var mask=[];for(var i=0,len=sourcePixels.length;i<len;i+=4){if(sourcePixels[i+ 3]>0)mask.push(inverted?false:true);else mask.push(inverted?true:false);}
            return mask;},grayscaleToMask:function(){var sourceData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var sourcePixels=sourceData.data;var mask=[];for(var i=0,len=sourcePixels.length;i<len;i+=4){mask.push(((sourcePixels[i+ 0]+ sourcePixels[i+ 1]+ sourcePixels[i+ 2])/ 3) / 255);
        }
            return mask;},applyMask:function(mask){var sourceData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var sourcePixels=sourceData.data;var mode=typeof mask[0]==="boolean"?"bool":"byte";for(var i=0,len=sourcePixels.length;i<len;i+=4){var value=mask[i/4];sourcePixels[i+ 3]=value*255|0;}
            this.context.putImageData(sourceData,0,0);return this;},fillMask:function(mask){var sourceData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var sourcePixels=sourceData.data;var maskType=typeof mask[0]==="boolean"?"bool":"byte";var colorMode=arguments.length===2?"normal":"gradient";var color=cq.color(arguments[1]);if(colorMode==="gradient")colorB=cq.color(arguments[2]);for(var i=0,len=sourcePixels.length;i<len;i+=4){var value=mask[i/4];if(maskType==="byte")value/=255;if(colorMode==="normal"){if(value){sourcePixels[i+ 0]=color[0]|0;sourcePixels[i+ 1]=color[1]|0;sourcePixels[i+ 2]=color[2]|0;sourcePixels[i+ 3]=value*255|0;}}else{sourcePixels[i+ 0]=color[0]+(colorB[0]- color[0])*value|0;sourcePixels[i+ 1]=color[1]+(colorB[1]- color[1])*value|0;sourcePixels[i+ 2]=color[2]+(colorB[2]- color[2])*value|0;sourcePixels[i+ 3]=255;}}
            this.context.putImageData(sourceData,0,0);return this;},clear:function(color){if(color){this.context.fillStyle=color;this.context.fillRect(0,0,this.canvas.width,this.canvas.height);}else{this.context.clearRect(0,0,this.canvas.width,this.canvas.height);}
            return this;},clone:function(){var result=cq.pool();result.width=this.width;result.height=this.height;result.getContext("2d").drawImage(this.canvas,0,0);return cq(result);},gradientText:function(text,x,y,maxWidth,gradient){var words=text.split(" ");var h=this.fontHeight()*2;var ox=0;var oy=0;if(maxWidth){var line=0;var lines=[""];for(var i=0;i<words.length;i++){var word=words[i]+" ";var wordWidth=this.context.measureText(word).width;if(ox+ wordWidth>maxWidth){lines[++line]="";ox=0;}
            lines[line]+=word;ox+=wordWidth;}}else var lines=[text];for(var i=0;i<lines.length;i++){var oy=y+ i*h*0.6|0;var lingrad=this.context.createLinearGradient(0,oy,0,oy+ h*0.6|0);for(var j=0;j<gradient.length;j+=2){lingrad.addColorStop(gradient[j],gradient[j+ 1]);}
            var text=lines[i];this.fillStyle(lingrad).fillText(text,x,oy);}
            return this;},removeColor:function(color){color=cq.color(color);var data=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var pixels=data.data;for(var x=0;x<this.canvas.width;x++){for(var y=0;y<this.canvas.height;y++){var i=(y*this.canvas.width+ x)*4;if(pixels[i+ 0]===color[0]&&pixels[i+ 1]===color[1]&&pixels[i+ 2]===color[2]){pixels[i+ 3]=0;}}}
            this.clear();this.context.putImageData(data,0,0);return this;},_outlineCheck:function check(x,y,width,height,pixels){if(x<0)return 0;if(x>=width)return 0;if(y<0)return 0;if(y>=height)return 0;var i=(x+ y*width)*4;return pixels[i+ 3]>0;},outline:function(color){var color=cq.color(color||"#fff");var data=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var pixels=data.data;var newData=this.createImageData(this.canvas.width,this.canvas.height);var newPixels=newData.data;var canvas=this.canvas;for(var x=0;x<this.canvas.width;x++){for(var y=0;y<this.canvas.height;y++){var full=0;var i=(y*canvas.width+ x)*4;if(!pixels[i+ 3])continue;full+=this._outlineCheck(x- 1,y,canvas.width,canvas.height,pixels);full+=this._outlineCheck(x+ 1,y,canvas.width,canvas.height,pixels);full+=this._outlineCheck(x,y- 1,canvas.width,canvas.height,pixels);full+=this._outlineCheck(x,y+ 1,canvas.width,canvas.height,pixels);if(full!==4){newPixels[i]=color[0];newPixels[i+ 1]=color[1];newPixels[i+ 2]=color[2];newPixels[i+ 3]=255;}}}
            this.context.putImageData(newData,0,0);return this;},setHsl:function(){if(arguments.length===1){var args=arguments[0];}else{var args=arguments;}
            var data=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var pixels=data.data;var r,g,b,a,h,s,l,hsl=[],newPixel=[];for(var i=0,len=pixels.length;i<len;i+=4){hsl=cq.rgbToHsl(pixels[i+ 0],pixels[i+ 1],pixels[i+ 2]);h=args[0]===false?hsl[0]:cq.limitValue(args[0],0,1);s=args[1]===false?hsl[1]:cq.limitValue(args[1],0,1);l=args[2]===false?hsl[2]:cq.limitValue(args[2],0,1);newPixel=cq.hslToRgb(h,s,l);pixels[i+ 0]=newPixel[0];pixels[i+ 1]=newPixel[1];pixels[i+ 2]=newPixel[2];}
            this.context.putImageData(data,0,0);return this;},shiftHsl:function(){if(arguments.length===1){var args=arguments[0];}else{var args=arguments;}
            var data=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var pixels=data.data;var r,g,b,a,h,s,l,hsl=[],newPixel=[];for(var i=0,len=pixels.length;i<len;i+=4){hsl=cq.rgbToHsl(pixels[i+ 0],pixels[i+ 1],pixels[i+ 2]);if(pixels[i+ 0]!==pixels[i+ 1]||pixels[i+ 1]!==pixels[i+ 2]){h=args[0]===false?hsl[0]:cq.wrapValue(hsl[0]+ args[0],0,1);s=args[1]===false?hsl[1]:cq.limitValue(hsl[1]+ args[1],0,1);}else{h=hsl[0];s=hsl[1];}
                l=args[2]===false?hsl[2]:cq.limitValue(hsl[2]+ args[2],0,1);newPixel=cq.hslToRgb(h,s,l);pixels[i+ 0]=newPixel[0];pixels[i+ 1]=newPixel[1];pixels[i+ 2]=newPixel[2];}
            this.context.putImageData(data,0,0);return this;},applyColor:function(color){if(COCOONJS)return this;this.save();this.globalCompositeOperation("source-in");this.clear(color);this.restore();return this;},negative:function(src,dst){var data=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);var pixels=data.data;var r,g,b,a,h,s,l,hsl=[],newPixel=[];for(var i=0,len=pixels.length;i<len;i+=4){pixels[i+ 0]=255- pixels[i+ 0];pixels[i+ 1]=255- pixels[i+ 1];pixels[i+ 2]=255- pixels[i+ 2];}
            this.context.putImageData(data,0,0);return this;},roundRect:function(x,y,width,height,radius){this.moveTo(x+ radius,y);this.lineTo(x+ width- radius,y);this.quadraticCurveTo(x+ width,y,x+ width,y+ radius);this.lineTo(x+ width,y+ height- radius);this.quadraticCurveTo(x+ width,y+ height,x+ width- radius,y+ height);this.lineTo(x+ radius,y+ height);this.quadraticCurveTo(x,y+ height,x,y+ height- radius);this.lineTo(x,y+ radius);this.quadraticCurveTo(x,y,x+ radius,y);this.closePath();return this;},markupText:function(text){},charWidth:function(char){if(!cq.charWidthCache)cq.charWidthCache=new Map();if(!cq.charWidthCache.has(this.context.font+ char)){var width=this.measureText(char).width;cq.charWidthCache.set(this.context.font+ char,width);}
            return cq.charWidthCache.get(this.context.font+ char);},pixelText:function(text,x,y){var prevTextAlign=this.context.textAlign;this.context.textAlign="left";var textWidth=0;if(prevTextAlign==="center"){for(var i=0;i<text.length;i++){var w=this.charWidth(text[i]);var o=w-(w|0);textWidth+=w+(o>0.5?1:0)|0;}
            x-=textWidth/2|0;}
            for(var i=0;i<text.length;i++){var c=text[i];var w=this.charWidth(c);var o=w-(w|0);this.context.fillText(c,x,y);x+=w+(o>0.5?1:0)|0;}
            this.context.textAlign=prevTextAlign;return this;},wrappedText:function(text,x,y,maxWidth,lineHeight){if(maxWidth<0)maxWidth=0;var words=text.split(" ");var lineHeight=lineHeight||this.fontHeight();var ox=0;var oy=0;var textAlign=this.context.textAlign;var textBaseline=this.context.textBaseline;this.textBaseline("top");var spaceWidth=this.context.measureText(" ").width+ 0.5|0;if(!maxWidth&&text.indexOf("\n")>-1){maxWidth=this.textBoundaries(text).width;}
            if(maxWidth){var line=0;var lines=[""];var linesWidth=[0];for(var i=0;i<words.length;i++){var word=words[i];var wordWidth=Math.ceil(this.context.measureText(word).width);if(maxWidth&&wordWidth>maxWidth){if(word.length<=5)return;var split=word.length/2|0;words.splice(i,1);words.splice(i,0,"-"+ word.substr(split));words.splice(i,0,word.substr(0,split)+"-");i--;continue;}
                if((ox+ wordWidth>maxWidth)||words[i]==="\n"){lines[line]=lines[line].substr(0,lines[line].length- 1);linesWidth[line]-=spaceWidth;lines[++line]="";linesWidth[line]=0;ox=0;}
                if(words[i]!=="\n"){lines[line]+=word+" ";ox+=wordWidth+ spaceWidth;linesWidth[line]+=wordWidth+ spaceWidth;}}
                if(words[i]!=="\n"){lines[line]=lines[line].substr(0,lines[line].length- 1);linesWidth[line]-=spaceWidth;}}else{var lines=[text];var linesWidth=[this.context.measureText(text).width+ 0.5|0];}
            for(var i=0;i<lines.length;i++){var oy=y+ i*lineHeight|0;var text=lines[i];var width=linesWidth[i];this.textAlign("left");if(textAlign==="left"||textAlign==="start")
                this.fillText(text,x,oy);else if(textAlign==="center")
                this.fillText(text,x- width*0.5|0,oy);else
                this.fillText(text,x- width,oy);}
            this.textAlign(textAlign);this.textBaseline(textBaseline);return this;},fontHeights:{},fontTops:{},fontTop:function(){if(!this.fontTops[this.context.font])this.fontHeight();return this.fontTops[this.context.font];},parseFontHeight:function(font){var match=font.match(/([0-9]+)(px|pt)/);return match[2]==="px"?(match[1]|0):(math[1]*1.33|0);},fontHeight:function(){var font=this.font();if(!this.fontHeights[font]){var fontStyleHeight=this.parseFontHeight(font);var temp=cq(100,10+ fontStyleHeight*2|0);cq.setContextSmoothing(temp.context,false);temp.font(font).fillStyle("#fff");temp.textBaseline("top");var oy=10;temp.context.fillText("Play Moog",20,oy);var data=temp.getImageData(0,0,temp.width,temp.height).data;var top=temp.height;var bottom=0;for(var i=0;i<data.length;i+=4){var x=(i/4|0)%temp.width;var y=(i/4|0)/ temp.width | 0;
            if(data[i+ 3]<200)continue;if(y<top)top=y;if(y>bottom)bottom=y;}
            this.fontHeights[font]=bottom- oy+ 1;this.fontTops[font]=top- oy;}
            return this.fontHeights[font];},textBoundaries:function(text,maxWidth){if(maxWidth<0)maxWidth=0;var words=text.split(" ");var h=this.fontHeight();var ox=0;var oy=0;var spaceWidth=this.context.measureText(" ").width+ 0.5|0;var line=0;var lines=[""];var width=0;for(var i=0;i<words.length;i++){var word=words[i];var wordWidth=Math.ceil(this.context.measureText(word).width);if(maxWidth&&(wordWidth>maxWidth)){if(word.length<=5)continue;var split=word.length/2|0;words.splice(i,1);words.splice(i,0,"-"+ word.substr(split));words.splice(i,0,word.substr(0,split)+"-");i--;continue;}
            if(((ox+ wordWidth>maxWidth)&&maxWidth)||words[i]==="\n"){if(ox>width)width=ox;lines[++line]="";ox=0;}
            if(words[i]!=="\n"){lines[line]+=word;ox+=wordWidth+ spaceWidth;}}
            if(maxWidth){var width=maxWidth;}else{if(!width){width=this.context.measureText(text).width+ 0.5|0;}}
            return{height:lines.length*h,width:Math.ceil(width),lines:lines.length,fontHeight:h}},repeatImageRegion:function(image,sx,sy,sw,sh,dx,dy,dw,dh){this.save();this.rect(dx,dy,dw,dh);this.clip();for(var x=0,len=Math.ceil(dw/sw);x<len;x++){for(var y=0,leny=Math.ceil(dh/sh);y<leny;y++){this.drawImage(image,sx,sy,sw,sh,dx+ x*sw,dy+ y*sh,sw,sh);}}
            this.restore();return this;},repeatImage:function(image,x,y,w,h){if(arguments.length<9){this.repeatImageRegion(image,0,0,image.width,image.height,x,y,w,h);}else{this.repeatImageRegion.apply(this,arguments);}
            return this;},borderImageEmptyRegion:[0,0,0,0],borderImage:function(image,x,y,w,h,t,r,b,l,fill){if(typeof t==="object"){var region=t.region;if(!region){region=this.borderImageEmptyRegion;region[2]=image.width;region[3]=image.height;}
            if(t.outset){var outset=t.outset;if(w>outset*2&&h>outset*2){if(t.fill!==false){this.drawImage(image,region[0]+ outset,region[1]+ outset,(region[2]- outset*2),(region[3]- outset*2),x+ outset,y+ outset,w- outset*2,h- outset*2);}
                this.drawImage(image,region[0],region[1]+ outset,outset,region[3]- 2*outset,x,y+ outset,outset,h- outset*2);this.drawImage(image,region[0]+ region[2]- outset,region[1]+ outset,outset,region[3]- 2*outset,x+ w- outset,y+ outset,outset,h- outset*2);this.drawImage(image,region[0]+ outset,region[1],region[2]- outset*2,outset,x+ outset,y,w- outset*2,outset);this.drawImage(image,region[0]+ outset,region[1]+ region[3]- outset,region[2]- outset*2,outset,x+ outset,y+ h- outset,w- outset*2,outset);this.drawImage(image,region[0],region[1],outset,outset,x,y,outset,outset);this.drawImage(image,region[0],region[1]+ region[3]- outset,outset,outset,x,y+ h- outset,outset,outset);this.drawImage(image,region[0]+ region[2]- outset,region[1],outset,outset,x+ w- outset,y,outset,outset);this.drawImage(image,region[0]+ region[2]- outset,region[1]+ region[3]- outset,outset,outset,x+ w- outset,y+ h- outset,outset,outset);}}
            else{var bottomLeft=t.bottomLeft||[0,0,0,0];var bottomRight=t.bottomRight||[0,0,0,0];var topLeft=t.topLeft||[0,0,0,0];var topRight=t.topRight||[0,0,0,0];var clh=bottomLeft[3]+ topLeft[3];var crh=bottomRight[3]+ topRight[3];var ctw=topLeft[2]+ topRight[2];var cbw=bottomLeft[2]+ bottomRight[2];t.fillPadding=[0,0,0,0];if(t.left)t.fillPadding[0]=t.left[2];if(t.top)t.fillPadding[1]=t.top[3];if(t.right)t.fillPadding[2]=t.right[2];if(t.bottom)t.fillPadding[3]=t.bottom[3];if(t.fill){this.drawImage(image,t.fill[0],t.fill[1],t.fill[2],t.fill[3],x+ t.fillPadding[0],y+ t.fillPadding[1],w- t.fillPadding[2]- t.fillPadding[0],h- t.fillPadding[3]- t.fillPadding[1]);}else{}
                if(t.left)this[t.left[4]==="stretch"?"drawImage":"repeatImage"](image,t.left[0],t.left[1],t.left[2],t.left[3],x,y+ topLeft[3],t.left[2],h- clh);if(t.right)this[t.right[4]==="stretch"?"drawImage":"repeatImage"](image,t.right[0],t.right[1],t.right[2],t.right[3],x+ w- t.right[2],y+ topRight[3],t.right[2],h- crh);if(t.top)this[t.top[4]==="stretch"?"drawImage":"repeatImage"](image,t.top[0],t.top[1],t.top[2],t.top[3],x+ topLeft[2],y,w- ctw,t.top[3]);if(t.bottom)this[t.bottom[4]==="stretch"?"drawImage":"repeatImage"](image,t.bottom[0],t.bottom[1],t.bottom[2],t.bottom[3],x+ bottomLeft[2],y+ h- t.bottom[3],w- cbw,t.bottom[3]);if(t.bottomLeft)this.drawImage(image,t.bottomLeft[0],t.bottomLeft[1],t.bottomLeft[2],t.bottomLeft[3],x,y+ h- t.bottomLeft[3],t.bottomLeft[2],t.bottomLeft[3]);if(t.topLeft)this.drawImage(image,t.topLeft[0],t.topLeft[1],t.topLeft[2],t.topLeft[3],x,y,t.topLeft[2],t.topLeft[3]);if(t.topRight)this.drawImage(image,t.topRight[0],t.topRight[1],t.topRight[2],t.topRight[3],x+ w- t.topRight[2],y,t.topRight[2],t.topRight[3]);if(t.bottomRight)this.drawImage(image,t.bottomRight[0],t.bottomRight[1],t.bottomRight[2],t.bottomRight[3],x+ w- t.bottomRight[2],y+ h- t.bottomRight[3],t.bottomRight[2],t.bottomRight[3]);}}else{if(t>0&&w- l- r>0)this.drawImage(image,l,0,image.width- l- r,t,x+ l,y,w- l- r,t);if(b>0&&w- l- r>0)this.drawImage(image,l,image.height- b,image.width- l- r,b,x+ l,y+ h- b,w- l- r,b);if(l>0&&h- b- t>0)this.drawImage(image,0,t,l,image.height- b- t,x,y+ t,l,h- b- t);if(r>0&&h- b- t>0)this.drawImage(image,image.width- r,t,r,image.height- b- t,x+ w- r,y+ t,r,h- b- t);if(l>0&&t>0)this.drawImage(image,0,0,l,t,x,y,l,t);if(r>0&&t>0)this.drawImage(image,image.width- r,0,r,t,x+ w- r,y,r,t);if(r>0&&b>0)this.drawImage(image,image.width- r,image.height- b,r,b,x+ w- r,y+ h- b,r,b);if(l>0&&b>0)this.drawImage(image,0,image.height- b,l,b,x,y+ h- b,l,b);if(fill){if(typeof fill==="string"){this.fillStyle(fill).fillRect(x+ l,y+ t,w- l- r,h- t- b);}else{if(w- l- r>0&&h- t- b>0)
            this.drawImage(image,l,t,image.width- r- l,image.height- b- t,x+ l,y+ t,w- l- r,h- t- b);}}}},setPixel:function(color,x,y){return this.fillStyle(color).fillRect(x,y,1,1);color=cq.color(color);var pixel=this.createImageData(1,1);pixel.data[0]=color[0];pixel.data[1]=color[1];pixel.data[2]=color[2];pixel.data[3]=255;this.putImageData(pixel,x,y);return this;},getPixel:function(x,y){var pixel=this.context.getImageData(x,y,1,1).data;return cq.color([pixel[0],pixel[1],pixel[2],pixel[3]]);},clearRect:function(x,y,w,h){this.context.clearRect(x,y,w,h);return this;},fill:function(){this.context.fill();return this;},stroke:function(){this.context.stroke();return this;},createImageData:function(width,height){if(false&&this.context.createImageData){return this.context.createImageData.apply(this.context,arguments);}else{if(!this.emptyCanvas){this.emptyCanvas=cq.createCanvas(width,height);this.emptyCanvasContext=this.emptyCanvas.getContext("2d");}
            this.emptyCanvas.width=width;this.emptyCanvas.height=height;return this.emptyCanvasContext.getImageData(0,0,width,height);}},strokeLine:function(x1,y1,x2,y2){this.beginPath();if(typeof x2==="undefined"){this.moveTo(x1.x,x1.y);this.lineTo(y1.x,y1.y);}else{this.moveTo(x1,y1);this.lineTo(x2,y2);}
            this.stroke();return this;},shadowOffset:function(x,y){this.context.shadowOffsetX=x;this.context.shadowOffsetY=y;return this;},noLineDash:[],tempLineDash:[2,2],setLineDash:function(dash){if(typeof dash==="number"){this.tempLineDash[0]=dash;this.tempLineDash[1]=dash;dash=this.tempLineDash;}
            this.context.setLineDash(dash?dash:this.noLineDash);return this;},measureText:function(text){return this.context.measureText(text);},getLineDash:function(){return this.context.getLineDash();},createRadialGradient:function(x0,y0,r0,x1,y1,r1){return this.context.createRadialGradient(x0,y0,r0,x1,y1,r1);},createLinearGradient:function(x0,y0,x1,y1){return this.context.createLinearGradient(x0,y0,x1,y1);},createPattern:function(image,repeat){return this.context.createPattern(image,repeat);},getImageData:function(sx,sy,sw,sh){return this.context.getImageData(sx,sy,sw,sh);},writeMeta:function(data){var json=JSON.stringify(data);json=encodeURIComponent(json);var bytes=[];for(var i=0;i<json.length;i++){bytes.push(json.charCodeAt(i));}
            bytes.push(127);var x=this.width- 1;var y=this.height- 1;var pixel=[];while(bytes.length){var byte=bytes.shift();pixel.unshift(byte*2);if(!bytes.length)
                for(var i=0;i<3- pixel.length;i++)pixel.unshift(254);if(pixel.length===3){this.fillStyle(cq.color(pixel).toRgb()).fillRect(x,y,1,1);pixel=[];x--;if(x<0){y--;x=this.width- 1;}}}
            return this;},strokeStyle:function(style){if(style==null){return this.context.strokeStyle;}else{this.context.strokeStyle=style;return this;}},fillStyle:function(style){if(style==null){return this.context.fillStyle;}else{this.context.fillStyle=style;return this;}},font:function(font){if(font==null){return this.context.font;}else{this.context.font=font;return this;}},filter:function(filter){if(filter){this.context.filter=filter;return this;}else{return this.context.filter;}
            return this;},readMeta:function(){var bytes=[];var x=this.width- 1;var y=this.height- 1;while(true){var pixel=this.getPixel(x,y);var stop=false;for(var i=0;i<3;i++){if(pixel[2- i]===254)stop=true;else bytes.push(pixel[2- i]/2|0);}
            if(stop)break;x--;if(x<0){y--;x=this.width- 1;break;}}
            var json="";while(bytes.length){json+=String.fromCharCode(bytes.shift());}
            var data=false;console.log(json);try{data=JSON.parse(decodeURIComponent(json));}catch(e){}
            return data;},get width(){return this.canvas.width;},get height(){return this.canvas.height;},set width(w){this.canvas.width=w;this.update();return this.canvas.width;},set height(h){this.canvas.height=h;this.update();return this.canvas.height;}};var methods=["arc","arcTo","beginPath","bezierCurveTo","clip","closePath","createLinearGradient","createRadialGradient","createPattern","drawFocusRing","drawImage","fill","fillRect","fillText","getImageData","isPointInPath","lineTo","measureText","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","scale","setTransform","strokeRect","strokeText","transform","translate","setLineDash"];for(var i=0;i<methods.length;i++){var name=methods[i];if(cq.Layer.prototype[name])continue;cq.Layer.prototype[name]=(function(method){return function(){var args=new Array(arguments.length);for(var i=0;i<args.length;++i){args[i]=arguments[i];}
        cq.fastApply(method,this.context,args);return this;}})(CanvasRenderingContext2D.prototype[name]);continue;if(!this.debug){var self=this;(function(name){cq.Layer.prototype[name]=function(){cq.fastApply(this.context[name],this.context,arguments);return this;}})(name);}else{var self=this;(function(name){cq.Layer.prototype[name]=function(){try{this.context[name].apply(this.context,arguments);return this;}catch(e){var err=new Error();console.log(err.stack);throw(e+ err.stack);console.log(e,name,arguments);}}})(name);}};var properties=["globalAlpha","globalCompositeOperation","lineCap","lineJoin","lineWidth","miterLimit","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","textAlign","textBaseline","lineDashOffset"];for(var i=0;i<properties.length;i++){var name=properties[i];if(!cq.Layer.prototype[name])cq.Layer.prototype[name]=Function("if(arguments.length) { this.context."+ name+" = arguments[0]; return this; } else { return this.context."+ name+"; }");};cq.Color=function(data,type){if(arguments.length)this.parse(data,type);}
    cq.Color.prototype={toString:function(){return this.toRgb();},parse:function(args,type){if(args[0]instanceof cq.Color){this[0]=args[0][0];this[1]=args[0][1];this[2]=args[0][2];this[3]=args[0][3];return;}
            if(typeof args==="string"){var match=null;if(args[0]==="#"){var rgb=cq.hexToRgb(args);this[0]=rgb[0];this[1]=rgb[1];this[2]=rgb[2];this[3]=1.0;}else if(match=args.match(/rgb\((.*),(.*),(.*)\)/)){this[0]=match[1]|0;this[1]=match[2]|0;this[2]=match[3]|0;this[3]=1.0;}else if(match=args.match(/rgba\((.*),(.*),(.*)\)/)){this[0]=match[1]|0;this[1]=match[2]|0;this[2]=match[3]|0;this[3]=match[4]|0;}else if(match=args.match(/hsl\((.*),(.*),(.*)\)/)){this.fromHsl(match[1],match[2],match[3]);}else if(match=args.match(/hsv\((.*),(.*),(.*)\)/)){this.fromHsv(match[1],match[2],match[3]);}}else{switch(type){case"hsl":case"hsla":this.fromHsl(args[0],args[1],args[2],args[3]);break;case"hsv":case"hsva":this.fromHsv(args[0],args[1],args[2],args[3]);break;default:this[0]=args[0];this[1]=args[1];this[2]=args[2];this[3]=typeof args[3]==="undefined"?1.0:args[3];break;}}},a:function(a){if(arguments.length===1){this[3]=a;}else{return this[3];}
            return this;},alpha:function(a){if(arguments.length===1){this[3]=a;}else{return this[3];}
            return this;},fromHsl:function(){var components=arguments[0]instanceof Array?arguments[0]:arguments;var color=cq.hslToRgb(parseFloat(components[0]),parseFloat(components[1]),parseFloat(components[2]));this[0]=color[0];this[1]=color[1];this[2]=color[2];this[3]=typeof arguments[3]==="undefined"?1.0:arguments[3];},fromHsv:function(){var components=arguments[0]instanceof Array?arguments[0]:arguments;var color=cq.hsvToRgb(parseFloat(components[0]),parseFloat(components[1]),parseFloat(components[2]));this[0]=color[0];this[1]=color[1];this[2]=color[2];this[3]=typeof arguments[3]==="undefined"?1.0:arguments[3];},toArray:function(){return[this[0],this[1],this[2],this[3]];},toRgb:function(){return"rgb("+ this[0]+", "+ this[1]+", "+ this[2]+")";},toRgba:function(){return"rgba("+ this[0]+", "+ this[1]+", "+ this[2]+", "+ this[3]+")";},toHex:function(){return cq.rgbToHex(this[0],this[1],this[2]);},toHsl:function(){var c=cq.rgbToHsl(this[0],this[1],this[2]);c[3]=this[3];return c;},toHsv:function(){var c=cq.rgbToHsv(this[0],this[1],this[2]);c[3]=this[3];return c;},gradient:function(target,steps){var targetColor=cq.color(target);},shiftHsl:function(){var hsl=this.toHsl();if(this[0]!==this[1]||this[1]!==this[2]){var h=arguments[0]===false?hsl[0]:cq.wrapValue(hsl[0]+ arguments[0],0,1);var s=arguments[1]===false?hsl[1]:cq.limitValue(hsl[1]+ arguments[1],0,1);}else{var h=hsl[0];var s=hsl[1];}
            var l=arguments[2]===false?hsl[2]:cq.limitValue(hsl[2]+ arguments[2],0,1);this.fromHsl(h,s,l);return this;},setHsl:function(){var hsl=this.toHsl();var h=arguments[0]===false?hsl[0]:cq.limitValue(arguments[0],0,1);var s=arguments[1]===false?hsl[1]:cq.limitValue(arguments[1],0,1);var l=arguments[2]===false?hsl[2]:cq.limitValue(arguments[2],0,1);this.fromHsl(h,s,l);return this;},mix:function(color,amount){color=cq.color(color);for(var i=0;i<4;i++){this[i]=cq.mix(this[i],color[i],amount);}
            return this;}};cq.images={};cq.loadImages=function(){var promises=[];for(var i=0;i<arguments.length;i++){var current=arguments[i];var keys;keys=current;for(var key in keys){cq.loaderscount++;var path=keys[key];var image=new orgImage();cq.images[key]=image;cq.loaderscount++;var promise=new Promise(function(resolve,reject){image.addEventListener("load",function(){resolve();});image.addEventListener("error",function(){throw("unable to load "+ this.src);});});image.src=path;}
        promises.push(promise);}
        return Promise.all(promises);};cq.fn=cq.Layer.prototype;window["cq"]=window["CanvasQuery"]=cq;return cq;})();(function(){var ease=function(progress,easing){if(typeof ease.cache[easing]==="function"){return ease.cache[easing](progress);}else{return ease.spline(progress,easing||ease.defaultEasing);}};var extend=function(){for(var i=1;i<arguments.length;i++){for(var j in arguments[i]){arguments[0][j]=arguments[i][j];}}
    return arguments[0];};extend(ease,{defaultEasing:"016",cache:{linear:function(t){return t},inQuad:function(t){return t*t},outQuad:function(t){return t*(2- t)},inOutQuad:function(t){return t<.5?2*t*t:-1+(4- 2*t)*t},inCubic:function(t){return t*t*t},outCubic:function(t){return(--t)*t*t+ 1},inOutCubic:function(t){return t<.5?4*t*t*t:(t- 1)*(2*t- 2)*(2*t- 2)+ 1},inQuart:function(t){return t*t*t*t},outQuart:function(t){return 1-(--t)*t*t*t},inOutQuart:function(t){return t<.5?8*t*t*t*t:1- 8*(--t)*t*t*t},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return 1+(--t)*t*t*t*t},inOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+ 16*(--t)*t*t*t*t},inSine:function(t){return-1*Math.cos(t/1*(Math.PI*0.5))+ 1;},outSine:function(t){return Math.sin(t/1*(Math.PI*0.5));},inOutSine:function(t){return-1/2*(Math.cos(Math.PI*t)- 1);},inExpo:function(t){return(t==0)?0:Math.pow(2,10*(t- 1));},outExpo:function(t){return(t==1)?1:(-Math.pow(2,-10*t)+ 1);},inOutExpo:function(t){if(t==0)return 0;if(t==1)return 1;if((t/=1/2)<1)return 1/2*Math.pow(2,10*(t- 1));return 1/2*(-Math.pow(2,-10*--t)+ 2);},inCirc:function(t){return-1*(Math.sqrt(1- t*t)- 1);},outCirc:function(t){return Math.sqrt(1-(t=t- 1)*t);},inOutCirc:function(t){if((t/=1/2)<1)return-1/2*(Math.sqrt(1- t*t)- 1);return 1/2*(Math.sqrt(1-(t-=2)*t)+ 1);},inElastic:function(t){var s=1.70158;var p=0;var a=1;if(t==0)return 0;if(t==1)return 1;if(!p)p=0.3;if(a<1){a=1;var s=p/4;}else var s=p/(2*Math.PI)*Math.asin(1/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t- s)*(2*Math.PI)/ p));
        },outElastic:function(t){var s=1.70158;var p=0;var a=1;if(t==0)return 0;if(t==1)return 1;if(!p)p=0.3;if(a<1){a=1;var s=p/4;}else var s=p/(2*Math.PI)*Math.asin(1/a);return a*Math.pow(2,-10*t)*Math.sin((t- s)*(2*Math.PI)/ p) + 1;
        },inOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t==0)return 0;if((t/=1/2)==2)return 1;if(!p)p=(0.3*1.5);if(a<1){a=1;var s=p/4;}else var s=p/(2*Math.PI)*Math.asin(1/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t- s)*(2*Math.PI)/ p));
            return a*Math.pow(2,-10*(t-=1))*Math.sin((t- s)*(2*Math.PI)/ p) * 0.5 + 1;
        },inBack:function(t,s){if(s==undefined)s=1.70158;return 1*t*t*((s+ 1)*t- s);},outBack:function(t,s){if(s==undefined)s=1.70158;return 1*((t=t/1- 1)*t*((s+ 1)*t+ s)+ 1);},inOutBack:function(t,s){if(s==undefined)s=1.70158;if((t/=1/2)<1)return 1/2*(t*t*(((s*=(1.525))+ 1)*t- s));return 1/2*((t-=2)*t*(((s*=(1.525))+ 1)*t+ s)+ 2);},inBounce:function(t){return 1- this.outBounce(1- t);},outBounce:function(t){if((t/=1)<(1/2.75)){return(7.5625*t*t);}else if(t<(2/2.75)){return(7.5625*(t-=(1.5/2.75))*t+.75);}else if(t<(2.5/2.75)){return(7.5625*(t-=(2.25/2.75))*t+.9375);}else{return(7.5625*(t-=(2.625/2.75))*t+.984375);}},inOutBounce:function(t){if(t<1/2)return this.inBounce(t*2)*0.5;return this.outBounce(t*2- 1)*0.5+ 0.5;}},translateEasing:function(key){if(!this.cache[key]){var array=key.split('');var sign=1;var signed=false;var trimming=false;for(var i=0;i<array.length;i++){var char=array[i];if(char==="-"){sign=-1;signed=true;array.splice(i--,1);}else if(char==="+"){sign=1;array.splice(i--,1);}else if(char==="t"){trimming=!trimming;array.splice(i--,1);}else array[i]=parseInt(array[i],16)*sign;}
        var min=Math.min.apply(null,array);var max=Math.max.apply(null,array);var diff=max- min;var cache=[];var normalized=[];for(var i=0;i<array.length;i++){if(signed){var diff=Math.max(Math.abs(min),Math.abs(max))
            var value=array[i]/diff;}else{var diff=max- min;var value=(array[i]- min)/ diff;
        }
            if(trimming){if(value<0)value=0;if(value>1.0)value=1.0;}
            normalized.push(value);}
        this.cache[key]=normalized;}
        return this.cache[key]},splineK:{},splineX:{},splineY:{},insertIntermediateValues:function(a){var result=[];for(var i=0;i<a.length;i++){result.push(a[i]);if(i<a.length- 1)result.push(a[i+ 1]+(a[i]- a[i+ 1])*0.6);}
        return result;},spline:function(x,key){if(!this.splineK[key]){var xs=[];var ys=this.translateEasing(key);if(!ys.length)return 0;for(var i=0;i<ys.length;i++)xs.push(i*(1/(ys.length- 1)));var ks=xs.map(function(){return 0});ks=this.getNaturalKs(xs,ys,ks);this.splineX[key]=xs;this.splineY[key]=ys;this.splineK[key]=ks;}
        if(x>1)return this.splineY[key][this.splineY[key].length- 1];var ks=this.splineK[key];var xs=this.splineX[key];var ys=this.splineY[key];var i=1;while(xs[i]<x)i++;var t=(x- xs[i- 1])/ (xs[i] - xs[i - 1]);
        var a=ks[i- 1]*(xs[i]- xs[i- 1])-(ys[i]- ys[i- 1]);var b=-ks[i]*(xs[i]- xs[i- 1])+(ys[i]- ys[i- 1]);var q=(1- t)*ys[i- 1]+ t*ys[i]+ t*(1- t)*(a*(1- t)+ b*t);return q;},getNaturalKs:function(xs,ys,ks){var n=xs.length- 1;var A=this.zerosMat(n+ 1,n+ 2);for(var i=1;i<n;i++)
    {A[i][i- 1]=1/(xs[i]- xs[i- 1]);A[i][i]=2*(1/(xs[i]- xs[i- 1])+ 1/(xs[i+ 1]- xs[i]));A[i][i+ 1]=1/(xs[i+ 1]- xs[i]);A[i][n+ 1]=3*((ys[i]- ys[i- 1])/ ((xs[i] - xs[i - 1]) * (xs[i] - xs[i - 1])) + (ys[i + 1] - ys[i]) / ((xs[i + 1] - xs[i]) * (xs[i + 1] - xs[i])));
    }
        A[0][0]=2/(xs[1]- xs[0]);A[0][1]=1/(xs[1]- xs[0]);A[0][n+ 1]=3*(ys[1]- ys[0])/ ((xs[1] - xs[0]) * (xs[1] - xs[0]));
        A[n][n- 1]=1/(xs[n]- xs[n- 1]);A[n][n]=2/(xs[n]- xs[n- 1]);A[n][n+ 1]=3*(ys[n]- ys[n- 1])/ ((xs[n] - xs[n - 1]) * (xs[n] - xs[n - 1]));
        return this.solve(A,ks);},solve:function(A,ks){var m=A.length;for(var k=0;k<m;k++)
    {var i_max=0;var vali=Number.NEGATIVE_INFINITY;for(var i=k;i<m;i++)
        if(A[i][k]>vali){i_max=i;vali=A[i][k];}
        this.splineSwapRows(A,k,i_max);for(var i=k+ 1;i<m;i++){for(var j=k+ 1;j<m+ 1;j++)
        A[i][j]=A[i][j]- A[k][j]*(A[i][k]/A[k][k]);A[i][k]=0;}}
        for(var i=m- 1;i>=0;i--)
        {var v=A[i][m]/A[i][i];ks[i]=v;for(var j=i- 1;j>=0;j--)
        {A[j][m]-=A[j][i]*v;A[j][i]=0;}}
        return ks;},zerosMat:function(r,c){var A=[];for(var i=0;i<r;i++){A.push([]);for(var j=0;j<c;j++)A[i].push(0);}
        return A;},splineSwapRows:function(m,k,l){var p=m[k];m[k]=m[l];m[l]=p;}});window.ease=ease;})();window.PLAYGROUND={};PLAYGROUND.MOBILE=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);function playground(args){return new PLAYGROUND.Application(args);};PLAYGROUND.data={};PLAYGROUND.images={};PLAYGROUND.atlases={};PLAYGROUND.Utils={extend:function(){for(var i=1;i<arguments.length;i++){for(var j in arguments[i]){arguments[0][j]=arguments[i][j];}}
        return arguments[0];},defaults:function(){for(var i=1;i<arguments.length;i++){for(var j in arguments[i]){if(typeof arguments[0][j]==="undefined")arguments[0][j]=arguments[i][j];}}
        return arguments[0];},merge:function(a){for(var i=1;i<arguments.length;i++){var b=arguments[i];for(var key in b){var value=b[key];if(typeof a[key]!=="undefined"){if(typeof a[key]==="object")this.merge(a[key],value);else a[key]=value;}else{a[key]=value;}}}
        return a;},invoke:function(object,methodName){var args=Array.prototype.slice.call(arguments,2);for(var i=0;i<object.length;i++){var current=object[i];if(current[methodName])current[methodName].apply(current,args);}},throttle:function(fn,delay){var timeout;var last=0;return function(){var args=[];for(var i=0;i<arguments.length;i++)args.push(arguments[i]);var context=this;if(Date.now()- last>delay){last=Date.now();fn.apply(context,args);clearTimeout(timeout);}else{clearTimeout(timeout);timeout=setTimeout(function(){fn.apply(context,args);last=Date.now();},Date.now()- last);}};},wrapTo:function(value,target,max,step){if(value===target)return target;var result=value;var d=this.wrappedDistance(value,target,max);if(Math.abs(d)<step)return target;result+=(d<0?-1:1)*step;if(result>max){result=result- max;}else if(result<0){result=max+ result;}
        return result;},wrap:function(value,min,max){if(value<min)return max+(value%max);if(value>=max)return value%max;return value;},circWrap:function(val){return this.wrap(val,0,Math.PI*2);},circWrapTo:function(value,target,step){return this.wrapTo(value,target,Math.PI*2,step);},wrappedDistance:function(a,b,max){if(a===b)return 0;else if(a<b){var l=-a- max+ b;var r=b- a;}else{var l=b- a;var r=max- a+ b;}
        if(Math.abs(l)>Math.abs(r))return r;else return l;},circWrappedDistance:function(a,b){return this.wrappedDistance(a,b,Math.PI*2)},ground:function(num,threshold){return(num/threshold|0)*threshold;},circDistance:function(a,b){return this.circWrappedDistance(a,b)},distance:function(x1,y1,x2,y2){if(arguments.length>2){var dx=x1- x2;var dy=y1- y2;return Math.sqrt(dx*dx+ dy*dy);}else{var dx=x1.x- y1.x;var dy=x1.y- y1.y;return Math.sqrt(dx*dx+ dy*dy);}},sprintf:function(string,replace){for(var key in replace){var find=new RegExp("{"+ key+"}","g");string=string.replace(find,replace[key]);}
        return string;},classInParents:function(element,className){var parent=element;while(parent){if(parent.classList.contains(className)){return true;}
        parent=parent.parentElement;}
        return false;}};PLAYGROUND.Utils.ease=ease;PLAYGROUND.Events=function(){this.listeners={};};PLAYGROUND.Events.prototype={on:function(event,callback,context){if(typeof event==="object"){var result={};for(var key in event){result[key]=this.on(key,event[key],context)}
        return result;}
        if(!this.listeners[event])this.listeners[event]=[];var listener={once:false,callback:callback,context:context};this.listeners[event].push(listener);return listener;},once:function(event,callback,context){if(typeof event==="object"){var result={};for(var key in event){result[key]=this.once(key,event[key],context)}
        return result;}
        if(!this.listeners[event])this.listeners[event]=[];var listener={once:true,callback:callback,context:context};this.listeners[event].push(listener);return listener;},off:function(event,callback){for(var i=0,len=this.listeners[event].length;i<len;i++){if(this.listeners[event][i]===callback){this.listeners[event].splice(i--,1);len--;}}},trigger:function(event,data){if(this.listeners["event"]){for(var i=0,len=this.listeners["event"].length;i<len;i++){var listener=this.listeners["event"][i];listener.callback.call(listener.context||this,event,data);}}
        if(this.listeners[event]){for(var i=0,len=this.listeners[event].length;i<len;i++){var listener=this.listeners[event][i];listener.callback.call(listener.context||this,data);if(listener.once){this.listeners[event].splice(i--,1);len--;}}}}};PLAYGROUND.States=function(app){this.app=app;PLAYGROUND.Events.call(this);app.on("step",this.step.bind(this));};PLAYGROUND.States.prototype={step:function(delta){if(!this.next)return;if(this.current&&this.current.locked)return;var state=this.next;if(typeof state==="function")state=new state;if(!state.__created){state.__created=true;state.app=this.app;this.trigger("createstate",{state:state});if(state.create)state.create();}
        if(this.current){this.trigger("leavestate",{prev:this.current,next:state,state:this.current});}
        this.trigger("enterstate",{prev:this.current,next:state,state:state});this.current=state;if(this.current&&this.current.enter){this.current.enter();}
        this.app.state=this.current;this.next=false;},set:function(state){if(this.current&&this.current.leave)this.current.leave();this.next=state;this.step(0);}};PLAYGROUND.Utils.extend(PLAYGROUND.States.prototype,PLAYGROUND.Events.prototype);PLAYGROUND.Application=function(args){var app=this;this.killed=false;this.dataSource={};PLAYGROUND.Events.call(this);PLAYGROUND.Utils.merge(this,this.defaults,args);this.autoWidth=this.width?false:true;this.autoHeight=this.height?false:true;this.autoScale=this.scale?false:true;if(!this.container)this.container=document.body;if(this.container!==document.body)this.customContainer=true;if(typeof this.container==="string")this.container=document.querySelector(this.container);if(args.background!==false)this.container.style.background=this.background;this.updateSize();this.states=new PLAYGROUND.States(this);this.states.on("event",this.emitLocalEvent,this);this.mouse=new PLAYGROUND.Mouse(this,this.container);this.mouse.on("event",this.emitGlobalEvent,this);this.touch=new PLAYGROUND.Touch(this,this.container);this.touch.on("event",this.emitGlobalEvent,this);this.keyboard=new PLAYGROUND.Keyboard(this);this.keyboard.on("event",this.emitGlobalEvent,this);this.gamepads=new PLAYGROUND.Gamepads(this);this.gamepads.on("event",this.emitGlobalEvent,this);this.tweens=new PLAYGROUND.TweenManager(this);this.ease=PLAYGROUND.Utils.ease;window.addEventListener("storage",this.handleLocalStorage.bind(this));PLAYGROUND.Sound(this);document.addEventListener("visibilitychange",function(){app.handleVisibilityChange(document.hidden);});window.addEventListener("blur",this.handleBlur.bind(this));window.addEventListener("focus",this.handleFocus.bind(this));this.resizelistener=PLAYGROUND.Utils.throttle(this.handleResize.bind(this),100);window.addEventListener("resize",this.resizelistener);this.images=PLAYGROUND.images;this.atlases=PLAYGROUND.atlases;this.data=PLAYGROUND.data;this.loader=new PLAYGROUND.Loader(this);this.loadFoo(0.25);this.plugins=[];for(var key in PLAYGROUND){var property=PLAYGROUND[key];if(property.plugin)this.plugins.push(new property(this));}
    this.emitLocalEvent("preload");this.firstBatch=true;if(this.disabledUntilLoaded)this.skipEvents=true;function onPreloadEnd(){app.loadFoo(0.25);setTimeout(function(){app.emitLocalEvent("create");app.setState(PLAYGROUND.DefaultState);app.handleResize();if(PLAYGROUND.LoadingScreen)app.setState(PLAYGROUND.LoadingScreen);PLAYGROUND.GameLoop(app);app.loader.once("ready",function(){app.firstBatch=false;if(app.disabledUntilLoaded)app.skipEvents=false;app.setState(PLAYGROUND.DefaultState);app.emitLocalEvent("ready");app.handleResize();});});};this.loader.once("ready",onPreloadEnd);};PLAYGROUND.Application.prototype={defaults:{background:"#272822",smoothing:1,paths:{base:"",images:"images/",fonts:"fonts/",rewrite:{},rewriteURL:{}},offsetX:0,offsetY:0,skipEvents:false,disabledUntilLoaded:true,mouseThrottling:15},setState:function(state){this.states.set(state);},insertAsset:function(asset,collection,path){var pathArray=path.split("/");var current=collection;for(var i=0;i<pathArray.length- 1;i++){var segment=pathArray[i];if(!current[segment])current[segment]={};current=current[segment];}
        current[pathArray.pop()]=asset;collection[path]=asset;},getPath:function(to){return this.paths.base+(this.paths[to]||(to+"/"));},rewriteURL:function(url){return this.paths.rewriteURL[url]||url;},getAssetEntry:function(path,folder,defaultExtension){var key;var url;var absolute=false;if(path[0]==="<"){absolute=true;var abslimit=path.indexOf(">");url=path.substr(1,abslimit- 1);key=path.substr(abslimit+ 1).trim();path=url;url=this.rewriteURL(url);}
        var folder=this.paths[folder]||(folder+"/");var fileinfo=path.match(/(.*)\..*/);if(!key)key=fileinfo?fileinfo[1]:path;var temp=path.split(".");var basename=path;if(temp.length>1){var ext=temp.pop();path=temp.join(".");}else{var ext=defaultExtension;basename+="."+ defaultExtension;}
        if(!url)url=this.rewriteURL(this.paths.base+ folder+ basename);return{key:key,url:url,path:this.paths.base+ folder+ path,ext:ext};},emitLocalEvent:function(event,data){this.trigger(event,data);if((event!=="render"||!this.skipEvents||this.loader.ready)&&this[event])this[event](data);},emitGlobalEvent:function(event,data){if(!this.state)return this.emitLocalEvent(event,data);this.trigger(event,data);if((event!=="render"||!this.skipEvents||this.loader.ready)&&this.event)this.event(event,data);if((event!=="render"||!this.skipEvents||this.loader.ready)&&this[event])this[event](data);if(this.state.event)this.state.event(event,data);if(this.state[event])this.state[event](data);this.trigger("after"+ event,data);},updateSize:function(){if(this.customContainer){var containerWidth=this.container.offsetWidth;var containerHeight=this.container.offsetHeight;}else{var containerWidth=window.innerWidth;var containerHeight=window.innerHeight;}
        if(!this.autoScale&&!this.autoWidth&&!this.autoHeight){}else if(!this.autoHeight&&this.autoWidth){if(this.autoScale)this.scale=containerHeight/this.height;this.width=Math.ceil(containerWidth/this.scale);}else if(!this.autoWidth&&this.autoHeight){if(this.autoScale)this.scale=containerWidth/this.width;this.height=Math.ceil(containerHeight/this.scale);}else if(this.autoWidth&&this.autoHeight&&this.autoScale){this.scale=1;this.width=containerWidth;this.height=containerHeight;}else if(this.autoWidth&&this.autoHeight){this.width=Math.ceil(containerWidth/this.scale);this.height=Math.ceil(containerHeight/this.scale);}else{this.scale=Math.min(containerWidth/this.width,containerHeight/this.height);}
        this.offsetX=(containerWidth- this.width*this.scale)/ 2 | 0;
        this.offsetY=(containerHeight- this.height*this.scale)/ 2 | 0;
        this.center={x:this.width/2|0,y:this.height/2|0};},handleLocalStorage(e){this.emitGlobalEvent("localstorage",e);},handleVisibilityChange:function(e){this.emitGlobalEvent("visibilitychange",{visible:!e.hidden,hidden:e.hidden});},handleBlur:function(e){this.emitGlobalEvent("blur",{});},handleFocus:function(e){this.emitGlobalEvent("focus",{});},handleResize:function(){this.updateSize();this.emitGlobalEvent("beforeresize",{});this.mouse.handleResize();this.touch.handleResize();this.emitGlobalEvent("resize",{});},request:function(url){var app=this;function promise(resolve,reject){var baseurl=url.split("?")[0];if(app.dataSource[baseurl]){return resolve({responseText:app.dataSource[baseurl]});}
        var request=new XMLHttpRequest();request.open("GET",url,true);request.onload=function(event){var xhr=event.target;if(xhr.status!==200&&xhr.status!==0){return reject(new Error("Failed to get "+ url));}
            resolve(xhr);}
        request.send();}
        return new Promise(promise);},loadFoo:function(timeout){var loader=this.loader;this.loader.add("foo "+ timeout);setTimeout(function(){loader.success("foo "+ timeout);},timeout*1000);},loadData:function(){for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(typeof arg==="object"){for(var key in arg)this.loadData(arg[key]);}else{this.loadDataItem(arg);}}},loadDataItem:function(name){var entry=this.getAssetEntry(name,"data","json");var app=this;this.loader.add();this.request(entry.url+(this.purgeCache?("?"+ Date.now()):"")).then(processData);function processData(request){if(entry.ext==="json"){try{var data=JSON.parse(request.responseText);}catch(e){console.error("JSON file corrupt "+ name);return;}
        app.insertAsset(data,app.data,entry.key);}else{app.insertAsset(request.responseText,app.data,entry.key);}
        app.loader.success(entry.url);}},loadImage:function(){return this.loadImages.apply(this,arguments);},loadImages:function(){var promises=[];for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(typeof arg==="object"){for(var key in arg)promises=promises.concat(this.loadImages(arg[key]));}else{promises.push(this.loadOneImage(arg));}}
        return Promise.all(promises);},loadOneImage:function(name){var app=this;if(!this._imageLoaders)this._imageLoaders={};if(!this._imageLoaders[name]){var promise=function(resolve,reject){var loader=app.loader;var entry=app.getAssetEntry(name,"images","png");app.loader.add(entry.url);var image=new Image;image.addEventListener("load",function(){app.images[entry.key]=image;resolve(image);loader.success(entry.url);entry.image=image;app.insertAsset(image,app.images,entry.key);app.emitLocalEvent("imageready",entry);});image.addEventListener("error",function(){reject("can't load "+ entry.url);loader.error(entry.url);});image.src=entry.url;};app._imageLoaders[name]=new Promise(promise);}
        return this._imageLoaders[name];},loadFont:function(){var promises=[];for(var i=0;i<arguments.length;i++){var arg=arguments[i];promises.push(this.loadFontItem(arg));}
        return Promise.all(promises);},loadFonts:function(){return this.loadFont.apply(this,arguments);},loadFontItem:function(name){if(!this.fontStyleSheet){var style=document.createElement("style");document.head.appendChild(style);this.fontStyleSheet=style;}
        var entry=this.getAssetEntry(name,"fonts","ttf");var format={woff:"woff",otf:"opentype",ttf:"truetype"}[entry.ext];var raw="@font-face { font-family: '{name}'; font-style: 'normal'; font-weight: 400, 800; src: url(fonts/{name}.{ext}) format('{format}'); }";var rule=PLAYGROUND.Utils.sprintf(raw,{name:name,ext:entry.ext,format:format});this.fontStyleSheet.innerHTML+=rule;var app=this;if(!this._fontPromises)this._fontPromises={};if(!this._fontPromises[name]){var promise=function(resolve,reject){app.loader.add("font "+ name);var checkingTimer=setInterval(function(){var base=cq(100,32).font("14px somethingrandom").fillStyle("#fff").textBaseline("top");base.context.fillText("lorem ipsum dolores sit",0,4);var test=cq(100,32).font("14px '"+ name+"'").fillStyle("#fff").textBaseline("top");test.context.fillText("lorem ipsum dolores sit",0,4);if(!cq.compare(base,test)){app.loader.success("font"+ name);clearInterval(checkingTimer);resolve();}},100);}
            this._fontPromises[name]=new Promise(promise);}
        return this._fontPromises[name];},render:function(){},enableInputs:function(){this.mouse.enabled=true;this.touch.enabled=true;this.keyboard.enabled=true;},disableInputs:function(){this.mouse.enabled=false;this.touch.enabled=false;this.keyboard.enabled=false;},kill:function(){this.killed=true;this.trigger("kill");window.removeEventListener("resize",this.resizelistener);}};PLAYGROUND.Utils.extend(PLAYGROUND.Application.prototype,PLAYGROUND.Events.prototype);PLAYGROUND.GameLoop=function(app){app.lifetime=0;app.ops=0;app.opcost=0;var lastTick=Date.now();var frame=0;function render(dt){app.emitGlobalEvent("prerender",dt)
    app.emitGlobalEvent("render",dt)
    app.emitGlobalEvent("postrender",dt)};function step(dt){app.emitGlobalEvent("step",dt)};function gameLoop(){if(app.killed)return;requestAnimationFrame(gameLoop);if(app.frameskip){frame++;if(frame===app.frameskip){frame=0;}else return;}
    var delta=Date.now()- lastTick;lastTick=Date.now();if(delta>1000)return;var dt=delta/1000;app.lifetime+=dt;app.elapsed=dt;step(dt);render(dt);app.opcost=delta/1000;app.ops=1000/app.opcost;};requestAnimationFrame(gameLoop);};PLAYGROUND.Gamepads=function(app){this.app=app;PLAYGROUND.Events.call(this);this.getGamepads=navigator.getGamepads||navigator.webkitGetGamepads;this.gamepadmoveEvent={};this.gamepaddownEvent={};this.gamepadupEvent={};this.gamepadholdEvent={};this.gamepads={};this.app.on("step",this.step.bind(this));};PLAYGROUND.Gamepads.prototype={buttons:{0:"1",1:"2",2:"3",3:"4",4:"l1",5:"r1",6:"l2",7:"r2",8:"select",9:"start",10:"stick1",11:"stick2",12:"up",13:"down",14:"left",15:"right",16:"super"},zeroState:function(){var buttons=[];for(var i=0;i<=15;i++){buttons.push({pressed:false,value:0});}
        return{axes:[],buttons:buttons};},createGamepad:function(){var result={buttons:{},sticks:[{x:0,y:0},{x:0,y:0}]};for(var i=0;i<16;i++){var key=this.buttons[i];result.buttons[key]=false;}
        return result;},step:function(){if(!navigator.getGamepads)return;var gamepads=navigator.getGamepads();for(var i=0;i<gamepads.length;i++){var current=gamepads[i];if(!current)continue;if(!this[i])this[i]=this.createGamepad();var buttons=[].concat(current.buttons);var previous=this[i];if(current.axes){var stickChanged=false;var stickA=false;var stickB=false;if(previous.sticks[0].x!==current.axes[0]){stickChanged=true;stickA=true;}
        if(previous.sticks[0].y!==current.axes[1]){stickChanged=true;stickA=true;}
        if(previous.sticks[1].x!==current.axes[2]){stickChanged=true;stickB=true;}
        if(previous.sticks[1].y!==current.axes[3]){stickChanged=true;stickB=true;}
        if(stickChanged){this.gamepadmoveEvent.old=[PLAYGROUND.Utils.extend({},previous.sticks[0]),PLAYGROUND.Utils.extend({},previous.sticks[1])];previous.sticks[0].x=current.axes[0];previous.sticks[0].y=current.axes[1];previous.sticks[1].x=current.axes[2];previous.sticks[1].y=current.axes[3];this.gamepadmoveEvent.sticks=previous.sticks;this.gamepadmoveEvent.gamepad=i;if(stickA){this.gamepadmoveEvent.b=false;this.gamepadmoveEvent.a=previous.sticks[0];this.trigger("gamepadmove",this.gamepadmoveEvent);}
            if(stickB){this.gamepadmoveEvent.a=false;this.gamepadmoveEvent.b=previous.sticks[1];this.trigger("gamepadmove",this.gamepadmoveEvent);}}}
        for(var j=0;j<buttons.length;j++){var key=this.buttons[j];if(buttons[j].pressed&&!previous.buttons[key]){previous.buttons[key]=true;this.gamepaddownEvent.button=this.buttons[j];this.gamepaddownEvent.gamepad=i;this.trigger("gamepaddown",this.gamepaddownEvent);this.trigger("keydown",{key:"gamepad"+ this.gamepaddownEvent.button,gamepad:i});}
            if(buttons[j].pressed){this.gamepadholdEvent.button=this.buttons[j];this.gamepadholdEvent.gamepad=i;this.gamepadholdEvent.dt=this.app.elapsed;this.trigger("gamepadhold",this.gamepadholdEvent);}
            else if(!buttons[j].pressed&&previous.buttons[key]){previous.buttons[key]=false;this.gamepadupEvent.button=this.buttons[j];this.gamepadupEvent.gamepad=i;this.trigger("gamepadup",this.gamepadupEvent);this.trigger("keyup",{key:"gamepad"+ this.gamepadupEvent.button,gamepad:i});}}}}};PLAYGROUND.Utils.extend(PLAYGROUND.Gamepads.prototype,PLAYGROUND.Events.prototype);PLAYGROUND.Keyboard=function(app){PLAYGROUND.Events.call(this);this.app=app;this.keys={};this.timestamps={};this.any=false;this.lastKey=-1;this.keydownlistener=this.keydown.bind(this);this.keyuplistener=this.keyup.bind(this);this.keypresslistener=this.keypress.bind(this);document.addEventListener("keydown",this.keydownlistener);document.addEventListener("keyup",this.keyuplistener);document.addEventListener("keypress",this.keypresslistener);this.keydownEvent={};this.keyupEvent={};this.keypressEvent={};this.preventDefault=true;this.enabled=true;this.app.on("kill",this.kill.bind(this));this.app.on("blur",this.blur.bind(this));this.mapping={};this.keyToCode={};for(var code in this.keycodes)this.keyToCode[this.keycodes[code]]=code;};PLAYGROUND.Keyboard.prototype={doubleTimeframe:0.25,kill:function(){document.removeEventListener("keydown",this.keydownlistener);document.removeEventListener("keyup",this.keyuplistener);document.removeEventListener("keypress",this.keypresslistener);},keycodes:{37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",96:"numpad0",97:"numpad1",98:"numpad2",99:"numpad3",100:"numpad4",101:"numpad5",102:"numpad6",103:"numpad7",104:"numpad8",105:"numpad9",106:"numpadmul",107:"numpadadd",109:"numpadsub",110:"numpaddec",111:"numpaddiv",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:"semicolon",187:"equal",188:"comma",189:"dash",190:"period",191:"slash",192:"graveaccent",219:"openbracket",220:"backslash",221:"closebracket",222:"singlequote"},bypassKeys:["f12","f11","f5","ctrl","alt","shift"],keydown:function(e){if(!this.enabled)return;if(e.which>=48&&e.which<=90)var keyName=String.fromCharCode(e.which).toLowerCase();else var keyName=this.keycodes[e.which];if(this.mapping[keyName])keyName=this.mapping[keyName];if(this.keys[keyName])return;this.any++;this.keydownEvent.key=keyName;this.keydownEvent.original=e;this.keys[keyName]=true;if(keyName===this.lastKey&&Date.now()- this.timestamps[keyName]<this.doubleTimeframe*1000){this.timestamps[keyName]=Date.now()- this.doubleTimeframe;this.keydownEvent.double=true;}else{this.timestamps[keyName]=Date.now();this.keydownEvent.double=false;}
        this.trigger("keydown",this.keydownEvent);if(this.preventDefault&&document.activeElement===document.body){var bypass=e.metaKey;if(!bypass){for(var i=0;i<this.bypassKeys.length;i++){if(this.keys[this.bypassKeys[i]]){bypass=true;break}}}
            if(!bypass){e.preventDefault();e.stopPropagation();}}
        this.lastKey=keyName;},keyup:function(e){if(!this.enabled)return;if(e.which>=48&&e.which<=90)var keyName=String.fromCharCode(e.which).toLowerCase();else var keyName=this.keycodes[e.which];if(this.mapping[keyName])keyName=this.mapping[keyName];this.any--;this.keyupEvent.key=keyName;this.keyupEvent.original=e;this.keys[keyName]=false;this.trigger("keyup",this.keyupEvent);},keypress:function(e){if(!this.enabled)return;if(e.which>=48&&e.which<=90)var keyName=String.fromCharCode(e.which).toLowerCase();else var keyName=this.keycodes[e.which];if(this.mapping[keyName])keyName=this.mapping[keyName];this.keypressEvent.key=keyName;this.keypressEvent.original=e;this.trigger("keypress",this.keypressEvent);},blur:function(e){for(var key in this.keys){var state=this.keys[key];if(!state)continue;this.keyup({which:this.keyToCode[key]});}}};PLAYGROUND.Utils.extend(PLAYGROUND.Keyboard.prototype,PLAYGROUND.Events.prototype);PLAYGROUND.Pointer=function(app){this.app=app;this.x=0;this.y=0;app.on("touchstart",this.touchstart,this);app.on("touchend",this.touchend,this);app.on("touchmove",this.touchmove,this);app.on("mousemove",this.mousemove,this);app.on("mousedown",this.mousedown,this);app.on("mouseup",this.mouseup,this);app.on("mousewheel",this.mousewheel,this);this.pointers=app.pointers={};this.app.pointer=this;this.lastTap=0;};PLAYGROUND.Pointer.plugin=true;PLAYGROUND.Pointer.prototype={updatePointer:function(e){if(!this.pointers[e.id])this.pointers[e.id]={};var pointer=this.pointers[e.id];pointer.x=e.x;pointer.y=e.y;pointer.id=e.id;return pointer;},removePointer:function(e){delete this.pointers[e.id];},touchstart:function(e){e.touch=true;this.updatePointer(e);this.x=this.app.touch.x;this.y=this.app.touch.y;this.pointerdown(e);this.app.emitGlobalEvent("pointerdown",e);},touchend:function(e){e.touch=true;this.pointerup(e);this.removePointer(e);this.app.emitGlobalEvent("pointerup",e);},touchmove:function(e){e.touch=true;this.updatePointer(e);this.pointermove(e);this.x=this.app.touch.x;this.y=this.app.touch.y;this.app.emitGlobalEvent("pointermove",e);},mousemove:function(e){e.mouse=true;this.updatePointer(e);this.pointermove(e);this.x=this.app.mouse.x;this.y=this.app.mouse.y;this.app.emitGlobalEvent("pointermove",e);},mousedown:function(e){e.mouse=true;this.pressed=true;this.updatePointer(e);this.app.emitGlobalEvent("pointerdown",e);this.pointerdown(e);},mouseup:function(e){e.mouse=true;this.pressed=false;this.pointerup(e);this.app.emitGlobalEvent("pointerup",e);},mousewheel:function(e){e.mouse=true;this.app.emitGlobalEvent("pointerwheel",e);},pointerdown:function(e){var pointer=this.pointers[e.id];e.double=false
        pointer.pressed=true;this.pressed=true;var timeFrame=this.app.lifetime- this.lastTap;this.lastTap=this.app.lifetime;if(timeFrame<0.4&&this.lastTapPosition&&PLAYGROUND.Utils.distance(e,this.lastTapPosition)<5){this.app.emitGlobalEvent("pointerdoubletap",pointer);e.double=true;this.lastTap=0;}
        this.lastTapPosition={x:e.x,y:e.y};},pointermove:function(e){var pointer=this.pointers[e.id];e.dragging=pointer.dragging;},pointerup:function(e){var pointer=this.pointers[e.id];pointer.pressed=false;pointer.dragging=false;this.pressed=false;}};PLAYGROUND.Loader=function(app){this.app=app;PLAYGROUND.Events.call(this);this.reset();};PLAYGROUND.Loader.prototype={add:function(id){this.queue++;this.count++;this.ready=false;this.trigger("add",id);return id;},error:function(id){this.trigger("error",id);},success:function(id){this.queue--;this.progress=1- this.queue/this.count;this.trigger("load",id);if(this.queue<=0){this.reset();this.trigger("ready");}},reset:function(){this.progress=0;this.queue=0;this.count=0;this.ready=true;}};PLAYGROUND.Utils.extend(PLAYGROUND.Loader.prototype,PLAYGROUND.Events.prototype);PLAYGROUND.Mouse=function(app,element){var self=this;this.app=app;PLAYGROUND.Events.call(this);this.element=element;this.preventContextMenu=true;this.enabled=true;this.releaseButtonsWhenOffscreen=true;this.mousemoveEvent={};this.mousedownEvent={};this.mouseupEvent={};this.mousewheelEvent={};this.x=0;this.y=0;if(app.mouseThrottling){this.mousemove=PLAYGROUND.Utils.throttle(this.mousemove,app.mouseThrottling);}
    this.mousemovelistener=this.mousemove.bind(this);this.mousedownlistener=this.mousedown.bind(this);this.mouseuplistener=this.mouseup.bind(this);this.mouseoutlistener=this.mouseout.bind(this);this.contextmenulistener=function(e){if(self.preventContextMenu&&!e.metaKey)e.preventDefault();};element.addEventListener("mousemove",this.mousemovelistener);element.addEventListener("mousedown",this.mousedownlistener);element.addEventListener("mouseup",this.mouseuplistener);element.addEventListener("mouseout",this.mouseoutlistener);element.addEventListener("contextmenu",this.contextmenulistener);this.app.on("kill",this.kill.bind(this));this.enableMousewheel();element.requestPointerLock=element.requestPointerLock||element.mozRequestPointerLock||element.webkitRequestPointerLock;document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock;this.handleResize();};PLAYGROUND.Mouse.prototype={kill:function(){this.element.removeEventListener("mousemove",this.mousemovelistener);this.element.removeEventListener("mousedown",this.mousedownlistener);this.element.removeEventListener("mouseup",this.mouseuplistener);this.element.removeEventListener("mouseout",this.mouseoutlistener);this.element.removeEventListener("contextmenu",this.contextmenulistener);},mouseout:function(button){if(!this.releaseButtonsWhenOffscreen)return;for(var i=0;i<3;i++){this.mouseup({button:i});}},lock:function(){this.locked=true;this.element.requestPointerLock();},unlock:function(){this.locked=false;document.exitPointerLock();},getElementOffset:function(element){var offsetX=0;var offsetY=0;do{offsetX+=element.offsetLeft;offsetY+=element.offsetTop;}
    while((element=element.offsetParent));return{x:offsetX,y:offsetY};},handleResize:function(){this.elementOffset=this.getElementOffset(this.element);},mousemove:function(e){if(!this.enabled)return;this.x=this.mousemoveEvent.x=(e.pageX- this.elementOffset.x- this.app.offsetX)/ this.app.scale | 0;
        this.y=this.mousemoveEvent.y=(e.pageY- this.elementOffset.y- this.app.offsetY)/ this.app.scale | 0;
        this.mousemoveEvent.original=e;if(this.locked){this.mousemoveEvent.movementX=e.movementX||e.mozMovementX||e.webkitMovementX||0;this.mousemoveEvent.movementY=e.movementY||e.mozMovementY||e.webkitMovementY||0;}
        if(this.app.mouseToTouch){this.mousemoveEvent.id=this.mousemoveEvent.identifier=255;this.trigger("touchmove",this.mousemoveEvent);}else{this.mousemoveEvent.id=this.mousemoveEvent.identifier=255;this.trigger("mousemove",this.mousemoveEvent);}},mousedown:function(e){if(!this.enabled)return;var buttonName=["left","middle","right"][e.button];this.mousedownEvent.x=this.mousemoveEvent.x;this.mousedownEvent.y=this.mousemoveEvent.y;this.mousedownEvent.button=buttonName;this.mousedownEvent.original=e;this[buttonName]=true;this.mousedownEvent.id=this.mousedownEvent.identifier=255;if(this.app.mouseToTouch){this.trigger("touchmove",this.mousedownEvent);this.trigger("touchstart",this.mousedownEvent);}else{this.trigger("mousedown",this.mousedownEvent);}
        this.trigger("keydown",{key:"mouse"+ buttonName});},mouseup:function(e){if(!this.enabled)return;var buttonName=["left","middle","right"][e.button];if(!this[buttonName])return;this.mouseupEvent.x=this.mousemoveEvent.x;this.mouseupEvent.y=this.mousemoveEvent.y;this.mouseupEvent.button=buttonName;this.mouseupEvent.original=e;this.mouseupEvent.id=this.mouseupEvent.identifier=255;if(this.app.mouseToTouch){this.trigger("touchend",this.mouseupEvent);}else{this.trigger("mouseup",this.mouseupEvent);}
        this.trigger("keyup",{key:"mouse"+ buttonName});this[buttonName]=false;},mousewheel:function(e){this.mousewheelEvent.x=this.mousemoveEvent.x;this.mousewheelEvent.y=this.mousemoveEvent.y;this.mousewheelEvent.button=["none","left","middle","right"][e.button];this.mousewheelEvent.original=e;this.mousewheelEvent.id=this.mousewheelEvent.identifier=255;this[e.button]=false;this.trigger("mousewheel",this.mousewheelEvent);this.trigger("keydown",{key:e.delta>0?"mousewheelup":"mousewheeldown"});},enableMousewheel:function(){var eventNames='onwheel'in document||document.documentMode>=9?['wheel']:['mousewheel','DomMouseScroll','MozMousePixelScroll'];var callback=this.mousewheel.bind(this);var self=this;var throttled=PLAYGROUND.Utils.throttle(function(event){var orgEvent=event||window.event,args=[].slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,absDeltaXY=0,fn;if(orgEvent.wheelDelta){delta=orgEvent.wheelDelta;}
        if(orgEvent.detail){delta=orgEvent.detail*-1;}
        if(orgEvent.deltaY){deltaY=orgEvent.deltaY*-1;delta=deltaY;}
        if(orgEvent.wheelDeltaY!==undefined){deltaY=orgEvent.wheelDeltaY;}
        var result=delta?delta:deltaY;self.mousewheelEvent.x=self.mousemoveEvent.x;self.mousewheelEvent.y=self.mousemoveEvent.y;self.mousewheelEvent.delta=result/Math.abs(result);self.mousewheelEvent.original=orgEvent;callback(self.mousewheelEvent);orgEvent.preventDefault();},40);for(var i=eventNames.length;i;){self.element.addEventListener(eventNames[--i],function(event){throttled(event);var prevent=!PLAYGROUND.Utils.classInParents(event.target,"scroll");if(prevent){event.preventDefault();event.stopPropagation();}},false);}}};PLAYGROUND.Utils.extend(PLAYGROUND.Mouse.prototype,PLAYGROUND.Events.prototype);PLAYGROUND.Sound=function(app){var audioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(audioContext&&!app.forceAudioFallback){if(!PLAYGROUND.audioContext)PLAYGROUND.audioContext=new audioContext;app.audioContext=PLAYGROUND.audioContext;app.sound=new PLAYGROUND.SoundWebAudioAPI(app,app.audioContext);app.music=new PLAYGROUND.SoundWebAudioAPI(app,app.audioContext);}else{app.sound=new PLAYGROUND.SoundAudio(app);app.music=new PLAYGROUND.SoundAudio(app);}};PLAYGROUND.Application.prototype.playSound=function(key,loop){return this.sound.play(key,loop);};PLAYGROUND.Application.prototype.stopSound=function(sound){this.sound.stop(sound);};PLAYGROUND.Application.prototype.loadSound=function(){return this.loadSounds.apply(this,arguments);};PLAYGROUND.Application.prototype.loadSounds=function(){for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(typeof arg==="object"){for(var key in arg)this.loadSounds(arg[key]);}else{this.sound.load(arg);}}};(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+ o+"'");throw f.code="MODULE_NOT_FOUND",f}
    var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}
    return n[o].exports}
    var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){(function(global){"use strict";var AudioContext=global.AudioContext||global.webkitAudioContext;var StereoPannerNode=require("stereo-panner-node");if(AudioContext&&!AudioContext.prototype.createStereoPanner){AudioContext.prototype.createStereoPanner=function(){return new StereoPannerNode(this)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"stereo-panner-node":4}],2:[function(require,module,exports){"use strict";var WS_CURVE_SIZE=4096;var curveL=new Float32Array(WS_CURVE_SIZE);var curveR=new Float32Array(WS_CURVE_SIZE);(function(){for(var i=0;i<WS_CURVE_SIZE;i++){curveL[i]=Math.cos(i/WS_CURVE_SIZE*Math.PI*.5);curveR[i]=Math.sin(i/WS_CURVE_SIZE*Math.PI*.5)}})();module.exports={L:curveL,R:curveR}},{}],3:[function(require,module,exports){(function(global){"use strict";var curve=require("./curve");function StereoPannerImpl(audioContext){this.audioContext=audioContext;this.inlet=audioContext.createChannelSplitter(2);this._pan=audioContext.createGain();this.pan=this._pan.gain;this._wsL=audioContext.createWaveShaper();this._wsR=audioContext.createWaveShaper();this._L=audioContext.createGain();this._R=audioContext.createGain();this.outlet=audioContext.createChannelMerger(2);this.inlet.channelCount=2;this.inlet.channelCountMode="explicit";this._pan.gain.value=0;this._wsL.curve=curve.L;this._wsR.curve=curve.R;this._L.gain.value=0;this._R.gain.value=0;this.inlet.connect(this._L,0);this.inlet.connect(this._R,1);this._L.connect(this.outlet,0,0);this._R.connect(this.outlet,0,1);this._pan.connect(this._wsL);this._pan.connect(this._wsR);this._wsL.connect(this._L.gain);this._wsR.connect(this._R.gain);this._isConnected=false;this._dc1buffer=null;this._dc1=null}
        StereoPannerImpl.prototype.connect=function(destination){var audioContext=this.audioContext;if(!this._isConnected){this._isConnected=true;this._dc1buffer=audioContext.createBuffer(1,2,audioContext.sampleRate);this._dc1buffer.getChannelData(0).set([1,1]);this._dc1=audioContext.createBufferSource();this._dc1.buffer=this._dc1buffer;this._dc1.loop=true;this._dc1.start(audioContext.currentTime);this._dc1.connect(this._pan)}
            global.AudioNode.prototype.connect.call(this.outlet,destination)};StereoPannerImpl.prototype.disconnect=function(){var audioContext=this.audioContext;if(this._isConnected){this._isConnected=false;this._dc1.stop(audioContext.currentTime);this._dc1.disconnect();this._dc1=null;this._dc1buffer=null}
            global.AudioNode.prototype.disconnect.call(this.outlet)};module.exports=StereoPannerImpl}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./curve":2}],4:[function(require,module,exports){"use strict";var StereoPannerImpl=require("./stereo-panner-impl");

        function StereoPanner(audioContext) {
            var impl = new StereoPannerImpl(audioContext);
            Object.defineProperties(impl.inlet, {
                pan: {
                    value: impl.pan,
                    enumerable: true
                },
                connect: {
                    value: function(node) {
                        return impl.connect(node)
                    }
                },
                disconnect: {
                    value: function() {
                        return impl.disconnect()
                    }
                }
            });
            return impl.inlet
        }
        module.exports = StereoPanner
    }, {
        "./stereo-panner-impl": 3
    }]
}, {}, [1]);


/** Sound back-end using Web Audio API
 *
 * Reference: https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API
 */


PLAYGROUND.SoundWebAudioAPI = function(app, audioContext) {

    this.app = app;

    var canPlayMp3 = (new Audio).canPlayType("audio/mp3");
    var canPlayOgg = (new Audio).canPlayType('audio/ogg; codecs="vorbis"');

    if (this.app.preferedAudioFormat === "mp3") {

        if (canPlayMp3) this.audioFormat = "mp3";
        else this.audioFormat = "ogg";

    } else {

        if (canPlayOgg) this.audioFormat = "ogg";
        else this.audioFormat = "mp3";

    }

    this.context = audioContext;

    this.gainNode = this.context.createGain()
    this.gainNode.connect(this.context.destination);

    this.compressor = this.context.createDynamicsCompressor();
    this.compressor.connect(this.gainNode);

    this.output = this.compressor;

    this.gainNode.gain.value = 1.0;

    this.pool = [];
    this.volume = 1.0;

    this.loops = [];

    this.app.on("step", this.step.bind(this));

};

PLAYGROUND.SoundWebAudioAPI.prototype = {

    buffers: {},
    aliases: {},

    alias: function(alias, source, volume, rate) {

        this.aliases[alias] = {
            source: source,
            volume: volume,
            rate: rate
        };

    },

    setMaster: function(volume) {

        this.volume = volume;

        this.gainNode.gain.value = volume;

    },

    load: function(file) {

        var entry = this.app.getAssetEntry(file, "sounds", this.audioFormat);

        var sampler = this;

        var request = new XMLHttpRequest();

        request.open("GET", entry.url, true);
        request.responseType = "arraybuffer";

        var id = this.app.loader.add(entry.url);

        request.onload = function() {

            sampler.context.decodeAudioData(this.response, function(decodedBuffer) {
                sampler.buffers[entry.key] = decodedBuffer;
                sampler.app.loader.success(entry.url);
            });

        }

        request.send();

    },

    cleanArray: function(array, property) {
        for (var i = 0, len = array.length; i < len; i++) {
            if (array[i] === null || (property && array[i][property])) {
                array.splice(i--, 1);
                len--;
            }
        }
    },

    getSoundBuffer: function() {

        if (!this.pool.length) {
            for (var i = 0; i < 100; i++) {

                var buffer, gain, panner;

                var nodes = [
                    buffer = this.context.createBufferSource(),
                    gain = this.context.createGain(),
                    panner = this.context.createStereoPanner()
                ];

                this.pool.push(nodes);


                if (!PLAYGROUND.MOBILE) {

                    nodes[0].connect(nodes[1]);
                    nodes[1].connect(nodes[2]);
                    nodes[2].connect(this.output);

                } else {

                    nodes[0].connect(nodes[1]);
                    nodes[1].connect(this.gainNode);

                }

            }
        }

        return this.pool.pop();
    },

    play: function(name, loop) {

        var alias = this.aliases[name];

        var nodes = this.getSoundBuffer();

        if (alias) name = alias.source;

        bufferSource = nodes[0];
        bufferSource.gainNode = nodes[1];
        bufferSource.pannerNode = nodes[2];
        bufferSource.buffer = this.buffers[name];
        bufferSource.loop = loop || false;
        bufferSource.key = name;

        bufferSource.alias = alias;

        this.setVolume(bufferSource, 1.0);
        this.setPlaybackRate(bufferSource, 1.0);

        if (this.loop) {
            //  bufferSource.loopStart = this.loopStart;
            // bufferSource.loopEnd = this.loopEnd;
        }


        bufferSource.start(0);

        bufferSource.volumeLimit = 1;

        return bufferSource;
    },

    stop: function(what) {

        if (!what) return;

        what.stop(0);

    },

    setPlaybackRate: function(sound, rate) {

        if (!sound) return;

        if (sound.alias) rate *= sound.alias.rate;

        return sound.playbackRate.value = rate;
    },

    getVolume: function(sound) {

        if (!sound) return;

        return sound.gainNode.gain.value;

    },

    setVolume: function(sound, volume) {

        if (!sound) return;

        if (sound.alias) volume *= sound.alias.volume;

        return sound.gainNode.gain.value = Math.max(0, volume);
    },

    setPanning: function(sound, pan) {

        sound.pannerNode.pan.value = pan;

    },

    getPanning: function(sound) {

        return sound.pannerNode.pan.value;

    },

    fadeOut: function(sound) {

        if (!sound) return;

        sound.fadeOut = true;

        this.loops.push(sound);

        return sound;

    },

    fadeIn: function(sound) {

        if (!sound) return;

        sound.fadeIn = true;

        this.loops.push(sound);
        this.setVolume(sound, 0);


        return sound;

    },

    step: function(delta) {

        for (var i = 0; i < this.loops.length; i++) {

            var loop = this.loops[i];

            if (loop.fadeIn) {
                var volume = this.getVolume(loop);
                volume = this.setVolume(loop, Math.min(1.0, volume + delta * 0.5));

                if (volume >= 1.0) {
                    this.loops.splice(i--, 1);
                }
            }

            if (loop.fadeOut) {
                var volume = this.getVolume(loop);
                volume = this.setVolume(loop, Math.min(1.0, volume - delta * 0.5));

                if (volume <= 0) {
                    this.loops.splice(i--, 1);
                    this.stop(loop);
                }
            }

        }

    }

};

/* file: src/SoundAudio.js */

/** Sound back-end using HTML DOM Audio object.
 *
 */
PLAYGROUND.SoundAudio = function(app) {

    this.app = app;

    var canPlayMp3 = (new Audio).canPlayType("audio/mp3");
    var canPlayOgg = (new Audio).canPlayType('audio/ogg; codecs="vorbis"');

    if (this.app.preferedAudioFormat === "mp3") {

        if (canPlayMp3) this.audioFormat = "mp3";
        else this.audioFormat = "ogg";

    } else {

        if (canPlayOgg) this.audioFormat = "ogg";
        else this.audioFormat = "mp3";

    }

};

PLAYGROUND.SoundAudio.prototype = {

    samples: {},

    setMaster: function(volume) {

        this.volume = volume;

    },

    setMasterPosition: function() {

    },

    setPosition: function(x, y, z) {
        return;
    },

    load: function(file) {

        console.log(file, this.audioFormat)

        var url = "sounds/" + file + "." + this.audioFormat;

        var loader = this.app.loader;

        this.app.loader.add(url);

        var audio = this.samples[file] = new Audio;

        audio.addEventListener("canplay", function() {

            console.log("CANPLAY");

            this.pause();
            loader.success(url);


        });
        /*
        audio.addEventListener("canplaythrough", function() {

          console.log("CANPLAYTHROUGH");

          loader.success(url);

        });

        audio.addEventListener("load", function() {

          console.log("LOAD");

          loader.success(url);

        });
    */
        audio.addEventListener("error", function() {

            loader.error(url);

        });

        audio.src = url;
        audio.play();


    },

    play: function(key, loop) {

        var sound = this.samples[key];

        sound.currentTime = 0;
        sound.loop = loop;
        sound.play();

        return sound;

    },

    stop: function(what) {

        if (!what) return;

        what.pause();

    },

    step: function(delta) {

    },

    setPlaybackRate: function(sound, rate) {

        return;
    },

    setVolume: function(sound, volume) {

        sound.volume = volume * this.volume;

    },

    setPosition: function() {

    },

    setPanning: function(sound, pan) {

    }

};

/* file: src/Touch.js */

/** Touch related functionality.
 *
 * The object keeps track of active touches using an unique id
 * provided by the browser. When a touch starts an entry is added
 * to the `touches` associative array with the key being the
 * unique identifier and the value an object with following members:
 * - x: horizontal position in pixels/scale
 * - y: vertical position in pixels/scale
 *
 * When the tracking point changes location the values are updated and
 * when the touches ends the entry is removed from the `touches` array.
 *
 * Properties:
 * - app: the main application object
 * - element: the DOM element we're handling events for
 * - touches: list of active touches
 * - x, y: last changed position across all touches
 *
 * Events generated by this object:
 * - touchmove: a touch changed its position
 * - touchstart: a touch was added
 * - touchend: a touch ended
 *
 * Event handlers receive the position (x, y), the id (identifier) and
 * original event.
 *
 * Reference: http://playgroundjs.com/playground-touch
 */
PLAYGROUND.Touch = function(app, element) {

    PLAYGROUND.Events.call(this);

    this.app = app;

    this.element = element;

    this.touches = {};

    this.enabled = true;

    this.x = 0;
    this.y = 0;

    this.touchmovelistener = this.touchmove.bind(this);
    this.touchstartlistener = this.touchstart.bind(this);
    this.touchendlistener = this.touchend.bind(this);

    element.addEventListener("touchmove", this.touchmovelistener, {passive: false});
    element.addEventListener("touchstart", this.touchstartlistener, {passive: false});
    element.addEventListener("touchend", this.touchendlistener, {passive: false});

    this.app.on("kill", this.kill.bind(this));

};

PLAYGROUND.Touch.prototype = {

    kill: function() {

        this.element.removeEventListener("touchmove", this.touchmovelistener);
        this.element.removeEventListener("touchstart", this.touchstartlistener);
        this.element.removeEventListener("touchend", this.touchendlistener);

    },

    getElementOffset: function(element) {

        var offsetX = 0;
        var offsetY = 0;

        do {
            offsetX += element.offsetLeft;
            offsetY += element.offsetTop;
        }

        while ((element = element.offsetParent));

        return {
            x: offsetX,
            y: offsetY
        };

    },

    handleResize: function() {

        this.elementOffset = this.getElementOffset(this.element);

    },

    touchmove: function(e) {

        if (!this.enabled) return;

        for (var i = 0; i < e.changedTouches.length; i++) {

            var touch = e.changedTouches[i];

            touchmoveEvent = {}

            this.x = touchmoveEvent.x = (touch.pageX - this.elementOffset.x - this.app.offsetX) / this.app.scale | 0;
            this.y = touchmoveEvent.y = (touch.pageY - this.elementOffset.y - this.app.offsetY) / this.app.scale | 0;

            touchmoveEvent.original = touch;
            touchmoveEvent.id = touchmoveEvent.identifier = touch.identifier;

            this.touches[touch.identifier].x = touchmoveEvent.x;
            this.touches[touch.identifier].y = touchmoveEvent.y;

            this.trigger("touchmove", touchmoveEvent);

        }

        var prevent = !PLAYGROUND.Utils.classInParents(e.target, "ui");

        if (prevent) e.preventDefault();

    },

    touchstart: function(e) {

        if (!this.enabled) return;


        for (var i = 0; i < e.changedTouches.length; i++) {

            var touch = e.changedTouches[i];

            var touchstartEvent = {}

            this.x = touchstartEvent.x = (touch.pageX - this.elementOffset.x - this.app.offsetX) / this.app.scale | 0;
            this.y = touchstartEvent.y = (touch.pageY - this.elementOffset.y - this.app.offsetY) / this.app.scale | 0;

            touchstartEvent.original = e.touch;
            touchstartEvent.id = touchstartEvent.identifier = touch.identifier;

            this.touches[touch.identifier] = {
                x: touchstartEvent.x,
                y: touchstartEvent.y
            };

            this.trigger("touchstart", touchstartEvent);

        }

        var prevent = !PLAYGROUND.Utils.classInParents(e.target, "ui");

        if (prevent) e.preventDefault();

    },

    touchend: function(e) {

        if (!this.enabled) return;

        for (var i = 0; i < e.changedTouches.length; i++) {

            var touch = e.changedTouches[i];
            var touchendEvent = {};

            touchendEvent.x = (touch.pageX - this.elementOffset.x - this.app.offsetX) / this.app.scale | 0;
            touchendEvent.y = (touch.pageY - this.elementOffset.y - this.app.offsetY) / this.app.scale | 0;

            touchendEvent.original = touch;
            touchendEvent.id = touchendEvent.identifier = touch.identifier;

            delete this.touches[touch.identifier];

            this.trigger("touchend", touchendEvent);

        }

        var prevent = !PLAYGROUND.Utils.classInParents(e.target, "ui");

        if (prevent) e.preventDefault();

    }

};

PLAYGROUND.Utils.extend(PLAYGROUND.Touch.prototype, PLAYGROUND.Events.prototype);

/* file: src/Tween.js */

PLAYGROUND.Tween = function(manager, context) {

    PLAYGROUND.Events.call(this);

    this.manager = manager;
    this.context = context;
    this.auto = true;

    PLAYGROUND.Utils.extend(this, {

        prevEasing: "linear",
        prevDuration: 0.5

    });

    this.clear();

};

PLAYGROUND.Tween.prototype = {

    manual: function() {

        this.auto = false;

        return this;

    },

    /*

    Add an action to the end of the list

    @param properties
    @param duration in miliseconds (optional, default is 0.5)
    @param easing (optional, default is linear)
    @returns `this` object so that calls can be chained.

  */

    add: function(properties, duration, easing) {

        if (typeof duration !== "undefined") this.prevDuration = duration;
        else duration = 0.5;

        if (easing) this.prevEasing = easing;
        else easing = "linear";

        this.actions.push([properties, duration, easing]);

        return this;

    },

    /* Clear animations */

    clear: function() {

        this.actions = [];
        this.index = -1;
        this.current = false;

        return this;

    },

    /* Discard all other tweens associated with same context as ours */

    discard: function() {

        this.manager.discard(this.context, this);

        return this;

    },

    /* Alias for `add()` */

    to: function(properties, duration, easing) {

        return this.add(properties, duration, easing);

    },

    /* Enqueue a method call */

    call: function(methodName, context) {

        var action = ["call", methodName, context || this.context];

        for (var i = 2; i < arguments.length; i++) action.push(arguments[i]);

        this.actions.push(action);

        return this;

    },

    /* Mark the instance as being a repeated tween */

    loop: function() {

        this.looped = true;

        return this;

    },

    /* Add a repeat action for specified number of times */

    repeat: function(times) {

        this.actions.push(["repeat", times]);

        return this;

    },

    /* Add a wait action for specified number of miliseconds */

    wait: function(time) {

        this.actions.push(["wait", time]);

        return this;

    },

    /* Alias for `wait()` */

    delay: function(time) {

        this.actions.push(["wait", time]);

        return this;

    },

    then: function(callback) {

        this.actions.push(["then", callback]);

        return this;

    },

    /* Remove this tween from the manager */

    stop: function() {

        this.manager.remove(this);

        return this;

    },

    /* Inserts the tween into the manager if not already inside. */

    play: function() {

        this.manager.add(this);

        this.finished = false;

        return this;

    },

    /* Performs last step in the animation list. */

    end: function() {

        var lastAnimationIndex = 0;

        for (var i = this.index + 1; i < this.actions.length; i++) {
            if (typeof this.actions[i][0] === "object") lastAnimationIndex = i;
        }

        this.index = lastAnimationIndex - 1;
        this.next();
        this.delta = this.duration;
        this.step(0);

        return this;

    },

    /* TBD */

    forward: function() {

        this.delta = this.duration;
        this.step(0);

    },

    /* TBD */

    rewind: function() {

        this.delta = 0;
        this.step(0);

    },

    /*

    Perform one animation step

    Advances the index and, if the index reached the end of the
    `actions` array, either restarts it (for looped tweens) or terminates it.

    The function will set a string in `currentAction` indicating what it
    should be done next but it does not perform the action itself.

  */

    next: function() {

        this.delta = 0;

        this.index++;

        if (this.index >= this.actions.length) {

            if (this.looped) {

                this.trigger("loop", {
                    tween: this
                });

                this.index = 0;

            } else {

                this.manager.remove(this);

                return;

            }
        }

        this.current = this.actions[this.index];

        if (this.current[0] === "call") {

            var args = this.current.slice(2);

            var methodName = this.current[1];
            var context = this.current[2];
            var method = context[methodName];

            method.apply(context, args);

        } else if (this.current[0] === "wait") {

            this.duration = this.current[1];
            this.currentAction = "wait";

        } else if (this.current[0] === "then") {

            this.current[1](this.context);
            this.currentAction = "then";
            this.next();

        } else {

            /* calculate changes */

            var properties = this.current[0];

            /* keep keys as array for 0.0001% performance boost */

            this.keys = Object.keys(properties);

            this.change = [];
            this.before = [];
            this.types = [];

            for (var i = 0; i < this.keys.length; i++) {

                var key = this.keys[i];
                var value = this.context[key];

                if (typeof properties[key] === "number") {

                    value = value || 0;

                    this.before.push(value);
                    this.change.push(properties[key] - value);
                    this.types.push(0);

                } else if (typeof properties[key] === "string" && properties[key].indexOf("rad") > -1) {

                    value = value || 0;

                    this.before.push(value);
                    this.change.push(PLAYGROUND.Utils.circWrappedDistance(value, parseFloat(properties[key])));
                    this.types.push(2);

                } else {

                    value = value || "#000";

                    var before = cq.color(value);

                    this.before.push(before);

                    var after = cq.color(properties[key]);

                    var temp = [];

                    for (var j = 0; j < 3; j++) {
                        temp.push(after[j] - before[j]);
                    }

                    this.change.push(temp);

                    this.types.push(1);

                }

            }

            this.currentAction = "animate";

            this.duration = this.current[1];
            this.easing = this.current[2];

        }


    },

    /* TBD */

    prev: function() {

    },

    /* Select an action if none is current then perform required steps. */

    step: function(delta) {

        this.delta += delta;

        if (!this.current) this.next();

        switch (this.currentAction) {

            case "animate":
                this.doAnimate(delta);
                break;

            case "wait":
                this.doWait(delta);
                break;

        }

    },

    doAnimate: function(delta) {

        this.progress = this.duration ? Math.min(1, this.delta / this.duration) : 1.0;

        var mod = PLAYGROUND.Utils.ease(this.progress, this.easing);

        for (var i = 0; i < this.keys.length; i++) {

            var key = this.keys[i];

            switch (this.types[i]) {

                /* number */

                case 0:

                    this.context[key] = this.before[i] + this.change[i] * mod;

                    break;

                /* color */

                case 1:

                    var change = this.change[i];
                    var before = this.before[i];
                    var color = [];

                    for (var j = 0; j < 3; j++) {
                        color.push(before[j] + change[j] * mod | 0);
                    }

                    this.context[key] = "rgb(" + color.join(",") + ")";

                    break;

                /* angle */

                case 2:

                    this.context[key] = PLAYGROUND.Utils.circWrap(this.before[i] + this.change[i] * mod);

                    break;
            }
        }

        if (this.progress >= 1) {

            this.next();

        }

        if (this.listeners["step"]) {

            this.trigger("step", {
                tween: this,
                dt: delta
            });

        }

    },

    /*

    Advances the animation if enough time has passed

    The function is called in response to `step()`; it will advance the
    index to next slot in the animation if

  */

    doWait: function(delta) {

        if (this.delta >= this.duration) this.next();

    },

    onremove: function() {

        this.trigger("finished", {
            tween: this
        });

        this.trigger("finish", {
            tween: this
        });

        this.finished = true;

    }

};

PLAYGROUND.Utils.extend(PLAYGROUND.Tween.prototype, PLAYGROUND.Events.prototype);


/*

  Manager for easing effects (transition between various states).

  If `app` is provided the manager becomes application's manager
  for tween effects. The constructor inserts a `tween()` function
  in application for simplicity.

  Properties:
  - delta:
  - defaultEasing:
  - tweens: the list of active animations

*/

PLAYGROUND.TweenManager = function(app) {

    this.tweens = [];

    if (app) {
        this.app = app;
        this.app.tween = this.tween.bind(this);
    }

    this.delta = 0;

    this.app.on("step", this.step.bind(this));

};

PLAYGROUND.TweenManager.prototype = {

    defaultEasing: "128",

    /* TBD */

    circ: function(value) {

        return {
            type: "circ",
            value: value
        };

    },

    /*

    Marks the tween for removing.

    The tween is actually removed in `step()` function.

    @param object the object associated with the tween
    @param safe if the tween located using `object` is `safe` then it is not removed.

  */

    discard: function(object, safe) {

        for (var i = 0; i < this.tweens.length; i++) {

            var tween = this.tweens[i];

            if (tween.context === object && tween !== safe) this.remove(tween);

        }

    },

    /*

    Create a new tween.

    The tween is also added to internal list (you don't have to call
    `add()` yourself).

    @param context the object to associate with the new tween
    @returns a new PLAYGROUND.Tween object

  */

    tween: function(context) {

        var tween = new PLAYGROUND.Tween(this, context);

        this.add(tween);

        return tween;

    },

    /*

    Called each frame to update logic.

    The function updates all active tweens and removes the ones
    tagged as such.

  */

    step: function(delta) {

        this.delta += delta;

        for (var i = 0; i < this.tweens.length; i++) {

            var tween = this.tweens[i];

            if (!tween.auto) continue;

            if (!tween._remove) tween.step(delta);

            if (tween._remove) this.tweens.splice(i--, 1);

        }

    },

    /* Add a tween to internal list. */

    add: function(tween) {

        tween._remove = false;

        var index = this.tweens.indexOf(tween);

        if (index === -1) this.tweens.push(tween);

    },

    /* Marks a tween for removing during next step(). */

    remove: function(tween) {

        if (tween._remove) return;

        tween._remove = true;

        tween.onremove();

    }

};

/* file: src/Atlases.js */

/** Extend Application object with a function to load any number of atlases
 *
 * Each atlas consists of a pair of image file and a json file
 *
 * The application is extended with an `atlases` associative array.
 * The keys are file keys generated by `getAssetEntry()` and
 * values have following structure:
 * - image: the image object
 * - frames: array of objects:
 *     - region: [x, y, w, h],
 *     - offset: [x, y],
 *     - width
 *     - height
 *
 * Default renderer can draw such an atlas using
 * `drawAtlasFrame(atlas, frame, x, y)` function.
 *
 * Reference: http://playgroundjs.com/playground-atlases
 */
PLAYGROUND.Application.prototype.loadAtlases = function() {

    for (var i = 0; i < arguments.length; i++) {

        var arg = arguments[i];

        /* polymorphism at its finest */

        if (typeof arg === "object") {

            for (var key in arg) this.loadAtlases(arg[key]);

        } else {

            /* if argument is not an object/array let's try to load it */

            this._loadAtlas(arg)

        }
    }

};

/** Alias for `loadAtlases()`. */
PLAYGROUND.Application.prototype.loadAtlas = function() {

    return this.loadAtlases.apply(this, arguments);

};

/** Load a single atlas (internal). */
PLAYGROUND.Application.prototype._loadAtlas = function(filename) {

    var entry = this.getAssetEntry(filename, "atlases", "png");

    this.loader.add(entry.url);

    var atlas = this.atlases[entry.key] = {};

    var image = atlas.image = new Image;

    image.addEventListener("load", function() {
        loader.success(entry.url);
    });

    image.addEventListener("error", function() {
        loader.error(entry.url);
    });

    image.src = entry.url;

    /* data */

    var request = new XMLHttpRequest();

    request.open("GET", entry.path + ".json", true);

    this.loader.add(entry.path + ".json");

    var loader = this.loader;

    request.onload = function() {

        var data = JSON.parse(this.response);

        atlas.frames = [];

        for (var i = 0; i < data.frames.length; i++) {
            var frame = data.frames[i];

            atlas.frames.push({
                region: [frame.frame.x, frame.frame.y, frame.frame.w, frame.frame.h],
                offset: [frame.spriteSourceSize.x || 0, frame.spriteSourceSize.y || 0],
                width: frame.sourceSize.w,
                height: frame.sourceSize.h
            });
        }

        loader.success(entry.path + ".json");

    }

    request.send();
};

/* file: src/Fonts.js */

/** Load a font.
 * @deprecated Use `Application.loadFont()` instead.
 */
PLAYGROUND.Application.prototype.loadFontOld = function(name) {

    var styleNode = document.createElement("style");
    styleNode.type = "text/css";

    var formats = {
        "woff": "woff",
        "ttf": "truetype"
    };

    var sources = "";

    for (var ext in formats) {
        var type = formats[ext];
        sources += " url(\"fonts/" + name + "." + ext + "\") format('" + type + "');"
    }

    styleNode.textContent = "@font-face { font-family: '" + name + "'; src: " + sources + " }";

    document.head.appendChild(styleNode);

    var layer = cq(32, 32);

    layer.font("10px Testing");
    layer.fillText(16, 16, 16).trim();

    var width = layer.width;
    var height = layer.height;

    this.loader.add("font " + name);

    var self = this;

    function check() {

        var layer = cq(32, 32);

        layer.font("10px " + name).fillText(16, 16, 16);
        layer.trim();

        if (layer.width !== width || layer.height !== height) {

            self.loader.ready("font " + name);

        } else {

            setTimeout(check, 250);

        }

    };

    check();

};

/* file: src/DefaultState.js */

/** State used while initializing the application */
PLAYGROUND.DefaultState = {

};

/* file: src/LoadingScreen.js */

/** Basic loading screen using DOM
 *
 * Loading screen is a state like any other except that
 * it is loaded from `PLAYGROUND.LoadingScreen`. To override
 * simply define a `PLAYGROUND.LoadingScreen` in your code after
 * playground.js was imported.
 */
PLAYGROUND.LoadingScreen = {

    logoRaw: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANoAAAASBAMAAADPiN0xAAAAGFBMVEUAAQAtLixHSUdnaGaJioimqKXMzsv7/fr5shgVAAAAAWJLR0QAiAUdSAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB98EAwkeA4oQWJ4AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAB9klEQVQ4y72UvW+rMBDAz+FrpVKrrFmesmapWNOlrKjSe1kZ+uoVAvj+/frujG1SaJcqJwU7voOf7xMQzQmsIDi5NPTMsLRntH3U+F6SAZo3NlCvcgBFJz8o+vkDiE63lI95Y/UmpinsZWkgJWJiDbAVQ16htptxSTNloIlugwaw001Ey3ASF3so6L1qLNXzQS5S0UGKL/CI5wWNriE0UH9Yty37LqIVg+wsqu7Ix0MwVBSF/dU+jv2SNnma021LEdPqVnMeU3xAu0kXcSGjmq7Ox4E2Wn88LZ2+EFj3avjixzai6VPVyuYveZLHF2XfdDnvAq27DIHGuq+0DJFsE30OtB1KqOwd8Dr7PcM4b+jfj2g5lp4WyntBK66qua3JzEA+uXJpwH/NlVuzRVPY/kTLB2mjuN+KwdZ8FOy8j2gDbEUSqumnSCY4lf4ibq3IhVM4ycZQRnv+zFqVdJQVn6BxvUqebGpuaNo3sZxwBzjajiMZOoBiwyVF+kCr+nUaJOaGpnAeRPPJZTr4FqmHRXcneEo4DqQ/ftfdnLeDrUAME8xWKPeKCwW6YkEpXfs3p1EWJhdcUAYP0TI/uYaV8cgjwBovaeyWwji2T9rTFIdS/cP/MnkTLRUWxgNNZVin7bT5fqT9miDcUVJzR1gRpfIONMmulU+5Qqr6zXAUqAAAAABJRU5ErkJggg==",

    create: function() {

        var self = this;

        this.logo = new Image;

        this.logo.addEventListener("load", function() {
            self.ready = true;
            self.createElements();
        });

        this.logo.src = this.logoRaw;

        this.background = "#000";

        if (window.getComputedStyle) {
            this.background = window.getComputedStyle(document.body).backgroundColor || "#000";
        }


    },

    enter: function() {

        this.current = 0;

    },

    leave: function() {

        this.locked = true;

        this.animation = this.app.tween(this)
        .to({
            current: 1
        }, 0.5);

    },

    step: function(delta) {

        if (this.locked) {

            if (this.animation.finished) {
                this.locked = false;
                this.wrapper.parentNode.removeChild(this.wrapper);
            }

        } else {

            this.current = this.current + Math.abs(this.app.loader.progress - this.current) * delta;
        }

    },

    createElements: function() {

        this.width = window.innerWidth * 0.6 | 0;
        this.height = window.innerHeight * 0.1 | 0;

        this.wrapper = document.createElement("div");
        this.wrapper.style.width = this.width + "px";
        this.wrapper.style.height = this.height + "px";
        this.wrapper.style.background = "#000";
        this.wrapper.style.border = "4px solid #fff";
        this.wrapper.style.position = "absolute";
        this.wrapper.style.left = (window.innerWidth / 2 - this.width / 2 | 0) + "px";
        this.wrapper.style.top = (window.innerHeight / 2 - this.height / 2 | 0) + "px";
        this.wrapper.style.zIndex = 100;

        this.app.container.appendChild(this.wrapper);

        this.progressBar = document.createElement("div");
        this.progressBar.style.width = "0%";
        this.progressBar.style.height = this.height + "px";
        this.progressBar.style.background = "#fff";

        this.wrapper.appendChild(this.progressBar);

    },


    render: function() {

        if (!this.ready) return;

        this.progressBar.style.width = (this.current * 100 | 0) + "%";


    }

};

/* file: src/Pool.js */

(function() {

    var lib = {

        pools: new Map,

        resetMethod: "reset",

        getPool: function(constructor) {

            var pool = this.pools.get(constructor);

            if (!pool) {

                this.pools.set(constructor, []);

                return this.getPool(constructor);

            }

            return pool;

        },

        pull: function(constructor, args) {

            var pool = this.getPool(constructor);

            if (!pool.length) {

                for (var i = 0; i < 10; i++) {

                    pool.push(new constructor());

                }

            }

            var result = pool.pop();

            result[this.resetMethod](args);

            return result;

        },

        push: function(object) {

            var pool = this.getPool(object.constructor);

            pool.push(object);

        }

    };

    /* API */

    var api = function() {

        if (typeof arguments[0] === "function") {

            return lib.pull(arguments[0], arguments[1]);

        } else {

            return lib.push(arguments[0]);

        }

    };

    api.pull = lib.pull.bind(lib);
    api.push = lib.push.bind(lib);

    PLAYGROUND.Application.prototype.pool = api;

})();

/* file: ../../playground-webgl/playground-webgl.js */

/* shader loader */

PLAYGROUND.Application.prototype.loadShader = function(path) {

    let gl = this.gl;

    if (!this.shaders) this.shaders = {};

    let app = this;

    this.loader.add();

    let entry = this.getAssetEntry(path, "shaders", "glsl");

    let type = path.indexOf("_vertex") > -1 ? "vertex" : "fragment";

    return fetch(entry.url).then((response) => {

        return response.text();

}).then((text) => {

        let result = null;
    let shader = gl.createShader(type === "vertex" ? gl.VERTEX_SHADER : gl.FRAGMENT_SHADER);

    gl.shaderSource(shader, text);
    gl.compileShader(shader);

    var success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);

    if (success) {

        let asset = {
            native: shader,
            variables: {}
        };

        result = asset;

        let regexp = /(uniform|attribute) (.*) (.*);/g;
        let match;

        while (match = regexp.exec(text)) {

            let qualifier = match[1].trim();
            let type = match[2].trim();
            let name = match[3].trim();

            asset.variables[name] = {
                qualifier,
                type
            }

        }

        app.insertAsset(asset, this.shaders, entry.key);

    } else {

        console.log("Error in shader ", entry.key)
        console.log(gl.getShaderInfoLog(shader));

    }

    this.loader.success();

    return result;

});

};


PLAYGROUND.ProgramAsset = function(app, vertexShaderAsset, fragmentShaderAsset) {

    this.app = app;

    let gl = app.gl;

    let program = gl.createProgram();

    this.program = this.native = program;
    this.variables = {};

    gl.attachShader(program, vertexShaderAsset.native);
    gl.attachShader(program, fragmentShaderAsset.native);

    gl.linkProgram(program);

    var success = gl.getProgramParameter(program, gl.LINK_STATUS);

    if (success) {

        Object.assign(this.variables, vertexShaderAsset.variables, fragmentShaderAsset.variables);

    } else {

        console.log(gl.getProgramInfoLog(program));

        return null;

    }

    this.locations = {};

    for (let name in this.variables) {

        let def = this.variables[name];

        if (def.qualifier === "uniform") def.location = gl.getUniformLocation(program, name);
        else if (def.qualifier === "attribute") def.location = gl.getAttribLocation(program, name);

        this.locations[name] = def.location;

    }

};

Object.assign(PLAYGROUND.ProgramAsset.prototype, {

    set(name, a, b, c, d) {

        let def = this.variables[name];

        if (def.qualifier === "uniform") {

            if (def.type === "float") this.app.gl.uniform1f(def.location, a);
            else if (def.type === "bool") this.app.gl.uniform1i(def.location, a);
            else if (def.type === "vec2") this.app.gl.uniform2f(def.location, a, b);
            else if (def.type === "vec3") this.app.gl.uniform3f(def.location, a, b, c, d);
            else if (def.type === "vec4") this.app.gl.uniform4f(def.location, a, b, c, d);
            else if (def.type === "mat3") this.app.gl.uniformMatrix3fv(def.location, false, a);
            else if (def.type === "mat4") this.app.gl.uniformMatrix4fv(def.location, false, a);
            else if (def.type === "sampler2D") this.app.gl.uniform1i(def.location, a);

        }


    }

});


PLAYGROUND.Application.prototype.loadProgram = function(programName, vertexPath, fragmentPath) {

    let gl = this.gl;

    if (!this.programs) this.programs = {};

    this.loader.add();

    return Promise.all([this.loadShader(vertexPath), this.loadShader(fragmentPath)])

    .then((shaders) => {

        var programAsset = new PLAYGROUND.ProgramAsset(this, shaders[0], shaders[1]);

    this.programs[programName] = programAsset;

    this.loader.success();

    return programAsset;

});

}

PLAYGROUND.Application.prototype.nearestPOT = function(value, pow) {

    pow = pow || 1;

    while (pow < value) {

        pow *= 2;

    }

    return pow;

};

PLAYGROUND.Application.prototype.shouldUsePalette = function(url) {

};

PLAYGROUND.Application.prototype.loadTexture = function(path, options = {}) {

    let app = this;

    if (!this.textures) this.textures = {};

    let gl = this.gl;

    let entry = this.getAssetEntry(path, "textures", "png");

    var image = new Image();

    this.loader.add();

    image.src = entry.url;

    if (this.promises[entry.url]) return this.promises[entry.url];

    return this.promises[entry.url] = new Promise(function(resolve, reject) {

        image.addEventListener('load', function() {

            let texture = gl.createTexture();

            // Now that the image has loaded make copy it to the texture.

            let canvas = document.createElement("canvas");

            canvas.width = app.nearestPOT(image.width);
            canvas.height = app.nearestPOT(image.height);

            canvas.getContext("2d").drawImage(image, 0, 0);

            if (app.shouldUsePalette(entry.url) || options.usePalette) {

                cq(canvas).matchPalette(cq.palettes.db32).swapColors(app.paletteMap);

                texture.paletteReady = true;

            }

            gl.bindTexture(gl.TEXTURE_2D, texture);
            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);

            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);

            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

            gl.generateMipmap(gl.TEXTURE_2D);

            texture.width = canvas.width;
            texture.height = canvas.height;

            texture.originalWidth = image.width;
            texture.originalHeight = image.height;
            texture.src = entry.url;

            app.insertAsset(texture, app.textures, entry.key);

            app.loader.success();

            resolve(texture)

        });

    });

};

PLAYGROUND.Application.prototype.textureFromCanvas = function(canvas) {

    let gl = this.gl;

    let texture = gl.createTexture();

    gl.bindTexture(gl.TEXTURE_2D, texture);
    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
    gl.generateMipmap(gl.TEXTURE_2D);

    gl.bindTexture(gl.TEXTURE_2D, null);

    texture.width = canvas.width;
    texture.height = canvas.height;

    return texture;

}

/* file: script/lib/playground.painter.js */

PLAYGROUND.Painter = function(app) {

    this.values = {

        color: app.color(),
        rotation: 0.0,
        alpha: 1.0,
        creation: 0.0,
        dissolve: 0.0,
        range: [],
        align: {
            x: 0.5,
            y: 0.5
        },
        scale: {
            x: 0.0,
            y: 0.0
        },
        translation: {
            x: 0.0,
            y: 0.0
        },

        font: null,
        textAlign: "center"
    };

    this.app = app;
    this.matrix = Matrix3.create();

    app.loadProgram("image", "image_vertex", "image_fragment");

};

PLAYGROUND.Painter.prototype = {

    _region: [],
    _trim: [],

    white: {
        r: 1.0,
        g: 1.0,
        b: 1.0,
        a: 1.0
    },

    transparent: {
        r: 1.0,
        g: 1.0,
        b: 1.0,
        a: 0.0
    },

    reset() {

        this.values.alpha = 1.0;
        this.values.translation.x = 0.0;
        this.values.translation.y = 0.0;
        this.values.align.x = 0.5;
        this.values.align.y = 0.5;
        this.values.scale.x = 1.0;
        this.values.scale.y = 1.0;
        this.values.rotation = 0.0;
        this.values.dissolve = 0.0;
        this.values.creation = 0.0;
        this.values.palette = -1.0;

        this.values.range.length = 0;

        this.values.color.set(0x000000, 0.0);


        this.values.textAlign = "center";
        this.values.font = this.app.fonts.default;

    },

    range(a, b) {

        if (arguments.length === 0) {

            this.values.range.length = 0;

        } else {

            this.values.range[0] = a;
            this.values.range[1] = b;

        }

    },

    textAlign(textAlign) {

        this.values.textAlign = textAlign;

        return this;

    },

    palette(palette) {

        this.values.palette = palette;

        return this;

    },

    alpha(alpha) {

        this.values.alpha = alpha;

        return this;

    },

    rotate(rotation) {

        this.values.rotation = rotation;

        return this;

    },

    parseColor(color, temp) {

        if (temp.num === color) return temp;

        temp.r = (color / 65536 % 256 | 0) / 255.0;
        temp.g = (color / 256 % 256 | 0) / 255.0;
        temp.b = (color % 256) / 255.0;
        temp.a = 1.0;
        temp.num = color;

        return temp;

    },

    font(font) {

        if (typeof font === "string") font = app.fonts[font];

        this.values.font = font;

        return this;

    },

    color(color, alpha = 1.0) {

        if (color < 0) alpha = 0.0;

        this.values.color.set(color, alpha);

        return this;

    },

    dissolve(dissolve) {

        this.values.dissolve = dissolve;

        return this;

    },

    creation(creation) {

        this.values.creation = creation;

        return this;

    },

    align(x, y) {

        this.values.align.x = x;
        this.values.align.y = y;

        return this;

    },

    scale(x, y) {

        this.values.scale.x = x;
        this.values.scale.y = y;

    },


    translate(x, y) {

        this.values.translation.x = x;
        this.values.translation.y = y;

    },

    updateMatrix(x, y, width, height) {

        Matrix3.reset(this.matrix);
        Matrix3.translate(this.matrix, x | 0, y | 0);

        if (this.values.translation.x || this.values.translation.y) Matrix3.translate(this.matrix, this.values.translation.x, this.values.translation.y);

        if (this.values.rotation) Matrix3.rotate(this.matrix, -this.values.rotation);

        Matrix3.translate(this.matrix, (-width * this.values.align.x) * this.values.scale.x | 0, (-height * this.values.align.y) * this.values.scale.y | 0);

        if (this.values.scale.x !== 1.0 || this.values.scale.y !== 1.0) Matrix3.scale(this.matrix, this.values.scale.x, this.values.scale.y);

    },

    drawImage(texture, x, y) {

        let gl = this.app.gl;
        let program = this.app.programs.image;

        gl.enable(gl.BLEND);
        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);
        gl.useProgram(program.native);

        /* Position */

        gl.enableVertexAttribArray(program.locations.position);
        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        gl.enableVertexAttribArray(program.locations.uv);
        gl.bindTexture(gl.TEXTURE_2D, texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        program.set("width", texture.width);
        program.set("height", texture.height);
        program.set("alpha", this.values.alpha);
        program.set("creation", this.values.creation);

        program.set("tx", 0.0);
        program.set("ty", 0.0);
        program.set("tw", 1.0);
        program.set("th", 1.0);

        program.set("texture", 0);
        program.set("color", this.values.color.r, this.values.color.g, this.values.color.b, this.values.color.a * this.values.alpha);

        this.updateMatrix(x, y, texture.width, texture.height);

        program.set("modelMatrix", this.matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    },


    drawImageRegion(texture, srcX, srcY, srcW, srcH, dstX, dstY, dstW = 0, dstH = 0) {

        dstW = dstW || srcW;
        dstH = dstH || srcH;

        let gl = this.app.gl;
        let program = this.app.programs.image;

        gl.enable(gl.BLEND);
        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);
        gl.useProgram(program.native);

        /* Position */

        gl.enableVertexAttribArray(program.locations.position);
        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        gl.enableVertexAttribArray(program.locations.uv);
        gl.bindTexture(gl.TEXTURE_2D, texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        program.set("width", dstW);
        program.set("height", dstH);
        program.set("alpha", this.values.alpha);
        program.set("color", this.values.color.r, this.values.color.g, this.values.color.b, this.values.color.a * this.values.alpha);
        program.set("creation", this.values.creation);

        program.set("tx", srcX / texture.width);
        program.set("ty", srcY / texture.height);
        program.set("tw", srcW / texture.width);
        program.set("th", srcH / texture.height);

        program.set("texture", 0);

        this.updateMatrix(dstX, dstY, dstW, dstH);

        program.set("modelMatrix", this.matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    },

    drawSprite(sprite, x, y, frame = 0, row = 0) {

        if (typeof sprite === "string") {

            if (!this.app.sprites[sprite]) return app.loadSprite(sprite);

            sprite = this.app.sprites[sprite];

        }

        if (this.values.range.length) {

            let frames = this.values.range[1] - this.values.range[0];

            frame = this.values.range[0] + (frame % frames | 0);

        } else {

            frame = frame % sprite.frames | 0;
        }

        row = row % sprite.rows | 0;

        let gl = app.gl;
        let program = app.programs.sprite;

        /* Alpha */

        gl.enable(gl.BLEND);
        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);

        /* Assign shaders */

        gl.useProgram(program.native);

        /* Position */

        gl.enableVertexAttribArray(program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        gl.activeTexture(gl.TEXTURE1);
        gl.bindTexture(gl.TEXTURE_2D, app.textures.palette);

        gl.activeTexture(gl.TEXTURE0);
        gl.bindTexture(gl.TEXTURE_2D, sprite.texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

        gl.enableVertexAttribArray(program.locations.uv);
        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        let absFrame = row * sprite.frames + frame;

        let regionIndex = absFrame * 4;

        this._region[0] = sprite.regions[regionIndex + 0];
        this._region[1] = sprite.regions[regionIndex + 1];
        this._region[2] = sprite.regions[regionIndex + 2];
        this._region[3] = sprite.regions[regionIndex + 3];

        let trimIndex = absFrame * 2;

        if (sprite.trim) {

            this._trim[0] = sprite.trim[trimIndex + 0];
            this._trim[1] = sprite.trim[trimIndex + 1];

        } else {

            this._trim[0] = 0;
            this._trim[1] = 0;

        }

        let palette = this.values.palette;

        if (palette < 0 && sprite.texture.paletteReady) palette = 0;

        program.set("texture", 0);
        program.set("paletteTexture", 1);
        program.set("palette", palette);
        program.set("dissolve", this.values.dissolve);
        program.set("creation", this.values.creation);

        program.set("rw", this._region[2]);
        program.set("rh", this._region[3]);

        program.set("alpha", this.values.alpha);
        program.set("tx", this._region[0] / sprite.texture.width);
        program.set("ty", this._region[1] / sprite.texture.height);
        program.set("tw", this._region[2] / sprite.texture.width);
        program.set("th", this._region[3] / sprite.texture.height);
        program.set("color", this.values.color.r, this.values.color.g, this.values.color.b, this.values.color.a);

        this.updateMatrix(x, y, sprite.width, sprite.height);
        Matrix3.translate(this.matrix, this._trim[0], this._trim[1]);

        program.set("modelMatrix", this.matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    },

    textCache: {},

    getTextCache(text, font) {

        let key = font.id + "--" + text;

        if (!this.textCache[key]) {

            let batch = new CLIENT.ImageBatch();

            let x = 0;
            let y = 0;

            for (var i = 0; i < text.length; i++) {

                let letter = text[i];

                if (letter === "\n") {

                    y += font.height + 1;
                    x = 0;

                } else if (letter === " ") {

                    x += font.spaceWidth;

                    continue;

                }

                if (!font.regions[letter]) continue;

                let sprite = batch.add();
                let region = font.regions[letter];

                sprite.setSprite(region[0], region[1], region[2], region[3]);
                sprite.setRegion(x, y, region[2], region[3]);

                x += 1 + region[2];

            }

            batch.width = x - 1;
            batch.program = app.programs.text;

            this.textCache[key] = batch;

        }

        return this.textCache[key];

    },

    fillText(text, x, y) {

        let batch = this.getTextCache(text, this.values.font);

        batch.color = this.values.color;
        batch.dissolve = this.values.dissolve;
        batch.alpha = this.values.alpha;

        if (this.values.textAlign === "center") batch.x = x - (batch.width * this.values.scale.x) / 2 | 0;
        else if (this.values.textAlign === "right") batch.x = x - (batch.width * this.values.scale.x);
        else batch.x = x;

        batch.scale.x = this.values.scale.x;
        batch.scale.y = this.values.scale.y;

        batch.y = y;
        batch.render();

    },

    fillCircle(x, y, radius) {

        let gl = this.app.gl;
        let program = app.programs.circle;

        /* Alpha */

        gl.enable(gl.BLEND);
        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);

        /* Assign shaders */

        gl.useProgram(program.native);

        /* Position */

        gl.enableVertexAttribArray(program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.app.quad);
        gl.vertexAttribPointer(program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        if (this.values.texture) {

            gl.activeTexture(gl.TEXTURE0);

            gl.bindTexture(gl.TEXTURE_2D, this.values.texture);

            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

            program.set("texture", 0);

        }

        gl.enableVertexAttribArray(program.locations.uv);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.app.quad);
        gl.vertexAttribPointer(program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        program.set("radius", radius);

        program.set("color", this.values.color.r, this.values.color.g, this.values.color.b, this.values.color.a * this.values.alpha);

        this.updateMatrix(x, y, radius * 2.0, radius * 2.0);

        program.set("modelMatrix", this.matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    },

    fillRect(x, y, w, h) {

        let gl = this.app.gl;
        let program = app.programs.rect;

        /* Alpha */

        gl.enable(gl.BLEND);
        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);

        /* Assign shaders */

        gl.useProgram(program.native);

        /* Position */

        gl.enableVertexAttribArray(program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.app.quad);
        gl.vertexAttribPointer(program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        program.set("width", w);
        program.set("height", h);
        program.set("color", this.values.color.r, this.values.color.g, this.values.color.b, this.values.color.a * this.values.alpha);

        this.updateMatrix(x, y, w, h);

        program.set("modelMatrix", this.matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    }


};

/* file: script/lib/playground.color.js */

PLAYGROUND.Color = function(hex = 0, alpha = 1.0) {

    this.r = 1.0;
    this.g = 1.0;
    this.b = 1.0;
    this.a = 1.0;
    this.num = 0.0;

    this.set(hex, alpha);

};

PLAYGROUND.Color.prototype = {

    set(hex = 0.0, alpha = 1.0) {

        this.a = alpha;

        if (this.num !== hex) {

            this.num = hex;

            this.r = (hex / 65536 % 256 | 0) / 255.0;
            this.g = (hex / 256 % 256 | 0) / 255.0;
            this.b = (hex % 256) / 255.0;


        }

    }

};

PLAYGROUND.Application.prototype.color = function(hex = 0, alpha = 1.0) {

    return new PLAYGROUND.Color(hex, alpha);

};

/* file: script/lib/playground.soundondemand.js */

/*

  SoundOnDemand r24

  (c) 2012-2017 http://rezoner.net

  This library may be freely distributed under the MIT license.

*/
/* options */

/* output: output node, default */
/* audioContext: audioContext */

if (!window.AudioContext) {

    window.AudioContext = window.webkitAudioContext;

    if (!window.AudioContext.prototype.createStereoPanner) {

        window.AudioContext.prototype.createStereoPanner = function() {

            var node = this.createGain();

            node.pan = {
                value: 0
            };

            return node;

        }

    }

}

window.SoundOnDemand = function(options) {

    options = options || {};

    var canPlayMp3 = (new Audio).canPlayType("audio/mp3");
    var canPlayOgg = (new Audio).canPlayType('audio/ogg; codecs="vorbis"');

    if (this.preferedAudioFormat === "mp3") {

        if (canPlayMp3) this.audioFormat = "mp3";
        else this.audioFormat = "ogg";

    } else {

        if (canPlayOgg) this.audioFormat = "ogg";
        else this.audioFormat = "mp3";

    }

    this.audioContext = options.audioContext || new AudioContext;



    this.gainNode = this.audioContext.createGain()
    this.gainNode.connect(this.audioContext.destination);

    this.input = this.gainNode;

    this.gainNode.gain.value = 1.0;

    this.buffers = {};

    this.channels = {};
    this.aliases = {};

    var lastTick = Date.now();
    var engine = this;

    setInterval(function() {

        var delta = (Date.now() - lastTick) / 1000;

        lastTick = Date.now();

        engine.step(delta);

    }, 1000 / 30);

};

SoundOnDemand.moveTo = function(value, target, step) {

    if (value < target) {
        value += step;
        if (value > target) value = target;
    }

    if (value > target) {
        value -= step;
        if (value < target) value = target;
    }

    return value;

};

SoundOnDemand.prototype = {

    constructor: SoundOnDemand,

    path: "sounds/",

    channel: function(name) {

        if (!this.channels[name]) this.channels[name] = new SoundOnDemand.Channel(this);

        return this.channels[name];

    },

    getAssetEntry: function(path, defaultExtension) {

        /* translate folder according to user provided paths
       or leave as is */

        var fileinfo = path.match(/(.*)\..*/);
        var key = fileinfo ? fileinfo[1] : path;

        var temp = path.split(".");
        var basename = path;

        if (temp.length > 1) {
            var ext = temp.pop();
            path = temp.join(".");
        } else {
            var ext = defaultExtension;
            basename += "." + defaultExtension;
        }

        var url;

        if (app && app.rewriteURL) {

            url = app.rewriteURL(this.path + basename);

        } else {

            url = this.path + basename;

        }

        return {
            key: key,
            url: url,
            path: this.path + path,
            ext: ext
        };

    },

    loaders: {},

    load: function(key) {

        var engine = this;
        var entry = engine.getAssetEntry(key, engine.audioFormat);

        if (!this.loaders[key]) {

            this.loaders[key] = new Promise(function(resolve, reject) {

                if (engine.buffers[entry.key]) return resolve(engine.buffers[entry.key]);

                var request = new XMLHttpRequest();

                request.open("GET", entry.url, true);
                request.responseType = "arraybuffer";

                request.onload = function() {

                    engine.audioContext.decodeAudioData(this.response, function(decodedBuffer) {

                        engine.buffers[entry.key] = decodedBuffer;
                        resolve(decodedBuffer);

                    });

                }

                request.send();

            });

        }

        return this.loaders[key];

    },

    step: function(delta) {

        for (var key in this.channels) {

            this.channels[key].step(delta);

        }

    },

    duplicate: function(source, as, volume, rate) {

        var engine = this;

        this.load(source).then(function() {

            engine.buffers[source];

            engine.buffers[as] = engine.buffers[source];

        });

    },

    alias: function(name, source, rate, volume) {

        this.aliases[name] = {
            source: source,
            rate: rate,
            volume: volume
        };

    }

};SoundOnDemand.Events = function() {

    this.listeners = {};

};

SoundOnDemand.Events.prototype = {

    on: function(event, callback) {

        if (typeof event === "object") {
            var result = {};
            for (var key in event) {
                result[key] = this.on(key, event[key])
            }
            return result;
        }

        if (!this.listeners[event]) this.listeners[event] = [];

        this.listeners[event].push(callback);

        return callback;
    },

    once: function(event, callback) {

        callback.once = true;

        if (!this.listeners[event]) this.listeners[event] = [];

        this.listeners[event].push(callback);

        return callback;

    },

    off: function(event, callback) {

        for (var i = 0, len = this.listeners[event].length; i < len; i++) {
            if (this.listeners[event][i]._remove) {
                this.listeners[event].splice(i--, 1);
                len--;
            }
        }

    },

    trigger: function(event, data) {

        /* if you prefer events pipe */

        if (this.listeners["event"]) {
            for (var i = 0, len = this.listeners["event"].length; i < len; i++) {
                this.listeners["event"][i](event, data);
            }
        }

        /* or subscribed to single event */

        if (this.listeners[event]) {
            for (var i = 0, len = this.listeners[event].length; i < len; i++) {
                var listener = this.listeners[event][i];
                listener.call(this, data);

                if (listener.once) {
                    this.listeners[event].splice(i--, 1);
                    len--;
                }
            }
        }

    }

};SoundOnDemand.Channel = function(engine) {

    this.engine = engine;
    this.audioContext = engine.audioContext;

    /* connection order goes from bottom to top */

    /* gain node */

    this.gainNode = this.audioContext.createGain();

    /* convolver */

    this.convolverWetNode = this.audioContext.createGain();
    this.convolverDryNode = this.audioContext.createGain();


    this.convolverEnabled = false;

    this.compressorEnabled = true;

    this.route();

    this.queue = [];

    this.concurentSounds = 0;
    this.soundsThisStep = 0;

};

SoundOnDemand.Channel.prototype = {

    constructor: SoundOnDemand.Channel,

    get: function(key) {

        return new SoundOnDemand.Sound(key, this);

    },

    play: function(key) {

        if (this.mutedWith) key = this.mutedWith;

        var sound = this.get(key);

        this.add(sound);

        this.soundsThisStep++;

        if (this.concurentSounds && this.soundsThisStep > this.concurentSounds) sound.cancel = true;

        return sound;

    },

    remove: function(sound) {

        sound._remove = true;

    },

    add: function(sound) {

        sound._remove = false;

        if (this.queue.indexOf(sound) > -1) return;

        this.queue.push(sound);

    },

    step: function(delta) {

        this.soundsThisStep = 0;

        /* process queue */

        for (var i = 0; i < this.queue.length; i++) {

            var sound = this.queue[i];

            if (sound._remove) {

                this.queue.splice(i--, 1);

                continue;

            }

            sound.step(delta);

        }

    },

    muteWith: function(key) {

        this.mutedWith = key;

    },

    volume: function(value) {

        this.gainNode.gain.value = value;

        return this;

    },

    swapConvolver: function(key) {

        var engine = this.engine;
        var channel = this;

        return new Promise(function(resolve, fail) {

            if (channel.currentConvolverImpulse === key) {

                resolve();

            } else {

                engine.load(key).then(function(buffer) {
                    channel.currentConvolverImpulse = key;
                    channel.convolverNode.buffer = buffer;
                    resolve();
                });

            }

        });

    },

    updateConvovlerState: function(enabled) {

        this.convolverEnabled = enabled;
        this.route();

    },

    subroute: function(nodes) {

        for (var i = 0; i < nodes.length; i++) {

            if (i < nodes.length - 1) {

                var node = nodes[i];
                node.disconnect();
                node.connect(nodes[i + 1]);

            }

        }

        this.input = nodes[0];

    },

    disconnect() {
        this.gainNode.disconnect();

    },

    reconnect() {

        this.route();

    },

    route: function() {

        this.gainNode.disconnect();

        if (this.convolverEnabled && this.audioContext.createConvolver) {

            this.convolverNode = this.audioContext.createConvolver();

            this.gainNode.connect(this.convolverDryNode);

            this.gainNode.connect(this.convolverNode);
            this.convolverNode.connect(this.convolverWetNode);

            this.convolverWetNode.connect(this.engine.input);
            this.convolverDryNode.connect(this.engine.input);
            this.input = this.gainNode;

        } else if (this.compressorEnabled && this.audioContext.createDynamicsCompressor) {

            this.gainNode.connect(this.engine.input);

            if (!this.compressor) {

                this.compressor = this.audioContext.createDynamicsCompressor();

                this.compressor.threshold.value = -50;
                this.compressor.knee.value = 40;
                this.compressor.ratio.value = 12;
                this.compressor.attack.value = 0;
                this.compressor.release.value = 0.25;

            }

            this.compressor.connect(this.gainNode);

            this.input = this.compressor;

        } else {

            this.gainNode.connect(this.engine.input);
            this.input = this.gainNode;

        }


    },

    convolver: function(value, key) {

        var enabled = value > 0;
        var channel = this;

        this.swapConvolver(key).then(function() {

            if (enabled !== channel.convolverEnabled) channel.updateConvovlerState(enabled);

        });

        this.convolverWetNode.gain.value = value;
        this.convolverDryNode.gain.value = 1 - value;

        return this;

    }

};SoundOnDemand.Sound = function(key, channel) {

    this.key = key;
    this.bufferKey = key;
    this.delayTimeout = 0;
    this.paused = false;

    if (channel.engine.aliases[key]) {

        this.alias = channel.engine.aliases[key];

        this.bufferKey = this.alias.source;

    }

    if (!channel.engine.buffers[this.bufferKey]) channel.engine.load(this.bufferKey);

    this.channel = channel;
    this.audioContext = this.channel.engine.audioContext;

    this.current = {
        volume: 1.0,
        rate: 1.0
    };

    this.fadeMod = 1.0;

    this.createNodes();

};

SoundOnDemand.Sound.prototype = {

    constructor: SoundOnDemand.Sound,

    alias: {
        volume: 1.0,
        rate: 1.0
    },

    createNodes: function() {

        var bufferSource = this.audioContext.createBufferSource();
        var gainNode = this.audioContext.createGain();
        var panNode = this.audioContext.createStereoPanner();

        bufferSource.connect(panNode);
        panNode.connect(gainNode);
        gainNode.connect(this.channel.input);

        this.bufferSource = bufferSource;
        this.gainNode = gainNode;
        this.panNode = panNode;

    },

    volume: function(volume) {

        volume *= this.alias.volume;

        this.current.volume = volume;

        this.updateVolume();

        return this;

    },

    volumef: function(volume) {

        return this.volume(this.current.volume * volume);

    },

    delay: function(time) {

        this.delayTimeout = time;

        return this;

    },

    updateVolume: function() {

        this.gainNode.gain.value = this.current.volume * this.fadeMod;

    },

    pan: function(pan) {

        if (pan < -1.0) pan = -1.0;
        if (pan > 1.0) pan = 1.0;

        this.current.pan = pan;

        this.updatePanning();

        return this;

    },

    updatePanning: function() {

        this.panNode.pan.value = this.current.pan;

    },

    loop: function(start = 0, end = 0) {

        this.bufferSource.loop = true;
        this.current.loop = true;

        this.bufferSource.loopStart = start;

        if (end) this.bufferSource.loopEnd = end;

        return this;

    },

    rrate: function(range) {

        return this.rate(this.current.rate + (-1 + Math.random() * 2) * range);

    },

    nrate: function(range) {

        return this.rate(this.current.rate - Math.random() * range);

    },

    prate: function(range) {

        return this.rate(this.current.rate + Math.random() * range);

    },

    rate: function(rate) {

        rate *= this.alias.rate;

        this.bufferSource.playbackRate.value = rate;

        this.current.rate = rate;

        return this;

    },

    rateTo: function(target, duration) {

        if (!this.playing && this.ready) this.resume();

        duration = duration || 1.0;

        this.rateTime = 0;
        this.rateTarget = target;
        this.rateDuration = duration;

        this.rateSpeed = Math.abs(target - this.current.rate) / duration;

        return this;

    },

    onended: function() {

        if (!this.current.loop) this.stop();

    },

    step: function(delta) {

        if (this.cancel && !this.current.loop) {

            this.stop();

            return;

        }


        let updateVolume = false;

        if (this.delayTimeout > 0) {

            this.delayTimeout -= delta;

            return;

        }

        if (this.fadeTarget !== this.fadeMod) {

            updateVolume = true;

            this.fadeMod = SoundOnDemand.moveTo(this.fadeMod, this.fadeTarget, delta * this.fadeSpeed);

        } else if (this.fadeTarget === 0) {

            this.pause();

            return;

        }

        if (!this.ready) {

            if (!this.channel.engine.buffers[this.bufferKey]) return;

            this.ready = true;
            this.playing = true;

            this.buffer = this.channel.engine.buffers[this.bufferKey];

            this.bufferSource.buffer = this.buffer;

            this.bufferSource.start(0);
            this.bufferSource.onended = this.onended.bind(this);

            this.currentTime = 0;

            this.currentTime += this.bufferSource.playbackRate.value * delta;

        }

        if (updateVolume) this.updateVolume();

        if (this.rateTarget !== this.current.rate) {

            this.rate(SoundOnDemand.moveTo(this.current.rate, this.rateTarget, delta * this.rateSpeed));

        }

    },

    pause: function() {

        this.channel.remove(this);

        if (this.playing) this.bufferSource.stop(0);

        this.playing = false;

    },

    stop: function() {

        this.channel.remove(this);

        if (!this.playing) return;

        this.bufferSource.stop(0);

        this.playing = false;

    },

    play: function() {

        if (this.playing) return;

        this.createNodes();

        this.channel.add(this);

        this.ready = false;
        this.playing = false;

    },

    resume: function() {

        this.createNodes();

        this.bufferSource.buffer = this.buffer;

        this.currentTime = this.currentTime % this.buffer.duration;
        this.bufferSource.start(0, this.currentTime);

        this.rate(this.current.rate);
        this.volume(this.current.volume);
        this.loop(this.current.loop);

        this.channel.add(this);

        this.playing = true;

    },

    fadeTo: function(target, duration) {

        if (!this.playing && this.ready) this.resume();

        duration = duration || 1.0;

        this.fadeTime = 0;
        this.fadeTarget = target;
        this.fadeDuration = duration;

        this.fadeSpeed = Math.abs(target - this.fadeMod) / duration;

        return this;

    },

    fadeIn: function(duration) {

        if (!this.playing && this.ready) this.resume();

        this.fadeMod = 0;
        this.fadeTo(1.0, duration);

        return this;

    },

    fadeOut: function(duration) {

        this.fadeTo(0, duration || 1.0);

        return this;

    }

};PLAYGROUND.SoundOnDemand = function(app) {

    app.audio = new SoundOnDemand();

    app.audio.path = app.getPath("sounds");

    app.loadSounds = function() {

        for (var i = 0; i < arguments.length; i++) {

            var key = arguments[i];

            this.loader.add();

            this.audio.load(key).then(
                this.loader.success.bind(this.loader),
                this.loader.error.bind(this.loader)
            );

        }

    };

};

PLAYGROUND.SoundOnDemand.plugin = true;

/* file: script/lib/playground.ambient.js */

PLAYGROUND.Ambient = function(app) {

    let loops = {};
    let sounds = {};

    function step() {

        for (var key in sounds) {

            sounds[key] -= 0.25;

            if (sounds[key] <= 0) {

                delete sounds[key];
                loops[key].fadeOut(0.25);
                loops[key] = null;
            }


        }

    }

    setInterval(step, 250);

    app.ambient = function(sound, volume = 1.0, rate = 1.0) {

        sounds[sound] = 0.5;

        if (!loops[sound]) loops[sound] = app.sound.play(sound).loop().volume(volume).rate(rate).fadeIn(0.25);

    }


};

PLAYGROUND.Ambient.plugin = true;

/* file: script/lib/glmatrix.js */

/**
 * @fileoverview gl-matrix - High performance matrix and vector operations
 * @author Brandon Jones
 * @author Colin MacKenzie IV
 * @version 2.4.0
 */

/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE. */

!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var r=n();for(var a in r)("object"==typeof exports?exports:t)[a]=r[a]}}(this,function(){return function(t){function n(a){if(r[a])return r[a].exports;var e=r[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var r={};return n.m=t,n.c=r,n.d=function(t,r,a){n.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:a})},n.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(r,"a",r),r},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=4)}([function(t,n,r){"use strict";function a(t){n.ARRAY_TYPE=i=t}function e(t){return t*s}function u(t,n){return Math.abs(t-n)<=o*Math.max(1,Math.abs(t),Math.abs(n))}Object.defineProperty(n,"__esModule",{value:!0}),n.setMatrixArrayType=a,n.toRadian=e,n.equals=u;var o=n.EPSILON=1e-6,i=n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,s=(n.RANDOM=Math.random,Math.PI/180)},function(t,n,r){"use strict";function a(){var t=new g.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function e(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t}function u(t){var n=new g.ARRAY_TYPE(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function o(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function i(t,n,r,a,e,u,o,i,s){var c=new g.ARRAY_TYPE(9);return c[0]=t,c[1]=n,c[2]=r,c[3]=a,c[4]=e,c[5]=u,c[6]=o,c[7]=i,c[8]=s,c}function s(t,n,r,a,e,u,o,i,s,c){return t[0]=n,t[1]=r,t[2]=a,t[3]=e,t[4]=u,t[5]=o,t[6]=i,t[7]=s,t[8]=c,t}function c(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function f(t,n){if(t===n){var r=n[1],a=n[2],e=n[5];t[1]=n[3],t[2]=n[6],t[3]=r,t[5]=n[7],t[6]=a,t[7]=e}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}function M(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],s=n[6],c=n[7],f=n[8],M=f*o-i*c,h=-f*u+i*s,l=c*u-o*s,v=r*M+a*h+e*l;return v?(v=1/v,t[0]=M*v,t[1]=(-f*a+e*c)*v,t[2]=(i*a-e*o)*v,t[3]=h*v,t[4]=(f*r-e*s)*v,t[5]=(-i*r+e*u)*v,t[6]=l*v,t[7]=(-c*r+a*s)*v,t[8]=(o*r-a*u)*v,t):null}function h(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],s=n[6],c=n[7],f=n[8];return t[0]=o*f-i*c,t[1]=e*c-a*f,t[2]=a*i-e*o,t[3]=i*s-u*f,t[4]=r*f-e*s,t[5]=e*u-r*i,t[6]=u*c-o*s,t[7]=a*s-r*c,t[8]=r*o-a*u,t}function l(t){var n=t[0],r=t[1],a=t[2],e=t[3],u=t[4],o=t[5],i=t[6],s=t[7],c=t[8];return n*(c*u-o*s)+r*(-c*e+o*i)+a*(s*e-u*i)}function v(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],s=n[5],c=n[6],f=n[7],M=n[8],h=r[0],l=r[1],v=r[2],d=r[3],b=r[4],m=r[5],p=r[6],P=r[7],E=r[8];return t[0]=h*a+l*o+v*c,t[1]=h*e+l*i+v*f,t[2]=h*u+l*s+v*M,t[3]=d*a+b*o+m*c,t[4]=d*e+b*i+m*f,t[5]=d*u+b*s+m*M,t[6]=p*a+P*o+E*c,t[7]=p*e+P*i+E*f,t[8]=p*u+P*s+E*M,t}function d(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],s=n[5],c=n[6],f=n[7],M=n[8],h=r[0],l=r[1];return t[0]=a,t[1]=e,t[2]=u,t[3]=o,t[4]=i,t[5]=s,t[6]=h*a+l*o+c,t[7]=h*e+l*i+f,t[8]=h*u+l*s+M,t}function b(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],s=n[5],c=n[6],f=n[7],M=n[8],h=Math.sin(r),l=Math.cos(r);return t[0]=l*a+h*o,t[1]=l*e+h*i,t[2]=l*u+h*s,t[3]=l*o-h*a,t[4]=l*i-h*e,t[5]=l*s-h*u,t[6]=c,t[7]=f,t[8]=M,t}function m(t,n,r){var a=r[0],e=r[1];return t[0]=a*n[0],t[1]=a*n[1],t[2]=a*n[2],t[3]=e*n[3],t[4]=e*n[4],t[5]=e*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function p(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t}function P(t,n){var r=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=r,t[2]=0,t[3]=-r,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function E(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function O(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t}function x(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=r+r,i=a+a,s=e+e,c=r*o,f=a*o,M=a*i,h=e*o,l=e*i,v=e*s,d=u*o,b=u*i,m=u*s;return t[0]=1-M-v,t[3]=f-m,t[6]=h+b,t[1]=f+m,t[4]=1-c-v,t[7]=l-d,t[2]=h-b,t[5]=l+d,t[8]=1-c-M,t}function A(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],s=n[6],c=n[7],f=n[8],M=n[9],h=n[10],l=n[11],v=n[12],d=n[13],b=n[14],m=n[15],p=r*i-a*o,P=r*s-e*o,E=r*c-u*o,O=a*s-e*i,x=a*c-u*i,A=e*c-u*s,q=f*d-M*v,y=f*b-h*v,w=f*m-l*v,R=M*b-h*d,L=M*m-l*d,S=h*m-l*b,_=p*S-P*L+E*R+O*w-x*y+A*q;return _?(_=1/_,t[0]=(i*S-s*L+c*R)*_,t[1]=(s*w-o*S-c*y)*_,t[2]=(o*L-i*w+c*q)*_,t[3]=(e*L-a*S-u*R)*_,t[4]=(r*S-e*w+u*y)*_,t[5]=(a*w-r*L-u*q)*_,t[6]=(d*A-b*x+m*O)*_,t[7]=(b*E-v*A-m*P)*_,t[8]=(v*x-d*E+m*p)*_,t):null}function q(t,n,r){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function y(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function w(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function R(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t}function L(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t}function S(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t}function _(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t[2]=n[2]+r[2]*a,t[3]=n[3]+r[3]*a,t[4]=n[4]+r[4]*a,t[5]=n[5]+r[5]*a,t[6]=n[6]+r[6]*a,t[7]=n[7]+r[7]*a,t[8]=n[8]+r[8]*a,t}function I(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]}function N(t,n){var r=t[0],a=t[1],e=t[2],u=t[3],o=t[4],i=t[5],s=t[6],c=t[7],f=t[8],M=n[0],h=n[1],l=n[2],v=n[3],d=n[4],b=n[5],m=n[6],p=n[7],P=n[8];return Math.abs(r-M)<=g.EPSILON*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(a-h)<=g.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(e-l)<=g.EPSILON*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(u-v)<=g.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(o-d)<=g.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(i-b)<=g.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(s-m)<=g.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(c-p)<=g.EPSILON*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(f-P)<=g.EPSILON*Math.max(1,Math.abs(f),Math.abs(P))}Object.defineProperty(n,"__esModule",{value:!0}),n.sub=n.mul=void 0,n.create=a,n.fromMat4=e,n.clone=u,n.copy=o,n.fromValues=i,n.set=s,n.identity=c,n.transpose=f,n.invert=M,n.adjoint=h,n.determinant=l,n.multiply=v,n.translate=d,n.rotate=b,n.scale=m,n.fromTranslation=p,n.fromRotation=P,n.fromScaling=E,n.fromMat2d=O,n.fromQuat=x,n.normalFromMat4=A,n.projection=q,n.str=y,n.frob=w,n.add=R,n.subtract=L,n.multiplyScalar=S,n.multiplyScalarAndAdd=_,n.exactEquals=I,n.equals=N;var Y=r(0),g=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.default=t,n}(Y);n.mul=v,n.sub=L},function(t,n,r){"use strict";function a(){var t=new Z.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t}function e(t){var n=new Z.ARRAY_TYPE(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function u(t){var n=t[0],r=t[1],a=t[2];return Math.sqrt(n*n+r*r+a*a)}function o(t,n,r){var a=new Z.ARRAY_TYPE(3);return a[0]=t,a[1]=n,a[2]=r,a}function i(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function s(t,n,r,a){return t[0]=n,t[1]=r,t[2]=a,t}function c(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function f(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t}function M(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t}function h(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t}function l(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function v(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function d(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t}function b(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t}function m(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function p(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function P(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t[2]=n[2]+r[2]*a,t}function E(t,n){var r=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2];return Math.sqrt(r*r+a*a+e*e)}function O(t,n){var r=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2];return r*r+a*a+e*e}function x(t){var n=t[0],r=t[1],a=t[2];return n*n+r*r+a*a}function A(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function q(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function y(t,n){var r=n[0],a=n[1],e=n[2],u=r*r+a*a+e*e;return u>0&&(u=1/Math.sqrt(u),t[0]=n[0]*u,t[1]=n[1]*u,t[2]=n[2]*u),t}function w(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function R(t,n,r){var a=n[0],e=n[1],u=n[2],o=r[0],i=r[1],s=r[2];return t[0]=e*s-u*i,t[1]=u*o-a*s,t[2]=a*i-e*o,t}function L(t,n,r,a){var e=n[0],u=n[1],o=n[2];return t[0]=e+a*(r[0]-e),t[1]=u+a*(r[1]-u),t[2]=o+a*(r[2]-o),t}function S(t,n,r,a,e,u){var o=u*u,i=o*(2*u-3)+1,s=o*(u-2)+u,c=o*(u-1),f=o*(3-2*u);return t[0]=n[0]*i+r[0]*s+a[0]*c+e[0]*f,t[1]=n[1]*i+r[1]*s+a[1]*c+e[1]*f,t[2]=n[2]*i+r[2]*s+a[2]*c+e[2]*f,t}function _(t,n,r,a,e,u){var o=1-u,i=o*o,s=u*u,c=i*o,f=3*u*i,M=3*s*o,h=s*u;return t[0]=n[0]*c+r[0]*f+a[0]*M+e[0]*h,t[1]=n[1]*c+r[1]*f+a[1]*M+e[1]*h,t[2]=n[2]*c+r[2]*f+a[2]*M+e[2]*h,t}function I(t,n){n=n||1;var r=2*Z.RANDOM()*Math.PI,a=2*Z.RANDOM()-1,e=Math.sqrt(1-a*a)*n;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t[2]=a*n,t}function N(t,n,r){var a=n[0],e=n[1],u=n[2],o=r[3]*a+r[7]*e+r[11]*u+r[15];return o=o||1,t[0]=(r[0]*a+r[4]*e+r[8]*u+r[12])/o,t[1]=(r[1]*a+r[5]*e+r[9]*u+r[13])/o,t[2]=(r[2]*a+r[6]*e+r[10]*u+r[14])/o,t}function Y(t,n,r){var a=n[0],e=n[1],u=n[2];return t[0]=a*r[0]+e*r[3]+u*r[6],t[1]=a*r[1]+e*r[4]+u*r[7],t[2]=a*r[2]+e*r[5]+u*r[8],t}function g(t,n,r){var a=n[0],e=n[1],u=n[2],o=r[0],i=r[1],s=r[2],c=r[3],f=c*a+i*u-s*e,M=c*e+s*a-o*u,h=c*u+o*e-i*a,l=-o*a-i*e-s*u;return t[0]=f*c+l*-o+M*-s-h*-i,t[1]=M*c+l*-i+h*-o-f*-s,t[2]=h*c+l*-s+f*-i-M*-o,t}function T(t,n,r,a){var e=[],u=[];return e[0]=n[0]-r[0],e[1]=n[1]-r[1],e[2]=n[2]-r[2],u[0]=e[0],u[1]=e[1]*Math.cos(a)-e[2]*Math.sin(a),u[2]=e[1]*Math.sin(a)+e[2]*Math.cos(a),t[0]=u[0]+r[0],t[1]=u[1]+r[1],t[2]=u[2]+r[2],t}function j(t,n,r,a){var e=[],u=[];return e[0]=n[0]-r[0],e[1]=n[1]-r[1],e[2]=n[2]-r[2],u[0]=e[2]*Math.sin(a)+e[0]*Math.cos(a),u[1]=e[1],u[2]=e[2]*Math.cos(a)-e[0]*Math.sin(a),t[0]=u[0]+r[0],t[1]=u[1]+r[1],t[2]=u[2]+r[2],t}function D(t,n,r,a){var e=[],u=[];return e[0]=n[0]-r[0],e[1]=n[1]-r[1],e[2]=n[2]-r[2],u[0]=e[0]*Math.cos(a)-e[1]*Math.sin(a),u[1]=e[0]*Math.sin(a)+e[1]*Math.cos(a),u[2]=e[2],t[0]=u[0]+r[0],t[1]=u[1]+r[1],t[2]=u[2]+r[2],t}function V(t,n){var r=o(t[0],t[1],t[2]),a=o(n[0],n[1],n[2]);y(r,r),y(a,a);var e=w(r,a);return e>1?0:e<-1?Math.PI:Math.acos(e)}function z(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function F(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function Q(t,n){var r=t[0],a=t[1],e=t[2],u=n[0],o=n[1],i=n[2];return Math.abs(r-u)<=Z.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-o)<=Z.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(e-i)<=Z.EPSILON*Math.max(1,Math.abs(e),Math.abs(i))}Object.defineProperty(n,"__esModule",{value:!0}),n.forEach=n.sqrLen=n.len=n.sqrDist=n.dist=n.div=n.mul=n.sub=void 0,n.create=a,n.clone=e,n.length=u,n.fromValues=o,n.copy=i,n.set=s,n.add=c,n.subtract=f,n.multiply=M,n.divide=h,n.ceil=l,n.floor=v,n.min=d,n.max=b,n.round=m,n.scale=p,n.scaleAndAdd=P,n.distance=E,n.squaredDistance=O,n.squaredLength=x,n.negate=A,n.inverse=q,n.normalize=y,n.dot=w,n.cross=R,n.lerp=L,n.hermite=S,n.bezier=_,n.random=I,n.transformMat4=N,n.transformMat3=Y,n.transformQuat=g,n.rotateX=T,n.rotateY=j,n.rotateZ=D,n.angle=V,n.str=z,n.exactEquals=F,n.equals=Q;var X=r(0),Z=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.default=t,n}(X);n.sub=f,n.mul=M,n.div=h,n.dist=E,n.sqrDist=O,n.len=u,n.sqrLen=x,n.forEach=function(){var t=a();return function(n,r,a,e,u,o){var i=void 0,s=void 0;for(r||(r=3),a||(a=0),s=e?Math.min(e*r+a,n.length):n.length,i=a;i<s;i+=r)t[0]=n[i],t[1]=n[i+1],t[2]=n[i+2],u(t,t,o),n[i]=t[0],n[i+1]=t[1],n[i+2]=t[2];return n}}()},function(t,n,r){"use strict";function a(){var t=new T.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function e(t){var n=new T.ARRAY_TYPE(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function u(t,n,r,a){var e=new T.ARRAY_TYPE(4);return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e}function o(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function i(t,n,r,a,e){return t[0]=n,t[1]=r,t[2]=a,t[3]=e,t}function s(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t}function c(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t}function f(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t[3]=n[3]*r[3],t}function M(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t[3]=n[3]/r[3],t}function h(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t[3]=Math.ceil(n[3]),t}function l(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t[3]=Math.floor(n[3]),t}function v(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t[3]=Math.min(n[3],r[3]),t}function d(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t[3]=Math.max(n[3],r[3]),t}function b(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t[3]=Math.round(n[3]),t}function m(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t}function p(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t[2]=n[2]+r[2]*a,t[3]=n[3]+r[3]*a,t}function P(t,n){var r=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2],u=n[3]-t[3];return Math.sqrt(r*r+a*a+e*e+u*u)}function E(t,n){var r=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2],u=n[3]-t[3];return r*r+a*a+e*e+u*u}function O(t){var n=t[0],r=t[1],a=t[2],e=t[3];return Math.sqrt(n*n+r*r+a*a+e*e)}function x(t){var n=t[0],r=t[1],a=t[2],e=t[3];return n*n+r*r+a*a+e*e}function A(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function q(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t}function y(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=r*r+a*a+e*e+u*u;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=a*o,t[2]=e*o,t[3]=u*o),t}function w(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function R(t,n,r,a){var e=n[0],u=n[1],o=n[2],i=n[3];return t[0]=e+a*(r[0]-e),t[1]=u+a*(r[1]-u),t[2]=o+a*(r[2]-o),t[3]=i+a*(r[3]-i),t}function L(t,n){return n=n||1,t[0]=T.RANDOM(),t[1]=T.RANDOM(),t[2]=T.RANDOM(),t[3]=T.RANDOM(),y(t,t),m(t,t,n),t}function S(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3];return t[0]=r[0]*a+r[4]*e+r[8]*u+r[12]*o,t[1]=r[1]*a+r[5]*e+r[9]*u+r[13]*o,t[2]=r[2]*a+r[6]*e+r[10]*u+r[14]*o,t[3]=r[3]*a+r[7]*e+r[11]*u+r[15]*o,t}function _(t,n,r){var a=n[0],e=n[1],u=n[2],o=r[0],i=r[1],s=r[2],c=r[3],f=c*a+i*u-s*e,M=c*e+s*a-o*u,h=c*u+o*e-i*a,l=-o*a-i*e-s*u;return t[0]=f*c+l*-o+M*-s-h*-i,t[1]=M*c+l*-i+h*-o-f*-s,t[2]=h*c+l*-s+f*-i-M*-o,t[3]=n[3],t}function I(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function N(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function Y(t,n){var r=t[0],a=t[1],e=t[2],u=t[3],o=n[0],i=n[1],s=n[2],c=n[3];return Math.abs(r-o)<=T.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-i)<=T.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(e-s)<=T.EPSILON*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(u-c)<=T.EPSILON*Math.max(1,Math.abs(u),Math.abs(c))}Object.defineProperty(n,"__esModule",{value:!0}),n.forEach=n.sqrLen=n.len=n.sqrDist=n.dist=n.div=n.mul=n.sub=void 0,n.create=a,n.clone=e,n.fromValues=u,n.copy=o,n.set=i,n.add=s,n.subtract=c,n.multiply=f,n.divide=M,n.ceil=h,n.floor=l,n.min=v,n.max=d,n.round=b,n.scale=m,n.scaleAndAdd=p,n.distance=P,n.squaredDistance=E,n.length=O,n.squaredLength=x,n.negate=A,n.inverse=q,n.normalize=y,n.dot=w,n.lerp=R,n.random=L,n.transformMat4=S,n.transformQuat=_,n.str=I,n.exactEquals=N,n.equals=Y;var g=r(0),T=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.default=t,n}(g);n.sub=c,n.mul=f,n.div=M,n.dist=P,n.sqrDist=E,n.len=O,n.sqrLen=x,n.forEach=function(){var t=a();return function(n,r,a,e,u,o){var i=void 0,s=void 0;for(r||(r=4),a||(a=0),s=e?Math.min(e*r+a,n.length):n.length,i=a;i<s;i+=r)t[0]=n[i],t[1]=n[i+1],t[2]=n[i+2],t[3]=n[i+3],u(t,t,o),n[i]=t[0],n[i+1]=t[1],n[i+2]=t[2],n[i+3]=t[3];return n}}()},function(t,n,r){"use strict";function a(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.default=t,n}Object.defineProperty(n,"__esModule",{value:!0}),n.vec4=n.vec3=n.vec2=n.quat=n.mat4=n.mat3=n.mat2d=n.mat2=n.glMatrix=void 0;var e=r(0),u=a(e),o=r(5),i=a(o),s=r(6),c=a(s),f=r(1),M=a(f),h=r(7),l=a(h),v=r(8),d=a(v),b=r(9),m=a(b),p=r(2),P=a(p),E=r(3),O=a(E);n.glMatrix=u,n.mat2=i,n.mat2d=c,n.mat3=M,n.mat4=l,n.quat=d,n.vec2=m,n.vec3=P,n.vec4=O},function(t,n,r){"use strict";function a(){var t=new L.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function e(t){var n=new L.ARRAY_TYPE(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function u(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function o(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function i(t,n,r,a){var e=new L.ARRAY_TYPE(4);return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e}function s(t,n,r,a,e){return t[0]=n,t[1]=r,t[2]=a,t[3]=e,t}function c(t,n){if(t===n){var r=n[1];t[1]=n[2],t[2]=r}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t}function f(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=r*u-e*a;return o?(o=1/o,t[0]=u*o,t[1]=-a*o,t[2]=-e*o,t[3]=r*o,t):null}function M(t,n){var r=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=r,t}function h(t){return t[0]*t[3]-t[2]*t[1]}function l(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=r[0],s=r[1],c=r[2],f=r[3];return t[0]=a*i+u*s,t[1]=e*i+o*s,t[2]=a*c+u*f,t[3]=e*c+o*f,t}function v(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=Math.sin(r),s=Math.cos(r);return t[0]=a*s+u*i,t[1]=e*s+o*i,t[2]=a*-i+u*s,t[3]=e*-i+o*s,t}function d(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=r[0],s=r[1];return t[0]=a*i,t[1]=e*i,t[2]=u*s,t[3]=o*s,t}function b(t,n){var r=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=r,t[2]=-r,t[3]=a,t}function m(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t}function p(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function P(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}function E(t,n,r,a){return t[2]=a[2]/a[0],r[0]=a[0],r[1]=a[1],r[3]=a[3]-t[2]*r[1],[t,n,r]}function O(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t}function x(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t}function A(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function q(t,n){var r=t[0],a=t[1],e=t[2],u=t[3],o=n[0],i=n[1],s=n[2],c=n[3];return Math.abs(r-o)<=L.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-i)<=L.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(e-s)<=L.EPSILON*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(u-c)<=L.EPSILON*Math.max(1,Math.abs(u),Math.abs(c))}function y(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t}function w(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t[2]=n[2]+r[2]*a,t[3]=n[3]+r[3]*a,t}Object.defineProperty(n,"__esModule",{value:!0}),n.sub=n.mul=void 0,n.create=a,n.clone=e,n.copy=u,n.identity=o,n.fromValues=i,n.set=s,n.transpose=c,n.invert=f,n.adjoint=M,n.determinant=h,n.multiply=l,n.rotate=v,n.scale=d,n.fromRotation=b,n.fromScaling=m,n.str=p,n.frob=P,n.LDU=E,n.add=O,n.subtract=x,n.exactEquals=A,n.equals=q,n.multiplyScalar=y,n.multiplyScalarAndAdd=w;var R=r(0),L=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.default=t,n}(R);n.mul=l,n.sub=x},function(t,n,r){"use strict";function a(){var t=new R.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function e(t){var n=new R.ARRAY_TYPE(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function u(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function o(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function i(t,n,r,a,e,u){var o=new R.ARRAY_TYPE(6);return o[0]=t,o[1]=n,o[2]=r,o[3]=a,o[4]=e,o[5]=u,o}function s(t,n,r,a,e,u,o){return t[0]=n,t[1]=r,t[2]=a,t[3]=e,t[4]=u,t[5]=o,t}function c(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],s=r*u-a*e;return s?(s=1/s,t[0]=u*s,t[1]=-a*s,t[2]=-e*s,t[3]=r*s,t[4]=(e*i-u*o)*s,t[5]=(a*o-r*i)*s,t):null}function f(t){return t[0]*t[3]-t[1]*t[2]}function M(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],s=n[5],c=r[0],f=r[1],M=r[2],h=r[3],l=r[4],v=r[5];return t[0]=a*c+u*f,t[1]=e*c+o*f,t[2]=a*M+u*h,t[3]=e*M+o*h,t[4]=a*l+u*v+i,t[5]=e*l+o*v+s,t}function h(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],s=n[5],c=Math.sin(r),f=Math.cos(r);return t[0]=a*f+u*c,t[1]=e*f+o*c,t[2]=a*-c+u*f,t[3]=e*-c+o*f,t[4]=i,t[5]=s,t}function l(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],s=n[5],c=r[0],f=r[1];return t[0]=a*c,t[1]=e*c,t[2]=u*f,t[3]=o*f,t[4]=i,t[5]=s,t}function v(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],s=n[5],c=r[0],f=r[1];return t[0]=a,t[1]=e,t[2]=u,t[3]=o,t[4]=a*c+u*f+i,t[5]=e*c+o*f+s,t}function d(t,n){var r=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=r,t[2]=-r,t[3]=a,t[4]=0,t[5]=0,t}function b(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t}function m(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t}function p(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function P(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function E(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t}function O(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t}function x(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t}function A(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t[2]=n[2]+r[2]*a,t[3]=n[3]+r[3]*a,t[4]=n[4]+r[4]*a,t[5]=n[5]+r[5]*a,t}function q(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]}function y(t,n){var r=t[0],a=t[1],e=t[2],u=t[3],o=t[4],i=t[5],s=n[0],c=n[1],f=n[2],M=n[3],h=n[4],l=n[5];return Math.abs(r-s)<=R.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-c)<=R.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(e-f)<=R.EPSILON*Math.max(1,Math.abs(e),Math.abs(f))&&Math.abs(u-M)<=R.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(o-h)<=R.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(i-l)<=R.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))}Object.defineProperty(n,"__esModule",{value:!0}),n.sub=n.mul=void 0,n.create=a,n.clone=e,n.copy=u,n.identity=o,n.fromValues=i,n.set=s,n.invert=c,n.determinant=f,n.multiply=M,n.rotate=h,n.scale=l,n.translate=v,n.fromRotation=d,n.fromScaling=b,n.fromTranslation=m,n.str=p,n.frob=P,n.add=E,n.subtract=O,n.multiplyScalar=x,n.multiplyScalarAndAdd=A,n.exactEquals=q,n.equals=y;var w=r(0),R=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.default=t,n}(w);n.mul=M,n.sub=O},function(t,n,r){"use strict";function a(){var t=new C.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function e(t){var n=new C.ARRAY_TYPE(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function u(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function o(t,n,r,a,e,u,o,i,s,c,f,M,h,l,v,d){var b=new C.ARRAY_TYPE(16);return b[0]=t,b[1]=n,b[2]=r,b[3]=a,b[4]=e,b[5]=u,b[6]=o,b[7]=i,b[8]=s,b[9]=c,b[10]=f,b[11]=M,b[12]=h,b[13]=l,b[14]=v,b[15]=d,b}function i(t,n,r,a,e,u,o,i,s,c,f,M,h,l,v,d,b){return t[0]=n,t[1]=r,t[2]=a,t[3]=e,t[4]=u,t[5]=o,t[6]=i,t[7]=s,t[8]=c,t[9]=f,t[10]=M,t[11]=h,t[12]=l,t[13]=v,t[14]=d,t[15]=b,t}function s(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function c(t,n){if(t===n){var r=n[1],a=n[2],e=n[3],u=n[6],o=n[7],i=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=r,t[6]=n[9],t[7]=n[13],t[8]=a,t[9]=u,t[11]=n[14],t[12]=e,t[13]=o,t[14]=i}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t}function f(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],s=n[6],c=n[7],f=n[8],M=n[9],h=n[10],l=n[11],v=n[12],d=n[13],b=n[14],m=n[15],p=r*i-a*o,P=r*s-e*o,E=r*c-u*o,O=a*s-e*i,x=a*c-u*i,A=e*c-u*s,q=f*d-M*v,y=f*b-h*v,w=f*m-l*v,R=M*b-h*d,L=M*m-l*d,S=h*m-l*b,_=p*S-P*L+E*R+O*w-x*y+A*q;return _?(_=1/_,t[0]=(i*S-s*L+c*R)*_,t[1]=(e*L-a*S-u*R)*_,t[2]=(d*A-b*x+m*O)*_,t[3]=(h*x-M*A-l*O)*_,t[4]=(s*w-o*S-c*y)*_,t[5]=(r*S-e*w+u*y)*_,t[6]=(b*E-v*A-m*P)*_,t[7]=(f*A-h*E+l*P)*_,t[8]=(o*L-i*w+c*q)*_,t[9]=(a*w-r*L-u*q)*_,t[10]=(v*x-d*E+m*p)*_,t[11]=(M*E-f*x-l*p)*_,t[12]=(i*y-o*R-s*q)*_,t[13]=(r*R-a*y+e*q)*_,t[14]=(d*P-v*O-b*p)*_,t[15]=(f*O-M*P+h*p)*_,t):null}function M(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],s=n[6],c=n[7],f=n[8],M=n[9],h=n[10],l=n[11],v=n[12],d=n[13],b=n[14],m=n[15];return t[0]=i*(h*m-l*b)-M*(s*m-c*b)+d*(s*l-c*h),t[1]=-(a*(h*m-l*b)-M*(e*m-u*b)+d*(e*l-u*h)),t[2]=a*(s*m-c*b)-i*(e*m-u*b)+d*(e*c-u*s),t[3]=-(a*(s*l-c*h)-i*(e*l-u*h)+M*(e*c-u*s)),t[4]=-(o*(h*m-l*b)-f*(s*m-c*b)+v*(s*l-c*h)),t[5]=r*(h*m-l*b)-f*(e*m-u*b)+v*(e*l-u*h),t[6]=-(r*(s*m-c*b)-o*(e*m-u*b)+v*(e*c-u*s)),t[7]=r*(s*l-c*h)-o*(e*l-u*h)+f*(e*c-u*s),t[8]=o*(M*m-l*d)-f*(i*m-c*d)+v*(i*l-c*M),t[9]=-(r*(M*m-l*d)-f*(a*m-u*d)+v*(a*l-u*M)),t[10]=r*(i*m-c*d)-o*(a*m-u*d)+v*(a*c-u*i),t[11]=-(r*(i*l-c*M)-o*(a*l-u*M)+f*(a*c-u*i)),t[12]=-(o*(M*b-h*d)-f*(i*b-s*d)+v*(i*h-s*M)),t[13]=r*(M*b-h*d)-f*(a*b-e*d)+v*(a*h-e*M),t[14]=-(r*(i*b-s*d)-o*(a*b-e*d)+v*(a*s-e*i)),t[15]=r*(i*h-s*M)-o*(a*h-e*M)+f*(a*s-e*i),t}function h(t){var n=t[0],r=t[1],a=t[2],e=t[3],u=t[4],o=t[5],i=t[6],s=t[7],c=t[8],f=t[9],M=t[10],h=t[11],l=t[12],v=t[13],d=t[14],b=t[15];return(n*o-r*u)*(M*b-h*d)-(n*i-a*u)*(f*b-h*v)+(n*s-e*u)*(f*d-M*v)+(r*i-a*o)*(c*b-h*l)-(r*s-e*o)*(c*d-M*l)+(a*s-e*i)*(c*v-f*l)}function l(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],s=n[5],c=n[6],f=n[7],M=n[8],h=n[9],l=n[10],v=n[11],d=n[12],b=n[13],m=n[14],p=n[15],P=r[0],E=r[1],O=r[2],x=r[3];return t[0]=P*a+E*i+O*M+x*d,t[1]=P*e+E*s+O*h+x*b,t[2]=P*u+E*c+O*l+x*m,t[3]=P*o+E*f+O*v+x*p,P=r[4],E=r[5],O=r[6],x=r[7],t[4]=P*a+E*i+O*M+x*d,t[5]=P*e+E*s+O*h+x*b,t[6]=P*u+E*c+O*l+x*m,t[7]=P*o+E*f+O*v+x*p,P=r[8],E=r[9],O=r[10],x=r[11],t[8]=P*a+E*i+O*M+x*d,t[9]=P*e+E*s+O*h+x*b,t[10]=P*u+E*c+O*l+x*m,t[11]=P*o+E*f+O*v+x*p,P=r[12],E=r[13],O=r[14],x=r[15],t[12]=P*a+E*i+O*M+x*d,t[13]=P*e+E*s+O*h+x*b,t[14]=P*u+E*c+O*l+x*m,t[15]=P*o+E*f+O*v+x*p,t}function v(t,n,r){var a=r[0],e=r[1],u=r[2],o=void 0,i=void 0,s=void 0,c=void 0,f=void 0,M=void 0,h=void 0,l=void 0,v=void 0,d=void 0,b=void 0,m=void 0;return n===t?(t[12]=n[0]*a+n[4]*e+n[8]*u+n[12],t[13]=n[1]*a+n[5]*e+n[9]*u+n[13],t[14]=n[2]*a+n[6]*e+n[10]*u+n[14],t[15]=n[3]*a+n[7]*e+n[11]*u+n[15]):(o=n[0],i=n[1],s=n[2],c=n[3],f=n[4],M=n[5],h=n[6],l=n[7],v=n[8],d=n[9],b=n[10],m=n[11],t[0]=o,t[1]=i,t[2]=s,t[3]=c,t[4]=f,t[5]=M,t[6]=h,t[7]=l,t[8]=v,t[9]=d,t[10]=b,t[11]=m,t[12]=o*a+f*e+v*u+n[12],t[13]=i*a+M*e+d*u+n[13],t[14]=s*a+h*e+b*u+n[14],t[15]=c*a+l*e+m*u+n[15]),t}function d(t,n,r){var a=r[0],e=r[1],u=r[2];return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*u,t[9]=n[9]*u,t[10]=n[10]*u,t[11]=n[11]*u,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function b(t,n,r,a){var e=a[0],u=a[1],o=a[2],i=Math.sqrt(e*e+u*u+o*o),s=void 0,c=void 0,f=void 0,M=void 0,h=void 0,l=void 0,v=void 0,d=void 0,b=void 0,m=void 0,p=void 0,P=void 0,E=void 0,O=void 0,x=void 0,A=void 0,q=void 0,y=void 0,w=void 0,R=void 0,L=void 0,S=void 0,_=void 0,I=void 0;return Math.abs(i)<C.EPSILON?null:(i=1/i,e*=i,u*=i,o*=i,s=Math.sin(r),c=Math.cos(r),f=1-c,M=n[0],h=n[1],l=n[2],v=n[3],d=n[4],b=n[5],m=n[6],p=n[7],P=n[8],E=n[9],O=n[10],x=n[11],A=e*e*f+c,q=u*e*f+o*s,y=o*e*f-u*s,w=e*u*f-o*s,R=u*u*f+c,L=o*u*f+e*s,S=e*o*f+u*s,_=u*o*f-e*s,I=o*o*f+c,t[0]=M*A+d*q+P*y,t[1]=h*A+b*q+E*y,t[2]=l*A+m*q+O*y,t[3]=v*A+p*q+x*y,t[4]=M*w+d*R+P*L,t[5]=h*w+b*R+E*L,t[6]=l*w+m*R+O*L,t[7]=v*w+p*R+x*L,t[8]=M*S+d*_+P*I,t[9]=h*S+b*_+E*I,t[10]=l*S+m*_+O*I,t[11]=v*S+p*_+x*I,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function m(t,n,r){var a=Math.sin(r),e=Math.cos(r),u=n[4],o=n[5],i=n[6],s=n[7],c=n[8],f=n[9],M=n[10],h=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=u*e+c*a,t[5]=o*e+f*a,t[6]=i*e+M*a,t[7]=s*e+h*a,t[8]=c*e-u*a,t[9]=f*e-o*a,t[10]=M*e-i*a,t[11]=h*e-s*a,t}function p(t,n,r){var a=Math.sin(r),e=Math.cos(r),u=n[0],o=n[1],i=n[2],s=n[3],c=n[8],f=n[9],M=n[10],h=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=u*e-c*a,t[1]=o*e-f*a,t[2]=i*e-M*a,t[3]=s*e-h*a,t[8]=u*a+c*e,t[9]=o*a+f*e,t[10]=i*a+M*e,t[11]=s*a+h*e,t}function P(t,n,r){var a=Math.sin(r),e=Math.cos(r),u=n[0],o=n[1],i=n[2],s=n[3],c=n[4],f=n[5],M=n[6],h=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=u*e+c*a,t[1]=o*e+f*a,t[2]=i*e+M*a,t[3]=s*e+h*a,t[4]=c*e-u*a,t[5]=f*e-o*a,t[6]=M*e-i*a,t[7]=h*e-s*a,t}function E(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function O(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function x(t,n,r){var a=r[0],e=r[1],u=r[2],o=Math.sqrt(a*a+e*e+u*u),i=void 0,s=void 0,c=void 0;return Math.abs(o)<C.EPSILON?null:(o=1/o,a*=o,e*=o,u*=o,i=Math.sin(n),s=Math.cos(n),c=1-s,t[0]=a*a*c+s,t[1]=e*a*c+u*i,t[2]=u*a*c-e*i,t[3]=0,t[4]=a*e*c-u*i,t[5]=e*e*c+s,t[6]=u*e*c+a*i,t[7]=0,t[8]=a*u*c+e*i,t[9]=e*u*c-a*i,t[10]=u*u*c+s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function A(t,n){var r=Math.sin(n),a=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function q(t,n){var r=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function y(t,n){var r=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=a+a,s=e+e,c=u+u,f=a*i,M=a*s,h=a*c,l=e*s,v=e*c,d=u*c,b=o*i,m=o*s,p=o*c;return t[0]=1-(l+d),t[1]=M+p,t[2]=h-m,t[3]=0,t[4]=M-p,t[5]=1-(f+d),t[6]=v+b,t[7]=0,t[8]=h+m,t[9]=v-b,t[10]=1-(f+l),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function R(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function L(t,n){var r=n[0],a=n[1],e=n[2],u=n[4],o=n[5],i=n[6],s=n[8],c=n[9],f=n[10];return t[0]=Math.sqrt(r*r+a*a+e*e),t[1]=Math.sqrt(u*u+o*o+i*i),t[2]=Math.sqrt(s*s+c*c+f*f),t}function S(t,n){var r=n[0]+n[5]+n[10],a=0;return r>0?(a=2*Math.sqrt(r+1),t[3]=.25*a,t[0]=(n[6]-n[9])/a,t[1]=(n[8]-n[2])/a,t[2]=(n[1]-n[4])/a):n[0]>n[5]&n[0]>n[10]?(a=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/a,t[0]=.25*a,t[1]=(n[1]+n[4])/a,t[2]=(n[8]+n[2])/a):n[5]>n[10]?(a=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/a,t[0]=(n[1]+n[4])/a,t[1]=.25*a,t[2]=(n[6]+n[9])/a):(a=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/a,t[0]=(n[8]+n[2])/a,t[1]=(n[6]+n[9])/a,t[2]=.25*a),t}function _(t,n,r,a){var e=n[0],u=n[1],o=n[2],i=n[3],s=e+e,c=u+u,f=o+o,M=e*s,h=e*c,l=e*f,v=u*c,d=u*f,b=o*f,m=i*s,p=i*c,P=i*f,E=a[0],O=a[1],x=a[2];return t[0]=(1-(v+b))*E,t[1]=(h+P)*E,t[2]=(l-p)*E,t[3]=0,t[4]=(h-P)*O,t[5]=(1-(M+b))*O,t[6]=(d+m)*O,t[7]=0,t[8]=(l+p)*x,t[9]=(d-m)*x,t[10]=(1-(M+v))*x,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function I(t,n,r,a,e){var u=n[0],o=n[1],i=n[2],s=n[3],c=u+u,f=o+o,M=i+i,h=u*c,l=u*f,v=u*M,d=o*f,b=o*M,m=i*M,p=s*c,P=s*f,E=s*M,O=a[0],x=a[1],A=a[2],q=e[0],y=e[1],w=e[2];return t[0]=(1-(d+m))*O,t[1]=(l+E)*O,t[2]=(v-P)*O,t[3]=0,t[4]=(l-E)*x,t[5]=(1-(h+m))*x,t[6]=(b+p)*x,t[7]=0,t[8]=(v+P)*A,t[9]=(b-p)*A,t[10]=(1-(h+d))*A,t[11]=0,t[12]=r[0]+q-(t[0]*q+t[4]*y+t[8]*w),t[13]=r[1]+y-(t[1]*q+t[5]*y+t[9]*w),t[14]=r[2]+w-(t[2]*q+t[6]*y+t[10]*w),t[15]=1,t}function N(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=r+r,i=a+a,s=e+e,c=r*o,f=a*o,M=a*i,h=e*o,l=e*i,v=e*s,d=u*o,b=u*i,m=u*s;return t[0]=1-M-v,t[1]=f+m,t[2]=h-b,t[3]=0,t[4]=f-m,t[5]=1-c-v,t[6]=l+d,t[7]=0,t[8]=h+b,t[9]=l-d,t[10]=1-c-M,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Y(t,n,r,a,e,u,o){var i=1/(r-n),s=1/(e-a),c=1/(u-o);return t[0]=2*u*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*u*s,t[6]=0,t[7]=0,t[8]=(r+n)*i,t[9]=(e+a)*s,t[10]=(o+u)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*u*2*c,t[15]=0,t}function g(t,n,r,a,e){var u=1/Math.tan(n/2),o=1/(a-e);return t[0]=u/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+a)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*a*o,t[15]=0,t}function T(t,n,r,a){var e=Math.tan(n.upDegrees*Math.PI/180),u=Math.tan(n.downDegrees*Math.PI/180),o=Math.tan(n.leftDegrees*Math.PI/180),i=Math.tan(n.rightDegrees*Math.PI/180),s=2/(o+i),c=2/(e+u);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-i)*s*.5,t[9]=(e-u)*c*.5,t[10]=a/(r-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*r/(r-a),t[15]=0,t}function j(t,n,r,a,e,u,o){var i=1/(n-r),s=1/(a-e),c=1/(u-o);return t[0]=-2*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(n+r)*i,t[13]=(e+a)*s,t[14]=(o+u)*c,t[15]=1,t}function D(t,n,r,a){var e=void 0,u=void 0,o=void 0,i=void 0,s=void 0,c=void 0,f=void 0,M=void 0,h=void 0,l=void 0,v=n[0],d=n[1],b=n[2],m=a[0],p=a[1],P=a[2],E=r[0],O=r[1],x=r[2];return Math.abs(v-E)<C.EPSILON&&Math.abs(d-O)<C.EPSILON&&Math.abs(b-x)<C.EPSILON?mat4.identity(t):(f=v-E,M=d-O,h=b-x,l=1/Math.sqrt(f*f+M*M+h*h),f*=l,M*=l,h*=l,e=p*h-P*M,u=P*f-m*h,o=m*M-p*f,l=Math.sqrt(e*e+u*u+o*o),l?(l=1/l,e*=l,u*=l,o*=l):(e=0,u=0,o=0),i=M*o-h*u,s=h*e-f*o,c=f*u-M*e,l=Math.sqrt(i*i+s*s+c*c),l?(l=1/l,i*=l,s*=l,c*=l):(i=0,s=0,c=0),t[0]=e,t[1]=i,t[2]=f,t[3]=0,t[4]=u,t[5]=s,t[6]=M,t[7]=0,t[8]=o,t[9]=c,t[10]=h,t[11]=0,t[12]=-(e*v+u*d+o*b),t[13]=-(i*v+s*d+c*b),t[14]=-(f*v+M*d+h*b),t[15]=1,t)}function V(t,n,r,a){var e=n[0],u=n[1],o=n[2],i=a[0],s=a[1],c=a[2],f=e-r[0],M=u-r[1],h=o-r[2],l=f*f+M*M+h*h;l>0&&(l=1/Math.sqrt(l),f*=l,M*=l,h*=l);var v=s*h-c*M,d=c*f-i*h,b=i*M-s*f;return t[0]=v,t[1]=d,t[2]=b,t[3]=0,t[4]=M*b-h*d,t[5]=h*v-f*b,t[6]=f*d-M*v,t[7]=0,t[8]=f,t[9]=M,t[10]=h,t[11]=0,t[12]=e,t[13]=u,t[14]=o,t[15]=1,t}function z(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function F(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function Q(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t[9]=n[9]+r[9],t[10]=n[10]+r[10],t[11]=n[11]+r[11],t[12]=n[12]+r[12],t[13]=n[13]+r[13],t[14]=n[14]+r[14],t[15]=n[15]+r[15],t}function X(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t[9]=n[9]-r[9],t[10]=n[10]-r[10],t[11]=n[11]-r[11],t[12]=n[12]-r[12],t[13]=n[13]-r[13],t[14]=n[14]-r[14],t[15]=n[15]-r[15],t}function Z(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t[9]=n[9]*r,t[10]=n[10]*r,t[11]=n[11]*r,t[12]=n[12]*r,t[13]=n[13]*r,t[14]=n[14]*r,t[15]=n[15]*r,t}function k(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t[2]=n[2]+r[2]*a,t[3]=n[3]+r[3]*a,t[4]=n[4]+r[4]*a,t[5]=n[5]+r[5]*a,t[6]=n[6]+r[6]*a,t[7]=n[7]+r[7]*a,t[8]=n[8]+r[8]*a,t[9]=n[9]+r[9]*a,t[10]=n[10]+r[10]*a,t[11]=n[11]+r[11]*a,t[12]=n[12]+r[12]*a,t[13]=n[13]+r[13]*a,t[14]=n[14]+r[14]*a,t[15]=n[15]+r[15]*a,t}function U(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]}function W(t,n){var r=t[0],a=t[1],e=t[2],u=t[3],o=t[4],i=t[5],s=t[6],c=t[7],f=t[8],M=t[9],h=t[10],l=t[11],v=t[12],d=t[13],b=t[14],m=t[15],p=n[0],P=n[1],E=n[2],O=n[3],x=n[4],A=n[5],q=n[6],y=n[7],w=n[8],R=n[9],L=n[10],S=n[11],_=n[12],I=n[13],N=n[14],Y=n[15];return Math.abs(r-p)<=C.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(a-P)<=C.EPSILON*Math.max(1,Math.abs(a),Math.abs(P))&&Math.abs(e-E)<=C.EPSILON*Math.max(1,Math.abs(e),Math.abs(E))&&Math.abs(u-O)<=C.EPSILON*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(o-x)<=C.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(i-A)<=C.EPSILON*Math.max(1,Math.abs(i),Math.abs(A))&&Math.abs(s-q)<=C.EPSILON*Math.max(1,Math.abs(s),Math.abs(q))&&Math.abs(c-y)<=C.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(f-w)<=C.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(M-R)<=C.EPSILON*Math.max(1,Math.abs(M),Math.abs(R))&&Math.abs(h-L)<=C.EPSILON*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(l-S)<=C.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(v-_)<=C.EPSILON*Math.max(1,Math.abs(v),Math.abs(_))&&Math.abs(d-I)<=C.EPSILON*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(b-N)<=C.EPSILON*Math.max(1,Math.abs(b),Math.abs(N))&&Math.abs(m-Y)<=C.EPSILON*Math.max(1,Math.abs(m),Math.abs(Y))}Object.defineProperty(n,"__esModule",{value:!0}),n.sub=n.mul=void 0,n.create=a,n.clone=e,n.copy=u,n.fromValues=o,n.set=i,n.identity=s,n.transpose=c,n.invert=f,n.adjoint=M,n.determinant=h,n.multiply=l,n.translate=v,n.scale=d,n.rotate=b,n.rotateX=m,n.rotateY=p,n.rotateZ=P,n.fromTranslation=E,n.fromScaling=O,n.fromRotation=x,n.fromXRotation=A,n.fromYRotation=q,n.fromZRotation=y,n.fromRotationTranslation=w,n.getTranslation=R,n.getScaling=L,n.getRotation=S,n.fromRotationTranslationScale=_,n.fromRotationTranslationScaleOrigin=I,n.fromQuat=N,n.frustum=Y,n.perspective=g,n.perspectiveFromFieldOfView=T,n.ortho=j,n.lookAt=D,n.targetTo=V,n.str=z,n.frob=F,n.add=Q,n.subtract=X,n.multiplyScalar=Z,n.multiplyScalarAndAdd=k,n.exactEquals=U,n.equals=W;var B=r(0),C=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.default=t,n}(B);n.mul=l,n.sub=X},function(t,n,r){"use strict";function a(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.default=t,n}function e(){var t=new E.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function u(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function o(t,n,r){r*=.5;var a=Math.sin(r);return t[0]=a*n[0],t[1]=a*n[1],t[2]=a*n[2],t[3]=Math.cos(r),t}function i(t,n){var r=2*Math.acos(n[3]),a=Math.sin(r/2);return 0!=a?(t[0]=n[0]/a,t[1]=n[1]/a,t[2]=n[2]/a):(t[0]=1,t[1]=0,t[2]=0),r}function s(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=r[0],s=r[1],c=r[2],f=r[3];return t[0]=a*f+o*i+e*c-u*s,t[1]=e*f+o*s+u*i-a*c,t[2]=u*f+o*c+a*s-e*i,t[3]=o*f-a*i-e*s-u*c,t}function c(t,n,r){r*=.5;var a=n[0],e=n[1],u=n[2],o=n[3],i=Math.sin(r),s=Math.cos(r);return t[0]=a*s+o*i,t[1]=e*s+u*i,t[2]=u*s-e*i,t[3]=o*s-a*i,t}function f(t,n,r){r*=.5;var a=n[0],e=n[1],u=n[2],o=n[3],i=Math.sin(r),s=Math.cos(r);return t[0]=a*s-u*i,t[1]=e*s+o*i,t[2]=u*s+a*i,t[3]=o*s-e*i,t}function M(t,n,r){r*=.5;var a=n[0],e=n[1],u=n[2],o=n[3],i=Math.sin(r),s=Math.cos(r);return t[0]=a*s+e*i,t[1]=e*s-a*i,t[2]=u*s+o*i,t[3]=o*s-u*i,t}function h(t,n){var r=n[0],a=n[1],e=n[2];return t[0]=r,t[1]=a,t[2]=e,t[3]=Math.sqrt(Math.abs(1-r*r-a*a-e*e)),t}function l(t,n,r,a){var e=n[0],u=n[1],o=n[2],i=n[3],s=r[0],c=r[1],f=r[2],M=r[3],h=void 0,l=void 0,v=void 0,d=void 0,b=void 0;return l=e*s+u*c+o*f+i*M,l<0&&(l=-l,s=-s,c=-c,f=-f,M=-M),1-l>1e-6?(h=Math.acos(l),v=Math.sin(h),d=Math.sin((1-a)*h)/v,b=Math.sin(a*h)/v):(d=1-a,b=a),t[0]=d*e+b*s,t[1]=d*u+b*c,t[2]=d*o+b*f,t[3]=d*i+b*M,t}function v(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=r*r+a*a+e*e+u*u,i=o?1/o:0;return t[0]=-r*i,t[1]=-a*i,t[2]=-e*i,t[3]=u*i,t}function d(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function b(t,n){var r=n[0]+n[4]+n[8],a=void 0;if(r>0)a=Math.sqrt(r+1),t[3]=.5*a,a=.5/a,t[0]=(n[5]-n[7])*a,t[1]=(n[6]-n[2])*a,t[2]=(n[1]-n[3])*a;else{var e=0;n[4]>n[0]&&(e=1),n[8]>n[3*e+e]&&(e=2);var u=(e+1)%3,o=(e+2)%3;a=Math.sqrt(n[3*e+e]-n[3*u+u]-n[3*o+o]+1),t[e]=.5*a,a=.5/a,t[3]=(n[3*u+o]-n[3*o+u])*a,t[u]=(n[3*u+e]+n[3*e+u])*a,t[o]=(n[3*o+e]+n[3*e+o])*a}return t}function m(t,n,r,a){var e=.5*Math.PI/180;n*=e,r*=e,a*=e;var u=Math.sin(n),o=Math.cos(n),i=Math.sin(r),s=Math.cos(r),c=Math.sin(a),f=Math.cos(a);return t[0]=u*s*f-o*i*c,t[1]=o*i*f+u*s*c,t[2]=o*s*c-u*i*f,t[3]=o*s*f+u*i*c,t}function p(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}Object.defineProperty(n,"__esModule",{value:!0}),n.setAxes=n.sqlerp=n.rotationTo=n.equals=n.exactEquals=n.normalize=n.sqrLen=n.squaredLength=n.len=n.length=n.lerp=n.dot=n.scale=n.mul=n.add=n.set=n.copy=n.fromValues=n.clone=void 0,n.create=e,n.identity=u,n.setAxisAngle=o,n.getAxisAngle=i,n.multiply=s,n.rotateX=c,n.rotateY=f,n.rotateZ=M,n.calculateW=h,n.slerp=l,n.invert=v,n.conjugate=d,n.fromMat3=b,n.fromEuler=m,n.str=p;var P=r(0),E=a(P),O=r(1),x=a(O),A=r(2),q=a(A),y=r(3),w=a(y),R=(n.clone=w.clone,n.fromValues=w.fromValues,n.copy=w.copy,n.set=w.set,n.add=w.add,n.mul=s,n.scale=w.scale,n.dot=w.dot,n.lerp=w.lerp,n.length=w.length),L=(n.len=R,n.squaredLength=w.squaredLength),S=(n.sqrLen=L,n.normalize=w.normalize);n.exactEquals=w.exactEquals,n.equals=w.equals,n.rotationTo=function(){var t=q.create(),n=q.fromValues(1,0,0),r=q.fromValues(0,1,0);return function(a,e,u){var i=q.dot(e,u);return i<-.999999?(q.cross(t,n,e),q.len(t)<1e-6&&q.cross(t,r,e),q.normalize(t,t),o(a,t,Math.PI),a):i>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(q.cross(t,e,u),a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=1+i,S(a,a))}}(),n.sqlerp=function(){var t=e(),n=e();return function(r,a,e,u,o,i){return l(t,a,o,i),l(n,e,u,i),l(r,t,n,2*i*(1-i)),r}}(),n.setAxes=function(){var t=x.create();return function(n,r,a,e){return t[0]=a[0],t[3]=a[1],t[6]=a[2],t[1]=e[0],t[4]=e[1],t[7]=e[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],S(n,b(n,t))}}()},function(t,n,r){"use strict";function a(){var t=new V.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t}function e(t){var n=new V.ARRAY_TYPE(2);return n[0]=t[0],n[1]=t[1],n}function u(t,n){var r=new V.ARRAY_TYPE(2);return r[0]=t,r[1]=n,r}function o(t,n){return t[0]=n[0],t[1]=n[1],t}function i(t,n,r){return t[0]=n,t[1]=r,t}function s(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t}function c(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t}function f(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t}function M(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t}function h(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function l(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function v(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t}function d(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t}function b(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function m(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t}function p(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t}function P(t,n){var r=n[0]-t[0],a=n[1]-t[1];return Math.sqrt(r*r+a*a)}function E(t,n){var r=n[0]-t[0],a=n[1]-t[1];return r*r+a*a}function O(t){var n=t[0],r=t[1];return Math.sqrt(n*n+r*r)}function x(t){var n=t[0],r=t[1];return n*n+r*r}function A(t,n){return t[0]=-n[0],t[1]=-n[1],t}function q(t,n){return t[0]=1/n[0],t[1]=1/n[1],t}function y(t,n){var r=n[0],a=n[1],e=r*r+a*a;return e>0&&(e=1/Math.sqrt(e),t[0]=n[0]*e,t[1]=n[1]*e),t}function w(t,n){return t[0]*n[0]+t[1]*n[1]}function R(t,n,r){var a=n[0]*r[1]-n[1]*r[0];return t[0]=t[1]=0,t[2]=a,t}function L(t,n,r,a){var e=n[0],u=n[1];return t[0]=e+a*(r[0]-e),t[1]=u+a*(r[1]-u),t}function S(t,n){n=n||1;var r=2*V.RANDOM()*Math.PI;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t}function _(t,n,r){var a=n[0],e=n[1];return t[0]=r[0]*a+r[2]*e,t[1]=r[1]*a+r[3]*e,t}function I(t,n,r){var a=n[0],e=n[1];return t[0]=r[0]*a+r[2]*e+r[4],t[1]=r[1]*a+r[3]*e+r[5],t}function N(t,n,r){var a=n[0],e=n[1];return t[0]=r[0]*a+r[3]*e+r[6],t[1]=r[1]*a+r[4]*e+r[7],t}function Y(t,n,r){var a=n[0],e=n[1];return t[0]=r[0]*a+r[4]*e+r[12],t[1]=r[1]*a+r[5]*e+r[13],t}function g(t){return"vec2("+t[0]+", "+t[1]+")"}function T(t,n){return t[0]===n[0]&&t[1]===n[1]}function j(t,n){var r=t[0],a=t[1],e=n[0],u=n[1];return Math.abs(r-e)<=V.EPSILON*Math.max(1,Math.abs(r),Math.abs(e))&&Math.abs(a-u)<=V.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))}Object.defineProperty(n,"__esModule",{value:!0}),n.forEach=n.sqrLen=n.sqrDist=n.dist=n.div=n.mul=n.sub=n.len=void 0,n.create=a,n.clone=e,n.fromValues=u,n.copy=o,n.set=i,n.add=s,n.subtract=c,n.multiply=f,n.divide=M,n.ceil=h,n.floor=l,n.min=v,n.max=d,n.round=b,n.scale=m,n.scaleAndAdd=p,n.distance=P,n.squaredDistance=E,n.length=O,n.squaredLength=x,n.negate=A,n.inverse=q,n.normalize=y,n.dot=w,n.cross=R,n.lerp=L,n.random=S,n.transformMat2=_,n.transformMat2d=I,n.transformMat3=N,n.transformMat4=Y,n.str=g,n.exactEquals=T,n.equals=j;var D=r(0),V=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.default=t,n}(D);n.len=O,n.sub=c,n.mul=f,n.div=M,n.dist=P,n.sqrDist=E,n.sqrLen=x,n.forEach=function(){var t=a();return function(n,r,a,e,u,o){var i=void 0,s=void 0;for(r||(r=2),a||(a=0),s=e?Math.min(e*r+a,n.length):n.length,i=a;i<s;i+=r)t[0]=n[i],t[1]=n[i+1],u(t,t,o),n[i]=t[0],n[i+1]=t[1];return n}}()}])});

/* file: script/lib/earcut.js */

!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.earcut=e()}}(function(){return function e(n,t,r){function x(u,f){if(!t[u]){if(!n[u]){var o="function"==typeof require&&require;if(!f&&o)return o(u,!0);if(i)return i(u,!0);var v=new Error("Cannot find module '"+u+"'");throw v.code="MODULE_NOT_FOUND",v}var l=t[u]={exports:{}};n[u][0].call(l.exports,function(e){var t=n[u][1][e];return x(t?t:e)},l,l.exports,e,n,t,r)}return t[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)x(r[u]);return x}({1:[function(e,n,t){"use strict";function r(e,n,t){t=t||2;var r=n&&n.length,i=r?n[0]*t:e.length,f=x(e,0,i,t,!0),o=[];if(!f)return o;var v,l,p,a,h,s,c;if(r&&(f=y(e,n,f,t)),e.length>80*t){v=p=e[0],l=a=e[1];for(var d=t;i>d;d+=t)h=e[d],s=e[d+1],v>h&&(v=h),l>s&&(l=s),h>p&&(p=h),s>a&&(a=s);c=Math.max(p-v,a-l)}return u(f,o,t,v,l,c),o}function x(e,n,t,r,x){var i,u;if(x===_(e,n,t,r)>0)for(i=n;t>i;i+=r)u=E(i,e[i],e[i+1],u);else for(i=t-r;i>=n;i-=r)u=E(i,e[i],e[i+1],u);return u&&z(u,u.next)&&(N(u),u=u.next),u}function i(e,n){if(!e)return e;n||(n=e);var t,r=e;do if(t=!1,r.steiner||!z(r,r.next)&&0!==b(r.prev,r,r.next))r=r.next;else{if(N(r),r=n=r.prev,r===r.next)return null;t=!0}while(t||r!==n);return n}function u(e,n,t,r,x,y,p){if(e){!p&&y&&s(e,r,x,y);for(var a,h,c=e;e.prev!==e.next;)if(a=e.prev,h=e.next,y?o(e,r,x,y):f(e))n.push(a.i/t),n.push(e.i/t),n.push(h.i/t),N(e),e=h.next,c=h.next;else if(e=h,e===c){p?1===p?(e=v(e,n,t),u(e,n,t,r,x,y,2)):2===p&&l(e,n,t,r,x,y):u(i(e),n,t,r,x,y,1);break}}}function f(e){var n=e.prev,t=e,r=e.next;if(b(n,t,r)>=0)return!1;for(var x=e.next.next;x!==e.prev;){if(g(n.x,n.y,t.x,t.y,r.x,r.y,x.x,x.y)&&b(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function o(e,n,t,r){var x=e.prev,i=e,u=e.next;if(b(x,i,u)>=0)return!1;for(var f=x.x<i.x?x.x<u.x?x.x:u.x:i.x<u.x?i.x:u.x,o=x.y<i.y?x.y<u.y?x.y:u.y:i.y<u.y?i.y:u.y,v=x.x>i.x?x.x>u.x?x.x:u.x:i.x>u.x?i.x:u.x,l=x.y>i.y?x.y>u.y?x.y:u.y:i.y>u.y?i.y:u.y,y=d(f,o,n,t,r),p=d(v,l,n,t,r),a=e.nextZ;a&&a.z<=p;){if(a!==e.prev&&a!==e.next&&g(x.x,x.y,i.x,i.y,u.x,u.y,a.x,a.y)&&b(a.prev,a,a.next)>=0)return!1;a=a.nextZ}for(a=e.prevZ;a&&a.z>=y;){if(a!==e.prev&&a!==e.next&&g(x.x,x.y,i.x,i.y,u.x,u.y,a.x,a.y)&&b(a.prev,a,a.next)>=0)return!1;a=a.prevZ}return!0}function v(e,n,t){var r=e;do{var x=r.prev,i=r.next.next;!z(x,i)&&M(x,r,r.next,i)&&q(x,i)&&q(i,x)&&(n.push(x.i/t),n.push(r.i/t),n.push(i.i/t),N(r),N(r.next),r=e=i),r=r.next}while(r!==e);return r}function l(e,n,t,r,x,f){var o=e;do{for(var v=o.next.next;v!==o.prev;){if(o.i!==v.i&&w(o,v)){var l=D(o,v);return o=i(o,o.next),l=i(l,l.next),u(o,n,t,r,x,f),void u(l,n,t,r,x,f)}v=v.next}o=o.next}while(o!==e)}function y(e,n,t,r){var u,f,o,v,l,y=[];for(u=0,f=n.length;f>u;u++)o=n[u]*r,v=f-1>u?n[u+1]*r:e.length,l=x(e,o,v,r,!1),l===l.next&&(l.steiner=!0),y.push(Z(l));for(y.sort(p),u=0;u<y.length;u++)a(y[u],t),t=i(t,t.next);return t}function p(e,n){return e.x-n.x}function a(e,n){if(n=h(e,n)){var t=D(n,e);i(t,t.next)}}function h(e,n){var t,r=n,x=e.x,i=e.y,u=-(1/0);do{if(i<=r.y&&i>=r.next.y){var f=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(x>=f&&f>u){if(u=f,f===x){if(i===r.y)return r;if(i===r.next.y)return r.next}t=r.x<r.next.x?r:r.next}}r=r.next}while(r!==n);if(!t)return null;if(x===u)return t.prev;var o,v=t,l=t.x,y=t.y,p=1/0;for(r=t.next;r!==v;)x>=r.x&&r.x>=l&&g(y>i?x:u,i,l,y,y>i?u:x,i,r.x,r.y)&&(o=Math.abs(i-r.y)/(x-r.x),(p>o||o===p&&r.x>t.x)&&q(r,e)&&(t=r,p=o)),r=r.next;return t}function s(e,n,t,r){var x=e;do null===x.z&&(x.z=d(x.x,x.y,n,t,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next;while(x!==e);x.prevZ.nextZ=null,x.prevZ=null,c(x)}function c(e){var n,t,r,x,i,u,f,o,v=1;do{for(t=e,e=null,i=null,u=0;t;){for(u++,r=t,f=0,n=0;v>n&&(f++,r=r.nextZ,r);n++);for(o=v;f>0||o>0&&r;)0===f?(x=r,r=r.nextZ,o--):0!==o&&r?t.z<=r.z?(x=t,t=t.nextZ,f--):(x=r,r=r.nextZ,o--):(x=t,t=t.nextZ,f--),i?i.nextZ=x:e=x,x.prevZ=i,i=x;t=r}i.nextZ=null,v*=2}while(u>1);return e}function d(e,n,t,r,x){return e=32767*(e-t)/x,n=32767*(n-r)/x,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),n=16711935&(n|n<<8),n=252645135&(n|n<<4),n=858993459&(n|n<<2),n=1431655765&(n|n<<1),e|n<<1}function Z(e){var n=e,t=e;do n.x<t.x&&(t=n),n=n.next;while(n!==e);return t}function g(e,n,t,r,x,i,u,f){return(x-u)*(n-f)-(e-u)*(i-f)>=0&&(e-u)*(r-f)-(t-u)*(n-f)>=0&&(t-u)*(i-f)-(x-u)*(r-f)>=0}function w(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!m(e,n)&&q(e,n)&&q(n,e)&&O(e,n)}function b(e,n,t){return(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function z(e,n){return e.x===n.x&&e.y===n.y}function M(e,n,t,r){return z(e,n)&&z(t,r)||z(e,r)&&z(t,n)?!0:b(e,n,t)>0!=b(e,n,r)>0&&b(t,r,e)>0!=b(t,r,n)>0}function m(e,n){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==n.i&&t.next.i!==n.i&&M(t,t.next,e,n))return!0;t=t.next}while(t!==e);return!1}function q(e,n){return b(e.prev,e,e.next)<0?b(e,n,e.next)>=0&&b(e,e.prev,n)>=0:b(e,n,e.prev)<0||b(e,e.next,n)<0}function O(e,n){var t=e,r=!1,x=(e.x+n.x)/2,i=(e.y+n.y)/2;do t.y>i!=t.next.y>i&&x<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==e);return r}function D(e,n){var t=new U(e.i,e.x,e.y),r=new U(n.i,n.x,n.y),x=e.next,i=n.prev;return e.next=n,n.prev=e,t.next=x,x.prev=t,r.next=t,t.prev=r,i.next=r,r.prev=i,r}function E(e,n,t,r){var x=new U(e,n,t);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function N(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function U(e,n,t){this.i=e,this.x=n,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _(e,n,t,r){for(var x=0,i=n,u=t-r;t>i;i+=r)x+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return x}n.exports=r,r.deviation=function(e,n,t,r){var x=n&&n.length,i=x?n[0]*t:e.length,u=Math.abs(_(e,0,i,t));if(x)for(var f=0,o=n.length;o>f;f++){var v=n[f]*t,l=o-1>f?n[f+1]*t:e.length;u-=Math.abs(_(e,v,l,t))}var y=0;for(f=0;f<r.length;f+=3){var p=r[f]*t,a=r[f+1]*t,h=r[f+2]*t;y+=Math.abs((e[p]-e[h])*(e[a+1]-e[p+1])-(e[p]-e[a])*(e[h+1]-e[p+1]))}return 0===u&&0===y?0:Math.abs((y-u)/u)},r.flatten=function(e){for(var n=e[0][0].length,t={vertices:[],holes:[],dimensions:n},r=0,x=0;x<e.length;x++){for(var i=0;i<e[x].length;i++)for(var u=0;n>u;u++)t.vertices.push(e[x][i][u]);x>0&&(r+=e[x-1].length,t.holes.push(r))}return t}},{}]},{},[1])(1)});

/* file: script/lib/jquery.js */

/*! jQuery v3.2.1 | (c) JS Foundation and other contributors | jquery.org/license */
!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c=[],d=a.document,e=Object.getPrototypeOf,f=c.slice,g=c.concat,h=c.push,i=c.indexOf,j={},k=j.toString,l=j.hasOwnProperty,m=l.toString,n=m.call(Object),o={};function p(a,b){b=b||d;var c=b.createElement("script");c.text=a,b.head.appendChild(c).parentNode.removeChild(c)}var q="3.2.1",r=function(a,b){return new r.fn.init(a,b)},s=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,t=/^-ms-/,u=/-([a-z])/g,v=function(a,b){return b.toUpperCase()};r.fn=r.prototype={jquery:q,constructor:r,length:0,toArray:function(){return f.call(this)},get:function(a){return null==a?f.call(this):a<0?this[a+this.length]:this[a]},pushStack:function(a){var b=r.merge(this.constructor(),a);return b.prevObject=this,b},each:function(a){return r.each(this,a)},map:function(a){return this.pushStack(r.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:c.sort,splice:c.splice},r.extend=r.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||r.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(r.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,f=c&&Array.isArray(c)?c:[]):f=c&&r.isPlainObject(c)?c:{},g[b]=r.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},r.extend({expando:"jQuery"+(q+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===r.type(a)},isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=r.type(a);return("number"===b||"string"===b)&&!isNaN(a-parseFloat(a))},isPlainObject:function(a){var b,c;return!(!a||"[object Object]"!==k.call(a))&&(!(b=e(a))||(c=l.call(b,"constructor")&&b.constructor,"function"==typeof c&&m.call(c)===n))},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?j[k.call(a)]||"object":typeof a},globalEval:function(a){p(a)},camelCase:function(a){return a.replace(t,"ms-").replace(u,v)},each:function(a,b){var c,d=0;if(w(a)){for(c=a.length;d<c;d++)if(b.call(a[d],d,a[d])===!1)break}else for(d in a)if(b.call(a[d],d,a[d])===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(s,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(w(Object(a))?r.merge(c,"string"==typeof a?[a]:a):h.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:i.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;f<g;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,e,f=0,h=[];if(w(a))for(d=a.length;f<d;f++)e=b(a[f],f,c),null!=e&&h.push(e);else for(f in a)e=b(a[f],f,c),null!=e&&h.push(e);return g.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(c=a[b],b=a,a=c),r.isFunction(a))return d=f.call(arguments,2),e=function(){return a.apply(b||this,d.concat(f.call(arguments)))},e.guid=a.guid=a.guid||r.guid++,e},now:Date.now,support:o}),"function"==typeof Symbol&&(r.fn[Symbol.iterator]=c[Symbol.iterator]),r.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){j["[object "+b+"]"]=b.toLowerCase()});function w(a){var b=!!a&&"length"in a&&a.length,c=r.type(a);return"function"!==c&&!r.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}var x=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",L="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",M="\\["+K+"*("+L+")(?:"+K+"*([*^$|!~]?=)"+K+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+L+"))|)"+K+"*\\]",N=":("+L+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+M+")*)|.*)\\)|)",O=new RegExp(K+"+","g"),P=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),Q=new RegExp("^"+K+"*,"+K+"*"),R=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),S=new RegExp("="+K+"*([^\\]'\"]*?)"+K+"*\\]","g"),T=new RegExp(N),U=new RegExp("^"+L+"$"),V={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L+"|[*])"),ATTR:new RegExp("^"+M),PSEUDO:new RegExp("^"+N),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,_=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),aa=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ba=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ca=function(a,b){return b?"\0"===a?"\ufffd":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a},da=function(){m()},ea=ta(function(a){return a.disabled===!0&&("form"in a||"label"in a)},{dir:"parentNode",next:"legend"});try{G.apply(D=H.call(v.childNodes),v.childNodes),D[v.childNodes.length].nodeType}catch(fa){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s=b&&b.ownerDocument,w=b?b.nodeType:9;if(d=d||[],"string"!=typeof a||!a||1!==w&&9!==w&&11!==w)return d;if(!e&&((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,p)){if(11!==w&&(l=Z.exec(a)))if(f=l[1]){if(9===w){if(!(j=b.getElementById(f)))return d;if(j.id===f)return d.push(j),d}else if(s&&(j=s.getElementById(f))&&t(b,j)&&j.id===f)return d.push(j),d}else{if(l[2])return G.apply(d,b.getElementsByTagName(a)),d;if((f=l[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(f)),d}if(c.qsa&&!A[a+" "]&&(!q||!q.test(a))){if(1!==w)s=b,r=a;else if("object"!==b.nodeName.toLowerCase()){(k=b.getAttribute("id"))?k=k.replace(ba,ca):b.setAttribute("id",k=u),o=g(a),h=o.length;while(h--)o[h]="#"+k+" "+sa(o[h]);r=o.join(","),s=$.test(a)&&qa(b.parentNode)||b}if(r)try{return G.apply(d,s.querySelectorAll(r)),d}catch(x){}finally{k===u&&b.removeAttribute("id")}}}return i(a.replace(P,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("fieldset");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=c.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return function(b){return"form"in b?b.parentNode&&b.disabled===!1?"label"in b?"label"in b.parentNode?b.parentNode.disabled===a:b.disabled===a:b.isDisabled===a||b.isDisabled!==!a&&ea(b)===a:b.disabled===a:"label"in b&&b.disabled===a}}function pa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function qa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=n.documentElement,p=!f(n),v!==n&&(e=n.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",da,!1):e.attachEvent&&e.attachEvent("onunload",da)),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(n.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Y.test(n.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!n.getElementsByName||!n.getElementsByName(u).length}),c.getById?(d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){return a.getAttribute("id")===b}},d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c?[c]:[]}}):(d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}},d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c,d,e,f=b.getElementById(a);if(f){if(c=f.getAttributeNode("id"),c&&c.value===a)return[f];e=b.getElementsByName(a),d=0;while(f=e[d++])if(c=f.getAttributeNode("id"),c&&c.value===a)return[f]}return[]}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){if("undefined"!=typeof b.getElementsByClassName&&p)return b.getElementsByClassName(a)},r=[],q=[],(c.qsa=Y.test(n.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+K+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+K+"*(?:value|"+J+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){a.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var b=n.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+K+"*[*^$|!~]?="),2!==a.querySelectorAll(":enabled").length&&q.push(":enabled",":disabled"),o.appendChild(a).disabled=!0,2!==a.querySelectorAll(":disabled").length&&q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=Y.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"*"),s.call(a,"[s!='']:x"),r.push("!=",N)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=Y.test(o.compareDocumentPosition),t=b||Y.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===n||a.ownerDocument===v&&t(v,a)?-1:b===n||b.ownerDocument===v&&t(v,b)?1:k?I(k,a)-I(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,g=[a],h=[b];if(!e||!f)return a===n?-1:b===n?1:e?-1:f?1:k?I(k,a)-I(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)g.unshift(c);c=b;while(c=c.parentNode)h.unshift(c);while(g[d]===h[d])d++;return d?la(g[d],h[d]):g[d]===v?-1:h[d]===v?1:0},n):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(S,"='$1']"),c.matchesSelector&&p&&!A[b+" "]&&(!r||!r.test(b))&&(!q||!q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.escape=function(a){return(a+"").replace(ba,ca)},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(_,aa),a[3]=(a[3]||a[4]||a[5]||"").replace(_,aa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return V.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&T.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(_,aa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+K+")"+a+"("+K+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(O," ")+" ").indexOf(c)>-1:"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){while(p){m=b;while(m=m[p])if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){m=q,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n&&j[2],m=n&&q.childNodes[n];while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if(1===m.nodeType&&++t&&m===b){k[a]=[w,n,t];break}}else if(s&&(m=b,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n),t===!1)while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if((h?m.nodeName.toLowerCase()===r:1===m.nodeType)&&++t&&(s&&(l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[w,t]),m===b))break;return t-=e,t===d||t%d===0&&t/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(P,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(_,aa),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return U.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(_,aa).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:oa(!1),disabled:oa(!0),checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:pa(function(){return[0]}),last:pa(function(a,b){return[b-1]}),eq:pa(function(a,b,c){return[c<0?c+b:c]}),even:pa(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:pa(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:pa(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:pa(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function ra(){}ra.prototype=d.filters=d.pseudos,d.setFilters=new ra,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){c&&!(e=Q.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P," ")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function sa(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function ta(a,b,c){var d=b.dir,e=b.next,f=e||d,g=c&&"parentNode"===f,h=x++;return b.first?function(b,c,e){while(b=b[d])if(1===b.nodeType||g)return a(b,c,e);return!1}:function(b,c,i){var j,k,l,m=[w,h];if(i){while(b=b[d])if((1===b.nodeType||g)&&a(b,c,i))return!0}else while(b=b[d])if(1===b.nodeType||g)if(l=b[u]||(b[u]={}),k=l[b.uniqueID]||(l[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((j=k[f])&&j[0]===w&&j[1]===h)return m[2]=j[2];if(k[f]=m,m[2]=a(b,c,i))return!0}return!1}}function ua(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function va(a,b,c){for(var d=0,e=b.length;d<e;d++)ga(a,b[d],c);return c}function wa(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function xa(a,b,c,d,e,f){return d&&!d[u]&&(d=xa(d)),e&&!e[u]&&(e=xa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||va(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:wa(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=wa(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=wa(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ya(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=ta(function(a){return a===b},h,!0),l=ta(function(a){return I(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];i<f;i++)if(c=d.relative[a[i].type])m=[ta(ua(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;e<f;e++)if(d.relative[a[e].type])break;return xa(i>1&&ua(m),i>1&&sa(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(P,"$1"),c,i<e&&ya(a.slice(i,e)),e<f&&ya(a=a.slice(e)),e<f&&sa(a))}m.push(c)}return ua(m)}function za(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,o,q,r=0,s="0",t=f&&[],u=[],v=j,x=f||e&&d.find.TAG("*",k),y=w+=null==v?1:Math.random()||.1,z=x.length;for(k&&(j=g===n||g||k);s!==z&&null!=(l=x[s]);s++){if(e&&l){o=0,g||l.ownerDocument===n||(m(l),h=!p);while(q=a[o++])if(q(l,g||n,h)){i.push(l);break}k&&(w=y)}c&&((l=!q&&l)&&r--,f&&t.push(l))}if(r+=s,c&&s!==r){o=0;while(q=b[o++])q(t,u,g,h);if(f){if(r>0)while(s--)t[s]||u[s]||(u[s]=E.call(i));u=wa(u)}G.apply(i,u),k&&!f&&u.length>0&&r+b.length>1&&ga.uniqueSort(i)}return k&&(w=y,j=v),t};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=ya(b[c]),f[u]?d.push(f):e.push(f);f=A(a,za(e,d)),f.selector=a}return f},i=ga.select=function(a,b,c,e){var f,i,j,k,l,m="function"==typeof a&&a,n=!e&&g(a=m.selector||a);if(c=c||[],1===n.length){if(i=n[0]=n[0].slice(0),i.length>2&&"ID"===(j=i[0]).type&&9===b.nodeType&&p&&d.relative[i[1].type]){if(b=(d.find.ID(j.matches[0].replace(_,aa),b)||[])[0],!b)return c;m&&(b=b.parentNode),a=a.slice(i.shift().value.length)}f=V.needsContext.test(a)?0:i.length;while(f--){if(j=i[f],d.relative[k=j.type])break;if((l=d.find[k])&&(e=l(j.matches[0].replace(_,aa),$.test(i[0].type)&&qa(b.parentNode)||b))){if(i.splice(f,1),a=e.length&&sa(i),!a)return G.apply(c,e),c;break}}}return(m||h(a,n))(e,b,!p,c,!b||$.test(a)&&qa(b.parentNode)||b),c},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("fieldset"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(J,function(a,b,c){var d;if(!c)return a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);r.find=x,r.expr=x.selectors,r.expr[":"]=r.expr.pseudos,r.uniqueSort=r.unique=x.uniqueSort,r.text=x.getText,r.isXMLDoc=x.isXML,r.contains=x.contains,r.escapeSelector=x.escape;var y=function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&r(a).is(c))break;d.push(a)}return d},z=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},A=r.expr.match.needsContext;function B(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()}var C=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,D=/^.[^:#\[\.,]*$/;function E(a,b,c){return r.isFunction(b)?r.grep(a,function(a,d){return!!b.call(a,d,a)!==c}):b.nodeType?r.grep(a,function(a){return a===b!==c}):"string"!=typeof b?r.grep(a,function(a){return i.call(b,a)>-1!==c}):D.test(b)?r.filter(b,a,c):(b=r.filter(b,a),r.grep(a,function(a){return i.call(b,a)>-1!==c&&1===a.nodeType}))}r.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?r.find.matchesSelector(d,a)?[d]:[]:r.find.matches(a,r.grep(b,function(a){return 1===a.nodeType}))},r.fn.extend({find:function(a){var b,c,d=this.length,e=this;if("string"!=typeof a)return this.pushStack(r(a).filter(function(){for(b=0;b<d;b++)if(r.contains(e[b],this))return!0}));for(c=this.pushStack([]),b=0;b<d;b++)r.find(a,e[b],c);return d>1?r.uniqueSort(c):c},filter:function(a){return this.pushStack(E(this,a||[],!1))},not:function(a){return this.pushStack(E(this,a||[],!0))},is:function(a){return!!E(this,"string"==typeof a&&A.test(a)?r(a):a||[],!1).length}});var F,G=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,H=r.fn.init=function(a,b,c){var e,f;if(!a)return this;if(c=c||F,"string"==typeof a){if(e="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:G.exec(a),!e||!e[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(e[1]){if(b=b instanceof r?b[0]:b,r.merge(this,r.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:d,!0)),C.test(e[1])&&r.isPlainObject(b))for(e in b)r.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e]);return this}return f=d.getElementById(e[2]),f&&(this[0]=f,this.length=1),this}return a.nodeType?(this[0]=a,this.length=1,this):r.isFunction(a)?void 0!==c.ready?c.ready(a):a(r):r.makeArray(a,this)};H.prototype=r.fn,F=r(d);var I=/^(?:parents|prev(?:Until|All))/,J={children:!0,contents:!0,next:!0,prev:!0};r.fn.extend({has:function(a){var b=r(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(r.contains(this,b[a]))return!0})},closest:function(a,b){var c,d=0,e=this.length,f=[],g="string"!=typeof a&&r(a);if(!A.test(a))for(;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&r.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?r.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?i.call(r(a),this[0]):i.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(r.uniqueSort(r.merge(this.get(),r(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function K(a,b){while((a=a[b])&&1!==a.nodeType);return a}r.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return y(a,"parentNode")},parentsUntil:function(a,b,c){return y(a,"parentNode",c)},next:function(a){return K(a,"nextSibling")},prev:function(a){return K(a,"previousSibling")},nextAll:function(a){return y(a,"nextSibling")},prevAll:function(a){return y(a,"previousSibling")},nextUntil:function(a,b,c){return y(a,"nextSibling",c)},prevUntil:function(a,b,c){return y(a,"previousSibling",c)},siblings:function(a){return z((a.parentNode||{}).firstChild,a)},children:function(a){return z(a.firstChild)},contents:function(a){return B(a,"iframe")?a.contentDocument:(B(a,"template")&&(a=a.content||a),r.merge([],a.childNodes))}},function(a,b){r.fn[a]=function(c,d){var e=r.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=r.filter(d,e)),this.length>1&&(J[a]||r.uniqueSort(e),I.test(a)&&e.reverse()),this.pushStack(e)}});var L=/[^\x20\t\r\n\f]+/g;function M(a){var b={};return r.each(a.match(L)||[],function(a,c){b[c]=!0}),b}r.Callbacks=function(a){a="string"==typeof a?M(a):r.extend({},a);var b,c,d,e,f=[],g=[],h=-1,i=function(){for(e=e||a.once,d=b=!0;g.length;h=-1){c=g.shift();while(++h<f.length)f[h].apply(c[0],c[1])===!1&&a.stopOnFalse&&(h=f.length,c=!1)}a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},j={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function d(b){r.each(b,function(b,c){r.isFunction(c)?a.unique&&j.has(c)||f.push(c):c&&c.length&&"string"!==r.type(c)&&d(c)})}(arguments),c&&!b&&i()),this},remove:function(){return r.each(arguments,function(a,b){var c;while((c=r.inArray(b,f,c))>-1)f.splice(c,1),c<=h&&h--}),this},has:function(a){return a?r.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=g=[],c||b||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return j.fireWith(this,arguments),this},fired:function(){return!!d}};return j};function N(a){return a}function O(a){throw a}function P(a,b,c,d){var e;try{a&&r.isFunction(e=a.promise)?e.call(a).done(b).fail(c):a&&r.isFunction(e=a.then)?e.call(a,b,c):b.apply(void 0,[a].slice(d))}catch(a){c.apply(void 0,[a])}}r.extend({Deferred:function(b){var c=[["notify","progress",r.Callbacks("memory"),r.Callbacks("memory"),2],["resolve","done",r.Callbacks("once memory"),r.Callbacks("once memory"),0,"resolved"],["reject","fail",r.Callbacks("once memory"),r.Callbacks("once memory"),1,"rejected"]],d="pending",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),this},"catch":function(a){return e.then(null,a)},pipe:function(){var a=arguments;return r.Deferred(function(b){r.each(c,function(c,d){var e=r.isFunction(a[d[4]])&&a[d[4]];f[d[1]](function(){var a=e&&e.apply(this,arguments);a&&r.isFunction(a.promise)?a.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[d[0]+"With"](this,e?[a]:arguments)})}),a=null}).promise()},then:function(b,d,e){var f=0;function g(b,c,d,e){return function(){var h=this,i=arguments,j=function(){var a,j;if(!(b<f)){if(a=d.apply(h,i),a===c.promise())throw new TypeError("Thenable self-resolution");j=a&&("object"==typeof a||"function"==typeof a)&&a.then,r.isFunction(j)?e?j.call(a,g(f,c,N,e),g(f,c,O,e)):(f++,j.call(a,g(f,c,N,e),g(f,c,O,e),g(f,c,N,c.notifyWith))):(d!==N&&(h=void 0,i=[a]),(e||c.resolveWith)(h,i))}},k=e?j:function(){try{j()}catch(a){r.Deferred.exceptionHook&&r.Deferred.exceptionHook(a,k.stackTrace),b+1>=f&&(d!==O&&(h=void 0,i=[a]),c.rejectWith(h,i))}};b?k():(r.Deferred.getStackHook&&(k.stackTrace=r.Deferred.getStackHook()),a.setTimeout(k))}}return r.Deferred(function(a){c[0][3].add(g(0,a,r.isFunction(e)?e:N,a.notifyWith)),c[1][3].add(g(0,a,r.isFunction(b)?b:N)),c[2][3].add(g(0,a,r.isFunction(d)?d:O))}).promise()},promise:function(a){return null!=a?r.extend(a,e):e}},f={};return r.each(c,function(a,b){var g=b[2],h=b[5];e[b[1]]=g.add,h&&g.add(function(){d=h},c[3-a][2].disable,c[0][2].lock),g.add(b[3].fire),f[b[0]]=function(){return f[b[0]+"With"](this===f?void 0:this,arguments),this},f[b[0]+"With"]=g.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(a){var b=arguments.length,c=b,d=Array(c),e=f.call(arguments),g=r.Deferred(),h=function(a){return function(c){d[a]=this,e[a]=arguments.length>1?f.call(arguments):c,--b||g.resolveWith(d,e)}};if(b<=1&&(P(a,g.done(h(c)).resolve,g.reject,!b),"pending"===g.state()||r.isFunction(e[c]&&e[c].then)))return g.then();while(c--)P(e[c],h(c),g.reject);return g.promise()}});var Q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;r.Deferred.exceptionHook=function(b,c){a.console&&a.console.warn&&b&&Q.test(b.name)&&a.console.warn("jQuery.Deferred exception: "+b.message,b.stack,c)},r.readyException=function(b){a.setTimeout(function(){throw b})};var R=r.Deferred();r.fn.ready=function(a){return R.then(a)["catch"](function(a){r.readyException(a)}),this},r.extend({isReady:!1,readyWait:1,ready:function(a){(a===!0?--r.readyWait:r.isReady)||(r.isReady=!0,a!==!0&&--r.readyWait>0||R.resolveWith(d,[r]))}}),r.ready.then=R.then;function S(){d.removeEventListener("DOMContentLoaded",S),
    a.removeEventListener("load",S),r.ready()}"complete"===d.readyState||"loading"!==d.readyState&&!d.documentElement.doScroll?a.setTimeout(r.ready):(d.addEventListener("DOMContentLoaded",S),a.addEventListener("load",S));var T=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===r.type(c)){e=!0;for(h in c)T(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,r.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(r(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},U=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function V(){this.expando=r.expando+V.uid++}V.uid=1,V.prototype={cache:function(a){var b=a[this.expando];return b||(b={},U(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[r.camelCase(b)]=c;else for(d in b)e[r.camelCase(d)]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][r.camelCase(b)]},access:function(a,b,c){return void 0===b||b&&"string"==typeof b&&void 0===c?this.get(a,b):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d=a[this.expando];if(void 0!==d){if(void 0!==b){Array.isArray(b)?b=b.map(r.camelCase):(b=r.camelCase(b),b=b in d?[b]:b.match(L)||[]),c=b.length;while(c--)delete d[b[c]]}(void 0===b||r.isEmptyObject(d))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!r.isEmptyObject(b)}};var W=new V,X=new V,Y=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Z=/[A-Z]/g;function $(a){return"true"===a||"false"!==a&&("null"===a?null:a===+a+""?+a:Y.test(a)?JSON.parse(a):a)}function _(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Z,"-$&").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c=$(c)}catch(e){}X.set(a,b,c)}else c=void 0;return c}r.extend({hasData:function(a){return X.hasData(a)||W.hasData(a)},data:function(a,b,c){return X.access(a,b,c)},removeData:function(a,b){X.remove(a,b)},_data:function(a,b,c){return W.access(a,b,c)},_removeData:function(a,b){W.remove(a,b)}}),r.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=X.get(f),1===f.nodeType&&!W.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=r.camelCase(d.slice(5)),_(f,d,e[d])));W.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){X.set(this,a)}):T(this,function(b){var c;if(f&&void 0===b){if(c=X.get(f,a),void 0!==c)return c;if(c=_(f,a),void 0!==c)return c}else this.each(function(){X.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){X.remove(this,a)})}}),r.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=W.get(a,b),c&&(!d||Array.isArray(c)?d=W.access(a,b,r.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=r.queue(a,b),d=c.length,e=c.shift(),f=r._queueHooks(a,b),g=function(){r.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return W.get(a,c)||W.access(a,c,{empty:r.Callbacks("once memory").add(function(){W.remove(a,[b+"queue",c])})})}}),r.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?r.queue(this[0],a):void 0===b?this:this.each(function(){var c=r.queue(this,a,b);r._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&r.dequeue(this,a)})},dequeue:function(a){return this.each(function(){r.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=r.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=W.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var aa=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ba=new RegExp("^(?:([+-])=|)("+aa+")([a-z%]*)$","i"),ca=["Top","Right","Bottom","Left"],da=function(a,b){return a=b||a,"none"===a.style.display||""===a.style.display&&r.contains(a.ownerDocument,a)&&"none"===r.css(a,"display")},ea=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};function fa(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return r.css(a,b,"")},i=h(),j=c&&c[3]||(r.cssNumber[b]?"":"px"),k=(r.cssNumber[b]||"px"!==j&&+i)&&ba.exec(r.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do f=f||".5",k/=f,r.style(a,b,k+j);while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}var ga={};function ha(a){var b,c=a.ownerDocument,d=a.nodeName,e=ga[d];return e?e:(b=c.body.appendChild(c.createElement(d)),e=r.css(b,"display"),b.parentNode.removeChild(b),"none"===e&&(e="block"),ga[d]=e,e)}function ia(a,b){for(var c,d,e=[],f=0,g=a.length;f<g;f++)d=a[f],d.style&&(c=d.style.display,b?("none"===c&&(e[f]=W.get(d,"display")||null,e[f]||(d.style.display="")),""===d.style.display&&da(d)&&(e[f]=ha(d))):"none"!==c&&(e[f]="none",W.set(d,"display",c)));for(f=0;f<g;f++)null!=e[f]&&(a[f].style.display=e[f]);return a}r.fn.extend({show:function(){return ia(this,!0)},hide:function(){return ia(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){da(this)?r(this).show():r(this).hide()})}});var ja=/^(?:checkbox|radio)$/i,ka=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,la=/^$|\/(?:java|ecma)script/i,ma={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ma.optgroup=ma.option,ma.tbody=ma.tfoot=ma.colgroup=ma.caption=ma.thead,ma.th=ma.td;function na(a,b){var c;return c="undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName(b||"*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll(b||"*"):[],void 0===b||b&&B(a,b)?r.merge([a],c):c}function oa(a,b){for(var c=0,d=a.length;c<d;c++)W.set(a[c],"globalEval",!b||W.get(b[c],"globalEval"))}var pa=/<|&#?\w+;/;function qa(a,b,c,d,e){for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],n=0,o=a.length;n<o;n++)if(f=a[n],f||0===f)if("object"===r.type(f))r.merge(m,f.nodeType?[f]:f);else if(pa.test(f)){g=g||l.appendChild(b.createElement("div")),h=(ka.exec(f)||["",""])[1].toLowerCase(),i=ma[h]||ma._default,g.innerHTML=i[1]+r.htmlPrefilter(f)+i[2],k=i[0];while(k--)g=g.lastChild;r.merge(m,g.childNodes),g=l.firstChild,g.textContent=""}else m.push(b.createTextNode(f));l.textContent="",n=0;while(f=m[n++])if(d&&r.inArray(f,d)>-1)e&&e.push(f);else if(j=r.contains(f.ownerDocument,f),g=na(l.appendChild(f),"script"),j&&oa(g),c){k=0;while(f=g[k++])la.test(f.type||"")&&c.push(f)}return l}!function(){var a=d.createDocumentFragment(),b=a.appendChild(d.createElement("div")),c=d.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),o.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",o.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var ra=d.documentElement,sa=/^key/,ta=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ua=/^([^.]*)(?:\.(.+)|)/;function va(){return!0}function wa(){return!1}function xa(){try{return d.activeElement}catch(a){}}function ya(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)ya(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),e===!1)e=wa;else if(!e)return a;return 1===f&&(g=e,e=function(a){return r().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=r.guid++)),a.each(function(){r.event.add(this,b,e,d,c)})}r.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=W.get(a);if(q){c.handler&&(f=c,c=f.handler,e=f.selector),e&&r.find.matchesSelector(ra,e),c.guid||(c.guid=r.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return"undefined"!=typeof r&&r.event.triggered!==b.type?r.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(L)||[""],j=b.length;while(j--)h=ua.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=r.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=r.event.special[n]||{},k=r.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&r.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),r.event.global[n]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=W.hasData(a)&&W.get(a);if(q&&(i=q.events)){b=(b||"").match(L)||[""],j=b.length;while(j--)if(h=ua.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){l=r.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||r.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)r.event.remove(a,n+b[j],c,d,!0);r.isEmptyObject(i)&&W.remove(a,"handle events")}},dispatch:function(a){var b=r.event.fix(a),c,d,e,f,g,h,i=new Array(arguments.length),j=(W.get(this,"events")||{})[b.type]||[],k=r.event.special[b.type]||{};for(i[0]=b,c=1;c<arguments.length;c++)i[c]=arguments[c];if(b.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,b)!==!1){h=r.event.handlers.call(this,b,j),c=0;while((f=h[c++])&&!b.isPropagationStopped()){b.currentTarget=f.elem,d=0;while((g=f.handlers[d++])&&!b.isImmediatePropagationStopped())b.rnamespace&&!b.rnamespace.test(g.namespace)||(b.handleObj=g,b.data=g.data,e=((r.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(b.result=e)===!1&&(b.preventDefault(),b.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,b),b.result}},handlers:function(a,b){var c,d,e,f,g,h=[],i=b.delegateCount,j=a.target;if(i&&j.nodeType&&!("click"===a.type&&a.button>=1))for(;j!==this;j=j.parentNode||this)if(1===j.nodeType&&("click"!==a.type||j.disabled!==!0)){for(f=[],g={},c=0;c<i;c++)d=b[c],e=d.selector+" ",void 0===g[e]&&(g[e]=d.needsContext?r(e,this).index(j)>-1:r.find(e,this,null,[j]).length),g[e]&&f.push(d);f.length&&h.push({elem:j,handlers:f})}return j=this,i<b.length&&h.push({elem:j,handlers:b.slice(i)}),h},addProp:function(a,b){Object.defineProperty(r.Event.prototype,a,{enumerable:!0,configurable:!0,get:r.isFunction(b)?function(){if(this.originalEvent)return b(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[a]},set:function(b){Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(a){return a[r.expando]?a:new r.Event(a)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==xa()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===xa()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&B(this,"input"))return this.click(),!1},_default:function(a){return B(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},r.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},r.Event=function(a,b){return this instanceof r.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?va:wa,this.target=a.target&&3===a.target.nodeType?a.target.parentNode:a.target,this.currentTarget=a.currentTarget,this.relatedTarget=a.relatedTarget):this.type=a,b&&r.extend(this,b),this.timeStamp=a&&a.timeStamp||r.now(),void(this[r.expando]=!0)):new r.Event(a,b)},r.Event.prototype={constructor:r.Event,isDefaultPrevented:wa,isPropagationStopped:wa,isImmediatePropagationStopped:wa,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=va,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=va,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=va,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},r.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(a){var b=a.button;return null==a.which&&sa.test(a.type)?null!=a.charCode?a.charCode:a.keyCode:!a.which&&void 0!==b&&ta.test(a.type)?1&b?1:2&b?3:4&b?2:0:a.which}},r.event.addProp),r.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){r.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||r.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),r.fn.extend({on:function(a,b,c,d){return ya(this,a,b,c,d)},one:function(a,b,c,d){return ya(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,r(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&"function"!=typeof b||(c=b,b=void 0),c===!1&&(c=wa),this.each(function(){r.event.remove(this,a,c,b)})}});var za=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Aa=/<script|<style|<link/i,Ba=/checked\s*(?:[^=]|=\s*.checked.)/i,Ca=/^true\/(.*)/,Da=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ea(a,b){return B(a,"table")&&B(11!==b.nodeType?b:b.firstChild,"tr")?r(">tbody",a)[0]||a:a}function Fa(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function Ga(a){var b=Ca.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function Ha(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(W.hasData(a)&&(f=W.access(a),g=W.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)r.event.add(b,e,j[e][c])}X.hasData(a)&&(h=X.access(a),i=r.extend({},h),X.set(b,i))}}function Ia(a,b){var c=b.nodeName.toLowerCase();"input"===c&&ja.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function Ja(a,b,c,d){b=g.apply([],b);var e,f,h,i,j,k,l=0,m=a.length,n=m-1,q=b[0],s=r.isFunction(q);if(s||m>1&&"string"==typeof q&&!o.checkClone&&Ba.test(q))return a.each(function(e){var f=a.eq(e);s&&(b[0]=q.call(this,e,f.html())),Ja(f,b,c,d)});if(m&&(e=qa(b,a[0].ownerDocument,!1,a,d),f=e.firstChild,1===e.childNodes.length&&(e=f),f||d)){for(h=r.map(na(e,"script"),Fa),i=h.length;l<m;l++)j=e,l!==n&&(j=r.clone(j,!0,!0),i&&r.merge(h,na(j,"script"))),c.call(a[l],j,l);if(i)for(k=h[h.length-1].ownerDocument,r.map(h,Ga),l=0;l<i;l++)j=h[l],la.test(j.type||"")&&!W.access(j,"globalEval")&&r.contains(k,j)&&(j.src?r._evalUrl&&r._evalUrl(j.src):p(j.textContent.replace(Da,""),k))}return a}function Ka(a,b,c){for(var d,e=b?r.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||r.cleanData(na(d)),d.parentNode&&(c&&r.contains(d.ownerDocument,d)&&oa(na(d,"script")),d.parentNode.removeChild(d));return a}r.extend({htmlPrefilter:function(a){return a.replace(za,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=r.contains(a.ownerDocument,a);if(!(o.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||r.isXMLDoc(a)))for(g=na(h),f=na(a),d=0,e=f.length;d<e;d++)Ia(f[d],g[d]);if(b)if(c)for(f=f||na(a),g=g||na(h),d=0,e=f.length;d<e;d++)Ha(f[d],g[d]);else Ha(a,h);return g=na(h,"script"),g.length>0&&oa(g,!i&&na(a,"script")),h},cleanData:function(a){for(var b,c,d,e=r.event.special,f=0;void 0!==(c=a[f]);f++)if(U(c)){if(b=c[W.expando]){if(b.events)for(d in b.events)e[d]?r.event.remove(c,d):r.removeEvent(c,d,b.handle);c[W.expando]=void 0}c[X.expando]&&(c[X.expando]=void 0)}}}),r.fn.extend({detach:function(a){return Ka(this,a,!0)},remove:function(a){return Ka(this,a)},text:function(a){return T(this,function(a){return void 0===a?r.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return Ja(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Ea(this,a);b.appendChild(a)}})},prepend:function(){return Ja(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Ea(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return Ja(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return Ja(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(r.cleanData(na(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return r.clone(this,a,b)})},html:function(a){return T(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Aa.test(a)&&!ma[(ka.exec(a)||["",""])[1].toLowerCase()]){a=r.htmlPrefilter(a);try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(r.cleanData(na(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return Ja(this,arguments,function(b){var c=this.parentNode;r.inArray(this,a)<0&&(r.cleanData(na(this)),c&&c.replaceChild(b,this))},a)}}),r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){r.fn[a]=function(a){for(var c,d=[],e=r(a),f=e.length-1,g=0;g<=f;g++)c=g===f?this:this.clone(!0),r(e[g])[b](c),h.apply(d,c.get());return this.pushStack(d)}});var La=/^margin/,Ma=new RegExp("^("+aa+")(?!px)[a-z%]+$","i"),Na=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)};!function(){function b(){if(i){i.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",i.innerHTML="",ra.appendChild(h);var b=a.getComputedStyle(i);c="1%"!==b.top,g="2px"===b.marginLeft,e="4px"===b.width,i.style.marginRight="50%",f="4px"===b.marginRight,ra.removeChild(h),i=null}}var c,e,f,g,h=d.createElement("div"),i=d.createElement("div");i.style&&(i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",o.clearCloneStyle="content-box"===i.style.backgroundClip,h.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",h.appendChild(i),r.extend(o,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return b(),e},pixelMarginRight:function(){return b(),f},reliableMarginLeft:function(){return b(),g}}))}();function Oa(a,b,c){var d,e,f,g,h=a.style;return c=c||Na(a),c&&(g=c.getPropertyValue(b)||c[b],""!==g||r.contains(a.ownerDocument,a)||(g=r.style(a,b)),!o.pixelMarginRight()&&Ma.test(g)&&La.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function Pa(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}var Qa=/^(none|table(?!-c[ea]).+)/,Ra=/^--/,Sa={position:"absolute",visibility:"hidden",display:"block"},Ta={letterSpacing:"0",fontWeight:"400"},Ua=["Webkit","Moz","ms"],Va=d.createElement("div").style;function Wa(a){if(a in Va)return a;var b=a[0].toUpperCase()+a.slice(1),c=Ua.length;while(c--)if(a=Ua[c]+b,a in Va)return a}function Xa(a){var b=r.cssProps[a];return b||(b=r.cssProps[a]=Wa(a)||a),b}function Ya(a,b,c){var d=ba.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function Za(a,b,c,d,e){var f,g=0;for(f=c===(d?"border":"content")?4:"width"===b?1:0;f<4;f+=2)"margin"===c&&(g+=r.css(a,c+ca[f],!0,e)),d?("content"===c&&(g-=r.css(a,"padding"+ca[f],!0,e)),"margin"!==c&&(g-=r.css(a,"border"+ca[f]+"Width",!0,e))):(g+=r.css(a,"padding"+ca[f],!0,e),"padding"!==c&&(g+=r.css(a,"border"+ca[f]+"Width",!0,e)));return g}function $a(a,b,c){var d,e=Na(a),f=Oa(a,b,e),g="border-box"===r.css(a,"boxSizing",!1,e);return Ma.test(f)?f:(d=g&&(o.boxSizingReliable()||f===a.style[b]),"auto"===f&&(f=a["offset"+b[0].toUpperCase()+b.slice(1)]),f=parseFloat(f)||0,f+Za(a,b,c||(g?"border":"content"),d,e)+"px")}r.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Oa(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=r.camelCase(b),i=Ra.test(b),j=a.style;return i||(b=Xa(h)),g=r.cssHooks[b]||r.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:j[b]:(f=typeof c,"string"===f&&(e=ba.exec(c))&&e[1]&&(c=fa(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(r.cssNumber[h]?"":"px")),o.clearCloneStyle||""!==c||0!==b.indexOf("background")||(j[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i?j.setProperty(b,c):j[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=r.camelCase(b),i=Ra.test(b);return i||(b=Xa(h)),g=r.cssHooks[b]||r.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=Oa(a,b,d)),"normal"===e&&b in Ta&&(e=Ta[b]),""===c||c?(f=parseFloat(e),c===!0||isFinite(f)?f||0:e):e}}),r.each(["height","width"],function(a,b){r.cssHooks[b]={get:function(a,c,d){if(c)return!Qa.test(r.css(a,"display"))||a.getClientRects().length&&a.getBoundingClientRect().width?$a(a,b,d):ea(a,Sa,function(){return $a(a,b,d)})},set:function(a,c,d){var e,f=d&&Na(a),g=d&&Za(a,b,d,"border-box"===r.css(a,"boxSizing",!1,f),f);return g&&(e=ba.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=r.css(a,b)),Ya(a,c,g)}}}),r.cssHooks.marginLeft=Pa(o.reliableMarginLeft,function(a,b){if(b)return(parseFloat(Oa(a,"marginLeft"))||a.getBoundingClientRect().left-ea(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px"}),r.each({margin:"",padding:"",border:"Width"},function(a,b){r.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+ca[d]+b]=f[d]||f[d-2]||f[0];return e}},La.test(a)||(r.cssHooks[a+b].set=Ya)}),r.fn.extend({css:function(a,b){return T(this,function(a,b,c){var d,e,f={},g=0;if(Array.isArray(b)){for(d=Na(a),e=b.length;g<e;g++)f[b[g]]=r.css(a,b[g],!1,d);return f}return void 0!==c?r.style(a,b,c):r.css(a,b)},a,b,arguments.length>1)}});function _a(a,b,c,d,e){return new _a.prototype.init(a,b,c,d,e)}r.Tween=_a,_a.prototype={constructor:_a,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||r.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(r.cssNumber[c]?"":"px")},cur:function(){var a=_a.propHooks[this.prop];return a&&a.get?a.get(this):_a.propHooks._default.get(this)},run:function(a){var b,c=_a.propHooks[this.prop];return this.options.duration?this.pos=b=r.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):_a.propHooks._default.set(this),this}},_a.prototype.init.prototype=_a.prototype,_a.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=r.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){r.fx.step[a.prop]?r.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[r.cssProps[a.prop]]&&!r.cssHooks[a.prop]?a.elem[a.prop]=a.now:r.style(a.elem,a.prop,a.now+a.unit)}}},_a.propHooks.scrollTop=_a.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},r.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},r.fx=_a.prototype.init,r.fx.step={};var ab,bb,cb=/^(?:toggle|show|hide)$/,db=/queueHooks$/;function eb(){bb&&(d.hidden===!1&&a.requestAnimationFrame?a.requestAnimationFrame(eb):a.setTimeout(eb,r.fx.interval),r.fx.tick())}function fb(){return a.setTimeout(function(){ab=void 0}),ab=r.now()}function gb(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=ca[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function hb(a,b,c){for(var d,e=(kb.tweeners[b]||[]).concat(kb.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function ib(a,b,c){var d,e,f,g,h,i,j,k,l="width"in b||"height"in b,m=this,n={},o=a.style,p=a.nodeType&&da(a),q=W.get(a,"fxshow");c.queue||(g=r._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,m.always(function(){m.always(function(){g.unqueued--,r.queue(a,"fx").length||g.empty.fire()})}));for(d in b)if(e=b[d],cb.test(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}n[d]=q&&q[d]||r.style(a,d)}if(i=!r.isEmptyObject(b),i||!r.isEmptyObject(n)){l&&1===a.nodeType&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=q&&q.display,null==j&&(j=W.get(a,"display")),k=r.css(a,"display"),"none"===k&&(j?k=j:(ia([a],!0),j=a.style.display||j,k=r.css(a,"display"),ia([a]))),("inline"===k||"inline-block"===k&&null!=j)&&"none"===r.css(a,"float")&&(i||(m.done(function(){o.display=j}),null==j&&(k=o.display,j="none"===k?"":k)),o.display="inline-block")),c.overflow&&(o.overflow="hidden",m.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]})),i=!1;for(d in n)i||(q?"hidden"in q&&(p=q.hidden):q=W.access(a,"fxshow",{display:j}),f&&(q.hidden=!p),p&&ia([a],!0),m.done(function(){p||ia([a]),W.remove(a,"fxshow");for(d in n)r.style(a,d,n[d])})),i=hb(p?q[d]:0,d,m),d in q||(q[d]=i.start,p&&(i.end=i.start,i.start=0))}}function jb(a,b){var c,d,e,f,g;for(c in a)if(d=r.camelCase(c),e=b[d],f=a[c],Array.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=r.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function kb(a,b,c){var d,e,f=0,g=kb.prefilters.length,h=r.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=ab||fb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(i||h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:r.extend({},b),opts:r.extend(!0,{specialEasing:{},easing:r.easing._default},c),originalProperties:b,originalOptions:c,startTime:ab||fb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=r.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(jb(k,j.opts.specialEasing);f<g;f++)if(d=kb.prefilters[f].call(j,a,k,j.opts))return r.isFunction(d.stop)&&(r._queueHooks(j.elem,j.opts.queue).stop=r.proxy(d.stop,d)),d;return r.map(k,hb,j),r.isFunction(j.opts.start)&&j.opts.start.call(a,j),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always),r.fx.timer(r.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j}r.Animation=r.extend(kb,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return fa(c.elem,a,ba.exec(b),c),c}]},tweener:function(a,b){r.isFunction(a)?(b=a,a=["*"]):a=a.match(L);for(var c,d=0,e=a.length;d<e;d++)c=a[d],kb.tweeners[c]=kb.tweeners[c]||[],kb.tweeners[c].unshift(b)},prefilters:[ib],prefilter:function(a,b){b?kb.prefilters.unshift(a):kb.prefilters.push(a)}}),r.speed=function(a,b,c){var d=a&&"object"==typeof a?r.extend({},a):{complete:c||!c&&b||r.isFunction(a)&&a,duration:a,easing:c&&b||b&&!r.isFunction(b)&&b};return r.fx.off?d.duration=0:"number"!=typeof d.duration&&(d.duration in r.fx.speeds?d.duration=r.fx.speeds[d.duration]:d.duration=r.fx.speeds._default),null!=d.queue&&d.queue!==!0||(d.queue="fx"),d.old=d.complete,d.complete=function(){r.isFunction(d.old)&&d.old.call(this),d.queue&&r.dequeue(this,d.queue)},d},r.fn.extend({fadeTo:function(a,b,c,d){return this.filter(da).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=r.isEmptyObject(a),f=r.speed(b,c,d),g=function(){var b=kb(this,r.extend({},a),f);(e||W.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=r.timers,g=W.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&db.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||r.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=W.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=r.timers,g=d?d.length:0;for(c.finish=!0,r.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),r.each(["toggle","show","hide"],function(a,b){var c=r.fn[b];r.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(gb(b,!0),a,d,e)}}),r.each({slideDown:gb("show"),slideUp:gb("hide"),slideToggle:gb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){r.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),r.timers=[],r.fx.tick=function(){var a,b=0,c=r.timers;for(ab=r.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||r.fx.stop(),ab=void 0},r.fx.timer=function(a){r.timers.push(a),r.fx.start()},r.fx.interval=13,r.fx.start=function(){bb||(bb=!0,eb())},r.fx.stop=function(){bb=null},r.fx.speeds={slow:600,fast:200,_default:400},r.fn.delay=function(b,c){return b=r.fx?r.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=d.createElement("input"),b=d.createElement("select"),c=b.appendChild(d.createElement("option"));a.type="checkbox",o.checkOn=""!==a.value,o.optSelected=c.selected,a=d.createElement("input"),a.value="t",a.type="radio",o.radioValue="t"===a.value}();var lb,mb=r.expr.attrHandle;r.fn.extend({attr:function(a,b){return T(this,r.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){r.removeAttr(this,a)})}}),r.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return"undefined"==typeof a.getAttribute?r.prop(a,b,c):(1===f&&r.isXMLDoc(a)||(e=r.attrHooks[b.toLowerCase()]||(r.expr.match.bool.test(b)?lb:void 0)),void 0!==c?null===c?void r.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=r.find.attr(a,b),
        null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!o.radioValue&&"radio"===b&&B(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d=0,e=b&&b.match(L);if(e&&1===a.nodeType)while(c=e[d++])a.removeAttribute(c)}}),lb={set:function(a,b,c){return b===!1?r.removeAttr(a,c):a.setAttribute(c,c),c}},r.each(r.expr.match.bool.source.match(/\w+/g),function(a,b){var c=mb[b]||r.find.attr;mb[b]=function(a,b,d){var e,f,g=b.toLowerCase();return d||(f=mb[g],mb[g]=e,e=null!=c(a,b,d)?g:null,mb[g]=f),e}});var nb=/^(?:input|select|textarea|button)$/i,ob=/^(?:a|area)$/i;r.fn.extend({prop:function(a,b){return T(this,r.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[r.propFix[a]||a]})}}),r.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&r.isXMLDoc(a)||(b=r.propFix[b]||b,e=r.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=r.find.attr(a,"tabindex");return b?parseInt(b,10):nb.test(a.nodeName)||ob.test(a.nodeName)&&a.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),o.optSelected||(r.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),r.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){r.propFix[this.toLowerCase()]=this});function pb(a){var b=a.match(L)||[];return b.join(" ")}function qb(a){return a.getAttribute&&a.getAttribute("class")||""}r.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).addClass(a.call(this,b,qb(this)))});if("string"==typeof a&&a){b=a.match(L)||[];while(c=this[i++])if(e=qb(c),d=1===c.nodeType&&" "+pb(e)+" "){g=0;while(f=b[g++])d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=pb(d),e!==h&&c.setAttribute("class",h)}}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).removeClass(a.call(this,b,qb(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a){b=a.match(L)||[];while(c=this[i++])if(e=qb(c),d=1===c.nodeType&&" "+pb(e)+" "){g=0;while(f=b[g++])while(d.indexOf(" "+f+" ")>-1)d=d.replace(" "+f+" "," ");h=pb(d),e!==h&&c.setAttribute("class",h)}}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):r.isFunction(a)?this.each(function(c){r(this).toggleClass(a.call(this,c,qb(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c){d=0,e=r(this),f=a.match(L)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else void 0!==a&&"boolean"!==c||(b=qb(this),b&&W.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||a===!1?"":W.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;b=" "+a+" ";while(c=this[d++])if(1===c.nodeType&&(" "+pb(qb(c))+" ").indexOf(b)>-1)return!0;return!1}});var rb=/\r/g;r.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=r.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,r(this).val()):a,null==e?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=r.map(e,function(a){return null==a?"":a+""})),b=r.valHooks[this.type]||r.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=r.valHooks[e.type]||r.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(rb,""):null==c?"":c)}}}),r.extend({valHooks:{option:{get:function(a){var b=r.find.attr(a,"value");return null!=b?b:pb(r.text(a))}},select:{get:function(a){var b,c,d,e=a.options,f=a.selectedIndex,g="select-one"===a.type,h=g?null:[],i=g?f+1:e.length;for(d=f<0?i:g?f:0;d<i;d++)if(c=e[d],(c.selected||d===f)&&!c.disabled&&(!c.parentNode.disabled||!B(c.parentNode,"optgroup"))){if(b=r(c).val(),g)return b;h.push(b)}return h},set:function(a,b){var c,d,e=a.options,f=r.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=r.inArray(r.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),r.each(["radio","checkbox"],function(){r.valHooks[this]={set:function(a,b){if(Array.isArray(b))return a.checked=r.inArray(r(a).val(),b)>-1}},o.checkOn||(r.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var sb=/^(?:focusinfocus|focusoutblur)$/;r.extend(r.event,{trigger:function(b,c,e,f){var g,h,i,j,k,m,n,o=[e||d],p=l.call(b,"type")?b.type:b,q=l.call(b,"namespace")?b.namespace.split("."):[];if(h=i=e=e||d,3!==e.nodeType&&8!==e.nodeType&&!sb.test(p+r.event.triggered)&&(p.indexOf(".")>-1&&(q=p.split("."),p=q.shift(),q.sort()),k=p.indexOf(":")<0&&"on"+p,b=b[r.expando]?b:new r.Event(p,"object"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=q.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=e),c=null==c?[b]:r.makeArray(c,[b]),n=r.event.special[p]||{},f||!n.trigger||n.trigger.apply(e,c)!==!1)){if(!f&&!n.noBubble&&!r.isWindow(e)){for(j=n.delegateType||p,sb.test(j+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),i=h;i===(e.ownerDocument||d)&&o.push(i.defaultView||i.parentWindow||a)}g=0;while((h=o[g++])&&!b.isPropagationStopped())b.type=g>1?j:n.bindType||p,m=(W.get(h,"events")||{})[b.type]&&W.get(h,"handle"),m&&m.apply(h,c),m=k&&h[k],m&&m.apply&&U(h)&&(b.result=m.apply(h,c),b.result===!1&&b.preventDefault());return b.type=p,f||b.isDefaultPrevented()||n._default&&n._default.apply(o.pop(),c)!==!1||!U(e)||k&&r.isFunction(e[p])&&!r.isWindow(e)&&(i=e[k],i&&(e[k]=null),r.event.triggered=p,e[p](),r.event.triggered=void 0,i&&(e[k]=i)),b.result}},simulate:function(a,b,c){var d=r.extend(new r.Event,c,{type:a,isSimulated:!0});r.event.trigger(d,null,b)}}),r.fn.extend({trigger:function(a,b){return this.each(function(){r.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return r.event.trigger(a,b,c,!0)}}),r.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(a,b){r.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),r.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),o.focusin="onfocusin"in a,o.focusin||r.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){r.event.simulate(b,a.target,r.event.fix(a))};r.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=W.access(d,b);e||d.addEventListener(a,c,!0),W.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=W.access(d,b)-1;e?W.access(d,b,e):(d.removeEventListener(a,c,!0),W.remove(d,b))}}});var tb=a.location,ub=r.now(),vb=/\?/;r.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(d){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||r.error("Invalid XML: "+b),c};var wb=/\[\]$/,xb=/\r?\n/g,yb=/^(?:submit|button|image|reset|file)$/i,zb=/^(?:input|select|textarea|keygen)/i;function Ab(a,b,c,d){var e;if(Array.isArray(b))r.each(b,function(b,e){c||wb.test(a)?d(a,e):Ab(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==r.type(b))d(a,b);else for(e in b)Ab(a+"["+e+"]",b[e],c,d)}r.param=function(a,b){var c,d=[],e=function(a,b){var c=r.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(null==c?"":c)};if(Array.isArray(a)||a.jquery&&!r.isPlainObject(a))r.each(a,function(){e(this.name,this.value)});else for(c in a)Ab(c,a[c],b,e);return d.join("&")},r.fn.extend({serialize:function(){return r.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=r.prop(this,"elements");return a?r.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!r(this).is(":disabled")&&zb.test(this.nodeName)&&!yb.test(a)&&(this.checked||!ja.test(a))}).map(function(a,b){var c=r(this).val();return null==c?null:Array.isArray(c)?r.map(c,function(a){return{name:b.name,value:a.replace(xb,"\r\n")}}):{name:b.name,value:c.replace(xb,"\r\n")}}).get()}});var Bb=/%20/g,Cb=/#.*$/,Db=/([?&])_=[^&]*/,Eb=/^(.*?):[ \t]*([^\r\n]*)$/gm,Fb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Gb=/^(?:GET|HEAD)$/,Hb=/^\/\//,Ib={},Jb={},Kb="*/".concat("*"),Lb=d.createElement("a");Lb.href=tb.href;function Mb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(L)||[];if(r.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Nb(a,b,c,d){var e={},f=a===Jb;function g(h){var i;return e[h]=!0,r.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Ob(a,b){var c,d,e=r.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&r.extend(!0,a,d),a}function Pb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function Qb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}r.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:tb.href,type:"GET",isLocal:Fb.test(tb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Kb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":r.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Ob(Ob(a,r.ajaxSettings),b):Ob(r.ajaxSettings,a)},ajaxPrefilter:Mb(Ib),ajaxTransport:Mb(Jb),ajax:function(b,c){"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m,n,o=r.ajaxSetup({},c),p=o.context||o,q=o.context&&(p.nodeType||p.jquery)?r(p):r.event,s=r.Deferred(),t=r.Callbacks("once memory"),u=o.statusCode||{},v={},w={},x="canceled",y={readyState:0,getResponseHeader:function(a){var b;if(k){if(!h){h={};while(b=Eb.exec(g))h[b[1].toLowerCase()]=b[2]}b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return k?g:null},setRequestHeader:function(a,b){return null==k&&(a=w[a.toLowerCase()]=w[a.toLowerCase()]||a,v[a]=b),this},overrideMimeType:function(a){return null==k&&(o.mimeType=a),this},statusCode:function(a){var b;if(a)if(k)y.always(a[y.status]);else for(b in a)u[b]=[u[b],a[b]];return this},abort:function(a){var b=a||x;return e&&e.abort(b),A(0,b),this}};if(s.promise(y),o.url=((b||o.url||tb.href)+"").replace(Hb,tb.protocol+"//"),o.type=c.method||c.type||o.method||o.type,o.dataTypes=(o.dataType||"*").toLowerCase().match(L)||[""],null==o.crossDomain){j=d.createElement("a");try{j.href=o.url,j.href=j.href,o.crossDomain=Lb.protocol+"//"+Lb.host!=j.protocol+"//"+j.host}catch(z){o.crossDomain=!0}}if(o.data&&o.processData&&"string"!=typeof o.data&&(o.data=r.param(o.data,o.traditional)),Nb(Ib,o,c,y),k)return y;l=r.event&&o.global,l&&0===r.active++&&r.event.trigger("ajaxStart"),o.type=o.type.toUpperCase(),o.hasContent=!Gb.test(o.type),f=o.url.replace(Cb,""),o.hasContent?o.data&&o.processData&&0===(o.contentType||"").indexOf("application/x-www-form-urlencoded")&&(o.data=o.data.replace(Bb,"+")):(n=o.url.slice(f.length),o.data&&(f+=(vb.test(f)?"&":"?")+o.data,delete o.data),o.cache===!1&&(f=f.replace(Db,"$1"),n=(vb.test(f)?"&":"?")+"_="+ub++ +n),o.url=f+n),o.ifModified&&(r.lastModified[f]&&y.setRequestHeader("If-Modified-Since",r.lastModified[f]),r.etag[f]&&y.setRequestHeader("If-None-Match",r.etag[f])),(o.data&&o.hasContent&&o.contentType!==!1||c.contentType)&&y.setRequestHeader("Content-Type",o.contentType),y.setRequestHeader("Accept",o.dataTypes[0]&&o.accepts[o.dataTypes[0]]?o.accepts[o.dataTypes[0]]+("*"!==o.dataTypes[0]?", "+Kb+"; q=0.01":""):o.accepts["*"]);for(m in o.headers)y.setRequestHeader(m,o.headers[m]);if(o.beforeSend&&(o.beforeSend.call(p,y,o)===!1||k))return y.abort();if(x="abort",t.add(o.complete),y.done(o.success),y.fail(o.error),e=Nb(Jb,o,c,y)){if(y.readyState=1,l&&q.trigger("ajaxSend",[y,o]),k)return y;o.async&&o.timeout>0&&(i=a.setTimeout(function(){y.abort("timeout")},o.timeout));try{k=!1,e.send(v,A)}catch(z){if(k)throw z;A(-1,z)}}else A(-1,"No Transport");function A(b,c,d,h){var j,m,n,v,w,x=c;k||(k=!0,i&&a.clearTimeout(i),e=void 0,g=h||"",y.readyState=b>0?4:0,j=b>=200&&b<300||304===b,d&&(v=Pb(o,y,d)),v=Qb(o,v,y,j),j?(o.ifModified&&(w=y.getResponseHeader("Last-Modified"),w&&(r.lastModified[f]=w),w=y.getResponseHeader("etag"),w&&(r.etag[f]=w)),204===b||"HEAD"===o.type?x="nocontent":304===b?x="notmodified":(x=v.state,m=v.data,n=v.error,j=!n)):(n=x,!b&&x||(x="error",b<0&&(b=0))),y.status=b,y.statusText=(c||x)+"",j?s.resolveWith(p,[m,x,y]):s.rejectWith(p,[y,x,n]),y.statusCode(u),u=void 0,l&&q.trigger(j?"ajaxSuccess":"ajaxError",[y,o,j?m:n]),t.fireWith(p,[y,x]),l&&(q.trigger("ajaxComplete",[y,o]),--r.active||r.event.trigger("ajaxStop")))}return y},getJSON:function(a,b,c){return r.get(a,b,c,"json")},getScript:function(a,b){return r.get(a,void 0,b,"script")}}),r.each(["get","post"],function(a,b){r[b]=function(a,c,d,e){return r.isFunction(c)&&(e=e||d,d=c,c=void 0),r.ajax(r.extend({url:a,type:b,dataType:e,data:c,success:d},r.isPlainObject(a)&&a))}}),r._evalUrl=function(a){return r.ajax({url:a,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},r.fn.extend({wrapAll:function(a){var b;return this[0]&&(r.isFunction(a)&&(a=a.call(this[0])),b=r(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this},wrapInner:function(a){return r.isFunction(a)?this.each(function(b){r(this).wrapInner(a.call(this,b))}):this.each(function(){var b=r(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=r.isFunction(a);return this.each(function(c){r(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(a){return this.parent(a).not("body").each(function(){r(this).replaceWith(this.childNodes)}),this}}),r.expr.pseudos.hidden=function(a){return!r.expr.pseudos.visible(a)},r.expr.pseudos.visible=function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},r.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Rb={0:200,1223:204},Sb=r.ajaxSettings.xhr();o.cors=!!Sb&&"withCredentials"in Sb,o.ajax=Sb=!!Sb,r.ajaxTransport(function(b){var c,d;if(o.cors||Sb&&!b.crossDomain)return{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Rb[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}}),r.ajaxPrefilter(function(a){a.crossDomain&&(a.contents.script=!1)}),r.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return r.globalEval(a),a}}}),r.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),r.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(e,f){b=r("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&f("error"===a.type?404:200,a.type)}),d.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Tb=[],Ub=/(=)\?(?=&|$)|\?\?/;r.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Tb.pop()||r.expando+"_"+ub++;return this[a]=!0,a}}),r.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Ub.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ub.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=r.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Ub,"$1"+e):b.jsonp!==!1&&(b.url+=(vb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||r.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?r(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Tb.push(e)),g&&r.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),o.createHTMLDocument=function(){var a=d.implementation.createHTMLDocument("").body;return a.innerHTML="<form></form><form></form>",2===a.childNodes.length}(),r.parseHTML=function(a,b,c){if("string"!=typeof a)return[];"boolean"==typeof b&&(c=b,b=!1);var e,f,g;return b||(o.createHTMLDocument?(b=d.implementation.createHTMLDocument(""),e=b.createElement("base"),e.href=d.location.href,b.head.appendChild(e)):b=d),f=C.exec(a),g=!c&&[],f?[b.createElement(f[1])]:(f=qa([a],b,g),g&&g.length&&r(g).remove(),r.merge([],f.childNodes))},r.fn.load=function(a,b,c){var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=pb(a.slice(h)),a=a.slice(0,h)),r.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&r.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?r("<div>").append(r.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},r.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){r.fn[b]=function(a){return this.on(b,a)}}),r.expr.pseudos.animated=function(a){return r.grep(r.timers,function(b){return a===b.elem}).length},r.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=r.css(a,"position"),l=r(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=r.css(a,"top"),i=r.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),r.isFunction(b)&&(b=b.call(a,c,r.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},r.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){r.offset.setOffset(this,a,b)});var b,c,d,e,f=this[0];if(f)return f.getClientRects().length?(d=f.getBoundingClientRect(),b=f.ownerDocument,c=b.documentElement,e=b.defaultView,{top:d.top+e.pageYOffset-c.clientTop,left:d.left+e.pageXOffset-c.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===r.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),B(a[0],"html")||(d=a.offset()),d={top:d.top+r.css(a[0],"borderTopWidth",!0),left:d.left+r.css(a[0],"borderLeftWidth",!0)}),{top:b.top-d.top-r.css(c,"marginTop",!0),left:b.left-d.left-r.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent;while(a&&"static"===r.css(a,"position"))a=a.offsetParent;return a||ra})}}),r.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;r.fn[a]=function(d){return T(this,function(a,d,e){var f;return r.isWindow(a)?f=a:9===a.nodeType&&(f=a.defaultView),void 0===e?f?f[b]:a[d]:void(f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e)},a,d,arguments.length)}}),r.each(["top","left"],function(a,b){r.cssHooks[b]=Pa(o.pixelPosition,function(a,c){if(c)return c=Oa(a,b),Ma.test(c)?r(a).position()[b]+"px":c})}),r.each({Height:"height",Width:"width"},function(a,b){r.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){r.fn[d]=function(e,f){var g=arguments.length&&(c||"boolean"!=typeof e),h=c||(e===!0||f===!0?"margin":"border");return T(this,function(b,c,e){var f;return r.isWindow(b)?0===d.indexOf("outer")?b["inner"+a]:b.document.documentElement["client"+a]:9===b.nodeType?(f=b.documentElement,Math.max(b.body["scroll"+a],f["scroll"+a],b.body["offset"+a],f["offset"+a],f["client"+a])):void 0===e?r.css(b,c,h):r.style(b,c,e,h)},b,g?e:void 0,g)}})}),r.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}}),r.holdReady=function(a){a?r.readyWait++:r.ready(!0)},r.isArray=Array.isArray,r.parseJSON=JSON.parse,r.nodeName=B,"function"==typeof define&&define.amd&&define("jquery",[],function(){return r});var Vb=a.jQuery,Wb=a.$;return r.noConflict=function(b){return a.$===r&&(a.$=Wb),b&&a.jQuery===r&&(a.jQuery=Vb),r},b||(a.jQuery=a.$=r),r});


/* file: script/lib/FontLoader.js */

/* globals define, exports, module */

(function(root, definition) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define([], definition);
    } else if (typeof exports === 'object') {
        // Node. Does not work with strict CommonJS, but only CommonJS-like
        // environments that support module.exports, like Node.
        module.exports = definition();
    } else {
        // Browser globals (root is window)
        root.FontLoader = definition();
    }
}(window, function() {

    var isIE = /MSIE/i.test(navigator.userAgent),
        ieVer = null;

    // Get Internet Explorer version
    if (isIE) {
        var re, result;
        re = new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");
        result = re.exec(navigator.userAgent);
        if (result !== null) {
            ieVer = parseFloat(result[1]);
        }
    }

    /**
     * @typedef {Object} FontDescriptor
     * @property {String} family
     * @property {String} weight
     * @property {String} style
     * @property {String} stretch
     */
    function FontDescriptor(fontDescriptor) {
        this._validateFontDescriptor(fontDescriptor);
        this.family = fontDescriptor.family;
        this.weight = fontDescriptor.weight;
        this.style = fontDescriptor.style;
        this.stretch = fontDescriptor.stretch;
    }

    FontDescriptor.prototype = {
        constructor: FontDescriptor,
        /**
         * Returns font variation identifier of the FontDescriptor.
         *
         * FontDescriptors with different family-names may have same variation identifiers.
         * This identifier is useful for mapping and storing font dimensions of fallback fonts with font variation
         * properties similar to these of the loaded fonts.
         *
         * @returns {string}
         */
        variationKey: function() {
            return this.weight + this.style + this.stretch;
        },
        /**
         * Returns identifier of the FontDescriptor.
         *
         * @returns {string}
         */
        fontKey: function() {
            return this.family + this.variationKey();
        },
        toJSON: function() {
            return {
                family: this.family,
                weight: this.weight,
                style: this.style,
                stretch: this.stretch
            };
        },
        _validateFontDescriptor: function(fontDescriptor) {
            var style, stretch;

            if (!fontDescriptor.family || !fontDescriptor.weight || !fontDescriptor.style) {
                throw new Error("Illegal font descriptor, family, weight and style properties are required.")
            }

            if (!('possibleFontStyles' in FontLoader)) {
                FontLoader.possibleFontStyles = [];
                for (style in FontLoader.fontStyleAliasesMap) {
                    if (FontLoader.fontStyleAliasesMap.hasOwnProperty(style)) {
                        FontLoader.possibleFontStyles.push(FontLoader.fontStyleAliasesMap[style]);
                    }
                }
            }
            if (FontLoader.possibleFontStyles.indexOf(fontDescriptor.style) === -1) {
                throw new Error("Illegal font descriptor, style property must be one of the following: " + FontLoader.possibleFontStyles.join(", "));
            }

            // For backward compatibility do not require "stretch" property
            if ('stretch' in fontDescriptor) {
                if (!('possibleFontStretches' in FontLoader)) {
                    FontLoader.possibleFontStretches = [];
                    for (stretch in FontLoader.fontStretchAliasesMap) {
                        if (FontLoader.fontStretchAliasesMap.hasOwnProperty(stretch)) {
                            FontLoader.possibleFontStretches.push(FontLoader.fontStretchAliasesMap[stretch]);
                        }
                    }
                }
                if (FontLoader.possibleFontStretches.indexOf(fontDescriptor.stretch) === -1) {
                    throw new Error("Illegal font descriptor, stretch property must be one of the following: " + FontLoader.possibleFontStretches.join(", "));
                }
            } else {
                fontDescriptor.stretch = 'normal';
            }
        }
    };

    /**
     * FontLoader detects when web fonts specified in the "fontFamiliesArray" array were loaded and rendered. Then it
     * notifies the specified delegate object via "fontLoaded" and "complete" methods when specific or all fonts were
     * loaded respectively. The use of this functions implies that the insertion of specified web fonts into the
     * document is done elsewhere.
     *
     * The fonts parameter may be an array of strings specifying the font-families with optionally specified font
     * variations using FVD notation or font descriptor objects of the following type:
     * {
     *     family: "fontFamily",
     *     weight: 400,
     *     style: 'normal',
     *     stretch: 'normal'
     * }
     * Where styles may ne one of the following: normal, bold, italic or oblique. If only string is specified, the
     * default values used for weight, style and stretch are 400, 'normal' and 'normal' respectively.
     *
     * If all the specified fonts were loaded before the timeout was reached, the "complete" delegate method will be
     * invoked with "null" error parameter. Otherwise, if timeout was reached before all specified fonts were loaded,
     * the "complete" method will be invoked with an error object with two fields: the "message" string and the
     * "notLoadedFonts" array of FontDescriptor objects of all the fonts that weren't loaded.
     *
     * @param {Array.<String|FontDescriptor>} fonts   Array of font-family strings or font descriptor objects.
     * @param {Object}        delegate                Delegate object whose callback methods will be invoked in its own context.
     * @param {Function}      [delegate.complete]     Called when all fonts were loaded or the timeout was reached.
     * @param {Function}      [delegate.fontLoaded]   Called for each loaded font with its font-family string as its single parameter.
     * @param {Number}        [timeout=3000]          Timeout in milliseconds. Pass "null" to disable timeout.
     * @param {HTMLDocument}  [contextDocument]       The DOM tree context to use, if none provided then it will be the document.
     * @constructor
     */
    function FontLoader(fonts, delegate, timeout, contextDocument) {
        // Public
        this.delegate = delegate;
        this.timeout = (typeof timeout !== "undefined") ? timeout : 3000;

        // Private
        this._fontsArray = this._parseFonts(fonts);
        this._started = false;
        this._testDiv = null;
        this._testContainer = null;
        this._adobeBlankSizeWatcher = null;
        this._sizeWatchers = [];
        this._timeoutId = null;
        this._intervalId = null;
        this._intervalDelay = 50;
        this._numberOfLoadedFonts = 0;
        this._numberOfFonts = this._fontsArray.length;
        this._fontsMap = {};
        this._finished = false;
        this._document = contextDocument || document;
    }

    FontLoader.useAdobeBlank = !isIE || ieVer >= 11.0;
    FontLoader.useResizeEvent = isIE && ieVer < 11.0 && typeof document.attachEvent !== "undefined";
    FontLoader.useIntervalChecking = window.opera || (isIE && ieVer < 11.0 && !FontLoader.useResizeEvent);
    FontLoader.referenceText = " !\"\\#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~";
    FontLoader.referenceFontFamilies = FontLoader.useAdobeBlank ? ["AdobeBlank"] : ["serif", "cursive"];
    FontLoader.adobeBlankFontFaceStyleId = "fontLoaderAdobeBlankFontFace";
    FontLoader.adobeBlankReferenceSize = null;
    FontLoader.referenceFontFamilyVariationSizes = {};
    FontLoader.adobeBlankFontFaceRule = "@font-face{ font-family:AdobeBlank; src:url('data:font/opentype;base64,T1RUTwAKAIAAAwAgQ0ZGIM6ZbkwAAEPEAAAZM0RTSUcAAAABAABtAAAAAAhPUy8yAR6vMwAAARAAAABgY21hcDqI98oAACjEAAAa4GhlYWT+BQILAAAArAAAADZoaGVhCCID7wAAAOQAAAAkaG10eAPoAHwAAFz4AAAQBm1heHAIAVAAAAABCAAAAAZuYW1lD/tWxwAAAXAAACdScG9zdP+4ADIAAEOkAAAAIAABAAAAAQj1Snw1O18PPPUAAwPoAAAAAM2C2p8AAAAAzYLanwB8/4gDbANwAAAAAwACAAAAAAAAAAEAAANw/4gAyAPoAHwAfANsAAEAAAAAAAAAAAAAAAAAAAACAABQAAgBAAAABAAAAZAABQAAAooCWAAAAEsCigJYAAABXgAyANwAAAAAAAAAAAAAAAD3/67/+9///w/gAD8AAAAAQURCRQHAAAD//wNw/4gAyANwAHhgLwH/AAAAAAAAAAAAAAAgAAAAAAARANIAAQAAAAAAAQALAAAAAQAAAAAAAgAHAAsAAQAAAAAAAwAbABIAAQAAAAAABAALAAAAAQAAAAAABQA5AC0AAQAAAAAABgAKAGYAAwABBAkAAABuAHAAAwABBAkAAQAWAN4AAwABBAkAAgAOAPQAAwABBAkAAwA2AQIAAwABBAkABAAWAN4AAwABBAkABQByATgAAwABBAkABgAUAaoAAwABBAkACAA0Ab4AAwABBAkACwA0AfIAAwABBAkADSQSAiYAAwABBAkADgBIJjhBZG9iZSBCbGFua1JlZ3VsYXIxLjAzNTtBREJFO0Fkb2JlQmxhbms7QURPQkVWZXJzaW9uIDEuMDM1O1BTIDEuMDAzO2hvdGNvbnYgMS4wLjcwO21ha2VvdGYubGliMi41LjU5MDBBZG9iZUJsYW5rAKkAIAAyADAAMQAzACAAQQBkAG8AYgBlACAAUwB5AHMAdABlAG0AcwAgAEkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkAC4AIABBAGwAbAAgAFIAaQBnAGgAdABzACAAUgBlAHMAZQByAHYAZQBkAC4AQQBkAG8AYgBlACAAQgBsAGEAbgBrAFIAZQBnAHUAbABhAHIAMQAuADAAMwA1ADsAQQBEAEIARQA7AEEAZABvAGIAZQBCAGwAYQBuAGsAOwBBAEQATwBCAEUAVgBlAHIAcwBpAG8AbgAgADEALgAwADMANQA7AFAAUwAgADEALgAwADAAMwA7AGgAbwB0AGMAbwBuAHYAIAAxAC4AMAAuADcAMAA7AG0AYQBrAGUAbwB0AGYALgBsAGkAYgAyAC4ANQAuADUAOQAwADAAQQBkAG8AYgBlAEIAbABhAG4AawBBAGQAbwBiAGUAIABTAHkAcwB0AGUAbQBzACAASQBuAGMAbwByAHAAbwByAGEAdABlAGQAaAB0AHQAcAA6AC8ALwB3AHcAdwAuAGEAZABvAGIAZQAuAGMAbwBtAC8AdAB5AHAAZQAvAEEAZABvAGIAZQAgAEIAbABhAG4AawAgAGkAcwAgAHIAZQBsAGUAYQBzAGUAZAAgAHUAbgBkAGUAcgAgAHQAaABlACAAUwBJAEwAIABPAHAAZQBuACAARgBvAG4AdAAgAEwAaQBjAGUAbgBzAGUAIAAtACAAcABsAGUAYQBzAGUAIAByAGUAYQBkACAAaQB0ACAAYwBhAHIAZQBmAHUAbABsAHkAIABhAG4AZAAgAGQAbwAgAG4AbwB0ACAAZABvAHcAbgBsAG8AYQBkACAAdABoAGUAIABmAG8AbgB0AHMAIAB1AG4AbABlAHMAcwAgAHkAbwB1ACAAYQBnAHIAZQBlACAAdABvACAAdABoAGUAIAB0AGgAZQAgAHQAZQByAG0AcwAgAG8AZgAgAHQAaABlACAAbABpAGMAZQBuAHMAZQA6AA0ACgANAAoAQwBvAHAAeQByAGkAZwBoAHQAIACpACAAMgAwADEAMwAgAEEAZABvAGIAZQAgAFMAeQBzAHQAZQBtAHMAIABJAG4AYwBvAHIAcABvAHIAYQB0AGUAZAAgACgAaAB0AHQAcAA6AC8ALwB3AHcAdwAuAGEAZABvAGIAZQAuAGMAbwBtAC8AKQAsACAAdwBpAHQAaAAgAFIAZQBzAGUAcgB2AGUAZAAgAEYAbwBuAHQAIABOAGEAbQBlACAAQQBkAG8AYgBlACAAQgBsAGEAbgBrAA0ACgANAAoAVABoAGkAcwAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABpAHMAIABsAGkAYwBlAG4AcwBlAGQAIAB1AG4AZABlAHIAIAB0AGgAZQAgAFMASQBMACAATwBwAGUAbgAgAEYAbwBuAHQAIABMAGkAYwBlAG4AcwBlACwAIABWAGUAcgBzAGkAbwBuACAAMQAuADEALgANAAoADQAKAFQAaABpAHMAIABsAGkAYwBlAG4AcwBlACAAaQBzACAAYwBvAHAAaQBlAGQAIABiAGUAbABvAHcALAAgAGEAbgBkACAAaQBzACAAYQBsAHMAbwAgAGEAdgBhAGkAbABhAGIAbABlACAAdwBpAHQAaAAgAGEAIABGAEEAUQAgAGEAdAA6ACAAaAB0AHQAcAA6AC8ALwBzAGMAcgBpAHAAdABzAC4AcwBpAGwALgBvAHIAZwAvAE8ARgBMAA0ACgANAAoALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAA0ACgBTAEkATAAgAE8AUABFAE4AIABGAE8ATgBUACAATABJAEMARQBOAFMARQAgAFYAZQByAHMAaQBvAG4AIAAxAC4AMQAgAC0AIAAyADYAIABGAGUAYgByAHUAYQByAHkAIAAyADAAMAA3AA0ACgAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ADQAKAA0ACgBQAFIARQBBAE0AQgBMAEUADQAKAFQAaABlACAAZwBvAGEAbABzACAAbwBmACAAdABoAGUAIABPAHAAZQBuACAARgBvAG4AdAAgAEwAaQBjAGUAbgBzAGUAIAAoAE8ARgBMACkAIABhAHIAZQAgAHQAbwAgAHMAdABpAG0AdQBsAGEAdABlACAAdwBvAHIAbABkAHcAaQBkAGUAIABkAGUAdgBlAGwAbwBwAG0AZQBuAHQAIABvAGYAIABjAG8AbABsAGEAYgBvAHIAYQB0AGkAdgBlACAAZgBvAG4AdAAgAHAAcgBvAGoAZQBjAHQAcwAsACAAdABvACAAcwB1AHAAcABvAHIAdAAgAHQAaABlACAAZgBvAG4AdAAgAGMAcgBlAGEAdABpAG8AbgAgAGUAZgBmAG8AcgB0AHMAIABvAGYAIABhAGMAYQBkAGUAbQBpAGMAIABhAG4AZAAgAGwAaQBuAGcAdQBpAHMAdABpAGMAIABjAG8AbQBtAHUAbgBpAHQAaQBlAHMALAAgAGEAbgBkACAAdABvACAAcAByAG8AdgBpAGQAZQAgAGEAIABmAHIAZQBlACAAYQBuAGQAIABvAHAAZQBuACAAZgByAGEAbQBlAHcAbwByAGsAIABpAG4AIAB3AGgAaQBjAGgAIABmAG8AbgB0AHMAIABtAGEAeQAgAGIAZQAgAHMAaABhAHIAZQBkACAAYQBuAGQAIABpAG0AcAByAG8AdgBlAGQAIABpAG4AIABwAGEAcgB0AG4AZQByAHMAaABpAHAAIAB3AGkAdABoACAAbwB0AGgAZQByAHMALgANAAoADQAKAFQAaABlACAATwBGAEwAIABhAGwAbABvAHcAcwAgAHQAaABlACAAbABpAGMAZQBuAHMAZQBkACAAZgBvAG4AdABzACAAdABvACAAYgBlACAAdQBzAGUAZAAsACAAcwB0AHUAZABpAGUAZAAsACAAbQBvAGQAaQBmAGkAZQBkACAAYQBuAGQAIAByAGUAZABpAHMAdAByAGkAYgB1AHQAZQBkACAAZgByAGUAZQBsAHkAIABhAHMAIABsAG8AbgBnACAAYQBzACAAdABoAGUAeQAgAGEAcgBlACAAbgBvAHQAIABzAG8AbABkACAAYgB5ACAAdABoAGUAbQBzAGUAbAB2AGUAcwAuACAAVABoAGUAIABmAG8AbgB0AHMALAAgAGkAbgBjAGwAdQBkAGkAbgBnACAAYQBuAHkAIABkAGUAcgBpAHYAYQB0AGkAdgBlACAAdwBvAHIAawBzACwAIABjAGEAbgAgAGIAZQAgAGIAdQBuAGQAbABlAGQALAAgAGUAbQBiAGUAZABkAGUAZAAsACAAcgBlAGQAaQBzAHQAcgBpAGIAdQB0AGUAZAAgAGEAbgBkAC8AbwByACAAcwBvAGwAZAAgAHcAaQB0AGgAIABhAG4AeQAgAHMAbwBmAHQAdwBhAHIAZQAgAHAAcgBvAHYAaQBkAGUAZAAgAHQAaABhAHQAIABhAG4AeQAgAHIAZQBzAGUAcgB2AGUAZAAgAG4AYQBtAGUAcwAgAGEAcgBlACAAbgBvAHQAIAB1AHMAZQBkACAAYgB5ACAAZABlAHIAaQB2AGEAdABpAHYAZQAgAHcAbwByAGsAcwAuACAAVABoAGUAIABmAG8AbgB0AHMAIABhAG4AZAAgAGQAZQByAGkAdgBhAHQAaQB2AGUAcwAsACAAaABvAHcAZQB2AGUAcgAsACAAYwBhAG4AbgBvAHQAIABiAGUAIAByAGUAbABlAGEAcwBlAGQAIAB1AG4AZABlAHIAIABhAG4AeQAgAG8AdABoAGUAcgAgAHQAeQBwAGUAIABvAGYAIABsAGkAYwBlAG4AcwBlAC4AIABUAGgAZQAgAHIAZQBxAHUAaQByAGUAbQBlAG4AdAAgAGYAbwByACAAZgBvAG4AdABzACAAdABvACAAcgBlAG0AYQBpAG4AIAB1AG4AZABlAHIAIAB0AGgAaQBzACAAbABpAGMAZQBuAHMAZQAgAGQAbwBlAHMAIABuAG8AdAAgAGEAcABwAGwAeQAgAHQAbwAgAGEAbgB5ACAAZABvAGMAdQBtAGUAbgB0ACAAYwByAGUAYQB0AGUAZAAgAHUAcwBpAG4AZwAgAHQAaABlACAAZgBvAG4AdABzACAAbwByACAAdABoAGUAaQByACAAZABlAHIAaQB2AGEAdABpAHYAZQBzAC4ADQAKAA0ACgBEAEUARgBJAE4ASQBUAEkATwBOAFMADQAKACIARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAiACAAcgBlAGYAZQByAHMAIAB0AG8AIAB0AGgAZQAgAHMAZQB0ACAAbwBmACAAZgBpAGwAZQBzACAAcgBlAGwAZQBhAHMAZQBkACAAYgB5ACAAdABoAGUAIABDAG8AcAB5AHIAaQBnAGgAdAAgAEgAbwBsAGQAZQByACgAcwApACAAdQBuAGQAZQByACAAdABoAGkAcwAgAGwAaQBjAGUAbgBzAGUAIABhAG4AZAAgAGMAbABlAGEAcgBsAHkAIABtAGEAcgBrAGUAZAAgAGEAcwAgAHMAdQBjAGgALgAgAFQAaABpAHMAIABtAGEAeQAgAGkAbgBjAGwAdQBkAGUAIABzAG8AdQByAGMAZQAgAGYAaQBsAGUAcwAsACAAYgB1AGkAbABkACAAcwBjAHIAaQBwAHQAcwAgAGEAbgBkACAAZABvAGMAdQBtAGUAbgB0AGEAdABpAG8AbgAuAA0ACgANAAoAIgBSAGUAcwBlAHIAdgBlAGQAIABGAG8AbgB0ACAATgBhAG0AZQAiACAAcgBlAGYAZQByAHMAIAB0AG8AIABhAG4AeQAgAG4AYQBtAGUAcwAgAHMAcABlAGMAaQBmAGkAZQBkACAAYQBzACAAcwB1AGMAaAAgAGEAZgB0AGUAcgAgAHQAaABlACAAYwBvAHAAeQByAGkAZwBoAHQAIABzAHQAYQB0AGUAbQBlAG4AdAAoAHMAKQAuAA0ACgANAAoAIgBPAHIAaQBnAGkAbgBhAGwAIABWAGUAcgBzAGkAbwBuACIAIAByAGUAZgBlAHIAcwAgAHQAbwAgAHQAaABlACAAYwBvAGwAbABlAGMAdABpAG8AbgAgAG8AZgAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABjAG8AbQBwAG8AbgBlAG4AdABzACAAYQBzACAAZABpAHMAdAByAGkAYgB1AHQAZQBkACAAYgB5ACAAdABoAGUAIABDAG8AcAB5AHIAaQBnAGgAdAAgAEgAbwBsAGQAZQByACgAcwApAC4ADQAKAA0ACgAiAE0AbwBkAGkAZgBpAGUAZAAgAFYAZQByAHMAaQBvAG4AIgAgAHIAZQBmAGUAcgBzACAAdABvACAAYQBuAHkAIABkAGUAcgBpAHYAYQB0AGkAdgBlACAAbQBhAGQAZQAgAGIAeQAgAGEAZABkAGkAbgBnACAAdABvACwAIABkAGUAbABlAHQAaQBuAGcALAAgAG8AcgAgAHMAdQBiAHMAdABpAHQAdQB0AGkAbgBnACAALQAtACAAaQBuACAAcABhAHIAdAAgAG8AcgAgAGkAbgAgAHcAaABvAGwAZQAgAC0ALQAgAGEAbgB5ACAAbwBmACAAdABoAGUAIABjAG8AbQBwAG8AbgBlAG4AdABzACAAbwBmACAAdABoAGUAIABPAHIAaQBnAGkAbgBhAGwAIABWAGUAcgBzAGkAbwBuACwAIABiAHkAIABjAGgAYQBuAGcAaQBuAGcAIABmAG8AcgBtAGEAdABzACAAbwByACAAYgB5ACAAcABvAHIAdABpAG4AZwAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAgAHQAbwAgAGEAIABuAGUAdwAgAGUAbgB2AGkAcgBvAG4AbQBlAG4AdAAuAA0ACgANAAoAIgBBAHUAdABoAG8AcgAiACAAcgBlAGYAZQByAHMAIAB0AG8AIABhAG4AeQAgAGQAZQBzAGkAZwBuAGUAcgAsACAAZQBuAGcAaQBuAGUAZQByACwAIABwAHIAbwBnAHIAYQBtAG0AZQByACwAIAB0AGUAYwBoAG4AaQBjAGEAbAAgAHcAcgBpAHQAZQByACAAbwByACAAbwB0AGgAZQByACAAcABlAHIAcwBvAG4AIAB3AGgAbwAgAGMAbwBuAHQAcgBpAGIAdQB0AGUAZAAgAHQAbwAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAuAA0ACgANAAoAUABFAFIATQBJAFMAUwBJAE8ATgAgACYAIABDAE8ATgBEAEkAVABJAE8ATgBTAA0ACgBQAGUAcgBtAGkAcwBzAGkAbwBuACAAaQBzACAAaABlAHIAZQBiAHkAIABnAHIAYQBuAHQAZQBkACwAIABmAHIAZQBlACAAbwBmACAAYwBoAGEAcgBnAGUALAAgAHQAbwAgAGEAbgB5ACAAcABlAHIAcwBvAG4AIABvAGIAdABhAGkAbgBpAG4AZwAgAGEAIABjAG8AcAB5ACAAbwBmACAAdABoAGUAIABGAG8AbgB0ACAAUwBvAGYAdAB3AGEAcgBlACwAIAB0AG8AIAB1AHMAZQAsACAAcwB0AHUAZAB5ACwAIABjAG8AcAB5ACwAIABtAGUAcgBnAGUALAAgAGUAbQBiAGUAZAAsACAAbQBvAGQAaQBmAHkALAAgAHIAZQBkAGkAcwB0AHIAaQBiAHUAdABlACwAIABhAG4AZAAgAHMAZQBsAGwAIABtAG8AZABpAGYAaQBlAGQAIABhAG4AZAAgAHUAbgBtAG8AZABpAGYAaQBlAGQAIABjAG8AcABpAGUAcwAgAG8AZgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAsACAAcwB1AGIAagBlAGMAdAAgAHQAbwAgAHQAaABlACAAZgBvAGwAbABvAHcAaQBuAGcAIABjAG8AbgBkAGkAdABpAG8AbgBzADoADQAKAA0ACgAxACkAIABOAGUAaQB0AGgAZQByACAAdABoAGUAIABGAG8AbgB0ACAAUwBvAGYAdAB3AGEAcgBlACAAbgBvAHIAIABhAG4AeQAgAG8AZgAgAGkAdABzACAAaQBuAGQAaQB2AGkAZAB1AGEAbAAgAGMAbwBtAHAAbwBuAGUAbgB0AHMALAAgAGkAbgAgAE8AcgBpAGcAaQBuAGEAbAAgAG8AcgAgAE0AbwBkAGkAZgBpAGUAZAAgAFYAZQByAHMAaQBvAG4AcwAsACAAbQBhAHkAIABiAGUAIABzAG8AbABkACAAYgB5ACAAaQB0AHMAZQBsAGYALgANAAoADQAKADIAKQAgAE8AcgBpAGcAaQBuAGEAbAAgAG8AcgAgAE0AbwBkAGkAZgBpAGUAZAAgAFYAZQByAHMAaQBvAG4AcwAgAG8AZgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAgAG0AYQB5ACAAYgBlACAAYgB1AG4AZABsAGUAZAAsACAAcgBlAGQAaQBzAHQAcgBpAGIAdQB0AGUAZAAgAGEAbgBkAC8AbwByACAAcwBvAGwAZAAgAHcAaQB0AGgAIABhAG4AeQAgAHMAbwBmAHQAdwBhAHIAZQAsACAAcAByAG8AdgBpAGQAZQBkACAAdABoAGEAdAAgAGUAYQBjAGgAIABjAG8AcAB5ACAAYwBvAG4AdABhAGkAbgBzACAAdABoAGUAIABhAGIAbwB2AGUAIABjAG8AcAB5AHIAaQBnAGgAdAAgAG4AbwB0AGkAYwBlACAAYQBuAGQAIAB0AGgAaQBzACAAbABpAGMAZQBuAHMAZQAuACAAVABoAGUAcwBlACAAYwBhAG4AIABiAGUAIABpAG4AYwBsAHUAZABlAGQAIABlAGkAdABoAGUAcgAgAGEAcwAgAHMAdABhAG4AZAAtAGEAbABvAG4AZQAgAHQAZQB4AHQAIABmAGkAbABlAHMALAAgAGgAdQBtAGEAbgAtAHIAZQBhAGQAYQBiAGwAZQAgAGgAZQBhAGQAZQByAHMAIABvAHIAIABpAG4AIAB0AGgAZQAgAGEAcABwAHIAbwBwAHIAaQBhAHQAZQAgAG0AYQBjAGgAaQBuAGUALQByAGUAYQBkAGEAYgBsAGUAIABtAGUAdABhAGQAYQB0AGEAIABmAGkAZQBsAGQAcwAgAHcAaQB0AGgAaQBuACAAdABlAHgAdAAgAG8AcgAgAGIAaQBuAGEAcgB5ACAAZgBpAGwAZQBzACAAYQBzACAAbABvAG4AZwAgAGEAcwAgAHQAaABvAHMAZQAgAGYAaQBlAGwAZABzACAAYwBhAG4AIABiAGUAIABlAGEAcwBpAGwAeQAgAHYAaQBlAHcAZQBkACAAYgB5ACAAdABoAGUAIAB1AHMAZQByAC4ADQAKAA0ACgAzACkAIABOAG8AIABNAG8AZABpAGYAaQBlAGQAIABWAGUAcgBzAGkAbwBuACAAbwBmACAAdABoAGUAIABGAG8AbgB0ACAAUwBvAGYAdAB3AGEAcgBlACAAbQBhAHkAIAB1AHMAZQAgAHQAaABlACAAUgBlAHMAZQByAHYAZQBkACAARgBvAG4AdAAgAE4AYQBtAGUAKABzACkAIAB1AG4AbABlAHMAcwAgAGUAeABwAGwAaQBjAGkAdAAgAHcAcgBpAHQAdABlAG4AIABwAGUAcgBtAGkAcwBzAGkAbwBuACAAaQBzACAAZwByAGEAbgB0AGUAZAAgAGIAeQAgAHQAaABlACAAYwBvAHIAcgBlAHMAcABvAG4AZABpAG4AZwAgAEMAbwBwAHkAcgBpAGcAaAB0ACAASABvAGwAZABlAHIALgAgAFQAaABpAHMAIAByAGUAcwB0AHIAaQBjAHQAaQBvAG4AIABvAG4AbAB5ACAAYQBwAHAAbABpAGUAcwAgAHQAbwAgAHQAaABlACAAcAByAGkAbQBhAHIAeQAgAGYAbwBuAHQAIABuAGEAbQBlACAAYQBzACAAcAByAGUAcwBlAG4AdABlAGQAIAB0AG8AIAB0AGgAZQAgAHUAcwBlAHIAcwAuAA0ACgANAAoANAApACAAVABoAGUAIABuAGEAbQBlACgAcwApACAAbwBmACAAdABoAGUAIABDAG8AcAB5AHIAaQBnAGgAdAAgAEgAbwBsAGQAZQByACgAcwApACAAbwByACAAdABoAGUAIABBAHUAdABoAG8AcgAoAHMAKQAgAG8AZgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAgAHMAaABhAGwAbAAgAG4AbwB0ACAAYgBlACAAdQBzAGUAZAAgAHQAbwAgAHAAcgBvAG0AbwB0AGUALAAgAGUAbgBkAG8AcgBzAGUAIABvAHIAIABhAGQAdgBlAHIAdABpAHMAZQAgAGEAbgB5ACAATQBvAGQAaQBmAGkAZQBkACAAVgBlAHIAcwBpAG8AbgAsACAAZQB4AGMAZQBwAHQAIAB0AG8AIABhAGMAawBuAG8AdwBsAGUAZABnAGUAIAB0AGgAZQAgAGMAbwBuAHQAcgBpAGIAdQB0AGkAbwBuACgAcwApACAAbwBmACAAdABoAGUAIABDAG8AcAB5AHIAaQBnAGgAdAAgAEgAbwBsAGQAZQByACgAcwApACAAYQBuAGQAIAB0AGgAZQAgAEEAdQB0AGgAbwByACgAcwApACAAbwByACAAdwBpAHQAaAAgAHQAaABlAGkAcgAgAGUAeABwAGwAaQBjAGkAdAAgAHcAcgBpAHQAdABlAG4AIABwAGUAcgBtAGkAcwBzAGkAbwBuAC4ADQAKAA0ACgA1ACkAIABUAGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUALAAgAG0AbwBkAGkAZgBpAGUAZAAgAG8AcgAgAHUAbgBtAG8AZABpAGYAaQBlAGQALAAgAGkAbgAgAHAAYQByAHQAIABvAHIAIABpAG4AIAB3AGgAbwBsAGUALAAgAG0AdQBzAHQAIABiAGUAIABkAGkAcwB0AHIAaQBiAHUAdABlAGQAIABlAG4AdABpAHIAZQBsAHkAIAB1AG4AZABlAHIAIAB0AGgAaQBzACAAbABpAGMAZQBuAHMAZQAsACAAYQBuAGQAIABtAHUAcwB0ACAAbgBvAHQAIABiAGUAIABkAGkAcwB0AHIAaQBiAHUAdABlAGQAIAB1AG4AZABlAHIAIABhAG4AeQAgAG8AdABoAGUAcgAgAGwAaQBjAGUAbgBzAGUALgAgAFQAaABlACAAcgBlAHEAdQBpAHIAZQBtAGUAbgB0ACAAZgBvAHIAIABmAG8AbgB0AHMAIAB0AG8AIAByAGUAbQBhAGkAbgAgAHUAbgBkAGUAcgAgAHQAaABpAHMAIABsAGkAYwBlAG4AcwBlACAAZABvAGUAcwAgAG4AbwB0ACAAYQBwAHAAbAB5ACAAdABvACAAYQBuAHkAIABkAG8AYwB1AG0AZQBuAHQAIABjAHIAZQBhAHQAZQBkACAAdQBzAGkAbgBnACAAdABoAGUAIABGAG8AbgB0ACAAUwBvAGYAdAB3AGEAcgBlAC4ADQAKAA0ACgBUAEUAUgBNAEkATgBBAFQASQBPAE4ADQAKAFQAaABpAHMAIABsAGkAYwBlAG4AcwBlACAAYgBlAGMAbwBtAGUAcwAgAG4AdQBsAGwAIABhAG4AZAAgAHYAbwBpAGQAIABpAGYAIABhAG4AeQAgAG8AZgAgAHQAaABlACAAYQBiAG8AdgBlACAAYwBvAG4AZABpAHQAaQBvAG4AcwAgAGEAcgBlACAAbgBvAHQAIABtAGUAdAAuAA0ACgANAAoARABJAFMAQwBMAEEASQBNAEUAUgANAAoAVABIAEUAIABGAE8ATgBUACAAUwBPAEYAVABXAEEAUgBFACAASQBTACAAUABSAE8AVgBJAEQARQBEACAAIgBBAFMAIABJAFMAIgAsACAAVwBJAFQASABPAFUAVAAgAFcAQQBSAFIAQQBOAFQAWQAgAE8ARgAgAEEATgBZACAASwBJAE4ARAAsACAARQBYAFAAUgBFAFMAUwAgAE8AUgAgAEkATQBQAEwASQBFAEQALAAgAEkATgBDAEwAVQBEAEkATgBHACAAQgBVAFQAIABOAE8AVAAgAEwASQBNAEkAVABFAEQAIABUAE8AIABBAE4AWQAgAFcAQQBSAFIAQQBOAFQASQBFAFMAIABPAEYAIABNAEUAUgBDAEgAQQBOAFQAQQBCAEkATABJAFQAWQAsACAARgBJAFQATgBFAFMAUwAgAEYATwBSACAAQQAgAFAAQQBSAFQASQBDAFUATABBAFIAIABQAFUAUgBQAE8AUwBFACAAQQBOAEQAIABOAE8ATgBJAE4ARgBSAEkATgBHAEUATQBFAE4AVAAgAE8ARgAgAEMATwBQAFkAUgBJAEcASABUACwAIABQAEEAVABFAE4AVAAsACAAVABSAEEARABFAE0AQQBSAEsALAAgAE8AUgAgAE8AVABIAEUAUgAgAFIASQBHAEgAVAAuACAASQBOACAATgBPACAARQBWAEUATgBUACAAUwBIAEEATABMACAAVABIAEUAIABDAE8AUABZAFIASQBHAEgAVAAgAEgATwBMAEQARQBSACAAQgBFACAATABJAEEAQgBMAEUAIABGAE8AUgAgAEEATgBZACAAQwBMAEEASQBNACwAIABEAEEATQBBAEcARQBTACAATwBSACAATwBUAEgARQBSACAATABJAEEAQgBJAEwASQBUAFkALAAgAEkATgBDAEwAVQBEAEkATgBHACAAQQBOAFkAIABHAEUATgBFAFIAQQBMACwAIABTAFAARQBDAEkAQQBMACwAIABJAE4ARABJAFIARQBDAFQALAAgAEkATgBDAEkARABFAE4AVABBAEwALAAgAE8AUgAgAEMATwBOAFMARQBRAFUARQBOAFQASQBBAEwAIABEAEEATQBBAEcARQBTACwAIABXAEgARQBUAEgARQBSACAASQBOACAAQQBOACAAQQBDAFQASQBPAE4AIABPAEYAIABDAE8ATgBUAFIAQQBDAFQALAAgAFQATwBSAFQAIABPAFIAIABPAFQASABFAFIAVwBJAFMARQAsACAAQQBSAEkAUwBJAE4ARwAgAEYAUgBPAE0ALAAgAE8AVQBUACAATwBGACAAVABIAEUAIABVAFMARQAgAE8AUgAgAEkATgBBAEIASQBMAEkAVABZACAAVABPACAAVQBTAEUAIABUAEgARQAgAEYATwBOAFQAIABTAE8ARgBUAFcAQQBSAEUAIABPAFIAIABGAFIATwBNACAATwBUAEgARQBSACAARABFAEEATABJAE4ARwBTACAASQBOACAAVABIAEUAIABGAE8ATgBUACAAUwBPAEYAVABXAEEAUgBFAC4ADQAKAGgAdAB0AHAAOgAvAC8AdwB3AHcALgBhAGQAbwBiAGUALgBjAG8AbQAvAHQAeQBwAGUALwBsAGUAZwBhAGwALgBoAHQAbQBsAAAAAAAFAAAAAwAAADgAAAAEAAABUAABAAAAAAAsAAMAAQAAADgAAwAKAAABUAAGAAwAAAAAAAEAAAAEARgAAABCAEAABQACB/8P/xf/H/8n/y//N/8//0f/T/9X/1//Z/9v/3f/f/+H/4//l/+f/6f/r/+3/7//x//P/9f/5//v//f//c///f//AAAAAAgAEAAYACAAKAAwADgAQABIAFAAWABgAGgAcAB4AIAAiACQAJgAoACoALAAuADAAMgA0ADgAOgA8AD4AP3w//8AAfgB8AHoAeAB2AHQAcgBwAG4AbABqAGgAZgBkAGIAYABeAFwAWgBYAFYAVABSAFAATgBMAEgARgBEAEIAQgBAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAZkAAAAAAAAAIgAAAAAAAAB/8AAAABAAAIAAAAD/8AAAABAAAQAAAAF/8AAAABAAAYAAAAH/8AAAABAAAgAAAAJ/8AAAABAAAoAAAAL/8AAAABAAAwAAAAN/8AAAABAAA4AAAAP/8AAAABAABAAAAAR/8AAAABAABIAAAAT/8AAAABAABQAAAAV/8AAAABAABYAAAAX/8AAAABAABgAAAAZ/8AAAABAABoAAAAb/8AAAABAABwAAAAd/8AAAABAAB4AAAAf/8AAAABAACAAAAAh/8AAAABAACIAAAAj/8AAAABAACQAAAAl/8AAAABAACYAAAAn/8AAAABAACgAAAAp/8AAAABAACoAAAAr/8AAAABAACwAAAAt/8AAAABAAC4AAAAv/8AAAABAADAAAAAx/8AAAABAADIAAAAz/8AAAABAADQAAAA1/8AAAABAADgAAAA5/8AAAABAADoAAAA7/8AAAABAADwAAAA9/8AAAABAAD4AAAA/c8AAAABAAD98AAA//0AAAXxAAEAAAABB/8AAAABAAEIAAABD/8AAAABAAEQAAABF/8AAAABAAEYAAABH/8AAAABAAEgAAABJ/8AAAABAAEoAAABL/8AAAABAAEwAAABN/8AAAABAAE4AAABP/8AAAABAAFAAAABR/8AAAABAAFIAAABT/8AAAABAAFQAAABV/8AAAABAAFYAAABX/8AAAABAAFgAAABZ/8AAAABAAFoAAABb/8AAAABAAFwAAABd/8AAAABAAF4AAABf/8AAAABAAGAAAABh/8AAAABAAGIAAABj/8AAAABAAGQAAABl/8AAAABAAGYAAABn/8AAAABAAGgAAABp/8AAAABAAGoAAABr/8AAAABAAGwAAABt/8AAAABAAG4AAABv/8AAAABAAHAAAABx/8AAAABAAHIAAABz/8AAAABAAHQAAAB1/8AAAABAAHYAAAB3/8AAAABAAHgAAAB5/8AAAABAAHoAAAB7/8AAAABAAHwAAAB9/8AAAABAAH4AAAB//0AAAABAAIAAAACB/8AAAABAAIIAAACD/8AAAABAAIQAAACF/8AAAABAAIYAAACH/8AAAABAAIgAAACJ/8AAAABAAIoAAACL/8AAAABAAIwAAACN/8AAAABAAI4AAACP/8AAAABAAJAAAACR/8AAAABAAJIAAACT/8AAAABAAJQAAACV/8AAAABAAJYAAACX/8AAAABAAJgAAACZ/8AAAABAAJoAAACb/8AAAABAAJwAAACd/8AAAABAAJ4AAACf/8AAAABAAKAAAACh/8AAAABAAKIAAACj/8AAAABAAKQAAACl/8AAAABAAKYAAACn/8AAAABAAKgAAACp/8AAAABAAKoAAACr/8AAAABAAKwAAACt/8AAAABAAK4AAACv/8AAAABAALAAAACx/8AAAABAALIAAACz/8AAAABAALQAAAC1/8AAAABAALYAAAC3/8AAAABAALgAAAC5/8AAAABAALoAAAC7/8AAAABAALwAAAC9/8AAAABAAL4AAAC//0AAAABAAMAAAADB/8AAAABAAMIAAADD/8AAAABAAMQAAADF/8AAAABAAMYAAADH/8AAAABAAMgAAADJ/8AAAABAAMoAAADL/8AAAABAAMwAAADN/8AAAABAAM4AAADP/8AAAABAANAAAADR/8AAAABAANIAAADT/8AAAABAANQAAADV/8AAAABAANYAAADX/8AAAABAANgAAADZ/8AAAABAANoAAADb/8AAAABAANwAAADd/8AAAABAAN4AAADf/8AAAABAAOAAAADh/8AAAABAAOIAAADj/8AAAABAAOQAAADl/8AAAABAAOYAAADn/8AAAABAAOgAAADp/8AAAABAAOoAAADr/8AAAABAAOwAAADt/8AAAABAAO4AAADv/8AAAABAAPAAAADx/8AAAABAAPIAAADz/8AAAABAAPQAAAD1/8AAAABAAPYAAAD3/8AAAABAAPgAAAD5/8AAAABAAPoAAAD7/8AAAABAAPwAAAD9/8AAAABAAP4AAAD//0AAAABAAQAAAAEB/8AAAABAAQIAAAED/8AAAABAAQQAAAEF/8AAAABAAQYAAAEH/8AAAABAAQgAAAEJ/8AAAABAAQoAAAEL/8AAAABAAQwAAAEN/8AAAABAAQ4AAAEP/8AAAABAARAAAAER/8AAAABAARIAAAET/8AAAABAARQAAAEV/8AAAABAARYAAAEX/8AAAABAARgAAAEZ/8AAAABAARoAAAEb/8AAAABAARwAAAEd/8AAAABAAR4AAAEf/8AAAABAASAAAAEh/8AAAABAASIAAAEj/8AAAABAASQAAAEl/8AAAABAASYAAAEn/8AAAABAASgAAAEp/8AAAABAASoAAAEr/8AAAABAASwAAAEt/8AAAABAAS4AAAEv/8AAAABAATAAAAEx/8AAAABAATIAAAEz/8AAAABAATQAAAE1/8AAAABAATYAAAE3/8AAAABAATgAAAE5/8AAAABAAToAAAE7/8AAAABAATwAAAE9/8AAAABAAT4AAAE//0AAAABAAUAAAAFB/8AAAABAAUIAAAFD/8AAAABAAUQAAAFF/8AAAABAAUYAAAFH/8AAAABAAUgAAAFJ/8AAAABAAUoAAAFL/8AAAABAAUwAAAFN/8AAAABAAU4AAAFP/8AAAABAAVAAAAFR/8AAAABAAVIAAAFT/8AAAABAAVQAAAFV/8AAAABAAVYAAAFX/8AAAABAAVgAAAFZ/8AAAABAAVoAAAFb/8AAAABAAVwAAAFd/8AAAABAAV4AAAFf/8AAAABAAWAAAAFh/8AAAABAAWIAAAFj/8AAAABAAWQAAAFl/8AAAABAAWYAAAFn/8AAAABAAWgAAAFp/8AAAABAAWoAAAFr/8AAAABAAWwAAAFt/8AAAABAAW4AAAFv/8AAAABAAXAAAAFx/8AAAABAAXIAAAFz/8AAAABAAXQAAAF1/8AAAABAAXYAAAF3/8AAAABAAXgAAAF5/8AAAABAAXoAAAF7/8AAAABAAXwAAAF9/8AAAABAAX4AAAF//0AAAABAAYAAAAGB/8AAAABAAYIAAAGD/8AAAABAAYQAAAGF/8AAAABAAYYAAAGH/8AAAABAAYgAAAGJ/8AAAABAAYoAAAGL/8AAAABAAYwAAAGN/8AAAABAAY4AAAGP/8AAAABAAZAAAAGR/8AAAABAAZIAAAGT/8AAAABAAZQAAAGV/8AAAABAAZYAAAGX/8AAAABAAZgAAAGZ/8AAAABAAZoAAAGb/8AAAABAAZwAAAGd/8AAAABAAZ4AAAGf/8AAAABAAaAAAAGh/8AAAABAAaIAAAGj/8AAAABAAaQAAAGl/8AAAABAAaYAAAGn/8AAAABAAagAAAGp/8AAAABAAaoAAAGr/8AAAABAAawAAAGt/8AAAABAAa4AAAGv/8AAAABAAbAAAAGx/8AAAABAAbIAAAGz/8AAAABAAbQAAAG1/8AAAABAAbYAAAG3/8AAAABAAbgAAAG5/8AAAABAAboAAAG7/8AAAABAAbwAAAG9/8AAAABAAb4AAAG//0AAAABAAcAAAAHB/8AAAABAAcIAAAHD/8AAAABAAcQAAAHF/8AAAABAAcYAAAHH/8AAAABAAcgAAAHJ/8AAAABAAcoAAAHL/8AAAABAAcwAAAHN/8AAAABAAc4AAAHP/8AAAABAAdAAAAHR/8AAAABAAdIAAAHT/8AAAABAAdQAAAHV/8AAAABAAdYAAAHX/8AAAABAAdgAAAHZ/8AAAABAAdoAAAHb/8AAAABAAdwAAAHd/8AAAABAAd4AAAHf/8AAAABAAeAAAAHh/8AAAABAAeIAAAHj/8AAAABAAeQAAAHl/8AAAABAAeYAAAHn/8AAAABAAegAAAHp/8AAAABAAeoAAAHr/8AAAABAAewAAAHt/8AAAABAAe4AAAHv/8AAAABAAfAAAAHx/8AAAABAAfIAAAHz/8AAAABAAfQAAAH1/8AAAABAAfYAAAH3/8AAAABAAfgAAAH5/8AAAABAAfoAAAH7/8AAAABAAfwAAAH9/8AAAABAAf4AAAH//0AAAABAAgAAAAIB/8AAAABAAgIAAAID/8AAAABAAgQAAAIF/8AAAABAAgYAAAIH/8AAAABAAggAAAIJ/8AAAABAAgoAAAIL/8AAAABAAgwAAAIN/8AAAABAAg4AAAIP/8AAAABAAhAAAAIR/8AAAABAAhIAAAIT/8AAAABAAhQAAAIV/8AAAABAAhYAAAIX/8AAAABAAhgAAAIZ/8AAAABAAhoAAAIb/8AAAABAAhwAAAId/8AAAABAAh4AAAIf/8AAAABAAiAAAAIh/8AAAABAAiIAAAIj/8AAAABAAiQAAAIl/8AAAABAAiYAAAIn/8AAAABAAigAAAIp/8AAAABAAioAAAIr/8AAAABAAiwAAAIt/8AAAABAAi4AAAIv/8AAAABAAjAAAAIx/8AAAABAAjIAAAIz/8AAAABAAjQAAAI1/8AAAABAAjYAAAI3/8AAAABAAjgAAAI5/8AAAABAAjoAAAI7/8AAAABAAjwAAAI9/8AAAABAAj4AAAI//0AAAABAAkAAAAJB/8AAAABAAkIAAAJD/8AAAABAAkQAAAJF/8AAAABAAkYAAAJH/8AAAABAAkgAAAJJ/8AAAABAAkoAAAJL/8AAAABAAkwAAAJN/8AAAABAAk4AAAJP/8AAAABAAlAAAAJR/8AAAABAAlIAAAJT/8AAAABAAlQAAAJV/8AAAABAAlYAAAJX/8AAAABAAlgAAAJZ/8AAAABAAloAAAJb/8AAAABAAlwAAAJd/8AAAABAAl4AAAJf/8AAAABAAmAAAAJh/8AAAABAAmIAAAJj/8AAAABAAmQAAAJl/8AAAABAAmYAAAJn/8AAAABAAmgAAAJp/8AAAABAAmoAAAJr/8AAAABAAmwAAAJt/8AAAABAAm4AAAJv/8AAAABAAnAAAAJx/8AAAABAAnIAAAJz/8AAAABAAnQAAAJ1/8AAAABAAnYAAAJ3/8AAAABAAngAAAJ5/8AAAABAAnoAAAJ7/8AAAABAAnwAAAJ9/8AAAABAAn4AAAJ//0AAAABAAoAAAAKB/8AAAABAAoIAAAKD/8AAAABAAoQAAAKF/8AAAABAAoYAAAKH/8AAAABAAogAAAKJ/8AAAABAAooAAAKL/8AAAABAAowAAAKN/8AAAABAAo4AAAKP/8AAAABAApAAAAKR/8AAAABAApIAAAKT/8AAAABAApQAAAKV/8AAAABAApYAAAKX/8AAAABAApgAAAKZ/8AAAABAApoAAAKb/8AAAABAApwAAAKd/8AAAABAAp4AAAKf/8AAAABAAqAAAAKh/8AAAABAAqIAAAKj/8AAAABAAqQAAAKl/8AAAABAAqYAAAKn/8AAAABAAqgAAAKp/8AAAABAAqoAAAKr/8AAAABAAqwAAAKt/8AAAABAAq4AAAKv/8AAAABAArAAAAKx/8AAAABAArIAAAKz/8AAAABAArQAAAK1/8AAAABAArYAAAK3/8AAAABAArgAAAK5/8AAAABAAroAAAK7/8AAAABAArwAAAK9/8AAAABAAr4AAAK//0AAAABAAsAAAALB/8AAAABAAsIAAALD/8AAAABAAsQAAALF/8AAAABAAsYAAALH/8AAAABAAsgAAALJ/8AAAABAAsoAAALL/8AAAABAAswAAALN/8AAAABAAs4AAALP/8AAAABAAtAAAALR/8AAAABAAtIAAALT/8AAAABAAtQAAALV/8AAAABAAtYAAALX/8AAAABAAtgAAALZ/8AAAABAAtoAAALb/8AAAABAAtwAAALd/8AAAABAAt4AAALf/8AAAABAAuAAAALh/8AAAABAAuIAAALj/8AAAABAAuQAAALl/8AAAABAAuYAAALn/8AAAABAAugAAALp/8AAAABAAuoAAALr/8AAAABAAuwAAALt/8AAAABAAu4AAALv/8AAAABAAvAAAALx/8AAAABAAvIAAALz/8AAAABAAvQAAAL1/8AAAABAAvYAAAL3/8AAAABAAvgAAAL5/8AAAABAAvoAAAL7/8AAAABAAvwAAAL9/8AAAABAAv4AAAL//0AAAABAAwAAAAMB/8AAAABAAwIAAAMD/8AAAABAAwQAAAMF/8AAAABAAwYAAAMH/8AAAABAAwgAAAMJ/8AAAABAAwoAAAML/8AAAABAAwwAAAMN/8AAAABAAw4AAAMP/8AAAABAAxAAAAMR/8AAAABAAxIAAAMT/8AAAABAAxQAAAMV/8AAAABAAxYAAAMX/8AAAABAAxgAAAMZ/8AAAABAAxoAAAMb/8AAAABAAxwAAAMd/8AAAABAAx4AAAMf/8AAAABAAyAAAAMh/8AAAABAAyIAAAMj/8AAAABAAyQAAAMl/8AAAABAAyYAAAMn/8AAAABAAygAAAMp/8AAAABAAyoAAAMr/8AAAABAAywAAAMt/8AAAABAAy4AAAMv/8AAAABAAzAAAAMx/8AAAABAAzIAAAMz/8AAAABAAzQAAAM1/8AAAABAAzYAAAM3/8AAAABAAzgAAAM5/8AAAABAAzoAAAM7/8AAAABAAzwAAAM9/8AAAABAAz4AAAM//0AAAABAA0AAAANB/8AAAABAA0IAAAND/8AAAABAA0QAAANF/8AAAABAA0YAAANH/8AAAABAA0gAAANJ/8AAAABAA0oAAANL/8AAAABAA0wAAANN/8AAAABAA04AAANP/8AAAABAA1AAAANR/8AAAABAA1IAAANT/8AAAABAA1QAAANV/8AAAABAA1YAAANX/8AAAABAA1gAAANZ/8AAAABAA1oAAANb/8AAAABAA1wAAANd/8AAAABAA14AAANf/8AAAABAA2AAAANh/8AAAABAA2IAAANj/8AAAABAA2QAAANl/8AAAABAA2YAAANn/8AAAABAA2gAAANp/8AAAABAA2oAAANr/8AAAABAA2wAAANt/8AAAABAA24AAANv/8AAAABAA3AAAANx/8AAAABAA3IAAANz/8AAAABAA3QAAAN1/8AAAABAA3YAAAN3/8AAAABAA3gAAAN5/8AAAABAA3oAAAN7/8AAAABAA3wAAAN9/8AAAABAA34AAAN//0AAAABAA4AAAAOB/8AAAABAA4IAAAOD/8AAAABAA4QAAAOF/8AAAABAA4YAAAOH/8AAAABAA4gAAAOJ/8AAAABAA4oAAAOL/8AAAABAA4wAAAON/8AAAABAA44AAAOP/8AAAABAA5AAAAOR/8AAAABAA5IAAAOT/8AAAABAA5QAAAOV/8AAAABAA5YAAAOX/8AAAABAA5gAAAOZ/8AAAABAA5oAAAOb/8AAAABAA5wAAAOd/8AAAABAA54AAAOf/8AAAABAA6AAAAOh/8AAAABAA6IAAAOj/8AAAABAA6QAAAOl/8AAAABAA6YAAAOn/8AAAABAA6gAAAOp/8AAAABAA6oAAAOr/8AAAABAA6wAAAOt/8AAAABAA64AAAOv/8AAAABAA7AAAAOx/8AAAABAA7IAAAOz/8AAAABAA7QAAAO1/8AAAABAA7YAAAO3/8AAAABAA7gAAAO5/8AAAABAA7oAAAO7/8AAAABAA7wAAAO9/8AAAABAA74AAAO//0AAAABAA8AAAAPB/8AAAABAA8IAAAPD/8AAAABAA8QAAAPF/8AAAABAA8YAAAPH/8AAAABAA8gAAAPJ/8AAAABAA8oAAAPL/8AAAABAA8wAAAPN/8AAAABAA84AAAPP/8AAAABAA9AAAAPR/8AAAABAA9IAAAPT/8AAAABAA9QAAAPV/8AAAABAA9YAAAPX/8AAAABAA9gAAAPZ/8AAAABAA9oAAAPb/8AAAABAA9wAAAPd/8AAAABAA94AAAPf/8AAAABAA+AAAAPh/8AAAABAA+IAAAPj/8AAAABAA+QAAAPl/8AAAABAA+YAAAPn/8AAAABAA+gAAAPp/8AAAABAA+oAAAPr/8AAAABAA+wAAAPt/8AAAABAA+4AAAPv/8AAAABAA/AAAAPx/8AAAABAA/IAAAPz/8AAAABAA/QAAAP1/8AAAABAA/YAAAP3/8AAAABAA/gAAAP5/8AAAABAA/oAAAP7/8AAAABAA/wAAAP9/8AAAABAA/4AAAP//0AAAABABAAAAAQB/8AAAABABAIAAAQD/8AAAABABAQAAAQF/8AAAABABAYAAAQH/8AAAABABAgAAAQJ/8AAAABABAoAAAQL/8AAAABABAwAAAQN/8AAAABABA4AAAQP/8AAAABABBAAAAQR/8AAAABABBIAAAQT/8AAAABABBQAAAQV/8AAAABABBYAAAQX/8AAAABABBgAAAQZ/8AAAABABBoAAAQb/8AAAABABBwAAAQd/8AAAABABB4AAAQf/8AAAABABCAAAAQh/8AAAABABCIAAAQj/8AAAABABCQAAAQl/8AAAABABCYAAAQn/8AAAABABCgAAAQp/8AAAABABCoAAAQr/8AAAABABCwAAAQt/8AAAABABC4AAAQv/8AAAABABDAAAAQx/8AAAABABDIAAAQz/8AAAABABDQAAAQ1/8AAAABABDYAAAQ3/8AAAABABDgAAAQ5/8AAAABABDoAAAQ7/8AAAABABDwAAAQ9/8AAAABABD4AAAQ//0AAAABAAMAAAAAAAD/tQAyAAAAAAAAAAAAAAAAAAAAAAAAAAABAAQCAAEBAQtBZG9iZUJsYW5rAAEBATD4G/gciwwe+B0B+B4Ci/sM+gD6BAUeGgA/DB8cCAEMIvdMD/dZEfdRDCUcGRYMJAAFAQEGDk1YZ0Fkb2JlSWRlbnRpdHlDb3B5cmlnaHQgMjAxMyBBZG9iZSBTeXN0ZW1zIEluY29ycG9yYXRlZC4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5BZG9iZSBCbGFua0Fkb2JlQmxhbmstMjA0OQAAAgABB/8DAAEAAAAIAQgBAgABAEsATABNAE4ATwBQAFEAUgBTAFQAVQBWAFcAWABZAFoAWwBcAF0AXgBfAGAAYQBiAGMAZABlAGYAZwBoAGkAagBrAGwAbQBuAG8AcABxAHIAcwB0AHUAdgB3AHgAeQB6AHsAfAB9AH4AfwCAAIEAggCDAIQAhQCGAIcAiACJAIoAiwCMAI0AjgCPAJAAkQCSAJMAlACVAJYAlwCYAJkAmgCbAJwAnQCeAJ8AoAChAKIAowCkAKUApgCnAKgAqQCqAKsArACtAK4ArwCwALEAsgCzALQAtQC2ALcAuAC5ALoAuwC8AL0AvgC/AMAAwQDCAMMAxADFAMYAxwDIAMkAygDLAMwAzQDOAM8A0ADRANIA0wDUANUA1gDXANgA2QDaANsA3ADdAN4A3wDgAOEA4gDjAOQA5QDmAOcA6ADpAOoA6wDsAO0A7gDvAPAA8QDyAPMA9AD1APYA9wD4APkA+gD7APwA/QD+AP8BAAEBAQIBAwEEAQUBBgEHAQgBCQEKAQsBDAENAQ4BDwEQAREBEgETARQBFQEWARcBGAEZARoBGwEcAR0BHgEfASABIQEiASMBJAElASYBJwEoASkBKgErASwBLQEuAS8BMAExATIBMwE0ATUBNgE3ATgBOQE6ATsBPAE9AT4BPwFAAUEBQgFDAUQBRQFGAUcBSAFJAUoBSwFMAU0BTgFPAVABUQFSAVMBVAFVAVYBVwFYAVkBWgFbAVwBXQFeAV8BYAFhAWIBYwFkAWUBZgFnAWgBaQFqAWsBbAFtAW4BbwFwAXEBcgFzAXQBdQF2AXcBeAF5AXoBewF8AX0BfgF/AYABgQGCAYMBhAGFAYYBhwGIAYkBigGLAYwBjQGOAY8BkAGRAZIBkwGUAZUBlgGXAZgBmQGaAZsBnAGdAZ4BnwGgAaEBogGjAaQBpQGmAacBqAGpAaoBqwGsAa0BrgGvAbABsQGyAbMBtAG1AbYBtwG4AbkBugG7AbwBvQG+Ab8BwAHBAcIBwwHEAcUBxgHHAcgByQHKAcsBzAHNAc4BzwHQAdEB0gHTAdQB1QHWAdcB2AHZAdoB2wHcAd0B3gHfAeAB4QHiAeMB5AHlAeYB5wHoAekB6gHrAewB7QHuAe8B8AHxAfIB8wH0AfUB9gH3AfgB+QH6AfsB/AH9Af4B/wIAAgECAgIDAgQCBQIGAgcCCAIJAgoCCwIMAg0CDgIPAhACEQISAhMCFAIVAhYCFwIYAhkCGgIbAhwCHQIeAh8CIAIhAiICIwIkAiUCJgInAigCKQIqAisCLAItAi4CLwIwAjECMgIzAjQCNQI2AjcCOAI5AjoCOwI8Aj0CPgI/AkACQQJCAkMCRAJFAkYCRwJIAkkCSgJLAkwCTQJOAk8CUAJRAlICUwJUAlUCVgJXAlgCWQJaAlsCXAJdAl4CXwJgAmECYgJjAmQCZQJmAmcCaAJpAmoCawJsAm0CbgJvAnACcQJyAnMCdAJ1AnYCdwJ4AnkCegJ7AnwCfQJ+An8CgAKBAoICgwKEAoUChgKHAogCiQKKAosCjAKNAo4CjwKQApECkgKTApQClQKWApcCmAKZApoCmwKcAp0CngKfAqACoQKiAqMCpAKlAqYCpwKoAqkCqgKrAqwCrQKuAq8CsAKxArICswK0ArUCtgK3ArgCuQK6ArsCvAK9Ar4CvwLAAsECwgLDAsQCxQLGAscCyALJAsoCywLMAs0CzgLPAtAC0QLSAtMC1ALVAtYC1wLYAtkC2gLbAtwC3QLeAt8C4ALhAuIC4wLkAuUC5gLnAugC6QLqAusC7ALtAu4C7wLwAvEC8gLzAvQC9QL2AvcC+AL5AvoC+wL8Av0C/gL/AwADAQMCAwMDBAMFAwYDBwMIAwkDCgMLAwwDDQMOAw8DEAMRAxIDEwMUAxUDFgMXAxgDGQMaAxsDHAMdAx4DHwMgAyEDIgMjAyQDJQMmAycDKAMpAyoDKwMsAy0DLgMvAzADMQMyAzMDNAM1AzYDNwM4AzkDOgM7AzwDPQM+Az8DQANBA0IDQwNEA0UDRgNHA0gDSQNKA0sDTANNA04DTwNQA1EDUgNTA1QDVQNWA1cDWANZA1oDWwNcA10DXgNfA2ADYQNiA2MDZANlA2YDZwNoA2kDagNrA2wDbQNuA28DcANxA3IDcwN0A3UDdgN3A3gDeQN6A3sDfAN9A34DfwOAA4EDggODA4QDhQOGA4cDiAOJA4oDiwOMA40DjgOPA5ADkQOSA5MDlAOVA5YDlwOYA5kDmgObA5wDnQOeA58DoAOhA6IDowOkA6UDpgOnA6gDqQOqA6sDrAOtA64DrwOwA7EDsgOzA7QDtQO2A7cDuAO5A7oDuwO8A70DvgO/A8ADwQPCA8MDxAPFA8YDxwPIA8kDygPLA8wDzQPOA88D0APRA9ID0wPUA9UD1gPXA9gD2QPaA9sD3APdA94D3wPgA+ED4gPjA+QD5QPmA+cD6APpA+oD6wPsA+0D7gPvA/AD8QPyA/MD9AP1A/YD9wP4A/kD+gP7A/wD/QP+A/8EAAQBBAIEAwQEBAUEBgQHBAgECQQKBAsEDAQNBA4EDwQQBBEEEgQTBBQEFQQWBBcEGAQZBBoEGwQcBB0EHgQfBCAEIQQiBCMEJAQlBCYEJwQoBCkEKgQrBCwELQQuBC8EMAQxBDIEMwQ0BDUENgQ3BDgEOQQ6BDsEPAQ9BD4EPwRABEEEQgRDBEQERQRGBEcESARJBEoESwRMBE0ETgRPBFAEUQRSBFMEVARVBFYEVwRYBFkEWgRbBFwEXQReBF8EYARhBGIEYwRkBGUEZgRnBGgEaQRqBGsEbARtBG4EbwRwBHEEcgRzBHQEdQR2BHcEeAR5BHoEewR8BH0EfgR/BIAEgQSCBIMEhASFBIYEhwSIBIkEigSLBIwEjQSOBI8EkASRBJIEkwSUBJUElgSXBJgEmQSaBJsEnASdBJ4EnwSgBKEEogSjBKQEpQSmBKcEqASpBKoEqwSsBK0ErgSvBLAEsQSyBLMEtAS1BLYEtwS4BLkEugS7BLwEvQS+BL8EwATBBMIEwwTEBMUExgTHBMgEyQTKBMsEzATNBM4EzwTQBNEE0gTTBNQE1QTWBNcE2ATZBNoE2wTcBN0E3gTfBOAE4QTiBOME5ATlBOYE5wToBOkE6gTrBOwE7QTuBO8E8ATxBPIE8wT0BPUE9gT3BPgE+QT6BPsE/AT9BP4E/wUABQEFAgUDBQQFBQUGBQcFCAUJBQoFCwUMBQ0FDgUPBRAFEQUSBRMFFAUVBRYFFwUYBRkFGgUbBRwFHQUeBR8FIAUhBSIFIwUkBSUFJgUnBSgFKQUqBSsFLAUtBS4FLwUwBTEFMgUzBTQFNQU2BTcFOAU5BToFOwU8BT0FPgU/BUAFQQVCBUMFRAVFBUYFRwVIBUkFSgVLBUwFTQVOBU8FUAVRBVIFUwVUBVUFVgVXBVgFWQVaBVsFXAVdBV4FXwVgBWEFYgVjBWQFZQVmBWcFaAVpBWoFawVsBW0FbgVvBXAFcQVyBXMFdAV1BXYFdwV4BXkFegV7BXwFfQV+BX8FgAWBBYIFgwWEBYUFhgWHBYgFiQWKBYsFjAWNBY4FjwWQBZEFkgWTBZQFlQWWBZcFmAWZBZoFmwWcBZ0FngWfBaAFoQWiBaMFpAWlBaYFpwWoBakFqgWrBawFrQWuBa8FsAWxBbIFswW0BbUFtgW3BbgFuQW6BbsFvAW9Bb4FvwXABcEFwgXDBcQFxQXGBccFyAXJBcoFywXMBc0FzgXPBdAF0QXSBdMF1AXVBdYF1wXYBdkF2gXbBdwF3QXeBd8F4AXhBeIF4wXkBeUF5gXnBegF6QXqBesF7AXtBe4F7wXwBfEF8gXzBfQF9QX2BfcF+AX5BfoF+wX8Bf0F/gX/BgAGAQYCBgMGBAYFBgYGBwYIBgkGCgYLBgwGDQYOBg8GEAYRBhIGEwYUBhUGFgYXBhgGGQYaBhsGHAYdBh4GHwYgBiEGIgYjBiQGJQYmBicGKAYpBioGKwYsBi0GLgYvBjAGMQYyBjMGNAY1BjYGNwY4BjkGOgY7BjwGPQY+Bj8GQAZBBkIGQwZEBkUGRgZHBkgGSQZKBksGTAZNBk4GTwZQBlEGUgZTBlQGVQZWBlcGWAZZBloGWwZcBl0GXgZfBmAGYQZiBmMGZAZlBmYGZwZoBmkGagZrBmwGbQZuBm8GcAZxBnIGcwZ0BnUGdgZ3BngGeQZ6BnsGfAZ9Bn4GfwaABoEGggaDBoQGhQaGBocGiAaJBooGiwaMBo0GjgaPBpAGkQaSBpMGlAaVBpYGlwaYBpkGmgabBpwGnQaeBp8GoAahBqIGowakBqUGpganBqgGqQaqBqsGrAatBq4GrwawBrEGsgazBrQGtQa2BrcGuAa5BroGuwa8Br0Gvga/BsAGwQbCBsMGxAbFBsYGxwbIBskGygbLBswGzQbOBs8G0AbRBtIG0wbUBtUG1gbXBtgG2QbaBtsG3AbdBt4G3wbgBuEG4gbjBuQG5QbmBucG6AbpBuoG6wbsBu0G7gbvBvAG8QbyBvMG9Ab1BvYG9wb4BvkG+gb7BvwG/Qb+Bv8HAAcBBwIHAwcEBwUHBgcHBwgHCQcKBwsHDAcNBw4HDwcQBxEHEgcTBxQHFQcWBxcHGAcZBxoHGwccBx0HHgcfByAHIQciByMHJAclByYHJwcoBykHKgcrBywHLQcuBy8HMAcxBzIHMwc0BzUHNgc3BzgHOQc6BzsHPAc9Bz4HPwdAB0EHQgdDB0QHRQdGB0cHSAdJB0oHSwdMB00HTgdPB1AHUQdSB1MHVAdVB1YHVwdYB1kHWgdbB1wHXQdeB18HYAdhB2IHYwdkB2UHZgdnB2gHaQdqB2sHbAdtB24HbwdwB3EHcgdzB3QHdQd2B3cHeAd5B3oHewd8B30Hfgd/B4AHgQeCB4MHhAeFB4YHhweIB4kHigeLB4wHjQeOB48HkAeRB5IHkweUB5UHlgeXB5gHmQeaB5sHnAedB54HnwegB6EHogejB6QHpQemB6cHqAepB6oHqwesB60HrgevB7AHsQeyB7MHtAe1B7YHtwe4B7kHuge7B7wHvQe+B78HwAfBB8IHwwfEB8UHxgfHB8gHyQfKB8sHzAfNB84HzwfQB9EH0gfTB9QH1QfWB9cH2AfZB9oH2wfcB90H3gffB+AH4QfiB+MH5AflB+YH5wfoB+kH6gfrB+wH7QfuB+8H8AfxB/IH8wf0B/UH9gf3B/gH+Qf6B/sH/Af9B/4H/wgACAEIAggDCAQIBQgGCAcICAgJCAoICwgMCA0IDggPCBAIEQgSCBMIFAgVCBYIFwgYCBkIGggbCBwIHQgeCB8IIAghCCIIIwgkCCUIJggnCCgIKQgqCCsILAgtCC4ILwgwCDEIMggzCDQINQg2CDcIOAg5CDoIOwg8CD0IPgg/CEAIQQhCCEMIRAhFCEYIRwhICEkISghLIPsMt/oktwH3ELf5LLcD9xD6BBX+fPmE+nwH/Vj+JxX50gf3xfwzBaawFfvF+DcF+PYGpmIV/dIH+8X4MwVwZhX3xfw3Bfz2Bg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODgABAQEK+B8MJpocGSQS+46LHAVGiwa9Cr0L+ucVAAPoAHwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAA') format('truetype'); }";
    FontLoader.fontStyleAliasesMap = {"n": "normal", "b": "bold", "i": "italic", "o": "oblique"};
    FontLoader.fontStretchAliasesMap = {"a": "ultra-condensed", "b": "extra-condensed", "c": "condensed", "d": "semi-condensed", "n": "normal", "e": "semi-expanded", "f": "expanded", "g": "extra-expanded", "h": "ultra-expanded"};

    FontLoader.prototype = {
        constructor: FontLoader,
        loadFonts: function() {
            var self = this,
                newFontVariations;

            if (this._started) {
                throw new Error("FontLoader: loadFonts can not be called twice. Create new FontLoader to load different fonts.");
            }
            this._started = true;

            if (this._numberOfFonts === 0) {
                this._finish();
                return;
            }

            if (this.timeout !== null) {
                this._timeoutId = window.setTimeout(function timeoutFire() {
                    self._finish();
                }, this.timeout);
            }

            // Use constant line-height so there won't be changes in height because Adobe Blank uses zero width but not zero height.
            this._testContainer = this._document.createElement("div");
            this._testContainer.style.cssText = "position:absolute; left:-10000px; top:-10000px; white-space:nowrap; font-size:20px; line-height:20px; visibility:hidden;";

            // Create testDiv template that will be cloned for each font
            this._testDiv = this._document.createElement("div");
            this._testDiv.style.position = "absolute";
            this._testDiv.appendChild(this._document.createTextNode(FontLoader.referenceText));

            if (!FontLoader.useAdobeBlank) {
                // AdobeBlank is not used
                // We need to extract dimensions of reference font-families for each requested font variation.
                // The extracted dimensions are stored in a static property "referenceFontFamilyVariationSizes",
                // so we might already have some or all of them all.
                newFontVariations = this._getNewFontVariationsFromFonts(this._fontsArray);
                if (newFontVariations.length) {
                    this._extractReferenceFontSizes(newFontVariations);
                }
                this._loadFonts();
            } else if (FontLoader.adobeBlankReferenceSize) {
                // AdobeBlank is used, and was loaded
                this._loadFonts();
            } else {
                // AdobeBlank is used but was not loaded
                this._loadAdobeBlankFont();
            }
        },
        _extractReferenceFontSizes: function(newFontVariations) {
            var clonedDiv, j, i,
                key, size, fontVariation;

            clonedDiv = this._testDiv.cloneNode(true);
            this._testContainer.appendChild(clonedDiv);
            this._document.body.appendChild(this._testContainer);

            for (i = 0; i < newFontVariations.length; i++) {
                fontVariation = newFontVariations[i];
                key = fontVariation.key;
                FontLoader.referenceFontFamilyVariationSizes[key] = [];
                for (j = 0; j < FontLoader.referenceFontFamilies.length; j++) {
                    clonedDiv.style.fontFamily = FontLoader.referenceFontFamilies[j];
                    clonedDiv.style.fontWeight = fontVariation.weight;
                    clonedDiv.style.fontStyle = fontVariation.style;
                    clonedDiv.style.fontStretch = fontVariation.stretch;
                    size = new Size(clonedDiv.offsetWidth, clonedDiv.offsetHeight);
                    FontLoader.referenceFontFamilyVariationSizes[key].push(size);
                }
            }

            this._testContainer.parentNode.removeChild(this._testContainer);
            clonedDiv.parentNode.removeChild(clonedDiv);
        },
        _loadAdobeBlankFont: function() {
            var self = this,
                adobeBlankDiv,
                adobeBlankFallbackFont = "serif";

            this._addAdobeBlankFontFaceIfNeeded();

            adobeBlankDiv = this._testDiv.cloneNode(true);
            this._testContainer.appendChild(adobeBlankDiv);
            this._document.body.appendChild(this._testContainer);

            // When using AdobeBlank (all browsers except IE < 11) only interval checking and size watcher methods
            // are available for watching element size.
            if (FontLoader.useIntervalChecking) {
                adobeBlankDiv.style.fontFamily = FontLoader.referenceFontFamilies[0] + ", " + adobeBlankFallbackFont;
                this._testContainer.appendChild(adobeBlankDiv);
                // Start polling element sizes but also do first synchronous check in case all fonts where already loaded.
                this._intervalId = window.setInterval(function intervalFire() {
                    self._checkAdobeBlankSize();
                }, this._intervalDelay);
                this._checkAdobeBlankSize();
            } else {
                adobeBlankDiv.style.fontFamily = adobeBlankFallbackFont;
                this._adobeBlankSizeWatcher = new SizeWatcher(/** @type HTMLElement */adobeBlankDiv, {
                    container: this._testContainer,
                    delegate: this,
                    continuous: true,
                    direction: SizeWatcher.directions.decrease,
                    dimension: SizeWatcher.dimensions.horizontal,
                    document: this._document
                });
                this._adobeBlankSizeWatcher.prepareForWatch();
                this._adobeBlankSizeWatcher.beginWatching();
                adobeBlankDiv.style.fontFamily = FontLoader.referenceFontFamilies[0] + ", " + adobeBlankFallbackFont;
            }
        },
        _getNewFontVariationsFromFonts: function(fontDescriptors) {
            var fontDescriptor, key, i,
                variations = [],
                variationsMap = {};

            for (i = 0; i < fontDescriptors.length; i++) {
                fontDescriptor = fontDescriptors[i];
                key = fontDescriptor.variationKey();
                if (!(key in variationsMap) && !(key in FontLoader.referenceFontFamilyVariationSizes)) {
                    variationsMap[key] = true;
                    variations.push({
                        key: key,
                        weight: fontDescriptor.weight,
                        style: fontDescriptor.style,
                        stretch: fontDescriptor.stretch
                    });
                }
            }
            return variations;
        },
        _parseFonts: function(fonts) {
            var fontDescriptors = [], filteredFD,
                i, font, fontKey, fontKeys = {};

            for (i = 0; i < fonts.length; i++) {
                font = fonts[i];
                if (typeof font === "string") {
                    if (font.indexOf(':') > -1) {
                        fontDescriptors = fontDescriptors.concat(this._parseFVD(font));
                    } else {
                        fontDescriptors.push(new FontDescriptor({
                            family: font,
                            weight: 400,
                            style: 'normal',
                            stretch: 'normal'
                        }));
                    }
                } else {
                    fontDescriptors.push(new FontDescriptor(font));
                }
            }

            // Filter duplicate fonts
            filteredFD = [];
            for (i = 0; i < fontDescriptors.length; i++) {
                fontKey = fontDescriptors[i].fontKey();
                if (!(fontKey in fontKeys)) {
                    fontKeys[fontKey] = true;
                    filteredFD.push(fontDescriptors[i]);
                }
            }

            return filteredFD;
        },
        /**
         * @param {string} fontString
         * @returns {Array.<FontDescriptor>}
         * @private
         */
        _parseFVD: function(fontString) {
            var fontDescriptors = [],
                parts = fontString.split(':'),
                fontFamily, variants, i, variant,
                styleAlias, weightAlias, stretchAlias,
                weight, style, stretch;

            fontFamily = parts[0];
            variants = parts[1].split(',');

            for (i = 0; i < variants.length; i++) {
                variant = variants[i];

                if (variant.length < 2 || variant.length > 3) {
                    throw new Error("Invalid Font Variation Description: '" + fontString + "', number of variation characters must be 2 or 3");
                }

                styleAlias = variant[0];
                weightAlias = variant[1];
                stretchAlias = "n"; // stretch character is optional, default is 'n': 'normal'
                if (variant.length === 3) {
                    stretchAlias = variant[2]
                }

                if (styleAlias in FontLoader.fontStyleAliasesMap) {
                    style = FontLoader.fontStyleAliasesMap[styleAlias];
                } else {
                    throw new Error("Invalid Font Variation Description: '" + fontString + "', the first variant character is not complying to FVD font-style specification");
                }

                weight = parseInt(weightAlias, 10);
                if (isNaN(weight)) {
                    throw new Error("Invalid Font Variation Description: '" + fontString + "', the second variant character is not complying to FVD font-weight specification");
                } else {
                    weight *= 100;
                }

                if (stretchAlias in FontLoader.fontStretchAliasesMap) {
                    stretch = FontLoader.fontStretchAliasesMap[stretchAlias];
                } else {
                    throw new Error("Invalid Font Variation Description: '" + fontString + "', the third variant character is not complying to FVD font-stretch specification");
                }

                fontDescriptors.push(new FontDescriptor({
                    family: fontFamily,
                    weight: weight,
                    style: style,
                    stretch: stretch
                }));
            }

            return fontDescriptors;
        },
        _addAdobeBlankFontFaceIfNeeded: function() {
            var adobeBlankFontFaceStyle;
            if (!this._document.getElementById(FontLoader.adobeBlankFontFaceStyleId)) {
                adobeBlankFontFaceStyle = this._document.createElement("style");
                adobeBlankFontFaceStyle.setAttribute("type", "text/css");
                adobeBlankFontFaceStyle.setAttribute("id", FontLoader.adobeBlankFontFaceStyleId);
                adobeBlankFontFaceStyle.appendChild(this._document.createTextNode(FontLoader.adobeBlankFontFaceRule));
                this._document.getElementsByTagName("head")[0].appendChild(adobeBlankFontFaceStyle);
            }
        },
        _checkAdobeBlankSize: function() {
            var adobeBlankDiv = this._testContainer.firstChild;
            this._adobeBlankLoaded(adobeBlankDiv);
        },
        _adobeBlankLoaded: function(adobeBlankDiv) {
            // Prevent false size change, for example if AdobeBlank height is higher than fallback font.
            if (adobeBlankDiv.offsetWidth !== 0) {
                return;
            }

            FontLoader.adobeBlankReferenceSize = new Size(adobeBlankDiv.offsetWidth, adobeBlankDiv.offsetHeight);

            if (this._adobeBlankSizeWatcher !== null) {
                // SizeWatcher method
                this._adobeBlankSizeWatcher.endWatching();
                this._adobeBlankSizeWatcher.removeScrollWatchers();
                this._adobeBlankSizeWatcher = null;
            } else {
                // Polling method (IE)
                window.clearInterval(this._intervalId);
                adobeBlankDiv.parentNode.removeChild(adobeBlankDiv);
            }

            this._testContainer.parentNode.removeChild(this._testContainer);

            this._loadFonts();
        },
        _cloneNodeSetStyleAndAttributes: function(font, fontKey, referenceFontFamilyIndex) {
            var clonedDiv = this._testDiv.cloneNode(true);
            clonedDiv.style.fontWeight = font.weight;
            clonedDiv.style.fontStyle = font.style;
            clonedDiv.style.fontStretch = font.stretch;
            clonedDiv.setAttribute("data-font-map-key", fontKey);
            clonedDiv.setAttribute("data-ref-font-family-index", String(referenceFontFamilyIndex));
            return clonedDiv;
        },
        _getFontMapKeyFromElement: function(element) {
            return element.getAttribute("data-font-map-key");
        },
        _getFontFromElement: function(element) {
            var fontKey = this._getFontMapKeyFromElement(element);
            return this._fontsMap[fontKey];
        },
        _getFontFamilyFromElement: function(element) {
            var font = this._getFontFromElement(element);
            return font.family;
        },
        _getReferenceFontFamilyIndexFromElement: function(element) {
            return element.getAttribute("data-ref-font-family-index");
        },
        _getReferenceFontFamilyFromElement: function(element) {
            var referenceFontFamilyIndex = this._getReferenceFontFamilyIndexFromElement(element);
            return FontLoader.referenceFontFamilies[referenceFontFamilyIndex];
        },
        _loadFonts: function() {
            var i, j, clonedDiv, sizeWatcher,
                font,
                fontKey,
                fontVariationKey,
                referenceFontSize,
                sizeWatcherDirection,
                sizeWatcherDimension,
                self = this;

            // Add div for each font-family
            for (i = 0; i < this._numberOfFonts; i++) {
                font = this._fontsArray[i];
                fontKey = font.fontKey();
                this._fontsMap[fontKey] = font;

                for (j = 0; j < FontLoader.referenceFontFamilies.length; j++) {
                    clonedDiv = this._cloneNodeSetStyleAndAttributes(font, fontKey, j);
                    if (FontLoader.useResizeEvent) {
                        clonedDiv.style.fontFamily = FontLoader.referenceFontFamilies[j];
                        this._testContainer.appendChild(clonedDiv);
                    } else if (FontLoader.useIntervalChecking) {
                        clonedDiv.style.fontFamily = "'" + font.family + "', " + FontLoader.referenceFontFamilies[j];
                        this._testContainer.appendChild(clonedDiv);
                    } else {
                        clonedDiv.style.fontFamily = FontLoader.referenceFontFamilies[j];
                        if (FontLoader.useAdobeBlank) {
                            referenceFontSize = FontLoader.adobeBlankReferenceSize;
                            sizeWatcherDirection = SizeWatcher.directions.increase;
                            sizeWatcherDimension = SizeWatcher.dimensions.horizontal;
                        } else {
                            fontVariationKey = font.variationKey();
                            referenceFontSize = FontLoader.referenceFontFamilyVariationSizes[fontVariationKey][j];
                            sizeWatcherDirection = SizeWatcher.directions.both;
                            sizeWatcherDimension = SizeWatcher.dimensions.both;
                        }
                        sizeWatcher = new SizeWatcher(/** @type HTMLElement */clonedDiv, {
                            container: this._testContainer,
                            delegate: this,
                            size: referenceFontSize,
                            direction: sizeWatcherDirection,
                            dimension: sizeWatcherDimension,
                            document: this._document
                        });
                        // The prepareForWatch() and beginWatching() methods will be invoked in separate iterations to
                        // reduce number of browser's CSS recalculations.
                        this._sizeWatchers.push(sizeWatcher);
                    }
                }
            }

            // Append the testContainer after all test elements to minimize DOM insertions
            this._document.body.appendChild(this._testContainer);

            if (FontLoader.useResizeEvent) {
                for (j = 0; j < this._testContainer.childNodes.length; j++) {
                    clonedDiv = this._testContainer.childNodes[j];
                    // "resize" event works only with attachEvent
                    clonedDiv.attachEvent("onresize", (function(self, clonedDiv) {
                        return function() {
                            self._elementSizeChanged(clonedDiv);
                        }
                    })(this, clonedDiv));
                }
                window.setTimeout(function() {
                    for (j = 0; j < self._testContainer.childNodes.length; j++) {
                        clonedDiv = self._testContainer.childNodes[j];
                        clonedDiv.style.fontFamily = "'" + self._getFontFamilyFromElement(clonedDiv) + "', " + self._getReferenceFontFamilyFromElement(clonedDiv);
                    }
                }, 0);
            } else if (FontLoader.useIntervalChecking) {
                // Start polling element sizes but also do first synchronous check in case all fonts where already loaded.
                this._intervalId = window.setInterval(function intervalFire() {
                    self._checkSizes();
                }, this._intervalDelay);
                this._checkSizes();
            } else {
                // We are dividing the prepareForWatch() and beginWatching() methods to optimize browser performance by
                // removing CSS recalculation from each iteration to the end of iterations.
                for (i = 0; i < this._sizeWatchers.length; i++) {
                    sizeWatcher = this._sizeWatchers[i];
                    sizeWatcher.prepareForWatch();
                }
                for (i = 0; i < this._sizeWatchers.length; i++) {
                    sizeWatcher = this._sizeWatchers[i];
                    sizeWatcher.beginWatching();
                    // Apply tested font-family
                    clonedDiv = sizeWatcher.getWatchedElement();
                    clonedDiv.style.fontFamily = "'" + this._getFontFamilyFromElement(clonedDiv) + "', " + self._getReferenceFontFamilyFromElement(clonedDiv);
                }
            }
        },
        _checkSizes: function() {
            var i, testDiv, font, fontVariationKey, currSize, refSize, refFontFamilyIndex;

            for (i = this._testContainer.childNodes.length - 1; i >= 0; i--) {
                testDiv = this._testContainer.childNodes[i];
                currSize = new Size(testDiv.offsetWidth, testDiv.offsetHeight);
                if (FontLoader.useAdobeBlank) {
                    refSize = FontLoader.adobeBlankReferenceSize;
                } else {
                    font = this._getFontFromElement(testDiv);
                    fontVariationKey = font.variationKey();
                    refFontFamilyIndex = this._getReferenceFontFamilyIndexFromElement(testDiv);
                    refSize = FontLoader.referenceFontFamilyVariationSizes[fontVariationKey][refFontFamilyIndex];
                }
                if (!refSize.isEqual(currSize)) {
                    // Element dimensions changed, this means its font loaded, remove it from testContainer div
                    testDiv.parentNode.removeChild(testDiv);
                    this._elementSizeChanged(testDiv);
                }
            }
        },
        _elementSizeChanged: function(element) {
            var font, fontKey;

            if (this._finished) {
                return;
            }

            fontKey = this._getFontMapKeyFromElement(element);

            // Check that the font of this element wasn't already marked as loaded by an element with different reference font family.
            if (typeof this._fontsMap[fontKey] === "undefined") {
                return;
            }

            font = this._fontsMap[fontKey];

            this._numberOfLoadedFonts++;
            delete this._fontsMap[fontKey];

            if (this.delegate && typeof this.delegate.fontLoaded === "function") {
                this.delegate.fontLoaded(font.toJSON());
            }

            if (this._numberOfLoadedFonts === this._numberOfFonts) {
                this._finish();
            }
        },
        _finish: function() {
            var error, i, sizeWatcher,
                fontKey,
                notLoadedFonts = [];

            if (this._finished) {
                return;
            }

            this._finished = true;

            if (this._adobeBlankSizeWatcher !== null) {
                if (this._adobeBlankSizeWatcher.getState() === SizeWatcher.states.watchingForSizeChange) {
                    this._adobeBlankSizeWatcher.endWatching();
                }
                this._adobeBlankSizeWatcher = null;
            }

            for (i = 0; i < this._sizeWatchers.length; i++) {
                sizeWatcher = this._sizeWatchers[i];
                if (sizeWatcher.getState() === SizeWatcher.states.watchingForSizeChange) {
                    sizeWatcher.endWatching();
                }
            }
            this._sizeWatchers = [];

            if (this._testContainer !== null) {
                this._testContainer.parentNode.removeChild(this._testContainer);
            }

            if (this._timeoutId !== null) {
                window.clearTimeout(this._timeoutId);
            }

            if (this._intervalId !== null) {
                window.clearInterval(this._intervalId);
            }

            if (this.delegate) {
                if (this._numberOfLoadedFonts < this._numberOfFonts) {
                    for (fontKey in this._fontsMap) {
                        if (this._fontsMap.hasOwnProperty(fontKey)) {
                            notLoadedFonts.push(this._fontsMap[fontKey].toJSON());
                        }
                    }
                    error = {
                        message: "Not all fonts were loaded (" + this._numberOfLoadedFonts + "/" + this._numberOfFonts + ")",
                        notLoadedFonts: notLoadedFonts
                    };
                } else {
                    error = null;
                }
                if (typeof this.delegate.complete === "function") {
                    this.delegate.complete(error);
                } else if (typeof this.delegate.fontsLoaded === "function") {
                    this.delegate.fontsLoaded(error);
                }
            }
        },
        /**
         * SizeWatcher delegate method
         * @param {SizeWatcher} sizeWatcher
         */
        sizeWatcherChangedSize: function(sizeWatcher) {
            var watchedElement = sizeWatcher.getWatchedElement();
            if (sizeWatcher === this._adobeBlankSizeWatcher) {
                this._adobeBlankLoaded(watchedElement);
            } else {
                this._elementSizeChanged(watchedElement);
            }
        }
    };

    /**
     * Size object
     *
     * @param width
     * @param height
     * @constructor
     */
    function Size(width, height) {
        this.width = width;
        this.height = height;
    }

    Size.sizeFromString = function(sizeString) {
        var arr = sizeString.split(",");
        if (arr.length !== 2) {
            return null;
        }
        return new Size(arr[0], arr[1]);
    };

    /**
     * Compares receiver object to passed in size object.
     *
     * @param otherSize
     * @returns {boolean}
     */
    Size.prototype.isEqual = function(otherSize) {
        return (this.width === otherSize.width && this.height === otherSize.height);
    };

    Size.prototype.toString = function() {
        return this.width + "," + this.height;
    };

    /**
     * SizeWatcher observes size of an element and notifies when its size is changed. It doesn't use any timeouts
     * to check the element size, when change in size occurs a callback method immediately invoked.
     *
     * To watch for element's size changes the element, and other required elements are appended to a container element
     * you specify, and which must be added to the DOM tree before invoking prepareForWatch() method. Your container
     * element should be positioned outside of client's visible area. Therefore you shouldn't use SizeWatcher to watch
     * for size changes of elements used for UI.
     * Such container element could be a simple <div> that is a child of the <body> element:
     * <div style="position:absolute; left:-10000px; top:-10000px;"></div>
     *
     * You must invoke SizeWatcher's methods in a specific order to establish size change listeners:
     *
     * 1. Create SizeWatcher instance by invoke SizeWatcher constructor passing the element (size of which you want to
     *    observe), the container element, the delegate object and optional size parameter of type Size which should be
     *    the pre-calculated initial size of your element.
     * 4. Invoke prepareForWatch() method. This method will calculate element size if you didn't passed it to the constructor.
     * 5. Invoke beginWatching() method. This method will set event listeners and invoke your delegate's method once
     *    element size changes.
     *
     * Failing to invoke above methods in their predefined order will throw an exception.
     *
     * @param {HTMLElement}   element An element, size of which will be observed for changes.
     * @param {Object}        options
     * @param {HTMLElement}   options.container An element to which special observing elements will be added. Must be in DOM tree
     *                        when prepareForWatch() method is called.
     * @param {Object}        options.delegate A delegate object with a sizeWatcherChangedSize method which will be invoked, in
     *                        context of the delegate object, when change in size occurs. This method is invoked with single
     *                        parameter which is the current SizeWatcher instance.
     * @param {Size}          [options.size] The pre-calculated initial size of your element. When passed, the element is not
     *                        asked for offsetWidth and offsetHeight, which may be useful to reduce browser's CSS
     *                        recalculations. If you will not pass the size parameter then its size calculation will be
     *                        deferred to prepareForWatch() method.
     * @param {Boolean}       [options.continuous=false] A boolean flag indicating if the SizeWatcher will watch only for
     *                        the first size change (default) or will continuously watch for size changes.
     * @param {Number}        [options.direction=SizeWatcher.directions.both] The direction of size change that should be
     *                        watched: SizeWatcher.directions.increase, SizeWatcher.directions.decrease or
     *                        SizeWatcher.directions.both
     * @param {Number}        [options.dimension=SizeWatcher.dimensions.both] The dimension of size change that should be
     *                        watched: SizeWatcher.dimensions.horizontal, SizeWatcher.dimensions.vertical or
     *                        SizeWatcher.dimensions.both
     * @param {HTMLDocument}  [options.document] The DOM tree context to use, if none provided then it will be the document.
     * @constructor
     */
    function SizeWatcher(element, options) {
        this._element = element;
        this._delegate = options.delegate;
        this._size = null;
        this._continuous = !!options.continuous;
        this._direction = options.direction ? options.direction : SizeWatcher.directions.both;
        this._dimension = options.dimension ? options.dimension : SizeWatcher.dimensions.both;
        this._sizeIncreaseWatcherContentElm = null;
        this._sizeDecreaseWatcherElm = null;
        this._sizeIncreaseWatcherElm = null;
        this._state = SizeWatcher.states.initialized;
        this._scrollAmount = 2;
        this._document = options.document || document;

        this._generateScrollWatchers(options.size);
        this._appendScrollWatchersToElement(options.container);
    }

    SizeWatcher.states = {
        initialized: 0,
        generatedScrollWatchers: 1,
        appendedScrollWatchers: 2,
        preparedScrollWatchers: 3,
        watchingForSizeChange: 4
    };

    SizeWatcher.directions = {
        decrease: 1,
        increase: 2,
        both: 3
    };

    SizeWatcher.dimensions = {
        horizontal: 1,
        vertical: 2,
        both: 3
    };

    //noinspection JSUnusedLocalSymbols
    SizeWatcher.prototype = {
        constructor: SizeWatcher,
        getWatchedElement: function() {
            return this._element;
        },
        getState: function() {
            return this._state;
        },
        setSize: function(size) {
            this._size = size;
            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.increase) {
                this._sizeIncreaseWatcherContentElm.style.cssText = "width: " + (size.width + this._scrollAmount) + "px; height: " + (size.height + this._scrollAmount) + "px;";
            }
            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.decrease) {
                this._sizeDecreaseWatcherElm.style.cssText = "position:absolute; left: 0px; top: 0px; overflow: hidden; width: " + (size.width - this._scrollAmount) + "px; height: " + (size.height - this._scrollAmount) + "px;";
            }
        },
        _generateScrollWatchers: function(size) {

            this._element.style.position = "absolute";

            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.increase) {
                this._sizeIncreaseWatcherContentElm = this._document.createElement("div");

                this._sizeIncreaseWatcherElm = this._document.createElement("div");
                this._sizeIncreaseWatcherElm.style.cssText = "position: absolute; left: 0; top: 0; width: 100%; height: 100%; overflow: hidden;";
                this._sizeIncreaseWatcherElm.appendChild(this._sizeIncreaseWatcherContentElm);

                this._element.appendChild(this._sizeIncreaseWatcherElm);
            }

            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.decrease) {
                this._sizeDecreaseWatcherElm = this._document.createElement("div");
                this._sizeDecreaseWatcherElm.appendChild(this._element);
            }

            if (size) {
                this.setSize(size);
            }

            this._state = SizeWatcher.states.generatedScrollWatchers;
        },
        _appendScrollWatchersToElement: function(container) {
            if (this._state !== SizeWatcher.states.generatedScrollWatchers) {
                throw new Error("SizeWatcher._appendScrollWatchersToElement() was invoked before SizeWatcher._generateScrollWatchers()");
            }

            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.decrease) {
                container.appendChild(this._sizeDecreaseWatcherElm);
            } else {
                container.appendChild(this._element);
            }

            this._state = SizeWatcher.states.appendedScrollWatchers;
        },
        removeScrollWatchers: function() {
            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.decrease) {
                if (this._sizeDecreaseWatcherElm.parentNode) {
                    this._sizeDecreaseWatcherElm.parentNode.removeChild(this._sizeDecreaseWatcherElm);
                }
            } else if (this._element.parentNode) {
                this._element.parentNode.removeChild(this._element);
            }
        },
        prepareForWatch: function() {
            var parentNode,
                sizeDecreaseWatcherElmScrolled = true,
                sizeIncreaseWatcherElmScrolled = true;

            if (this._state !== SizeWatcher.states.appendedScrollWatchers) {
                throw new Error("SizeWatcher.prepareForWatch() invoked before SizeWatcher._appendScrollWatchersToElement()");
            }

            if (this._size === null) {
                this.setSize(new Size(this._element.offsetWidth, this._element.offsetHeight));
            }

            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.decrease) {
                sizeDecreaseWatcherElmScrolled = this._scrollElementToBottomRight(this._sizeDecreaseWatcherElm);
            }
            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.increase) {
                sizeIncreaseWatcherElmScrolled = this._scrollElementToBottomRight(this._sizeIncreaseWatcherElm);
            }

            // Check if scroll positions updated.
            if (!sizeDecreaseWatcherElmScrolled || !sizeIncreaseWatcherElmScrolled) {

                // Traverse tree to the top node to see if element is in the DOM tree.
                parentNode = this._element.parentNode;
                while (parentNode !== this._document && parentNode !== null) {
                    parentNode = parentNode.parentNode;
                }

                if (parentNode === null) {
                    throw new Error("Can't set scroll position of scroll watchers. SizeWatcher is not in the DOM tree.");
                } else if (console && typeof console.warn === "function") {
                    console.warn("SizeWatcher can't set scroll position of scroll watchers.");
                }
            }

            this._state = SizeWatcher.states.preparedScrollWatchers;
        },
        _scrollElementToBottomRight: function(element) {
            var elementScrolled = true;
            //noinspection JSBitwiseOperatorUsage
            if (this._dimension & SizeWatcher.dimensions.vertical) {
                element.scrollTop = this._scrollAmount;
                elementScrolled = elementScrolled && element.scrollTop > 0;
            }
            //noinspection JSBitwiseOperatorUsage
            if (this._dimension & SizeWatcher.dimensions.horizontal) {
                element.scrollLeft = this._scrollAmount;
                elementScrolled = elementScrolled && element.scrollLeft > 0;
            }
            return elementScrolled;
        },
        beginWatching: function() {
            if (this._state !== SizeWatcher.states.preparedScrollWatchers) {
                throw new Error("SizeWatcher.beginWatching() invoked before SizeWatcher.prepareForWatch()");
            }

            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.decrease) {
                //noinspection JSValidateTypes
                this._sizeDecreaseWatcherElm.addEventListener("scroll", this, false);
            }
            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.increase) {
                //noinspection JSValidateTypes
                this._sizeIncreaseWatcherElm.addEventListener("scroll", this, false);
            }

            this._state = SizeWatcher.states.watchingForSizeChange;
        },
        endWatching: function() {
            if (this._state !== SizeWatcher.states.watchingForSizeChange) {
                throw new Error("SizeWatcher.endWatching() invoked before SizeWatcher.beginWatching()");
            }

            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.decrease) {
                //noinspection JSValidateTypes
                this._sizeDecreaseWatcherElm.removeEventListener("scroll", this, false);
            }
            //noinspection JSBitwiseOperatorUsage
            if (this._direction & SizeWatcher.directions.increase) {
                //noinspection JSValidateTypes
                this._sizeIncreaseWatcherElm.removeEventListener("scroll", this, false);
            }
            this._state = SizeWatcher.states.appendedScrollWatchers;
        },
        /**
         * @private
         */
        handleEvent: function(event) {
            var newSize, oldSize;

            // This is not suppose to happen because when we run endWatching() we remove scroll listeners.
            // But some browsers will fire second scroll event which was pushed into event stack before listener was
            // removed so do this check anyway.
            if (this._state !== SizeWatcher.states.watchingForSizeChange) {
                return;
            }

            newSize = new Size(this._element.offsetWidth, this._element.offsetHeight);
            oldSize = this._size;

            // Check if element size is changed. How come that element size isn't changed but scroll event fired?
            // This can happen in two cases: when double scroll occurs or immediately after calling prepareForWatch()
            // (event if scroll event listeners attached after it).
            // The double scroll event happens when one size dimension (e.g.:width) is increased and another
            // (e.g.:height) is decreased.
            if (oldSize.isEqual(newSize)) {
                return;
            }

            if (this._delegate && typeof this._delegate.sizeWatcherChangedSize === "function") {
                this._delegate.sizeWatcherChangedSize(this);

                // Check that endWatching() wasn't invoked from within the delegate.
                if (this._state !== SizeWatcher.states.watchingForSizeChange) {
                    return;
                }
            }

            if (!this._continuous) {
                this.endWatching();
            } else {
                // Set the new size so in case of double scroll event we won't cause the delegate method to be executed twice
                // and also to update to the new watched size.
                this.setSize(newSize);
                // change state so prepareFowWatch() won't throw exception about wrong order invocation.
                this._state = SizeWatcher.states.appendedScrollWatchers;
                // Run prepareForWatch to reset the scroll watchers, we have already set the size
                this.prepareForWatch();
                // Set state to listeningForSizeChange, there is no need to invoke beginWatching() method as scroll event
                // listeners and callback are already set.
                this._state = SizeWatcher.states.watchingForSizeChange;

            }
        }
    };

    return FontLoader;

}));

/* file: script/lib/lodash.js */

/**
 * @license
 * lodash lodash.com/license | Underscore.js 1.8.3 underscorejs.org/LICENSE
 */
;(function(){function t(t,n){return t.set(n[0],n[1]),t}function n(t,n){return t.add(n),t}function r(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}function e(t,n,r,e){for(var u=-1,o=t.length;++u<o;){var i=t[u];n(e,i,r(i),t)}return e}function u(t,n){for(var r=-1,e=t.length;++r<e&&false!==n(t[r],r,t););return t}function o(t,n){for(var r=t.length;r--&&false!==n(t[r],r,t););return t}function i(t,n){
    for(var r=-1,e=t.length;++r<e;)if(!n(t[r],r,t))return false;return true}function f(t,n){for(var r=-1,e=t.length,u=0,o=[];++r<e;){var i=t[r];n(i,r,t)&&(o[u++]=i)}return o}function c(t,n){return!!t.length&&-1<d(t,n,0)}function a(t,n,r){for(var e=-1,u=t.length;++e<u;)if(r(n,t[e]))return true;return false}function l(t,n){for(var r=-1,e=t.length,u=Array(e);++r<e;)u[r]=n(t[r],r,t);return u}function s(t,n){for(var r=-1,e=n.length,u=t.length;++r<e;)t[u+r]=n[r];return t}function h(t,n,r,e){var u=-1,o=t.length;for(e&&o&&(r=t[++u]);++u<o;)r=n(r,t[u],u,t);
    return r}function p(t,n,r,e){var u=t.length;for(e&&u&&(r=t[--u]);u--;)r=n(r,t[u],u,t);return r}function _(t,n){for(var r=-1,e=t.length;++r<e;)if(n(t[r],r,t))return true;return false}function v(t,n,r,e){var u;return r(t,function(t,r,o){return n(t,r,o)?(u=e?r:t,false):void 0}),u}function g(t,n,r){for(var e=t.length,u=r?e:-1;r?u--:++u<e;)if(n(t[u],u,t))return u;return-1}function d(t,n,r){if(n!==n)return M(t,r);--r;for(var e=t.length;++r<e;)if(t[r]===n)return r;return-1}function y(t,n,r,e){--r;for(var u=t.length;++r<u;)if(e(t[r],n))return r;
    return-1}function b(t,n){var r=t?t.length:0;return r?w(t,n)/r:V}function x(t,n,r,e,u){return u(t,function(t,u,o){r=e?(e=false,t):n(r,t,u,o)}),r}function j(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].c;return t}function w(t,n){for(var r,e=-1,u=t.length;++e<u;){var o=n(t[e]);o!==T&&(r=r===T?o:r+o)}return r}function m(t,n){for(var r=-1,e=Array(t);++r<t;)e[r]=n(r);return e}function A(t,n){return l(n,function(n){return[n,t[n]]})}function O(t){return function(n){return t(n)}}function k(t,n){return l(n,function(n){
    return t[n]})}function E(t,n){return t.has(n)}function I(t,n){for(var r=-1,e=t.length;++r<e&&-1<d(n,t[r],0););return r}function S(t,n){for(var r=t.length;r--&&-1<d(n,t[r],0););return r}function R(t){return t&&t.Object===Object?t:null}function W(t){return zt[t]}function B(t){return Ut[t]}function L(t){return"\\"+$t[t]}function M(t,n,r){var e=t.length;for(n+=r?0:-1;r?n--:++n<e;){var u=t[n];if(u!==u)return n}return-1}function C(t){var n=false;if(null!=t&&typeof t.toString!="function")try{n=!!(t+"")}catch(r){}
    return n}function z(t){for(var n,r=[];!(n=t.next()).done;)r.push(n.value);return r}function U(t){var n=-1,r=Array(t.size);return t.forEach(function(t,e){r[++n]=[e,t]}),r}function D(t,n){for(var r=-1,e=t.length,u=0,o=[];++r<e;){var i=t[r];i!==n&&"__lodash_placeholder__"!==i||(t[r]="__lodash_placeholder__",o[u++]=r)}return o}function F(t){var n=-1,r=Array(t.size);return t.forEach(function(t){r[++n]=t}),r}function $(t){var n=-1,r=Array(t.size);return t.forEach(function(t){r[++n]=[t,t]}),r}function N(t){
    if(!t||!Wt.test(t))return t.length;for(var n=St.lastIndex=0;St.test(t);)n++;return n}function P(t){return Dt[t]}function Z(R){function At(t){if(De(t)&&!ai(t)&&!(t instanceof zt)){if(t instanceof kt)return t;if(wu.call(t,"__wrapped__"))return ie(t)}return new kt(t)}function Ot(){}function kt(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=T}function zt(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=false,this.__iteratees__=[],
    this.__takeCount__=4294967295,this.__views__=[]}function Ut(t){var n=-1,r=t?t.length:0;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}function Dt(t){var n=-1,r=t?t.length:0;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}function Ft(t){var n=-1,r=t?t.length:0;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}function $t(t){var n=-1,r=t?t.length:0;for(this.__data__=new Ft;++n<r;)this.add(t[n])}function Zt(t){this.__data__=new Dt(t)}function Tt(t,n,r,e){return t===T||Se(t,bu[r])&&!wu.call(e,r)?n:t;
}function Vt(t,n,r){(r===T||Se(t[n],r))&&(typeof n!="number"||r!==T||n in t)||(t[n]=r)}function Kt(t,n,r){var e=t[n];wu.call(t,n)&&Se(e,r)&&(r!==T||n in t)||(t[n]=r)}function Gt(t,n){for(var r=t.length;r--;)if(Se(t[r][0],n))return r;return-1}function Ht(t,n,r,e){return go(t,function(t,u,o){n(e,t,r(t),o)}),e}function Qt(t,n){return t&&ar(n,nu(n),t)}function Xt(t,n){for(var r=-1,e=null==t,u=n.length,o=Array(u);++r<u;)o[r]=e?T:Xe(t,n[r]);return o}function tn(t,n,r){return t===t&&(r!==T&&(t=r>=t?t:r),
n!==T&&(t=t>=n?t:n)),t}function nn(t,n,r,e,o,i,f){var c;if(e&&(c=i?e(t,o,i,f):e(t)),c!==T)return c;if(!Ue(t))return t;if(o=ai(t)){if(c=Tr(t),!n)return cr(t,c)}else{var a=Pr(t),l="[object Function]"==a||"[object GeneratorFunction]"==a;if(li(t))return er(t,n);if("[object Object]"==a||"[object Arguments]"==a||l&&!i){if(C(t))return i?t:{};if(c=qr(l?{}:t),!n)return lr(t,Qt(c,t))}else{if(!Ct[a])return i?t:{};c=Vr(t,a,nn,n)}}if(f||(f=new Zt),i=f.get(t))return i;if(f.set(t,c),!o)var s=r?vn(t,nu,Nr):nu(t);
    return u(s||t,function(u,o){s&&(o=u,u=t[o]),Kt(c,o,nn(u,n,r,e,o,t,f))}),c}function rn(t){var n=nu(t),r=n.length;return function(e){if(null==e)return!r;for(var u=r;u--;){var o=n[u],i=t[o],f=e[o];if(f===T&&!(o in Object(e))||!i(f))return false}return true}}function en(t){return Ue(t)?zu(t):{}}function un(t,n,r){if(typeof t!="function")throw new du("Expected a function");return Du(function(){t.apply(T,r)},n)}function on(t,n,r,e){var u=-1,o=c,i=true,f=t.length,s=[],h=n.length;if(!f)return s;r&&(n=l(n,O(r))),e?(o=a,
    i=false):n.length>=200&&(o=E,i=false,n=new $t(n));t:for(;++u<f;){var p=t[u],_=r?r(p):p,p=e||0!==p?p:0;if(i&&_===_){for(var v=h;v--;)if(n[v]===_)continue t;s.push(p)}else o(n,_,e)||s.push(p)}return s}function fn(t,n){var r=true;return go(t,function(t,e,u){return r=!!n(t,e,u)}),r}function cn(t,n,r){for(var e=-1,u=t.length;++e<u;){var o=t[e],i=n(o);if(null!=i&&(f===T?i===i&&!Te(i):r(i,f)))var f=i,c=o}return c}function an(t,n){var r=[];return go(t,function(t,e,u){n(t,e,u)&&r.push(t)}),r}function ln(t,n,r,e,u){
    var o=-1,i=t.length;for(r||(r=Gr),u||(u=[]);++o<i;){var f=t[o];n>0&&r(f)?n>1?ln(f,n-1,r,e,u):s(u,f):e||(u[u.length]=f)}return u}function sn(t,n){return t&&bo(t,n,nu)}function hn(t,n){return t&&xo(t,n,nu)}function pn(t,n){return f(n,function(n){return Me(t[n])})}function _n(t,n){n=Qr(n,t)?[n]:nr(n);for(var r=0,e=n.length;null!=t&&e>r;)t=t[ue(n[r++])];return r&&r==e?t:T}function vn(t,n,r){return n=n(t),ai(t)?n:s(n,r(t))}function gn(t,n){return t>n}function dn(t,n){return wu.call(t,n)||typeof t=="object"&&n in t&&null===Pu(Object(t));
}function yn(t,n){return n in Object(t)}function bn(t,n,r){for(var e=r?a:c,u=t[0].length,o=t.length,i=o,f=Array(o),s=1/0,h=[];i--;){var p=t[i];i&&n&&(p=l(p,O(n))),s=Ku(p.length,s),f[i]=!r&&(n||u>=120&&p.length>=120)?new $t(i&&p):T}var p=t[0],_=-1,v=f[0];t:for(;++_<u&&s>h.length;){var g=p[_],d=n?n(g):g,g=r||0!==g?g:0;if(v?!E(v,d):!e(h,d,r)){for(i=o;--i;){var y=f[i];if(y?!E(y,d):!e(t[i],d,r))continue t}v&&v.push(d),h.push(g)}}return h}function xn(t,n,r){var e={};return sn(t,function(t,u,o){n(e,r(t),u,o);
}),e}function jn(t,n,e){return Qr(n,t)||(n=nr(n),t=ee(t,n),n=le(n)),n=null==t?t:t[ue(n)],null==n?T:r(n,t,e)}function wn(t,n,r,e,u){if(t===n)n=true;else if(null==t||null==n||!Ue(t)&&!De(n))n=t!==t&&n!==n;else t:{var o=ai(t),i=ai(n),f="[object Array]",c="[object Array]";o||(f=Pr(t),f="[object Arguments]"==f?"[object Object]":f),i||(c=Pr(n),c="[object Arguments]"==c?"[object Object]":c);var a="[object Object]"==f&&!C(t),i="[object Object]"==c&&!C(n);if((c=f==c)&&!a)u||(u=new Zt),n=o||qe(t)?Lr(t,n,wn,r,e,u):Mr(t,n,f,wn,r,e,u);else{
    if(!(2&e)&&(o=a&&wu.call(t,"__wrapped__"),f=i&&wu.call(n,"__wrapped__"),o||f)){t=o?t.value():t,n=f?n.value():n,u||(u=new Zt),n=wn(t,n,r,e,u);break t}if(c)n:if(u||(u=new Zt),o=2&e,f=nu(t),i=f.length,c=nu(n).length,i==c||o){for(a=i;a--;){var l=f[a];if(!(o?l in n:dn(n,l))){n=false;break n}}if(c=u.get(t))n=c==n;else{c=true,u.set(t,n);for(var s=o;++a<i;){var l=f[a],h=t[l],p=n[l];if(r)var _=o?r(p,h,l,n,t,u):r(h,p,l,t,n,u);if(_===T?h!==p&&!wn(h,p,r,e,u):!_){c=false;break}s||(s="constructor"==l)}c&&!s&&(r=t.constructor,
        e=n.constructor,r!=e&&"constructor"in t&&"constructor"in n&&!(typeof r=="function"&&r instanceof r&&typeof e=="function"&&e instanceof e)&&(c=false)),u["delete"](t),n=c}}else n=false;else n=false}}return n}function mn(t,n,r,e){var u=r.length,o=u,i=!e;if(null==t)return!o;for(t=Object(t);u--;){var f=r[u];if(i&&f[2]?f[1]!==t[f[0]]:!(f[0]in t))return false}for(;++u<o;){var f=r[u],c=f[0],a=t[c],l=f[1];if(i&&f[2]){if(a===T&&!(c in t))return false}else{if(f=new Zt,e)var s=e(a,l,c,t,n,f);if(s===T?!wn(l,a,e,3,f):!s)return false;
}}return true}function An(t){return typeof t=="function"?t:null==t?cu:typeof t=="object"?ai(t)?Sn(t[0],t[1]):In(t):hu(t)}function On(t){t=null==t?t:Object(t);var n,r=[];for(n in t)r.push(n);return r}function kn(t,n){return n>t}function En(t,n){var r=-1,e=We(t)?Array(t.length):[];return go(t,function(t,u,o){e[++r]=n(t,u,o)}),e}function In(t){var n=Fr(t);return 1==n.length&&n[0][2]?ne(n[0][0],n[0][1]):function(r){return r===t||mn(r,t,n)}}function Sn(t,n){return Qr(t)&&n===n&&!Ue(n)?ne(ue(t),n):function(r){
    var e=Xe(r,t);return e===T&&e===n?tu(r,t):wn(n,e,T,3)}}function Rn(t,n,r,e,o){if(t!==n){if(!ai(n)&&!qe(n))var i=ru(n);u(i||n,function(u,f){if(i&&(f=u,u=n[f]),Ue(u)){o||(o=new Zt);var c=f,a=o,l=t[c],s=n[c],h=a.get(s);if(h)Vt(t,c,h);else{var h=e?e(l,s,c+"",t,n,a):T,p=h===T;p&&(h=s,ai(s)||qe(s)?ai(l)?h=l:Be(l)?h=cr(l):(p=false,h=nn(s,true)):Ne(s)||Re(s)?Re(l)?h=He(l):!Ue(l)||r&&Me(l)?(p=false,h=nn(s,true)):h=l:p=false),a.set(s,h),p&&Rn(h,s,r,e,a),a["delete"](s),Vt(t,c,h)}}else c=e?e(t[f],u,f+"",t,n,o):T,c===T&&(c=u),
    Vt(t,f,c)})}}function Wn(t,n){var r=t.length;return r?(n+=0>n?r:0,Yr(n,r)?t[n]:T):void 0}function Bn(t,n,r){var e=-1;return n=l(n.length?n:[cu],O(Ur())),t=En(t,function(t){return{a:l(n,function(n){return n(t)}),b:++e,c:t}}),j(t,function(t,n){var e;t:{e=-1;for(var u=t.a,o=n.a,i=u.length,f=r.length;++e<i;){var c=or(u[e],o[e]);if(c){e=e>=f?c:c*("desc"==r[e]?-1:1);break t}}e=t.b-n.b}return e})}function Ln(t,n){return t=Object(t),h(n,function(n,r){return r in t&&(n[r]=t[r]),n},{})}function Mn(t,n){for(var r=-1,e=vn(t,ru,Oo),u=e.length,o={};++r<u;){
    var i=e[r],f=t[i];n(f,i)&&(o[i]=f)}return o}function Cn(t){return function(n){return null==n?T:n[t]}}function zn(t){return function(n){return _n(n,t)}}function Un(t,n,r,e){var u=e?y:d,o=-1,i=n.length,f=t;for(r&&(f=l(t,O(r)));++o<i;)for(var c=0,a=n[o],a=r?r(a):a;-1<(c=u(f,a,c,e));)f!==t&&Fu.call(f,c,1),Fu.call(t,c,1);return t}function Dn(t,n){for(var r=t?n.length:0,e=r-1;r--;){var u=n[r];if(r==e||u!==o){var o=u;if(Yr(u))Fu.call(t,u,1);else if(Qr(u,t))delete t[ue(u)];else{var u=nr(u),i=ee(t,u);null!=i&&delete i[ue(le(u))];
}}}}function Fn(t,n){return t+Nu(Ju()*(n-t+1))}function $n(t,n){var r="";if(!t||1>n||n>9007199254740991)return r;do n%2&&(r+=t),(n=Nu(n/2))&&(t+=t);while(n);return r}function Nn(t,n,r,e){n=Qr(n,t)?[n]:nr(n);for(var u=-1,o=n.length,i=o-1,f=t;null!=f&&++u<o;){var c=ue(n[u]);if(Ue(f)){var a=r;if(u!=i){var l=f[c],a=e?e(l,c,f):T;a===T&&(a=null==l?Yr(n[u+1])?[]:{}:l)}Kt(f,c,a)}f=f[c]}return t}function Pn(t,n,r){var e=-1,u=t.length;for(0>n&&(n=-n>u?0:u+n),r=r>u?u:r,0>r&&(r+=u),u=n>r?0:r-n>>>0,n>>>=0,r=Array(u);++e<u;)r[e]=t[e+n];
    return r}function Zn(t,n){var r;return go(t,function(t,e,u){return r=n(t,e,u),!r}),!!r}function Tn(t,n,r){var e=0,u=t?t.length:e;if(typeof n=="number"&&n===n&&2147483647>=u){for(;u>e;){var o=e+u>>>1,i=t[o];null!==i&&!Te(i)&&(r?n>=i:n>i)?e=o+1:u=o}return u}return qn(t,n,cu,r)}function qn(t,n,r,e){n=r(n);for(var u=0,o=t?t.length:0,i=n!==n,f=null===n,c=Te(n),a=n===T;o>u;){var l=Nu((u+o)/2),s=r(t[l]),h=s!==T,p=null===s,_=s===s,v=Te(s);(i?e||_:a?_&&(e||h):f?_&&h&&(e||!p):c?_&&h&&!p&&(e||!v):p||v?0:e?n>=s:n>s)?u=l+1:o=l;
}return Ku(o,4294967294)}function Vn(t,n){for(var r=-1,e=t.length,u=0,o=[];++r<e;){var i=t[r],f=n?n(i):i;if(!r||!Se(f,c)){var c=f;o[u++]=0===i?0:i}}return o}function Kn(t){return typeof t=="number"?t:Te(t)?V:+t}function Gn(t){if(typeof t=="string")return t;if(Te(t))return vo?vo.call(t):"";var n=t+"";return"0"==n&&1/t==-q?"-0":n}function Jn(t,n,r){var e=-1,u=c,o=t.length,i=true,f=[],l=f;if(r)i=false,u=a;else if(o>=200){if(u=n?null:wo(t))return F(u);i=false,u=E,l=new $t}else l=n?[]:f;t:for(;++e<o;){var s=t[e],h=n?n(s):s,s=r||0!==s?s:0;
    if(i&&h===h){for(var p=l.length;p--;)if(l[p]===h)continue t;n&&l.push(h),f.push(s)}else u(l,h,r)||(l!==f&&l.push(h),f.push(s))}return f}function Yn(t,n,r,e){for(var u=t.length,o=e?u:-1;(e?o--:++o<u)&&n(t[o],o,t););return r?Pn(t,e?0:o,e?o+1:u):Pn(t,e?o+1:0,e?u:o)}function Hn(t,n){var r=t;return r instanceof zt&&(r=r.value()),h(n,function(t,n){return n.func.apply(n.thisArg,s([t],n.args))},r)}function Qn(t,n,r){for(var e=-1,u=t.length;++e<u;)var o=o?s(on(o,t[e],n,r),on(t[e],o,n,r)):t[e];return o&&o.length?Jn(o,n,r):[];
}function Xn(t,n,r){for(var e=-1,u=t.length,o=n.length,i={};++e<u;)r(i,t[e],o>e?n[e]:T);return i}function tr(t){return Be(t)?t:[]}function nr(t){return ai(t)?t:Eo(t)}function rr(t,n,r){var e=t.length;return r=r===T?e:r,!n&&r>=e?t:Pn(t,n,r)}function er(t,n){if(n)return t.slice();var r=new t.constructor(t.length);return t.copy(r),r}function ur(t){var n=new t.constructor(t.byteLength);return new Wu(n).set(new Wu(t)),n}function or(t,n){if(t!==n){var r=t!==T,e=null===t,u=t===t,o=Te(t),i=n!==T,f=null===n,c=n===n,a=Te(n);
    if(!f&&!a&&!o&&t>n||o&&i&&c&&!f&&!a||e&&i&&c||!r&&c||!u)return 1;if(!e&&!o&&!a&&n>t||a&&r&&u&&!e&&!o||f&&r&&u||!i&&u||!c)return-1}return 0}function ir(t,n,r,e){var u=-1,o=t.length,i=r.length,f=-1,c=n.length,a=Vu(o-i,0),l=Array(c+a);for(e=!e;++f<c;)l[f]=n[f];for(;++u<i;)(e||o>u)&&(l[r[u]]=t[u]);for(;a--;)l[f++]=t[u++];return l}function fr(t,n,r,e){var u=-1,o=t.length,i=-1,f=r.length,c=-1,a=n.length,l=Vu(o-f,0),s=Array(l+a);for(e=!e;++u<l;)s[u]=t[u];for(l=u;++c<a;)s[l+c]=n[c];for(;++i<f;)(e||o>u)&&(s[l+r[i]]=t[u++]);
    return s}function cr(t,n){var r=-1,e=t.length;for(n||(n=Array(e));++r<e;)n[r]=t[r];return n}function ar(t,n,r,e){r||(r={});for(var u=-1,o=n.length;++u<o;){var i=n[u],f=e?e(r[i],t[i],i,r,t):t[i];Kt(r,i,f)}return r}function lr(t,n){return ar(t,Nr(t),n)}function sr(t,n){return function(r,u){var o=ai(r)?e:Ht,i=n?n():{};return o(r,t,Ur(u),i)}}function hr(t){return Ie(function(n,r){var e=-1,u=r.length,o=u>1?r[u-1]:T,i=u>2?r[2]:T,o=t.length>3&&typeof o=="function"?(u--,o):T;for(i&&Hr(r[0],r[1],i)&&(o=3>u?T:o,
    u=1),n=Object(n);++e<u;)(i=r[e])&&t(n,i,e,o);return n})}function pr(t,n){return function(r,e){if(null==r)return r;if(!We(r))return t(r,e);for(var u=r.length,o=n?u:-1,i=Object(r);(n?o--:++o<u)&&false!==e(i[o],o,i););return r}}function _r(t){return function(n,r,e){var u=-1,o=Object(n);e=e(n);for(var i=e.length;i--;){var f=e[t?i:++u];if(false===r(o[f],f,o))break}return n}}function vr(t,n,r){function e(){return(this&&this!==Jt&&this instanceof e?o:t).apply(u?r:this,arguments)}var u=1&n,o=yr(t);return e}function gr(t){
    return function(n){n=Qe(n);var r=Wt.test(n)?n.match(St):T,e=r?r[0]:n.charAt(0);return n=r?rr(r,1).join(""):n.slice(1),e[t]()+n}}function dr(t){return function(n){return h(iu(ou(n).replace(Et,"")),t,"")}}function yr(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);
    case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var r=en(t.prototype),n=t.apply(r,n);return Ue(n)?n:r}}function br(t,n,e){function u(){for(var i=arguments.length,f=Array(i),c=i,a=zr(u);c--;)f[c]=arguments[c];return c=3>i&&f[0]!==a&&f[i-1]!==a?[]:D(f,a),i-=c.length,e>i?Sr(t,n,jr,u.placeholder,T,f,c,T,T,e-i):r(this&&this!==Jt&&this instanceof u?o:t,this,f)}var o=yr(t);return u}function xr(t){return Ie(function(n){n=ln(n,1);var r=n.length,e=r,u=kt.prototype.thru;for(t&&n.reverse();e--;){var o=n[e];
    if(typeof o!="function")throw new du("Expected a function");if(u&&!i&&"wrapper"==Cr(o))var i=new kt([],true)}for(e=i?e:r;++e<r;)var o=n[e],u=Cr(o),f="wrapper"==u?mo(o):T,i=f&&Xr(f[0])&&424==f[1]&&!f[4].length&&1==f[9]?i[Cr(f[0])].apply(i,f[3]):1==o.length&&Xr(o)?i[u]():i.thru(o);return function(){var t=arguments,e=t[0];if(i&&1==t.length&&ai(e)&&e.length>=200)return i.plant(e).value();for(var u=0,t=r?n[u].apply(this,t):e;++u<r;)t=n[u].call(this,t);return t}})}function jr(t,n,r,e,u,o,i,f,c,a){function l(){
    for(var d=arguments.length,y=Array(d),b=d;b--;)y[b]=arguments[b];if(_){var x,j=zr(l),b=y.length;for(x=0;b--;)y[b]===j&&x++}if(e&&(y=ir(y,e,u,_)),o&&(y=fr(y,o,i,_)),d-=x,_&&a>d)return j=D(y,j),Sr(t,n,jr,l.placeholder,r,y,j,f,c,a-d);if(j=h?r:this,b=p?j[t]:t,d=y.length,f){x=y.length;for(var w=Ku(f.length,x),m=cr(y);w--;){var A=f[w];y[w]=Yr(A,x)?m[A]:T}}else v&&d>1&&y.reverse();return s&&d>c&&(y.length=c),this&&this!==Jt&&this instanceof l&&(b=g||yr(b)),b.apply(j,y)}var s=128&n,h=1&n,p=2&n,_=24&n,v=512&n,g=p?T:yr(t);
    return l}function wr(t,n){return function(r,e){return xn(r,t,n(e))}}function mr(t){return function(n,r){var e;if(n===T&&r===T)return 0;if(n!==T&&(e=n),r!==T){if(e===T)return r;typeof n=="string"||typeof r=="string"?(n=Gn(n),r=Gn(r)):(n=Kn(n),r=Kn(r)),e=t(n,r)}return e}}function Ar(t){return Ie(function(n){return n=1==n.length&&ai(n[0])?l(n[0],O(Ur())):l(ln(n,1,Jr),O(Ur())),Ie(function(e){var u=this;return t(n,function(t){return r(t,u,e)})})})}function Or(t,n){n=n===T?" ":Gn(n);var r=n.length;return 2>r?r?$n(n,t):n:(r=$n(n,$u(t/N(n))),
    Wt.test(n)?rr(r.match(St),0,t).join(""):r.slice(0,t))}function kr(t,n,e,u){function o(){for(var n=-1,c=arguments.length,a=-1,l=u.length,s=Array(l+c),h=this&&this!==Jt&&this instanceof o?f:t;++a<l;)s[a]=u[a];for(;c--;)s[a++]=arguments[++n];return r(h,i?e:this,s)}var i=1&n,f=yr(t);return o}function Er(t){return function(n,r,e){e&&typeof e!="number"&&Hr(n,r,e)&&(r=e=T),n=Ye(n),n=n===n?n:0,r===T?(r=n,n=0):r=Ye(r)||0,e=e===T?r>n?1:-1:Ye(e)||0;var u=-1;r=Vu($u((r-n)/(e||1)),0);for(var o=Array(r);r--;)o[t?r:++u]=n,
    n+=e;return o}}function Ir(t){return function(n,r){return typeof n=="string"&&typeof r=="string"||(n=Ye(n),r=Ye(r)),t(n,r)}}function Sr(t,n,r,e,u,o,i,f,c,a){var l=8&n,s=l?i:T;i=l?T:i;var h=l?o:T;return o=l?T:o,n=(n|(l?32:64))&~(l?64:32),4&n||(n&=-4),n=[t,n,u,h,s,o,i,f,c,a],r=r.apply(T,n),Xr(t)&&ko(r,n),r.placeholder=e,r}function Rr(t){var n=vu[t];return function(t,r){if(t=Ye(t),r=Ge(r)){var e=(Qe(t)+"e").split("e"),e=n(e[0]+"e"+(+e[1]+r)),e=(Qe(e)+"e").split("e");return+(e[0]+"e"+(+e[1]-r))}return n(t);
}}function Wr(t){return function(n){var r=Pr(n);return"[object Map]"==r?U(n):"[object Set]"==r?$(n):A(n,t(n))}}function Br(t,n,r,e,u,o,i,f){var c=2&n;if(!c&&typeof t!="function")throw new du("Expected a function");var a=e?e.length:0;if(a||(n&=-97,e=u=T),i=i===T?i:Vu(Ge(i),0),f=f===T?f:Ge(f),a-=u?u.length:0,64&n){var l=e,s=u;e=u=T}var h=c?T:mo(t);return o=[t,n,r,e,u,l,s,o,i,f],h&&(r=o[1],t=h[1],n=r|t,e=128==t&&8==r||128==t&&256==r&&h[8]>=o[7].length||384==t&&h[8]>=h[7].length&&8==r,131>n||e)&&(1&t&&(o[2]=h[2],
    n|=1&r?0:4),(r=h[3])&&(e=o[3],o[3]=e?ir(e,r,h[4]):r,o[4]=e?D(o[3],"__lodash_placeholder__"):h[4]),(r=h[5])&&(e=o[5],o[5]=e?fr(e,r,h[6]):r,o[6]=e?D(o[5],"__lodash_placeholder__"):h[6]),(r=h[7])&&(o[7]=r),128&t&&(o[8]=null==o[8]?h[8]:Ku(o[8],h[8])),null==o[9]&&(o[9]=h[9]),o[0]=h[0],o[1]=n),t=o[0],n=o[1],r=o[2],e=o[3],u=o[4],f=o[9]=null==o[9]?c?0:t.length:Vu(o[9]-a,0),!f&&24&n&&(n&=-25),(h?jo:ko)(n&&1!=n?8==n||16==n?br(t,n,f):32!=n&&33!=n||u.length?jr.apply(T,o):kr(t,n,r,e):vr(t,n,r),o)}function Lr(t,n,r,e,u,o){
    var i=2&u,f=t.length,c=n.length;if(f!=c&&!(i&&c>f))return false;if(c=o.get(t))return c==n;var c=-1,a=true,l=1&u?new $t:T;for(o.set(t,n);++c<f;){var s=t[c],h=n[c];if(e)var p=i?e(h,s,c,n,t,o):e(s,h,c,t,n,o);if(p!==T){if(p)continue;a=false;break}if(l){if(!_(n,function(t,n){return l.has(n)||s!==t&&!r(s,t,e,u,o)?void 0:l.add(n)})){a=false;break}}else if(s!==h&&!r(s,h,e,u,o)){a=false;break}}return o["delete"](t),a}function Mr(t,n,r,e,u,o,i){switch(r){case"[object DataView]":if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)break;
    t=t.buffer,n=n.buffer;case"[object ArrayBuffer]":if(t.byteLength!=n.byteLength||!e(new Wu(t),new Wu(n)))break;return true;case"[object Boolean]":case"[object Date]":return+t==+n;case"[object Error]":return t.name==n.name&&t.message==n.message;case"[object Number]":return t!=+t?n!=+n:t==+n;case"[object RegExp]":case"[object String]":return t==n+"";case"[object Map]":var f=U;case"[object Set]":if(f||(f=F),t.size!=n.size&&!(2&o))break;return(r=i.get(t))?r==n:(o|=1,i.set(t,n),Lr(f(t),f(n),e,u,o,i));case"[object Symbol]":
    if(_o)return _o.call(t)==_o.call(n)}return false}function Cr(t){for(var n=t.name+"",r=fo[n],e=wu.call(fo,n)?r.length:0;e--;){var u=r[e],o=u.func;if(null==o||o==t)return u.name}return n}function zr(t){return(wu.call(At,"placeholder")?At:t).placeholder}function Ur(){var t=At.iteratee||au,t=t===au?An:t;return arguments.length?t(arguments[0],arguments[1]):t}function Dr(t,n){var r=t.__data__,e=typeof n;return("string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==n:null===n)?r[typeof n=="string"?"string":"hash"]:r.map;
}function Fr(t){t=Ei(t);for(var n=t.length;n--;){var r=t[n][1];t[n][2]=r===r&&!Ue(r)}return t}function $r(t,n){var r=t[n];return Fe(r)?r:T}function Nr(t){return Mu(Object(t))}function Pr(t){return Ou.call(t)}function Zr(t,n,r){n=Qr(n,t)?[n]:nr(n);for(var e,u=-1,o=n.length;++u<o;){var i=ue(n[u]);if(!(e=null!=t&&r(t,i)))break;t=t[i]}return e?e:(o=t?t.length:0,!!o&&ze(o)&&Yr(i,o)&&(ai(t)||Ze(t)||Re(t)))}function Tr(t){var n=t.length,r=t.constructor(n);return n&&"string"==typeof t[0]&&wu.call(t,"index")&&(r.index=t.index,
    r.input=t.input),r}function qr(t){return typeof t.constructor!="function"||te(t)?{}:en(Pu(Object(t)))}function Vr(r,e,u,o){var i=r.constructor;switch(e){case"[object ArrayBuffer]":return ur(r);case"[object Boolean]":case"[object Date]":return new i(+r);case"[object DataView]":return e=o?ur(r.buffer):r.buffer,new r.constructor(e,r.byteOffset,r.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":
    case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return e=o?ur(r.buffer):r.buffer,new r.constructor(e,r.byteOffset,r.length);case"[object Map]":return e=o?u(U(r),true):U(r),h(e,t,new r.constructor);case"[object Number]":case"[object String]":return new i(r);case"[object RegExp]":return e=new r.constructor(r.source,_t.exec(r)),e.lastIndex=r.lastIndex,e;case"[object Set]":return e=o?u(F(r),true):F(r),h(e,n,new r.constructor);case"[object Symbol]":return _o?Object(_o.call(r)):{};
}}function Kr(t){var n=t?t.length:T;return ze(n)&&(ai(t)||Ze(t)||Re(t))?m(n,String):null}function Gr(t){return ai(t)||Re(t)}function Jr(t){return ai(t)&&!(2==t.length&&!Me(t[0]))}function Yr(t,n){return n=null==n?9007199254740991:n,!!n&&(typeof t=="number"||xt.test(t))&&t>-1&&0==t%1&&n>t}function Hr(t,n,r){if(!Ue(r))return false;var e=typeof n;return("number"==e?We(r)&&Yr(n,r.length):"string"==e&&n in r)?Se(r[n],t):false}function Qr(t,n){if(ai(t))return false;var r=typeof t;return"number"==r||"symbol"==r||"boolean"==r||null==t||Te(t)?true:ut.test(t)||!et.test(t)||null!=n&&t in Object(n);
}function Xr(t){var n=Cr(t),r=At[n];return typeof r=="function"&&n in zt.prototype?t===r?true:(n=mo(r),!!n&&t===n[0]):false}function te(t){var n=t&&t.constructor;return t===(typeof n=="function"&&n.prototype||bu)}function ne(t,n){return function(r){return null==r?false:r[t]===n&&(n!==T||t in Object(r))}}function re(t,n,r,e,u,o){return Ue(t)&&Ue(n)&&Rn(t,n,T,re,o.set(n,t)),t}function ee(t,n){return 1==n.length?t:_n(t,Pn(n,0,-1))}function ue(t){if(typeof t=="string"||Te(t))return t;var n=t+"";return"0"==n&&1/t==-q?"-0":n;
}function oe(t){if(null!=t){try{return ju.call(t)}catch(n){}return t+""}return""}function ie(t){if(t instanceof zt)return t.clone();var n=new kt(t.__wrapped__,t.__chain__);return n.__actions__=cr(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function fe(t,n,r){var e=t?t.length:0;return e?(n=r||n===T?1:Ge(n),Pn(t,0>n?0:n,e)):[]}function ce(t,n,r){var e=t?t.length:0;return e?(n=r||n===T?1:Ge(n),n=e-n,Pn(t,0,0>n?0:n)):[]}function ae(t){return t&&t.length?t[0]:T}function le(t){var n=t?t.length:0;
    return n?t[n-1]:T}function se(t,n){return t&&t.length&&n&&n.length?Un(t,n):t}function he(t){return t?Hu.call(t):t}function pe(t){if(!t||!t.length)return[];var n=0;return t=f(t,function(t){return Be(t)?(n=Vu(t.length,n),true):void 0}),m(n,function(n){return l(t,Cn(n))})}function _e(t,n){if(!t||!t.length)return[];var e=pe(t);return null==n?e:l(e,function(t){return r(n,T,t)})}function ve(t){return t=At(t),t.__chain__=true,t}function ge(t,n){return n(t)}function de(){return this}function ye(t,n){return(ai(t)?u:go)(t,Ur(n,3));
}function be(t,n){return(ai(t)?o:yo)(t,Ur(n,3))}function xe(t,n){return(ai(t)?l:En)(t,Ur(n,3))}function je(t,n,r){var e=-1,u=Ve(t),o=u.length,i=o-1;for(n=(r?Hr(t,n,r):n===T)?1:tn(Ge(n),0,o);++e<n;)t=Fn(e,i),r=u[t],u[t]=u[e],u[e]=r;return u.length=n,u}function we(t,n,r){return n=r?T:n,n=t&&null==n?t.length:n,Br(t,128,T,T,T,T,n)}function me(t,n){var r;if(typeof n!="function")throw new du("Expected a function");return t=Ge(t),function(){return 0<--t&&(r=n.apply(this,arguments)),1>=t&&(n=T),r}}function Ae(t,n,r){
    return n=r?T:n,t=Br(t,8,T,T,T,T,T,n),t.placeholder=Ae.placeholder,t}function Oe(t,n,r){return n=r?T:n,t=Br(t,16,T,T,T,T,T,n),t.placeholder=Oe.placeholder,t}function ke(t,n,r){function e(n){var r=c,e=a;return c=a=T,_=n,s=t.apply(e,r)}function u(t){var r=t-p;return t-=_,!p||r>=n||0>r||g&&t>=l}function o(){var t=Qo();if(u(t))return i(t);var r;r=t-_,t=n-(t-p),r=g?Ku(t,l-r):t,h=Du(o,r)}function i(t){return Bu(h),h=T,d&&c?e(t):(c=a=T,s)}function f(){var t=Qo(),r=u(t);if(c=arguments,a=this,p=t,r){if(h===T)return _=t=p,
    h=Du(o,n),v?e(t):s;if(g)return Bu(h),h=Du(o,n),e(p)}return h===T&&(h=Du(o,n)),s}var c,a,l,s,h,p=0,_=0,v=false,g=false,d=true;if(typeof t!="function")throw new du("Expected a function");return n=Ye(n)||0,Ue(r)&&(v=!!r.leading,l=(g="maxWait"in r)?Vu(Ye(r.maxWait)||0,n):l,d="trailing"in r?!!r.trailing:d),f.cancel=function(){h!==T&&Bu(h),p=_=0,c=a=h=T},f.flush=function(){return h===T?s:i(Qo())},f}function Ee(t,n){function r(){var e=arguments,u=n?n.apply(this,e):e[0],o=r.cache;return o.has(u)?o.get(u):(e=t.apply(this,e),
    r.cache=o.set(u,e),e)}if(typeof t!="function"||n&&typeof n!="function")throw new du("Expected a function");return r.cache=new(Ee.Cache||Ft),r}function Ie(t,n){if(typeof t!="function")throw new du("Expected a function");return n=Vu(n===T?t.length-1:Ge(n),0),function(){for(var e=arguments,u=-1,o=Vu(e.length-n,0),i=Array(o);++u<o;)i[u]=e[n+u];switch(n){case 0:return t.call(this,i);case 1:return t.call(this,e[0],i);case 2:return t.call(this,e[0],e[1],i)}for(o=Array(n+1),u=-1;++u<n;)o[u]=e[u];return o[n]=i,
    r(t,this,o)}}function Se(t,n){return t===n||t!==t&&n!==n}function Re(t){return Be(t)&&wu.call(t,"callee")&&(!Uu.call(t,"callee")||"[object Arguments]"==Ou.call(t))}function We(t){return null!=t&&ze(Ao(t))&&!Me(t)}function Be(t){return De(t)&&We(t)}function Le(t){return De(t)?"[object Error]"==Ou.call(t)||typeof t.message=="string"&&typeof t.name=="string":false}function Me(t){return t=Ue(t)?Ou.call(t):"","[object Function]"==t||"[object GeneratorFunction]"==t}function Ce(t){return typeof t=="number"&&t==Ge(t);
}function ze(t){return typeof t=="number"&&t>-1&&0==t%1&&9007199254740991>=t}function Ue(t){var n=typeof t;return!!t&&("object"==n||"function"==n)}function De(t){return!!t&&typeof t=="object"}function Fe(t){return Ue(t)?(Me(t)||C(t)?Eu:yt).test(oe(t)):false}function $e(t){return typeof t=="number"||De(t)&&"[object Number]"==Ou.call(t)}function Ne(t){return!De(t)||"[object Object]"!=Ou.call(t)||C(t)?false:(t=Pu(Object(t)),null===t?true:(t=wu.call(t,"constructor")&&t.constructor,typeof t=="function"&&t instanceof t&&ju.call(t)==Au));
}function Pe(t){return Ue(t)&&"[object RegExp]"==Ou.call(t)}function Ze(t){return typeof t=="string"||!ai(t)&&De(t)&&"[object String]"==Ou.call(t)}function Te(t){return typeof t=="symbol"||De(t)&&"[object Symbol]"==Ou.call(t)}function qe(t){return De(t)&&ze(t.length)&&!!Mt[Ou.call(t)]}function Ve(t){if(!t)return[];if(We(t))return Ze(t)?t.match(St):cr(t);if(Cu&&t[Cu])return z(t[Cu]());var n=Pr(t);return("[object Map]"==n?U:"[object Set]"==n?F:eu)(t)}function Ke(t){return t?(t=Ye(t),t===q||t===-q?1.7976931348623157e308*(0>t?-1:1):t===t?t:0):0===t?t:0;
}function Ge(t){t=Ke(t);var n=t%1;return t===t?n?t-n:t:0}function Je(t){return t?tn(Ge(t),0,4294967295):0}function Ye(t){if(typeof t=="number")return t;if(Te(t))return V;if(Ue(t)&&(t=Me(t.valueOf)?t.valueOf():t,t=Ue(t)?t+"":t),typeof t!="string")return 0===t?t:+t;t=t.replace(ct,"");var n=dt.test(t);return n||bt.test(t)?Pt(t.slice(2),n?2:8):gt.test(t)?V:+t}function He(t){return ar(t,ru(t))}function Qe(t){return null==t?"":Gn(t)}function Xe(t,n,r){return t=null==t?T:_n(t,n),t===T?r:t}function tu(t,n){
    return null!=t&&Zr(t,n,yn)}function nu(t){var n=te(t);if(!n&&!We(t))return qu(Object(t));var r,e=Kr(t),u=!!e,e=e||[],o=e.length;for(r in t)!dn(t,r)||u&&("length"==r||Yr(r,o))||n&&"constructor"==r||e.push(r);return e}function ru(t){for(var n=-1,r=te(t),e=On(t),u=e.length,o=Kr(t),i=!!o,o=o||[],f=o.length;++n<u;){var c=e[n];i&&("length"==c||Yr(c,f))||"constructor"==c&&(r||!wu.call(t,c))||o.push(c)}return o}function eu(t){return t?k(t,nu(t)):[]}function uu(t){return zi(Qe(t).toLowerCase())}function ou(t){
    return(t=Qe(t))&&t.replace(jt,W).replace(It,"")}function iu(t,n,r){return t=Qe(t),n=r?T:n,n===T&&(n=Bt.test(t)?Rt:st),t.match(n)||[]}function fu(t){return function(){return t}}function cu(t){return t}function au(t){return An(typeof t=="function"?t:nn(t,true))}function lu(t,n,r){var e=nu(n),o=pn(n,e);null!=r||Ue(n)&&(o.length||!e.length)||(r=n,n=t,t=this,o=pn(n,nu(n)));var i=!(Ue(r)&&"chain"in r&&!r.chain),f=Me(t);return u(o,function(r){var e=n[r];t[r]=e,f&&(t.prototype[r]=function(){var n=this.__chain__;
    if(i||n){var r=t(this.__wrapped__);return(r.__actions__=cr(this.__actions__)).push({func:e,args:arguments,thisArg:t}),r.__chain__=n,r}return e.apply(t,s([this.value()],arguments))})}),t}function su(){}function hu(t){return Qr(t)?Cn(ue(t)):zn(t)}R=R?Yt.defaults({},R,Yt.pick(Jt,Lt)):Jt;var pu=R.Date,_u=R.Error,vu=R.Math,gu=R.RegExp,du=R.TypeError,yu=R.Array.prototype,bu=R.Object.prototype,xu=R.String.prototype,ju=R.Function.prototype.toString,wu=bu.hasOwnProperty,mu=0,Au=ju.call(Object),Ou=bu.toString,ku=Jt._,Eu=gu("^"+ju.call(wu).replace(it,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Iu=qt?R.Buffer:T,Su=R.Reflect,Ru=R.Symbol,Wu=R.Uint8Array,Bu=R.clearTimeout,Lu=Su?Su.f:T,Mu=Object.getOwnPropertySymbols,Cu=typeof(Cu=Ru&&Ru.iterator)=="symbol"?Cu:T,zu=Object.create,Uu=bu.propertyIsEnumerable,Du=R.setTimeout,Fu=yu.splice,$u=vu.ceil,Nu=vu.floor,Pu=Object.getPrototypeOf,Zu=R.isFinite,Tu=yu.join,qu=Object.keys,Vu=vu.max,Ku=vu.min,Gu=R.parseInt,Ju=vu.random,Yu=xu.replace,Hu=yu.reverse,Qu=xu.split,Xu=$r(R,"DataView"),to=$r(R,"Map"),no=$r(R,"Promise"),ro=$r(R,"Set"),eo=$r(R,"WeakMap"),uo=$r(Object,"create"),oo=eo&&new eo,io=!Uu.call({
    valueOf:1},"valueOf"),fo={},co=oe(Xu),ao=oe(to),lo=oe(no),so=oe(ro),ho=oe(eo),po=Ru?Ru.prototype:T,_o=po?po.valueOf:T,vo=po?po.toString:T;At.templateSettings={escape:tt,evaluate:nt,interpolate:rt,variable:"",imports:{_:At}},At.prototype=Ot.prototype,At.prototype.constructor=At,kt.prototype=en(Ot.prototype),kt.prototype.constructor=kt,zt.prototype=en(Ot.prototype),zt.prototype.constructor=zt,Ut.prototype.clear=function(){this.__data__=uo?uo(null):{}},Ut.prototype["delete"]=function(t){return this.has(t)&&delete this.__data__[t];
},Ut.prototype.get=function(t){var n=this.__data__;return uo?(t=n[t],"__lodash_hash_undefined__"===t?T:t):wu.call(n,t)?n[t]:T},Ut.prototype.has=function(t){var n=this.__data__;return uo?n[t]!==T:wu.call(n,t)},Ut.prototype.set=function(t,n){return this.__data__[t]=uo&&n===T?"__lodash_hash_undefined__":n,this},Dt.prototype.clear=function(){this.__data__=[]},Dt.prototype["delete"]=function(t){var n=this.__data__;return t=Gt(n,t),0>t?false:(t==n.length-1?n.pop():Fu.call(n,t,1),true)},Dt.prototype.get=function(t){
    var n=this.__data__;return t=Gt(n,t),0>t?T:n[t][1]},Dt.prototype.has=function(t){return-1<Gt(this.__data__,t)},Dt.prototype.set=function(t,n){var r=this.__data__,e=Gt(r,t);return 0>e?r.push([t,n]):r[e][1]=n,this},Ft.prototype.clear=function(){this.__data__={hash:new Ut,map:new(to||Dt),string:new Ut}},Ft.prototype["delete"]=function(t){return Dr(this,t)["delete"](t)},Ft.prototype.get=function(t){return Dr(this,t).get(t)},Ft.prototype.has=function(t){return Dr(this,t).has(t)},Ft.prototype.set=function(t,n){
    return Dr(this,t).set(t,n),this},$t.prototype.add=$t.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},$t.prototype.has=function(t){return this.__data__.has(t)},Zt.prototype.clear=function(){this.__data__=new Dt},Zt.prototype["delete"]=function(t){return this.__data__["delete"](t)},Zt.prototype.get=function(t){return this.__data__.get(t)},Zt.prototype.has=function(t){return this.__data__.has(t)},Zt.prototype.set=function(t,n){var r=this.__data__;return r instanceof Dt&&200==r.__data__.length&&(r=this.__data__=new Ft(r.__data__)),
    r.set(t,n),this};var go=pr(sn),yo=pr(hn,true),bo=_r(),xo=_r(true);Lu&&!Uu.call({valueOf:1},"valueOf")&&(On=function(t){return z(Lu(t))});var jo=oo?function(t,n){return oo.set(t,n),t}:cu,wo=ro&&1/F(new ro([,-0]))[1]==q?function(t){return new ro(t)}:su,mo=oo?function(t){return oo.get(t)}:su,Ao=Cn("length");Mu||(Nr=function(){return[]});var Oo=Mu?function(t){for(var n=[];t;)s(n,Nr(t)),t=Pu(Object(t));return n}:Nr;(Xu&&"[object DataView]"!=Pr(new Xu(new ArrayBuffer(1)))||to&&"[object Map]"!=Pr(new to)||no&&"[object Promise]"!=Pr(no.resolve())||ro&&"[object Set]"!=Pr(new ro)||eo&&"[object WeakMap]"!=Pr(new eo))&&(Pr=function(t){
    var n=Ou.call(t);if(t=(t="[object Object]"==n?t.constructor:T)?oe(t):T)switch(t){case co:return"[object DataView]";case ao:return"[object Map]";case lo:return"[object Promise]";case so:return"[object Set]";case ho:return"[object WeakMap]"}return n});var ko=function(){var t=0,n=0;return function(r,e){var u=Qo(),o=16-(u-n);if(n=u,o>0){if(150<=++t)return r}else t=0;return jo(r,e)}}(),Eo=Ee(function(t){var n=[];return Qe(t).replace(ot,function(t,r,e,u){n.push(e?u.replace(ht,"$1"):r||t)}),n}),Io=Ie(function(t,n){
    return Be(t)?on(t,ln(n,1,Be,true)):[]}),So=Ie(function(t,n){var r=le(n);return Be(r)&&(r=T),Be(t)?on(t,ln(n,1,Be,true),Ur(r)):[]}),Ro=Ie(function(t,n){var r=le(n);return Be(r)&&(r=T),Be(t)?on(t,ln(n,1,Be,true),T,r):[]}),Wo=Ie(function(t){var n=l(t,tr);return n.length&&n[0]===t[0]?bn(n):[]}),Bo=Ie(function(t){var n=le(t),r=l(t,tr);return n===le(r)?n=T:r.pop(),r.length&&r[0]===t[0]?bn(r,Ur(n)):[]}),Lo=Ie(function(t){var n=le(t),r=l(t,tr);return n===le(r)?n=T:r.pop(),r.length&&r[0]===t[0]?bn(r,T,n):[]}),Mo=Ie(se),Co=Ie(function(t,n){
    n=ln(n,1);var r=t?t.length:0,e=Xt(t,n);return Dn(t,l(n,function(t){return Yr(t,r)?+t:t}).sort(or)),e}),zo=Ie(function(t){return Jn(ln(t,1,Be,true))}),Uo=Ie(function(t){var n=le(t);return Be(n)&&(n=T),Jn(ln(t,1,Be,true),Ur(n))}),Do=Ie(function(t){var n=le(t);return Be(n)&&(n=T),Jn(ln(t,1,Be,true),T,n)}),Fo=Ie(function(t,n){return Be(t)?on(t,n):[]}),$o=Ie(function(t){return Qn(f(t,Be))}),No=Ie(function(t){var n=le(t);return Be(n)&&(n=T),Qn(f(t,Be),Ur(n))}),Po=Ie(function(t){var n=le(t);return Be(n)&&(n=T),
    Qn(f(t,Be),T,n)}),Zo=Ie(pe),To=Ie(function(t){var n=t.length,n=n>1?t[n-1]:T,n=typeof n=="function"?(t.pop(),n):T;return _e(t,n)}),qo=Ie(function(t){function n(n){return Xt(n,t)}t=ln(t,1);var r=t.length,e=r?t[0]:0,u=this.__wrapped__;return!(r>1||this.__actions__.length)&&u instanceof zt&&Yr(e)?(u=u.slice(e,+e+(r?1:0)),u.__actions__.push({func:ge,args:[n],thisArg:T}),new kt(u,this.__chain__).thru(function(t){return r&&!t.length&&t.push(T),t})):this.thru(n)}),Vo=sr(function(t,n,r){wu.call(t,r)?++t[r]:t[r]=1;
}),Ko=sr(function(t,n,r){wu.call(t,r)?t[r].push(n):t[r]=[n]}),Go=Ie(function(t,n,e){var u=-1,o=typeof n=="function",i=Qr(n),f=We(t)?Array(t.length):[];return go(t,function(t){var c=o?n:i&&null!=t?t[n]:T;f[++u]=c?r(c,t,e):jn(t,n,e)}),f}),Jo=sr(function(t,n,r){t[r]=n}),Yo=sr(function(t,n,r){t[r?0:1].push(n)},function(){return[[],[]]}),Ho=Ie(function(t,n){if(null==t)return[];var r=n.length;return r>1&&Hr(t,n[0],n[1])?n=[]:r>2&&Hr(n[0],n[1],n[2])&&(n=[n[0]]),n=1==n.length&&ai(n[0])?n[0]:ln(n,1,Jr),Bn(t,n,[]);
}),Qo=pu.now,Xo=Ie(function(t,n,r){var e=1;if(r.length)var u=D(r,zr(Xo)),e=32|e;return Br(t,e,n,r,u)}),ti=Ie(function(t,n,r){var e=3;if(r.length)var u=D(r,zr(ti)),e=32|e;return Br(n,e,t,r,u)}),ni=Ie(function(t,n){return un(t,1,n)}),ri=Ie(function(t,n,r){return un(t,Ye(n)||0,r)});Ee.Cache=Ft;var ei=Ie(function(t,n){n=1==n.length&&ai(n[0])?l(n[0],O(Ur())):l(ln(n,1,Jr),O(Ur()));var e=n.length;return Ie(function(u){for(var o=-1,i=Ku(u.length,e);++o<i;)u[o]=n[o].call(this,u[o]);return r(t,this,u)})}),ui=Ie(function(t,n){
    var r=D(n,zr(ui));return Br(t,32,T,n,r)}),oi=Ie(function(t,n){var r=D(n,zr(oi));return Br(t,64,T,n,r)}),ii=Ie(function(t,n){return Br(t,256,T,T,T,ln(n,1))}),fi=Ir(gn),ci=Ir(function(t,n){return t>=n}),ai=Array.isArray,li=Iu?function(t){return t instanceof Iu}:fu(false),si=Ir(kn),hi=Ir(function(t,n){return n>=t}),pi=hr(function(t,n){if(io||te(n)||We(n))ar(n,nu(n),t);else for(var r in n)wu.call(n,r)&&Kt(t,r,n[r])}),_i=hr(function(t,n){if(io||te(n)||We(n))ar(n,ru(n),t);else for(var r in n)Kt(t,r,n[r])}),vi=hr(function(t,n,r,e){
    ar(n,ru(n),t,e)}),gi=hr(function(t,n,r,e){ar(n,nu(n),t,e)}),di=Ie(function(t,n){return Xt(t,ln(n,1))}),yi=Ie(function(t){return t.push(T,Tt),r(vi,T,t)}),bi=Ie(function(t){return t.push(T,re),r(Ai,T,t)}),xi=wr(function(t,n,r){t[n]=r},fu(cu)),ji=wr(function(t,n,r){wu.call(t,n)?t[n].push(r):t[n]=[r]},Ur),wi=Ie(jn),mi=hr(function(t,n,r){Rn(t,n,r)}),Ai=hr(function(t,n,r,e){Rn(t,n,r,e)}),Oi=Ie(function(t,n){return null==t?{}:(n=l(ln(n,1),ue),Ln(t,on(vn(t,ru,Oo),n)))}),ki=Ie(function(t,n){return null==t?{}:Ln(t,l(ln(n,1),ue));
}),Ei=Wr(nu),Ii=Wr(ru),Si=dr(function(t,n,r){return n=n.toLowerCase(),t+(r?uu(n):n)}),Ri=dr(function(t,n,r){return t+(r?"-":"")+n.toLowerCase()}),Wi=dr(function(t,n,r){return t+(r?" ":"")+n.toLowerCase()}),Bi=gr("toLowerCase"),Li=dr(function(t,n,r){return t+(r?"_":"")+n.toLowerCase()}),Mi=dr(function(t,n,r){return t+(r?" ":"")+zi(n)}),Ci=dr(function(t,n,r){return t+(r?" ":"")+n.toUpperCase()}),zi=gr("toUpperCase"),Ui=Ie(function(t,n){try{return r(t,T,n)}catch(e){return Le(e)?e:new _u(e)}}),Di=Ie(function(t,n){
    return u(ln(n,1),function(n){n=ue(n),t[n]=Xo(t[n],t)}),t}),Fi=xr(),$i=xr(true),Ni=Ie(function(t,n){return function(r){return jn(r,t,n)}}),Pi=Ie(function(t,n){return function(r){return jn(t,r,n)}}),Zi=Ar(l),Ti=Ar(i),qi=Ar(_),Vi=Er(),Ki=Er(true),Gi=mr(function(t,n){return t+n}),Ji=Rr("ceil"),Yi=mr(function(t,n){return t/n}),Hi=Rr("floor"),Qi=mr(function(t,n){return t*n}),Xi=Rr("round"),tf=mr(function(t,n){return t-n});return At.after=function(t,n){if(typeof n!="function")throw new du("Expected a function");
    return t=Ge(t),function(){return 1>--t?n.apply(this,arguments):void 0}},At.ary=we,At.assign=pi,At.assignIn=_i,At.assignInWith=vi,At.assignWith=gi,At.at=di,At.before=me,At.bind=Xo,At.bindAll=Di,At.bindKey=ti,At.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return ai(t)?t:[t]},At.chain=ve,At.chunk=function(t,n,r){if(n=(r?Hr(t,n,r):n===T)?1:Vu(Ge(n),0),r=t?t.length:0,!r||1>n)return[];for(var e=0,u=0,o=Array($u(r/n));r>e;)o[u++]=Pn(t,e,e+=n);return o},At.compact=function(t){for(var n=-1,r=t?t.length:0,e=0,u=[];++n<r;){
    var o=t[n];o&&(u[e++]=o)}return u},At.concat=function(){for(var t=arguments.length,n=Array(t?t-1:0),r=arguments[0],e=t;e--;)n[e-1]=arguments[e];return t?s(ai(r)?cr(r):[r],ln(n,1)):[]},At.cond=function(t){var n=t?t.length:0,e=Ur();return t=n?l(t,function(t){if("function"!=typeof t[1])throw new du("Expected a function");return[e(t[0]),t[1]]}):[],Ie(function(e){for(var u=-1;++u<n;){var o=t[u];if(r(o[0],this,e))return r(o[1],this,e)}})},At.conforms=function(t){return rn(nn(t,true))},At.constant=fu,At.countBy=Vo,
    At.create=function(t,n){var r=en(t);return n?Qt(r,n):r},At.curry=Ae,At.curryRight=Oe,At.debounce=ke,At.defaults=yi,At.defaultsDeep=bi,At.defer=ni,At.delay=ri,At.difference=Io,At.differenceBy=So,At.differenceWith=Ro,At.drop=fe,At.dropRight=ce,At.dropRightWhile=function(t,n){return t&&t.length?Yn(t,Ur(n,3),true,true):[]},At.dropWhile=function(t,n){return t&&t.length?Yn(t,Ur(n,3),true):[]},At.fill=function(t,n,r,e){var u=t?t.length:0;if(!u)return[];for(r&&typeof r!="number"&&Hr(t,n,r)&&(r=0,e=u),u=t.length,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              r=Ge(r),0>r&&(r=-r>u?0:u+r),e=e===T||e>u?u:Ge(e),0>e&&(e+=u),e=r>e?0:Je(e);e>r;)t[r++]=n;return t},At.filter=function(t,n){return(ai(t)?f:an)(t,Ur(n,3))},At.flatMap=function(t,n){return ln(xe(t,n),1)},At.flatMapDeep=function(t,n){return ln(xe(t,n),q)},At.flatMapDepth=function(t,n,r){return r=r===T?1:Ge(r),ln(xe(t,n),r)},At.flatten=function(t){return t&&t.length?ln(t,1):[]},At.flattenDeep=function(t){return t&&t.length?ln(t,q):[]},At.flattenDepth=function(t,n){return t&&t.length?(n=n===T?1:Ge(n),ln(t,n)):[];
},At.flip=function(t){return Br(t,512)},At.flow=Fi,At.flowRight=$i,At.fromPairs=function(t){for(var n=-1,r=t?t.length:0,e={};++n<r;){var u=t[n];e[u[0]]=u[1]}return e},At.functions=function(t){return null==t?[]:pn(t,nu(t))},At.functionsIn=function(t){return null==t?[]:pn(t,ru(t))},At.groupBy=Ko,At.initial=function(t){return ce(t,1)},At.intersection=Wo,At.intersectionBy=Bo,At.intersectionWith=Lo,At.invert=xi,At.invertBy=ji,At.invokeMap=Go,At.iteratee=au,At.keyBy=Jo,At.keys=nu,At.keysIn=ru,At.map=xe,
    At.mapKeys=function(t,n){var r={};return n=Ur(n,3),sn(t,function(t,e,u){r[n(t,e,u)]=t}),r},At.mapValues=function(t,n){var r={};return n=Ur(n,3),sn(t,function(t,e,u){r[e]=n(t,e,u)}),r},At.matches=function(t){return In(nn(t,true))},At.matchesProperty=function(t,n){return Sn(t,nn(n,true))},At.memoize=Ee,At.merge=mi,At.mergeWith=Ai,At.method=Ni,At.methodOf=Pi,At.mixin=lu,At.negate=function(t){if(typeof t!="function")throw new du("Expected a function");return function(){return!t.apply(this,arguments)}},At.nthArg=function(t){
    return t=Ge(t),Ie(function(n){return Wn(n,t)})},At.omit=Oi,At.omitBy=function(t,n){return n=Ur(n),Mn(t,function(t,r){return!n(t,r)})},At.once=function(t){return me(2,t)},At.orderBy=function(t,n,r,e){return null==t?[]:(ai(n)||(n=null==n?[]:[n]),r=e?T:r,ai(r)||(r=null==r?[]:[r]),Bn(t,n,r))},At.over=Zi,At.overArgs=ei,At.overEvery=Ti,At.overSome=qi,At.partial=ui,At.partialRight=oi,At.partition=Yo,At.pick=ki,At.pickBy=function(t,n){return null==t?{}:Mn(t,Ur(n))},At.property=hu,At.propertyOf=function(t){
    return function(n){return null==t?T:_n(t,n)}},At.pull=Mo,At.pullAll=se,At.pullAllBy=function(t,n,r){return t&&t.length&&n&&n.length?Un(t,n,Ur(r)):t},At.pullAllWith=function(t,n,r){return t&&t.length&&n&&n.length?Un(t,n,T,r):t},At.pullAt=Co,At.range=Vi,At.rangeRight=Ki,At.rearg=ii,At.reject=function(t,n){var r=ai(t)?f:an;return n=Ur(n,3),r(t,function(t,r,e){return!n(t,r,e)})},At.remove=function(t,n){var r=[];if(!t||!t.length)return r;var e=-1,u=[],o=t.length;for(n=Ur(n,3);++e<o;){var i=t[e];n(i,e,t)&&(r.push(i),
    u.push(e))}return Dn(t,u),r},At.rest=Ie,At.reverse=he,At.sampleSize=je,At.set=function(t,n,r){return null==t?t:Nn(t,n,r)},At.setWith=function(t,n,r,e){return e=typeof e=="function"?e:T,null==t?t:Nn(t,n,r,e)},At.shuffle=function(t){return je(t,4294967295)},At.slice=function(t,n,r){var e=t?t.length:0;return e?(r&&typeof r!="number"&&Hr(t,n,r)?(n=0,r=e):(n=null==n?0:Ge(n),r=r===T?e:Ge(r)),Pn(t,n,r)):[]},At.sortBy=Ho,At.sortedUniq=function(t){return t&&t.length?Vn(t):[]},At.sortedUniqBy=function(t,n){
    return t&&t.length?Vn(t,Ur(n)):[]},At.split=function(t,n,r){return r&&typeof r!="number"&&Hr(t,n,r)&&(n=r=T),r=r===T?4294967295:r>>>0,r?(t=Qe(t))&&(typeof n=="string"||null!=n&&!Pe(n))&&(n=Gn(n),""==n&&Wt.test(t))?rr(t.match(St),0,r):Qu.call(t,n,r):[]},At.spread=function(t,n){if(typeof t!="function")throw new du("Expected a function");return n=n===T?0:Vu(Ge(n),0),Ie(function(e){var u=e[n];return e=rr(e,0,n),u&&s(e,u),r(t,this,e)})},At.tail=function(t){return fe(t,1)},At.take=function(t,n,r){return t&&t.length?(n=r||n===T?1:Ge(n),
    Pn(t,0,0>n?0:n)):[]},At.takeRight=function(t,n,r){var e=t?t.length:0;return e?(n=r||n===T?1:Ge(n),n=e-n,Pn(t,0>n?0:n,e)):[]},At.takeRightWhile=function(t,n){return t&&t.length?Yn(t,Ur(n,3),false,true):[]},At.takeWhile=function(t,n){return t&&t.length?Yn(t,Ur(n,3)):[]},At.tap=function(t,n){return n(t),t},At.throttle=function(t,n,r){var e=true,u=true;if(typeof t!="function")throw new du("Expected a function");return Ue(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),ke(t,n,{leading:e,maxWait:n,
    trailing:u})},At.thru=ge,At.toArray=Ve,At.toPairs=Ei,At.toPairsIn=Ii,At.toPath=function(t){return ai(t)?l(t,ue):Te(t)?[t]:cr(Eo(t))},At.toPlainObject=He,At.transform=function(t,n,r){var e=ai(t)||qe(t);if(n=Ur(n,4),null==r)if(e||Ue(t)){var o=t.constructor;r=e?ai(t)?new o:[]:Me(o)?en(Pu(Object(t))):{}}else r={};return(e?u:sn)(t,function(t,e,u){return n(r,t,e,u)}),r},At.unary=function(t){return we(t,1)},At.union=zo,At.unionBy=Uo,At.unionWith=Do,At.uniq=function(t){return t&&t.length?Jn(t):[]},At.uniqBy=function(t,n){
    return t&&t.length?Jn(t,Ur(n)):[]},At.uniqWith=function(t,n){return t&&t.length?Jn(t,T,n):[]},At.unset=function(t,n){var r;if(null==t)r=true;else{r=t;var e=n,e=Qr(e,r)?[e]:nr(e);r=ee(r,e),e=ue(le(e)),r=!(null!=r&&dn(r,e))||delete r[e]}return r},At.unzip=pe,At.unzipWith=_e,At.update=function(t,n,r){return null==t?t:Nn(t,n,(typeof r=="function"?r:cu)(_n(t,n)),void 0)},At.updateWith=function(t,n,r,e){return e=typeof e=="function"?e:T,null!=t&&(t=Nn(t,n,(typeof r=="function"?r:cu)(_n(t,n)),e)),t},At.values=eu,
    At.valuesIn=function(t){return null==t?[]:k(t,ru(t))},At.without=Fo,At.words=iu,At.wrap=function(t,n){return n=null==n?cu:n,ui(n,t)},At.xor=$o,At.xorBy=No,At.xorWith=Po,At.zip=Zo,At.zipObject=function(t,n){return Xn(t||[],n||[],Kt)},At.zipObjectDeep=function(t,n){return Xn(t||[],n||[],Nn)},At.zipWith=To,At.entries=Ei,At.entriesIn=Ii,At.extend=_i,At.extendWith=vi,lu(At,At),At.add=Gi,At.attempt=Ui,At.camelCase=Si,At.capitalize=uu,At.ceil=Ji,At.clamp=function(t,n,r){return r===T&&(r=n,n=T),r!==T&&(r=Ye(r),
        r=r===r?r:0),n!==T&&(n=Ye(n),n=n===n?n:0),tn(Ye(t),n,r)},At.clone=function(t){return nn(t,false,true)},At.cloneDeep=function(t){return nn(t,true,true)},At.cloneDeepWith=function(t,n){return nn(t,true,true,n)},At.cloneWith=function(t,n){return nn(t,false,true,n)},At.deburr=ou,At.divide=Yi,At.endsWith=function(t,n,r){t=Qe(t),n=Gn(n);var e=t.length;return r=r===T?e:tn(Ge(r),0,e),r-=n.length,r>=0&&t.indexOf(n,r)==r},At.eq=Se,At.escape=function(t){return(t=Qe(t))&&X.test(t)?t.replace(H,B):t},At.escapeRegExp=function(t){
        return(t=Qe(t))&&ft.test(t)?t.replace(it,"\\$&"):t},At.every=function(t,n,r){var e=ai(t)?i:fn;return r&&Hr(t,n,r)&&(n=T),e(t,Ur(n,3))},At.find=function(t,n){if(n=Ur(n,3),ai(t)){var r=g(t,n);return r>-1?t[r]:T}return v(t,n,go)},At.findIndex=function(t,n){return t&&t.length?g(t,Ur(n,3)):-1},At.findKey=function(t,n){return v(t,Ur(n,3),sn,true)},At.findLast=function(t,n){if(n=Ur(n,3),ai(t)){var r=g(t,n,true);return r>-1?t[r]:T}return v(t,n,yo)},At.findLastIndex=function(t,n){return t&&t.length?g(t,Ur(n,3),true):-1;
    },At.findLastKey=function(t,n){return v(t,Ur(n,3),hn,true)},At.floor=Hi,At.forEach=ye,At.forEachRight=be,At.forIn=function(t,n){return null==t?t:bo(t,Ur(n,3),ru)},At.forInRight=function(t,n){return null==t?t:xo(t,Ur(n,3),ru)},At.forOwn=function(t,n){return t&&sn(t,Ur(n,3))},At.forOwnRight=function(t,n){return t&&hn(t,Ur(n,3))},At.get=Xe,At.gt=fi,At.gte=ci,At.has=function(t,n){return null!=t&&Zr(t,n,dn)},At.hasIn=tu,At.head=ae,At.identity=cu,At.includes=function(t,n,r,e){return t=We(t)?t:eu(t),r=r&&!e?Ge(r):0,
        e=t.length,0>r&&(r=Vu(e+r,0)),Ze(t)?e>=r&&-1<t.indexOf(n,r):!!e&&-1<d(t,n,r)},At.indexOf=function(t,n,r){var e=t?t.length:0;return e?(r=Ge(r),0>r&&(r=Vu(e+r,0)),d(t,n,r)):-1},At.inRange=function(t,n,r){return n=Ye(n)||0,r===T?(r=n,n=0):r=Ye(r)||0,t=Ye(t),t>=Ku(n,r)&&t<Vu(n,r)},At.invoke=wi,At.isArguments=Re,At.isArray=ai,At.isArrayBuffer=function(t){return De(t)&&"[object ArrayBuffer]"==Ou.call(t)},At.isArrayLike=We,At.isArrayLikeObject=Be,At.isBoolean=function(t){return true===t||false===t||De(t)&&"[object Boolean]"==Ou.call(t);
    },At.isBuffer=li,At.isDate=function(t){return De(t)&&"[object Date]"==Ou.call(t)},At.isElement=function(t){return!!t&&1===t.nodeType&&De(t)&&!Ne(t)},At.isEmpty=function(t){if(We(t)&&(ai(t)||Ze(t)||Me(t.splice)||Re(t)||li(t)))return!t.length;if(De(t)){var n=Pr(t);if("[object Map]"==n||"[object Set]"==n)return!t.size}for(var r in t)if(wu.call(t,r))return false;return!(io&&nu(t).length)},At.isEqual=function(t,n){return wn(t,n)},At.isEqualWith=function(t,n,r){var e=(r=typeof r=="function"?r:T)?r(t,n):T;return e===T?wn(t,n,r):!!e;
    },At.isError=Le,At.isFinite=function(t){return typeof t=="number"&&Zu(t)},At.isFunction=Me,At.isInteger=Ce,At.isLength=ze,At.isMap=function(t){return De(t)&&"[object Map]"==Pr(t)},At.isMatch=function(t,n){return t===n||mn(t,n,Fr(n))},At.isMatchWith=function(t,n,r){return r=typeof r=="function"?r:T,mn(t,n,Fr(n),r)},At.isNaN=function(t){return $e(t)&&t!=+t},At.isNative=Fe,At.isNil=function(t){return null==t},At.isNull=function(t){return null===t},At.isNumber=$e,At.isObject=Ue,At.isObjectLike=De,At.isPlainObject=Ne,
    At.isRegExp=Pe,At.isSafeInteger=function(t){return Ce(t)&&t>=-9007199254740991&&9007199254740991>=t},At.isSet=function(t){return De(t)&&"[object Set]"==Pr(t)},At.isString=Ze,At.isSymbol=Te,At.isTypedArray=qe,At.isUndefined=function(t){return t===T},At.isWeakMap=function(t){return De(t)&&"[object WeakMap]"==Pr(t)},At.isWeakSet=function(t){return De(t)&&"[object WeakSet]"==Ou.call(t)},At.join=function(t,n){return t?Tu.call(t,n):""},At.kebabCase=Ri,At.last=le,At.lastIndexOf=function(t,n,r){var e=t?t.length:0;
        if(!e)return-1;var u=e;if(r!==T&&(u=Ge(r),u=(0>u?Vu(e+u,0):Ku(u,e-1))+1),n!==n)return M(t,u,true);for(;u--;)if(t[u]===n)return u;return-1},At.lowerCase=Wi,At.lowerFirst=Bi,At.lt=si,At.lte=hi,At.max=function(t){return t&&t.length?cn(t,cu,gn):T},At.maxBy=function(t,n){return t&&t.length?cn(t,Ur(n),gn):T},At.mean=function(t){return b(t,cu)},At.meanBy=function(t,n){return b(t,Ur(n))},At.min=function(t){return t&&t.length?cn(t,cu,kn):T},At.minBy=function(t,n){return t&&t.length?cn(t,Ur(n),kn):T},At.multiply=Qi,
    At.nth=function(t,n){return t&&t.length?Wn(t,Ge(n)):T},At.noConflict=function(){return Jt._===this&&(Jt._=ku),this},At.noop=su,At.now=Qo,At.pad=function(t,n,r){t=Qe(t);var e=(n=Ge(n))?N(t):0;return!n||e>=n?t:(n=(n-e)/2,Or(Nu(n),r)+t+Or($u(n),r))},At.padEnd=function(t,n,r){t=Qe(t);var e=(n=Ge(n))?N(t):0;return n&&n>e?t+Or(n-e,r):t},At.padStart=function(t,n,r){t=Qe(t);var e=(n=Ge(n))?N(t):0;return n&&n>e?Or(n-e,r)+t:t},At.parseInt=function(t,n,r){return r||null==n?n=0:n&&(n=+n),t=Qe(t).replace(ct,""),
        Gu(t,n||(vt.test(t)?16:10))},At.random=function(t,n,r){if(r&&typeof r!="boolean"&&Hr(t,n,r)&&(n=r=T),r===T&&(typeof n=="boolean"?(r=n,n=T):typeof t=="boolean"&&(r=t,t=T)),t===T&&n===T?(t=0,n=1):(t=Ye(t)||0,n===T?(n=t,t=0):n=Ye(n)||0),t>n){var e=t;t=n,n=e}return r||t%1||n%1?(r=Ju(),Ku(t+r*(n-t+Nt("1e-"+((r+"").length-1))),n)):Fn(t,n)},At.reduce=function(t,n,r){var e=ai(t)?h:x,u=3>arguments.length;return e(t,Ur(n,4),r,u,go)},At.reduceRight=function(t,n,r){var e=ai(t)?p:x,u=3>arguments.length;return e(t,Ur(n,4),r,u,yo);
    },At.repeat=function(t,n,r){return n=(r?Hr(t,n,r):n===T)?1:Ge(n),$n(Qe(t),n)},At.replace=function(){var t=arguments,n=Qe(t[0]);return 3>t.length?n:Yu.call(n,t[1],t[2])},At.result=function(t,n,r){n=Qr(n,t)?[n]:nr(n);var e=-1,u=n.length;for(u||(t=T,u=1);++e<u;){var o=null==t?T:t[ue(n[e])];o===T&&(e=u,o=r),t=Me(o)?o.call(t):o}return t},At.round=Xi,At.runInContext=Z,At.sample=function(t){t=We(t)?t:eu(t);var n=t.length;return n>0?t[Fn(0,n-1)]:T},At.size=function(t){if(null==t)return 0;if(We(t)){var n=t.length;
        return n&&Ze(t)?N(t):n}return De(t)&&(n=Pr(t),"[object Map]"==n||"[object Set]"==n)?t.size:nu(t).length},At.snakeCase=Li,At.some=function(t,n,r){var e=ai(t)?_:Zn;return r&&Hr(t,n,r)&&(n=T),e(t,Ur(n,3))},At.sortedIndex=function(t,n){return Tn(t,n)},At.sortedIndexBy=function(t,n,r){return qn(t,n,Ur(r))},At.sortedIndexOf=function(t,n){var r=t?t.length:0;if(r){var e=Tn(t,n);if(r>e&&Se(t[e],n))return e}return-1},At.sortedLastIndex=function(t,n){return Tn(t,n,true)},At.sortedLastIndexBy=function(t,n,r){return qn(t,n,Ur(r),true);
    },At.sortedLastIndexOf=function(t,n){if(t&&t.length){var r=Tn(t,n,true)-1;if(Se(t[r],n))return r}return-1},At.startCase=Mi,At.startsWith=function(t,n,r){return t=Qe(t),r=tn(Ge(r),0,t.length),t.lastIndexOf(Gn(n),r)==r},At.subtract=tf,At.sum=function(t){return t&&t.length?w(t,cu):0},At.sumBy=function(t,n){return t&&t.length?w(t,Ur(n)):0},At.template=function(t,n,r){var e=At.templateSettings;r&&Hr(t,n,r)&&(n=T),t=Qe(t),n=vi({},n,e,Tt),r=vi({},n.imports,e.imports,Tt);var u,o,i=nu(r),f=k(r,i),c=0;r=n.interpolate||wt;
        var a="__p+='";r=gu((n.escape||wt).source+"|"+r.source+"|"+(r===rt?pt:wt).source+"|"+(n.evaluate||wt).source+"|$","g");var l="sourceURL"in n?"//# sourceURL="+n.sourceURL+"\n":"";if(t.replace(r,function(n,r,e,i,f,l){return e||(e=i),a+=t.slice(c,l).replace(mt,L),r&&(u=true,a+="'+__e("+r+")+'"),f&&(o=true,a+="';"+f+";\n__p+='"),e&&(a+="'+((__t=("+e+"))==null?'':__t)+'"),c=l+n.length,n}),a+="';",(n=n.variable)||(a="with(obj){"+a+"}"),a=(o?a.replace(K,""):a).replace(G,"$1").replace(J,"$1;"),a="function("+(n||"obj")+"){"+(n?"":"obj||(obj={});")+"var __t,__p=''"+(u?",__e=_.escape":"")+(o?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+a+"return __p}",
                n=Ui(function(){return Function(i,l+"return "+a).apply(T,f)}),n.source=a,Le(n))throw n;return n},At.times=function(t,n){if(t=Ge(t),1>t||t>9007199254740991)return[];var r=4294967295,e=Ku(t,4294967295);for(n=Ur(n),t-=4294967295,e=m(e,n);++r<t;)n(r);return e},At.toFinite=Ke,At.toInteger=Ge,At.toLength=Je,At.toLower=function(t){return Qe(t).toLowerCase()},At.toNumber=Ye,At.toSafeInteger=function(t){return tn(Ge(t),-9007199254740991,9007199254740991)},At.toString=Qe,At.toUpper=function(t){return Qe(t).toUpperCase();
    },At.trim=function(t,n,r){return(t=Qe(t))&&(r||n===T)?t.replace(ct,""):t&&(n=Gn(n))?(t=t.match(St),n=n.match(St),rr(t,I(t,n),S(t,n)+1).join("")):t},At.trimEnd=function(t,n,r){return(t=Qe(t))&&(r||n===T)?t.replace(lt,""):t&&(n=Gn(n))?(t=t.match(St),n=S(t,n.match(St))+1,rr(t,0,n).join("")):t},At.trimStart=function(t,n,r){return(t=Qe(t))&&(r||n===T)?t.replace(at,""):t&&(n=Gn(n))?(t=t.match(St),n=I(t,n.match(St)),rr(t,n).join("")):t},At.truncate=function(t,n){var r=30,e="...";if(Ue(n))var u="separator"in n?n.separator:u,r="length"in n?Ge(n.length):r,e="omission"in n?Gn(n.omission):e;
        t=Qe(t);var o=t.length;if(Wt.test(t))var i=t.match(St),o=i.length;if(r>=o)return t;if(o=r-N(e),1>o)return e;if(r=i?rr(i,0,o).join(""):t.slice(0,o),u===T)return r+e;if(i&&(o+=r.length-o),Pe(u)){if(t.slice(o).search(u)){var f=r;for(u.global||(u=gu(u.source,Qe(_t.exec(u))+"g")),u.lastIndex=0;i=u.exec(f);)var c=i.index;r=r.slice(0,c===T?o:c)}}else t.indexOf(Gn(u),o)!=o&&(u=r.lastIndexOf(u),u>-1&&(r=r.slice(0,u)));return r+e},At.unescape=function(t){return(t=Qe(t))&&Q.test(t)?t.replace(Y,P):t},At.uniqueId=function(t){
        var n=++mu;return Qe(t)+n},At.upperCase=Ci,At.upperFirst=zi,At.each=ye,At.eachRight=be,At.first=ae,lu(At,function(){var t={};return sn(At,function(n,r){wu.call(At.prototype,r)||(t[r]=n)}),t}(),{chain:false}),At.VERSION="4.12.0",u("bind bindKey curry curryRight partial partialRight".split(" "),function(t){At[t].placeholder=At}),u(["drop","take"],function(t,n){zt.prototype[t]=function(r){var e=this.__filtered__;if(e&&!n)return new zt(this);r=r===T?1:Vu(Ge(r),0);var u=this.clone();return e?u.__takeCount__=Ku(r,u.__takeCount__):u.__views__.push({
        size:Ku(r,4294967295),type:t+(0>u.__dir__?"Right":"")}),u},zt.prototype[t+"Right"]=function(n){return this.reverse()[t](n).reverse()}}),u(["filter","map","takeWhile"],function(t,n){var r=n+1,e=1==r||3==r;zt.prototype[t]=function(t){var n=this.clone();return n.__iteratees__.push({iteratee:Ur(t,3),type:r}),n.__filtered__=n.__filtered__||e,n}}),u(["head","last"],function(t,n){var r="take"+(n?"Right":"");zt.prototype[t]=function(){return this[r](1).value()[0]}}),u(["initial","tail"],function(t,n){var r="drop"+(n?"":"Right");
        zt.prototype[t]=function(){return this.__filtered__?new zt(this):this[r](1)}}),zt.prototype.compact=function(){return this.filter(cu)},zt.prototype.find=function(t){return this.filter(t).head()},zt.prototype.findLast=function(t){return this.reverse().find(t)},zt.prototype.invokeMap=Ie(function(t,n){return typeof t=="function"?new zt(this):this.map(function(r){return jn(r,t,n)})}),zt.prototype.reject=function(t){return t=Ur(t,3),this.filter(function(n){return!t(n)})},zt.prototype.slice=function(t,n){
        t=Ge(t);var r=this;return r.__filtered__&&(t>0||0>n)?new zt(r):(0>t?r=r.takeRight(-t):t&&(r=r.drop(t)),n!==T&&(n=Ge(n),r=0>n?r.dropRight(-n):r.take(n-t)),r)},zt.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},zt.prototype.toArray=function(){return this.take(4294967295)},sn(zt.prototype,function(t,n){var r=/^(?:filter|find|map|reject)|While$/.test(n),e=/^(?:head|last)$/.test(n),u=At[e?"take"+("last"==n?"Right":""):n],o=e||/^find/.test(n);u&&(At.prototype[n]=function(){
        function n(t){return t=u.apply(At,s([t],f)),e&&h?t[0]:t}var i=this.__wrapped__,f=e?[1]:arguments,c=i instanceof zt,a=f[0],l=c||ai(i);l&&r&&typeof a=="function"&&1!=a.length&&(c=l=false);var h=this.__chain__,p=!!this.__actions__.length,a=o&&!h,c=c&&!p;return!o&&l?(i=c?i:new zt(this),i=t.apply(i,f),i.__actions__.push({func:ge,args:[n],thisArg:T}),new kt(i,h)):a&&c?t.apply(this,f):(i=this.thru(n),a?e?i.value()[0]:i.value():i)})}),u("pop push shift sort splice unshift".split(" "),function(t){var n=yu[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",e=/^(?:pop|shift)$/.test(t);
        At.prototype[t]=function(){var t=arguments;if(e&&!this.__chain__){var u=this.value();return n.apply(ai(u)?u:[],t)}return this[r](function(r){return n.apply(ai(r)?r:[],t)})}}),sn(zt.prototype,function(t,n){var r=At[n];if(r){var e=r.name+"";(fo[e]||(fo[e]=[])).push({name:n,func:r})}}),fo[jr(T,2).name]=[{name:"wrapper",func:T}],zt.prototype.clone=function(){var t=new zt(this.__wrapped__);return t.__actions__=cr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=cr(this.__iteratees__),
        t.__takeCount__=this.__takeCount__,t.__views__=cr(this.__views__),t},zt.prototype.reverse=function(){if(this.__filtered__){var t=new zt(this);t.__dir__=-1,t.__filtered__=true}else t=this.clone(),t.__dir__*=-1;return t},zt.prototype.value=function(){var t,n=this.__wrapped__.value(),r=this.__dir__,e=ai(n),u=0>r,o=e?n.length:0;t=o;for(var i=this.__views__,f=0,c=-1,a=i.length;++c<a;){var l=i[c],s=l.size;switch(l.type){case"drop":f+=s;break;case"dropRight":t-=s;break;case"take":t=Ku(t,f+s);break;case"takeRight":
        f=Vu(f,t-s)}}if(t={start:f,end:t},i=t.start,f=t.end,t=f-i,u=u?f:i-1,i=this.__iteratees__,f=i.length,c=0,a=Ku(t,this.__takeCount__),!e||200>o||o==t&&a==t)return Hn(n,this.__actions__);e=[];t:for(;t--&&a>c;){for(u+=r,o=-1,l=n[u];++o<f;){var h=i[o],s=h.type,h=(0,h.iteratee)(l);if(2==s)l=h;else if(!h){if(1==s)continue t;break t}}e[c++]=l}return e},At.prototype.at=qo,At.prototype.chain=function(){return ve(this)},At.prototype.commit=function(){return new kt(this.value(),this.__chain__)},At.prototype.next=function(){
        this.__values__===T&&(this.__values__=Ve(this.value()));var t=this.__index__>=this.__values__.length,n=t?T:this.__values__[this.__index__++];return{done:t,value:n}},At.prototype.plant=function(t){for(var n,r=this;r instanceof Ot;){var e=ie(r);e.__index__=0,e.__values__=T,n?u.__wrapped__=e:n=e;var u=e,r=r.__wrapped__}return u.__wrapped__=t,n},At.prototype.reverse=function(){var t=this.__wrapped__;return t instanceof zt?(this.__actions__.length&&(t=new zt(this)),t=t.reverse(),t.__actions__.push({func:ge,
        args:[he],thisArg:T}),new kt(t,this.__chain__)):this.thru(he)},At.prototype.toJSON=At.prototype.valueOf=At.prototype.value=function(){return Hn(this.__wrapped__,this.__actions__)},Cu&&(At.prototype[Cu]=de),At}var T,q=1/0,V=NaN,K=/\b__p\+='';/g,G=/\b(__p\+=)''\+/g,J=/(__e\(.*?\)|\b__t\))\+'';/g,Y=/&(?:amp|lt|gt|quot|#39|#96);/g,H=/[&<>"'`]/g,Q=RegExp(Y.source),X=RegExp(H.source),tt=/<%-([\s\S]+?)%>/g,nt=/<%([\s\S]+?)%>/g,rt=/<%=([\s\S]+?)%>/g,et=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ut=/^\w*$/,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,it=/[\\^$.*+?()[\]{}|]/g,ft=RegExp(it.source),ct=/^\s+|\s+$/g,at=/^\s+/,lt=/\s+$/,st=/[a-zA-Z0-9]+/g,ht=/\\(\\)?/g,pt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_t=/\w*$/,vt=/^0x/i,gt=/^[-+]0x[0-9a-f]+$/i,dt=/^0b[01]+$/i,yt=/^\[object .+?Constructor\]$/,bt=/^0o[0-7]+$/i,xt=/^(?:0|[1-9]\d*)$/,jt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,wt=/($^)/,mt=/['\n\r\u2028\u2029\\]/g,At="[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?(?:\\u200d(?:[^\\ud800-\\udfff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?)*",Ot="(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])"+At,kt="(?:[^\\ud800-\\udfff][\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]?|[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff])",Et=RegExp("['\u2019]","g"),It=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]","g"),St=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|"+kt+At,"g"),Rt=RegExp(["[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde]|$)|(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde](?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])|$)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?(?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['\u2019](?:d|ll|m|re|s|t|ve))?|[A-Z\\xc0-\\xd6\\xd8-\\xde]+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?|\\d+",Ot].join("|"),"g"),Wt=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),Bt=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Lt="Array Buffer DataView Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Promise Reflect RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ clearTimeout isFinite parseInt setTimeout".split(" "),Mt={};
    Mt["[object Float32Array]"]=Mt["[object Float64Array]"]=Mt["[object Int8Array]"]=Mt["[object Int16Array]"]=Mt["[object Int32Array]"]=Mt["[object Uint8Array]"]=Mt["[object Uint8ClampedArray]"]=Mt["[object Uint16Array]"]=Mt["[object Uint32Array]"]=true,Mt["[object Arguments]"]=Mt["[object Array]"]=Mt["[object ArrayBuffer]"]=Mt["[object Boolean]"]=Mt["[object DataView]"]=Mt["[object Date]"]=Mt["[object Error]"]=Mt["[object Function]"]=Mt["[object Map]"]=Mt["[object Number]"]=Mt["[object Object]"]=Mt["[object RegExp]"]=Mt["[object Set]"]=Mt["[object String]"]=Mt["[object WeakMap]"]=false;
    var Ct={};Ct["[object Arguments]"]=Ct["[object Array]"]=Ct["[object ArrayBuffer]"]=Ct["[object DataView]"]=Ct["[object Boolean]"]=Ct["[object Date]"]=Ct["[object Float32Array]"]=Ct["[object Float64Array]"]=Ct["[object Int8Array]"]=Ct["[object Int16Array]"]=Ct["[object Int32Array]"]=Ct["[object Map]"]=Ct["[object Number]"]=Ct["[object Object]"]=Ct["[object RegExp]"]=Ct["[object Set]"]=Ct["[object String]"]=Ct["[object Symbol]"]=Ct["[object Uint8Array]"]=Ct["[object Uint8ClampedArray]"]=Ct["[object Uint16Array]"]=Ct["[object Uint32Array]"]=true,
        Ct["[object Error]"]=Ct["[object Function]"]=Ct["[object WeakMap]"]=false;var zt={"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O",
        "\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss"},Ut={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Dt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Ft={"function":true,object:true},$t={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"
    },Nt=parseFloat,Pt=parseInt,Zt=Ft[typeof exports]&&exports&&!exports.nodeType?exports:T,Tt=Ft[typeof module]&&module&&!module.nodeType?module:T,qt=Tt&&Tt.exports===Zt?Zt:T,Vt=R(Ft[typeof self]&&self),Kt=R(Ft[typeof window]&&window),Gt=R(Ft[typeof this]&&this),Jt=R(Zt&&Tt&&typeof global=="object"&&global)||Kt!==(Gt&&Gt.window)&&Kt||Vt||Gt||Function("return this")(),Yt=Z();(Kt||Vt||{})._=Yt,typeof define=="function"&&typeof define.amd=="object"&&define.amd? define(function(){return Yt}):Zt&&Tt?(qt&&((Tt.exports=Yt)._=Yt),
        Zt._=Yt):Jt._=Yt}).call(this);

/* file: script/lib/msgpacklite.js */

!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r;r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,r.msgpack=t()}}(function(){return function t(r,e,n){function i(f,u){if(!e[f]){if(!r[f]){var a="function"==typeof require&&require;if(!u&&a)return a(f,!0);if(o)return o(f,!0);var s=new Error("Cannot find module '"+f+"'");throw s.code="MODULE_NOT_FOUND",s}var c=e[f]={exports:{}};r[f][0].call(c.exports,function(t){var e=r[f][1][t];return i(e?e:t)},c,c.exports,t,r,e,n)}return e[f].exports}for(var o="function"==typeof require&&require,f=0;f<n.length;f++)i(n[f]);return i}({1:[function(t,r,e){e.encode=t("./encode").encode,e.decode=t("./decode").decode,e.Encoder=t("./encoder").Encoder,e.Decoder=t("./decoder").Decoder,e.createCodec=t("./ext").createCodec,e.codec=t("./codec").codec},{"./codec":4,"./decode":6,"./decoder":7,"./encode":9,"./encoder":10,"./ext":14}],2:[function(t,r,e){function n(t,r){for(var e=this,n=r||0,i=t.length,o=0;i>o;o++){var f=t.charCodeAt(o);128>f?e[n++]=f:2048>f?(e[n++]=192|f>>6,e[n++]=128|63&f):(e[n++]=224|f>>12,e[n++]=128|f>>6&63,e[n++]=128|63&f)}return n-r}function i(t,r){var e=this,n=t-0||0;r||(r=e.length);var i=r-t;i>h&&(i=h);for(var o=[];r>n;){for(var f=new Array(i),u=0;i>u&&r>n;){var a=e[n++];a=128>a?a:224>a?(63&a)<<6|63&e[n++]:(63&a)<<12|(63&e[n++])<<6|63&e[n++],f[u++]=a}i>u&&(f=f.slice(0,u)),o.push(String.fromCharCode.apply("",f))}return o.length>1?o.join(""):o.length?o.shift():""}function o(t,r,e,n){var i;e||(e=0),n||0===n||(n=this.length),r||(r=0);var o=n-e;if(t===this&&r>e&&n>r)for(i=o-1;i>=0;i--)t[i+r]=this[i+e];else for(i=0;o>i;i++)t[i+r]=this[i+e];return o}function f(t,r){new s(this,r,t)}function u(t,r){new c(this,r,t)}var a=t("int64-buffer"),s=a.Uint64BE,c=a.Int64BE,h=8192;e.writeString=n,e.readString=i,e.copy=o,e.writeUint64BE=f,e.writeInt64BE=u},{"int64-buffer":28}],3:[function(t,r,e){function n(t){return this instanceof n?(this.options=t,void this.init()):new n(t)}function i(t){for(var r in t)n.prototype[r]=o(n.prototype[r],t[r])}function o(t,r){function e(){return t.apply(this,arguments),r.apply(this,arguments)}return t&&r?e:t||r}function f(t){function r(t,r){return r(t)}return t=t.slice(),function(e){return t.reduce(r,e)}}function u(t){return s(t)?f(t):t}function a(t){return new n(t)}var s=t("isarray");e.createCodec=a,e.install=i,e.filter=u,n.prototype.init=function(){return this},e.preset=a({preset:!0})},{isarray:29}],4:[function(t,r,e){t("./read-core"),t("./write-core"),e.codec={preset:t("./codec-base").preset}},{"./codec-base":3,"./read-core":16,"./write-core":19}],5:[function(t,r,e){function n(t){return this instanceof n?void(t&&(this.options=t,t.codec&&(this.codec=t.codec))):new n(t)}e.DecodeBuffer=n;var i=t("./read-core").preset,o=t("./flex-buffer").FlexDecoder;o.mixin(n.prototype),n.prototype.codec=i,n.prototype.fetch=function(){return this.codec.decode(this)}},{"./flex-buffer":15,"./read-core":16}],6:[function(t,r,e){function n(t,r){var e=new i(r);return e.write(t),e.read()}e.decode=n;var i=t("./decode-buffer").DecodeBuffer},{"./decode-buffer":5}],7:[function(t,r,e){function n(t){return this instanceof n?void o.call(this,t):new n(t)}e.Decoder=n;var i=t("event-lite"),o=t("./decode-buffer").DecodeBuffer;n.prototype=new o,i.mixin(n.prototype),n.prototype.decode=function(t){arguments.length&&this.write(t),this.flush()},n.prototype.push=function(t){this.emit("data",t)},n.prototype.end=function(t){this.decode(t),this.emit("end")}},{"./decode-buffer":5,"event-lite":26}],8:[function(t,r,e){function n(t){return this instanceof n?void(t&&(this.options=t,t.codec&&(this.codec=t.codec))):new n(t)}e.EncodeBuffer=n;var i=t("./write-core").preset,o=t("./flex-buffer").FlexEncoder;o.mixin(n.prototype),n.prototype.codec=i,n.prototype.write=function(t){this.codec.encode(this,t)}},{"./flex-buffer":15,"./write-core":19}],9:[function(t,r,e){function n(t,r){var e=new i(r);return e.write(t),e.read()}e.encode=n;var i=t("./encode-buffer").EncodeBuffer},{"./encode-buffer":8}],10:[function(t,r,e){function n(t){return this instanceof n?void o.call(this,t):new n(t)}e.Encoder=n;var i=t("event-lite"),o=t("./encode-buffer").EncodeBuffer;n.prototype=new o,i.mixin(n.prototype),n.prototype.encode=function(t){this.write(t),this.emit("data",this.read())},n.prototype.end=function(t){arguments.length&&this.encode(t),this.flush(),this.emit("end")}},{"./encode-buffer":8,"event-lite":26}],11:[function(t,r,e){function n(t,r){return this instanceof n?(this.buffer=t,void(this.type=r)):new n(t,r)}e.ExtBuffer=n},{}],12:[function(t,r,e){(function(r){function n(t){t.addExtPacker(14,Error,[a,i]),t.addExtPacker(1,EvalError,[a,i]),t.addExtPacker(2,RangeError,[a,i]),t.addExtPacker(3,ReferenceError,[a,i]),t.addExtPacker(4,SyntaxError,[a,i]),t.addExtPacker(5,TypeError,[a,i]),t.addExtPacker(6,URIError,[a,i]),t.addExtPacker(10,RegExp,[u,i]),t.addExtPacker(11,Boolean,[f,i]),t.addExtPacker(12,String,[f,i]),t.addExtPacker(13,Date,[Number,i]),t.addExtPacker(15,Number,[f,i]),"undefined"!=typeof Uint8Array&&(t.addExtPacker(17,Int8Array,o),t.addExtPacker(18,Uint8Array,o),t.addExtPacker(19,Int16Array,s),t.addExtPacker(20,Uint16Array,s),t.addExtPacker(21,Int32Array,s),t.addExtPacker(22,Uint32Array,s),t.addExtPacker(23,Float32Array,s),"undefined"!=typeof Float64Array&&t.addExtPacker(24,Float64Array,s),"undefined"!=typeof Uint8ClampedArray&&t.addExtPacker(25,Uint8ClampedArray,o),t.addExtPacker(26,ArrayBuffer,c),t.addExtPacker(29,DataView,s))}function i(r){return h||(h=t("./encode").encode),h(r)}function o(t){return new r(t)}function f(t){return t.valueOf()}function u(t){t=RegExp.prototype.toString.call(t).split("/"),t.shift();var r=[t.pop()];return r.unshift(t.join("/")),r}function a(t){var r={};for(var e in p)r[e]=t[e];return r}function s(t){return new r(new Uint8Array(t.buffer))}function c(t){return new r(new Uint8Array(t))}e.setExtPackers=n;var h,p={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1}}).call(this,t("buffer").Buffer)},{"./encode":9,buffer:23}],13:[function(t,r,e){function n(t){t.addExtUnpacker(14,[i,f(Error)]),t.addExtUnpacker(1,[i,f(EvalError)]),t.addExtUnpacker(2,[i,f(RangeError)]),t.addExtUnpacker(3,[i,f(ReferenceError)]),t.addExtUnpacker(4,[i,f(SyntaxError)]),t.addExtUnpacker(5,[i,f(TypeError)]),t.addExtUnpacker(6,[i,f(URIError)]),t.addExtUnpacker(10,[i,o]),t.addExtUnpacker(11,[i,u(Boolean)]),t.addExtUnpacker(12,[i,u(String)]),t.addExtUnpacker(13,[i,u(Date)]),t.addExtUnpacker(15,[i,u(Number)]),"undefined"!=typeof Uint8Array&&(t.addExtUnpacker(17,u(Int8Array)),t.addExtUnpacker(18,u(Uint8Array)),t.addExtUnpacker(19,[a,u(Int16Array)]),t.addExtUnpacker(20,[a,u(Uint16Array)]),t.addExtUnpacker(21,[a,u(Int32Array)]),t.addExtUnpacker(22,[a,u(Uint32Array)]),t.addExtUnpacker(23,[a,u(Float32Array)]),"undefined"!=typeof Float64Array&&t.addExtUnpacker(24,[a,u(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&t.addExtUnpacker(25,u(Uint8ClampedArray)),t.addExtUnpacker(26,a),t.addExtUnpacker(29,[a,u(DataView)]))}function i(r){return s||(s=t("./decode").decode),s(r)}function o(t){return RegExp.apply(null,t)}function f(t){return function(r){var e=new t;for(var n in c)e[n]=r[n];return e}}function u(t){return function(r){return new t(r)}}function a(t){return new Uint8Array(t).buffer}e.setExtUnpackers=n;var s,c={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1}},{"./decode":6}],14:[function(t,r,e){t("./read-core"),t("./write-core"),e.createCodec=t("./codec-base").createCodec},{"./codec-base":3,"./read-core":16,"./write-core":19}],15:[function(t,r,e){(function(t){function r(){return this instanceof r?void 0:new r}function n(){return this instanceof n?void 0:new n}function i(){function r(r){var e=this.offset?this.buffer.slice(this.offset):this.buffer;this.buffer=e?r?t.concat([e,r]):e:r,this.offset=0}function e(){for(;this.offset<this.buffer.length;){var t,r=this.offset;try{t=this.fetch()}catch(e){if(e!==d)throw e;this.offset=r;break}this.push(t)}}function n(t){var r=this.offset,e=r+t;if(e>this.buffer.length)throw d;return this.offset=e,r}return{write:r,fetch:u,flush:e,push:s,pull:c,read:a,reserve:n,offset:0}}function o(){function r(){var t=this.start;if(t<this.offset){var r=this.start=this.offset;return this.buffer.slice(t,r)}}function e(){for(;this.start<this.offset;){var t=this.fetch();t&&this.push(t)}}function n(){var r=this.buffers||(this.buffers=[]),e=r.length>1?t.concat(r):r[0];return r.length=0,e}function i(r){var e=0|r;if(this.buffer){var n=this.buffer.length,i=0|this.offset,o=i+e;if(n>o)return this.offset=o,i;this.flush(),r=Math.max(r,Math.min(2*n,this.maxBufferSize))}return r=Math.max(r,this.minBufferSize),this.buffer=new t(r),this.start=0,this.offset=e,0}function o(t){var r=this.offset+t.length;this.buffer&&r<this.buffer.length?(t.copy(this.buffer,this.offset),this.offset=r):(this.flush(),this.push(t))}return{write:f,fetch:r,flush:e,push:s,pull:n,read:a,reserve:i,send:o,maxBufferSize:l,minBufferSize:p,offset:0,start:0}}function f(){throw new Error("method not implemented: write()")}function u(){throw new Error("method not implemented: fetch()")}function a(){var t=this.buffers&&this.buffers.length;return t?(this.flush(),this.pull()):this.fetch()}function s(t){var r=this.buffers||(this.buffers=[]);r.push(t)}function c(){var t=this.buffers||(this.buffers=[]);return t.shift()}function h(t){function r(r){for(var e in t)r[e]=t[e];return r}return r}e.FlexDecoder=r,e.FlexEncoder=n;var p=2048,l=65536,d=new Error("BUFFER_SHORTAGE");r.mixin=h(i()),r.mixin(r.prototype),n.mixin=h(o()),n.mixin(n.prototype)}).call(this,t("buffer").Buffer)},{buffer:23}],16:[function(t,r,e){function n(t){function r(t){var r=s(t),n=e[r];if(!n)throw new Error("Invalid type: "+(r?"0x"+r.toString(16):r));return n(t)}var e=c.getReadToken(t);return r}function i(){var t=this.options;return this.decode=n(t),t&&t.preset&&a.setExtUnpackers(this),this}function o(t,r){var e=this.extUnpackers||(this.extUnpackers=[]);e[t]=h.filter(r)}function f(t){function r(r){return new u(r,t)}var e=this.extUnpackers||(this.extUnpackers=[]);return e[t]||r}var u=t("./ext-buffer").ExtBuffer,a=t("./ext-unpacker"),s=t("./read-format").readUint8,c=t("./read-token"),h=t("./codec-base");h.install({addExtUnpacker:o,getExtUnpacker:f,init:i}),e.preset=i.call(h.preset)},{"./codec-base":3,"./ext-buffer":11,"./ext-unpacker":13,"./read-format":17,"./read-token":18}],17:[function(t,r,e){(function(r){function n(t){var e={map:i,array:o,str:f,bin:u,ext:a,uint8:s,uint16:c,uint32:h(4,r.prototype.readUInt32BE),uint64:h(8,p),int8:h(1,r.prototype.readInt8),int16:h(2,r.prototype.readInt16BE),int32:h(4,r.prototype.readInt32BE),int64:h(8,l),float32:h(4,g),float64:h(8,v)};return t&&t.int64&&(e.uint64=h(8,d),e.int64=h(8,y)),e}function i(t,r){var e,n={},i=new Array(r),o=new Array(r),f=t.codec.decode;for(e=0;r>e;e++)i[e]=f(t),o[e]=f(t);for(e=0;r>e;e++)n[i[e]]=o[e];return n}function o(t,r){for(var e=new Array(r),n=t.codec.decode,i=0;r>i;i++)e[i]=n(t);return e}function f(t,e){var n=t.reserve(e),i=n+e,o=t.buffer;return B||!r.isBuffer(o)?x.readString.call(o,n,i):o.toString("utf-8",n,i)}function u(t,r){var e=t.reserve(r),n=e+r;return w.call(t.buffer,e,n)}function a(t,r){var e=t.reserve(r),n=t.buffer[e++],i=e+r,o=t.codec.getExtUnpacker(n);if(!o)throw new Error("Invalid ext type: "+(n?"0x"+n.toString(16):n));var f=w.call(t.buffer,e,i);return o(f)}function s(t){var r=t.reserve(1);return t.buffer[r]}function c(t){var r=t.reserve(2),e=t.buffer;return e[r++]<<8|e[r]}function h(t,r){return function(e){var n=e.reserve(t);return r.call(e.buffer,n,U)}}function p(t){return new A(this,t).toNumber()}function l(t){return new m(this,t).toNumber()}function d(t){return new A(this,t)}function y(t){return new m(this,t)}function g(t){return this.readFloatBE?this.readFloatBE(t):E.read(this,t,!1,23,4)}function v(t){return this.readDoubleBE?this.readDoubleBE(t):E.read(this,t,!1,52,8)}function w(t,e){var n=this.slice||Array.prototype.slice,i=n.call(this,t,e);return r.isBuffer(i)||(i=r(i)),i}var E=t("ieee754"),b=t("int64-buffer"),A=b.Uint64BE,m=b.Int64BE;e.getReadFormat=n,e.readUint8=s;var x=t("./buffer-lite"),B="TYPED_ARRAY_SUPPORT"in r,U=!0}).call(this,t("buffer").Buffer)},{"./buffer-lite":2,buffer:23,ieee754:27,"int64-buffer":28}],18:[function(t,r,e){function n(t){var r=s.getReadFormat(t);return t&&t.useraw?o(r):i(r)}function i(t){var r,e=new Array(256);for(r=0;127>=r;r++)e[r]=f(r);for(r=128;143>=r;r++)e[r]=a(r-128,t.map);for(r=144;159>=r;r++)e[r]=a(r-144,t.array);for(r=160;191>=r;r++)e[r]=a(r-160,t.str);for(e[192]=f(null),e[193]=null,e[194]=f(!1),e[195]=f(!0),e[196]=u(t.uint8,t.bin),e[197]=u(t.uint16,t.bin),e[198]=u(t.uint32,t.bin),e[199]=u(t.uint8,t.ext),e[200]=u(t.uint16,t.ext),e[201]=u(t.uint32,t.ext),e[202]=t.float32,e[203]=t.float64,e[204]=t.uint8,e[205]=t.uint16,e[206]=t.uint32,e[207]=t.uint64,e[208]=t.int8,e[209]=t.int16,e[210]=t.int32,e[211]=t.int64,e[212]=a(1,t.ext),e[213]=a(2,t.ext),e[214]=a(4,t.ext),e[215]=a(8,t.ext),e[216]=a(16,t.ext),e[217]=u(t.uint8,t.str),e[218]=u(t.uint16,t.str),e[219]=u(t.uint32,t.str),e[220]=u(t.uint16,t.array),e[221]=u(t.uint32,t.array),e[222]=u(t.uint16,t.map),e[223]=u(t.uint32,t.map),r=224;255>=r;r++)e[r]=f(r-256);return e}function o(t){var r,e=n(t).slice();for(e[217]=e[196],e[218]=e[197],e[219]=e[198],r=160;191>=r;r++)e[r]=a(r-160,t.bin);return e}function f(t){return function(){return t}}function u(t,r){return function(e){var n=t(e);return r(e,n)}}function a(t,r){return function(e){return r(e,t)}}var s=t("./read-format");e.getReadToken=n},{"./read-format":17}],19:[function(t,r,e){function n(t){function r(t,r){var n=e[typeof r];if(!n)throw new Error('Unsupported type "'+typeof r+'": '+r);n(t,r)}var e=s.getWriteType(t);return r}function i(){var t=this.options;return this.encode=n(t),t&&t.preset&&a.setExtPackers(this),this}function o(t,r,e){function n(r){var n=e(r);return new u(n,t)}e=c.filter(e);var i=r.name;if(i&&"Object"!==i){var o=this.extPackers||(this.extPackers={});o[i]=n}else{var f=this.extEncoderList||(this.extEncoderList=[]);f.unshift([r,n])}}function f(t){var r=this.extPackers||(this.extPackers={}),e=t.constructor,n=e&&e.name&&r[e.name];if(n)return n;for(var i=this.extEncoderList||(this.extEncoderList=[]),o=i.length,f=0;o>f;f++){var u=i[f];if(e===u[0])return u[1]}}var u=t("./ext-buffer").ExtBuffer,a=t("./ext-packer"),s=t("./write-type"),c=t("./codec-base");c.install({addExtPacker:o,getExtPacker:f,init:i}),e.preset=i.call(c.preset)},{"./codec-base":3,"./ext-buffer":11,"./ext-packer":12,"./write-type":21}],20:[function(t,r,e){(function(r){function n(t){return l||t&&t.safe?o():i()}function i(){var t=h.slice();return t[196]=f(196),t[197]=u(197),t[198]=a(198),t[199]=f(199),t[200]=u(200),t[201]=a(201),t[202]=s(202,4,r.prototype.writeFloatBE,!0),t[203]=s(203,8,r.prototype.writeDoubleBE,!0),t[204]=f(204),t[205]=u(205),t[206]=a(206),t[207]=s(207,8,c.writeUint64BE),t[208]=f(208),t[209]=u(209),t[210]=a(210),t[211]=s(211,8,c.writeUint64BE),t[217]=f(217),t[218]=u(218),t[219]=a(219),t[220]=u(220),t[221]=a(221),t[222]=u(222),t[223]=a(223),t}function o(){var t=h.slice();return t[196]=s(196,1,r.prototype.writeUInt8),t[197]=s(197,2,r.prototype.writeUInt16BE),t[198]=s(198,4,r.prototype.writeUInt32BE),t[199]=s(199,1,r.prototype.writeUInt8),t[200]=s(200,2,r.prototype.writeUInt16BE),t[201]=s(201,4,r.prototype.writeUInt32BE),t[202]=s(202,4,r.prototype.writeFloatBE),t[203]=s(203,8,r.prototype.writeDoubleBE),t[204]=s(204,1,r.prototype.writeUInt8),t[205]=s(205,2,r.prototype.writeUInt16BE),t[206]=s(206,4,r.prototype.writeUInt32BE),t[207]=s(207,8,c.writeUint64BE),t[208]=s(208,1,r.prototype.writeInt8),t[209]=s(209,2,r.prototype.writeInt16BE),t[210]=s(210,4,r.prototype.writeInt32BE),t[211]=s(211,8,c.writeUint64BE),t[217]=s(217,1,r.prototype.writeUInt8),t[218]=s(218,2,r.prototype.writeUInt16BE),t[219]=s(219,4,r.prototype.writeUInt32BE),t[220]=s(220,2,r.prototype.writeUInt16BE),t[221]=s(221,4,r.prototype.writeUInt32BE),t[222]=s(222,2,r.prototype.writeUInt16BE),t[223]=s(223,4,r.prototype.writeUInt32BE),t}function f(t){return function(r,e){var n=r.reserve(2),i=r.buffer;i[n++]=t,i[n]=e}}function u(t){return function(r,e){var n=r.reserve(3),i=r.buffer;i[n++]=t,i[n++]=e>>>8,i[n]=e}}function a(t){return function(r,e){var n=r.reserve(5),i=r.buffer;i[n++]=t,i[n++]=e>>>24,i[n++]=e>>>16,i[n++]=e>>>8,i[n]=e}}function s(t,r,e,n){return function(i,o){var f=i.reserve(r+1);i.buffer[f++]=t,e.call(i.buffer,o,f,n)}}var c=t("./buffer-lite"),h=t("./write-uint8").uint8,p="TYPED_ARRAY_SUPPORT"in r,l=p&&!r.TYPED_ARRAY_SUPPORT;e.getWriteToken=n}).call(this,t("buffer").Buffer)},{"./buffer-lite":2,"./write-uint8":22,buffer:23}],21:[function(t,r,e){(function(r){function n(t){function e(t,r){var e=r?195:194;P[e](t,r)}function n(t,r){var e,n=0|r;return r!==n?(e=203,void P[e](t,r)):(e=n>=-32&&127>=n?255&n:n>=0?255>=n?204:65535>=n?205:206:n>=-128?208:n>=-32768?209:210,void P[e](t,n))}function o(t,r){var e=207;P[e](t,r.toArray())}function d(t,r){var e=211;P[e](t,r.toArray())}function y(t){return 32>t?1:255>=t?2:65535>=t?3:5}function g(t){return 32>t?1:65535>=t?3:5}function v(t){function e(e,n){var i=n.length,o=5+3*i;e.offset=e.reserve(o);var f=e.buffer,u=t(i),s=e.offset+u;i=a.writeString.call(f,n,s);var c=t(i);if(u!==c){var h=s+c-u,l=s+i;!p&&r.isBuffer(f)?f.copy(f,h,s,l):a.copy.call(f,f,h,s,l)}var d=1===c?160+i:3>=c?215+c:219;P[d](e,i),e.offset+=i}return e}function w(t,e){if(null===e)return b(t,e);if(r.isBuffer(e))return m(t,e);if(i(e))return A(t,e);if(f.isUint64BE(e))return o(t,e);if(u.isInt64BE(e))return d(t,e);var n=t.codec.getExtPacker(e);return n&&(e=n(e)),e instanceof h?x(t,e):void B(t,e)}function E(t,e){return r.isBuffer(e)?U(t,e):void w(t,e)}function b(t,r){var e=192;P[e](t,r)}function A(t,r){var e=r.length,n=16>e?144+e:65535>=e?220:221;P[n](t,e);for(var i=t.codec.encode,o=0;e>o;o++)i(t,r[o])}function m(t,r){var e=r.length,n=255>e?196:65535>=e?197:198;P[n](t,e),t.send(r)}function x(t,r){var e=r.buffer,n=e.length,i=l[n]||(255>n?199:65535>=n?200:201);P[i](t,n),c[r.type](t),t.send(e)}function B(t,r){var e=Object.keys(r),n=e.length,i=16>n?128+n:65535>=n?222:223;P[i](t,n);var o=t.codec.encode;e.forEach(function(e){o(t,e),o(t,r[e])})}function U(t,r){var e=r.length,n=32>e?160+e:65535>=e?218:219;P[n](t,e),t.send(r)}var P=s.getWriteToken(t),R=t&&t.useraw,k={"boolean":e,"function":b,number:n,object:R?E:w,string:v(R?g:y),symbol:b,undefined:b};return k}var i=t("isarray"),o=t("int64-buffer"),f=o.Uint64BE,u=o.Int64BE,a=t("./buffer-lite"),s=t("./write-token"),c=t("./write-uint8").uint8,h=t("./ext-buffer").ExtBuffer,p="TYPED_ARRAY_SUPPORT"in r,l=[];l[1]=212,l[2]=213,l[4]=214,l[8]=215,l[16]=216,e.getWriteType=n}).call(this,t("buffer").Buffer)},{"./buffer-lite":2,"./ext-buffer":11,"./write-token":20,"./write-uint8":22,buffer:23,"int64-buffer":28,isarray:29}],22:[function(t,r,e){function n(t){return function(r){var e=r.reserve(1);r.buffer[e]=t}}for(var i=e.uint8=new Array(256),o=0;255>=o;o++)i[o]=n(o)},{}],23:[function(t,r,e){(function(r){"use strict";function n(){try{var t=new Uint8Array(1);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(r){return!1}}function i(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,r){if(i()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r),t.__proto__=f.prototype):(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return u(this,t,r,e)}function u(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?l(t,r,e,n):"string"==typeof r?h(t,r,e):d(t,r)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number')}function s(t,r,e,n){return a(r),0>=r?o(t,r):void 0!==e?"string"==typeof n?o(t,r).fill(e,n):o(t,r).fill(e):o(t,r)}function c(t,r){if(a(r),t=o(t,0>r?0:0|y(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;r>e;e++)t[e]=0;return t}function h(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e);return t=o(t,n),t.write(r,e),t}function p(t,r){var e=0|y(r.length);t=o(t,e);for(var n=0;e>n;n+=1)t[n]=255&r[n];return t}function l(t,r,e,n){if(r.byteLength,0>e||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r,t.__proto__=f.prototype):t=p(t,r),t}function d(t,r){if(f.isBuffer(r)){var e=0|y(r.length);return t=o(t,e),0===t.length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||H(r.length)?o(t,0):p(t,r);if("Buffer"===r.type&&Q(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(t){if(t>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|t}function g(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"binary":case"raw":case"raws":return e;case"utf8":case"utf-8":case void 0:return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return X(t).length;default:if(n)return V(t).length;r=(""+r).toLowerCase(),n=!0}}function w(t,r,e){var n=!1;if((void 0===r||0>r)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),0>=e)return"";if(e>>>=0,r>>>=0,r>=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return S(this,r,e);case"utf8":case"utf-8":return k(this,r,e);case"ascii":return I(this,r,e);case"binary":return T(this,r,e);case"base64":return R(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function E(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function b(t,r,e,n){function i(t,r){return 1===o?t[r]:t.readUInt16BE(r*o)}var o=1,f=t.length,u=r.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;o=2,f/=2,u/=2,e/=2}for(var a=-1,s=0;f>e+s;s++)if(i(t,e+s)===i(r,-1===a?0:s-a)){if(-1===a&&(a=s),s-a+1===u)return(e+a)*o}else-1!==a&&(s-=s-a),a=-1;return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n),n>i&&(n=i)):n=i;var o=r.length;if(o%2!==0)throw new Error("Invalid hex string");n>o/2&&(n=o/2);for(var f=0;n>f;f++){var u=parseInt(r.substr(2*f,2),16);if(isNaN(u))return f;t[e+f]=u}return f}function m(t,r,e,n){return G(V(r,t.length-e),t,e,n)}function x(t,r,e,n){return G(W(r),t,e,n)}function B(t,r,e,n){return x(t,r,e,n)}function U(t,r,e,n){return G(X(r),t,e,n)}function P(t,r,e,n){return G(J(r,t.length-e),t,e,n)}function R(t,r,e){return 0===r&&e===t.length?Z.fromByteArray(t):Z.fromByteArray(t.slice(r,e))}function k(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;e>i;){var o=t[i],f=null,u=o>239?4:o>223?3:o>191?2:1;if(e>=i+u){var a,s,c,h;switch(u){case 1:128>o&&(f=o);break;case 2:a=t[i+1],128===(192&a)&&(h=(31&o)<<6|63&a,h>127&&(f=h));break;case 3:a=t[i+1],s=t[i+2],128===(192&a)&&128===(192&s)&&(h=(15&o)<<12|(63&a)<<6|63&s,h>2047&&(55296>h||h>57343)&&(f=h));break;case 4:a=t[i+1],s=t[i+2],c=t[i+3],128===(192&a)&&128===(192&s)&&128===(192&c)&&(h=(15&o)<<18|(63&a)<<12|(63&s)<<6|63&c,h>65535&&1114112>h&&(f=h))}}null===f?(f=65533,u=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),i+=u}return _(n)}function _(t){var r=t.length;if($>=r)return String.fromCharCode.apply(String,t);for(var e="",n=0;r>n;)e+=String.fromCharCode.apply(String,t.slice(n,n+=$));return e}function I(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;e>i;i++)n+=String.fromCharCode(127&t[i]);return n}function T(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;e>i;i++)n+=String.fromCharCode(t[i]);return n}function S(t,r,e){var n=t.length;(!r||0>r)&&(r=0),(!e||0>e||e>n)&&(e=n);for(var i="",o=r;e>o;o++)i+=q(t[o]);return i}function Y(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function D(t,r,e){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function C(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||o>r)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function O(t,r,e,n){0>r&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);o>i;i++)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function M(t,r,e,n){0>r&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);o>i;i++)t[e+i]=r>>>8*(n?i:3-i)&255}function L(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(0>e)throw new RangeError("Index out of range")}function N(t,r,e,n,i){return i||L(t,r,e,4,3.4028234663852886e38,-3.4028234663852886e38),K.write(t,r,e,n,23,4),e+4}function F(t,r,e,n,i){return i||L(t,r,e,8,1.7976931348623157e308,-1.7976931348623157e308),K.write(t,r,e,n,52,8),e+8}function j(t){if(t=z(t).replace(tt,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function z(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function q(t){return 16>t?"0"+t.toString(16):t.toString(16)}function V(t,r){r=r||1/0;for(var e,n=t.length,i=null,o=[],f=0;n>f;f++){if(e=t.charCodeAt(f),e>55295&&57344>e){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(f+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(56320>e){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=(i-55296<<10|e-56320)+65536}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,128>e){if((r-=1)<0)break;o.push(e)}else if(2048>e){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(65536>e){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(1114112>e))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function W(t){for(var r=[],e=0;e<t.length;e++)r.push(255&t.charCodeAt(e));return r}function J(t,r){for(var e,n,i,o=[],f=0;f<t.length&&!((r-=2)<0);f++)e=t.charCodeAt(f),n=e>>8,i=e%256,o.push(i),o.push(n);return o}function X(t){return Z.toByteArray(j(t))}function G(t,r,e,n){for(var i=0;n>i&&!(i+e>=r.length||i>=t.length);i++)r[i+e]=t[i];return i}function H(t){return t!==t}var Z=t("base64-js"),K=t("ieee754"),Q=t("isarray");e.Buffer=f,e.SlowBuffer=g,e.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==r.TYPED_ARRAY_SUPPORT?r.TYPED_ARRAY_SUPPORT:n(),e.kMaxLength=i(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return u(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return s(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);o>i;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return n>e?-1:e>n?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!Q(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;e++)r+=t[e].length;var n=f.allocUnsafe(r),i=0;for(e=0;e<t.length;e++){var o=t[e];if(!f.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;t>r;r+=2)E(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;t>r;r+=4)E(this,r,r+3),E(this,r+1,r+2);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?k(this,0,t):w.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),0>r||e>t.length||0>n||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(r>>>=0,e>>>=0,n>>>=0,i>>>=0,this===t)return 0;for(var o=i-n,u=e-r,a=Math.min(o,u),s=this.slice(n,i),c=t.slice(r,e),h=0;a>h;++h)if(s[h]!==c[h]){o=s[h],u=c[h];break}return u>o?-1:o>u?1:0},f.prototype.indexOf=function(t,r,e){if("string"==typeof r?(e=r,r=0):r>2147483647?r=2147483647:-2147483648>r&&(r=-2147483648),r>>=0,0===this.length)return-1;if(r>=this.length)return-1;if(0>r&&(r=Math.max(this.length+r,0)),"string"==typeof t&&(t=f.from(t,e)),f.isBuffer(t))return 0===t.length?-1:b(this,t,r,e);if("number"==typeof t)return f.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,r):b(this,[t],r,e);throw new TypeError("val must be string, number or Buffer")},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r=0|r,isFinite(e)?(e=0|e,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(0>e||0>r)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return x(this,t,r,e);case"binary":return B(this,t,r,e);case"base64":return U(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;f.prototype.slice=function(t,r){var e=this.length;t=~~t,r=void 0===r?e:~~r,0>t?(t+=e,0>t&&(t=0)):t>e&&(t=e),0>r?(r+=e,0>r&&(r=0)):r>e&&(r=e),t>r&&(r=t);var n;if(f.TYPED_ARRAY_SUPPORT)n=this.subarray(t,r),n.__proto__=f.prototype;else{var i=r-t;n=new f(i,void 0);for(var o=0;i>o;o++)n[o]=this[o+t]}return n},f.prototype.readUIntLE=function(t,r,e){t=0|t,r=0|r,e||D(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){
        t=0|t,r=0|r,e||D(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||D(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||D(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||D(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t=0|t,r=0|r,e||D(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t=0|t,r=0|r,e||D(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||D(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||D(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||D(t,4,this.length),K.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||D(t,4,this.length),K.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||D(t,8,this.length),K.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||D(t,8,this.length),K.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){if(t=+t,r=0|r,e=0|e,!n){var i=Math.pow(2,8*e)-1;C(this,t,r,e,i,0)}var o=1,f=0;for(this[r]=255&t;++f<e&&(o*=256);)this[r+f]=t/o&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){if(t=+t,r=0|r,e=0|e,!n){var i=Math.pow(2,8*e)-1;C(this,t,r,e,i,0)}var o=e-1,f=1;for(this[r+o]=255&t;--o>=0&&(f*=256);)this[r+o]=t/f&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r=0|r,e||C(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r=0|r,e||C(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):O(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r=0|r,e||C(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):O(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r=0|r,e||C(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):M(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r=0|r,e||C(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):M(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r=0|r,!n){var i=Math.pow(2,8*e-1);C(this,t,r,e,i-1,-i)}var o=0,f=1,u=0;for(this[r]=255&t;++o<e&&(f*=256);)0>t&&0===u&&0!==this[r+o-1]&&(u=1),this[r+o]=(t/f>>0)-u&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r=0|r,!n){var i=Math.pow(2,8*e-1);C(this,t,r,e,i-1,-i)}var o=e-1,f=1,u=0;for(this[r+o]=255&t;--o>=0&&(f*=256);)0>t&&0===u&&0!==this[r+o+1]&&(u=1),this[r+o]=(t/f>>0)-u&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r=0|r,e||C(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r=0|r,e||C(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):O(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r=0|r,e||C(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):O(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r=0|r,e||C(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):M(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r=0|r,e||C(this,t,r,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):M(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return N(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return N(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return F(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return F(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&e>n&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(0>r)throw new RangeError("targetStart out of bounds");if(0>e||e>=this.length)throw new RangeError("sourceStart out of bounds");if(0>n)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&r>e&&n>r)for(i=o-1;i>=0;i--)t[i+r]=this[i+e];else if(1e3>o||!f.TYPED_ARRAY_SUPPORT)for(i=0;o>i;i++)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);256>i&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t=255&t);if(0>r||this.length<r||this.length<e)throw new RangeError("Out of range index");if(r>=e)return this;r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0);var o;if("number"==typeof t)for(o=r;e>o;o++)this[o]=t;else{var u=f.isBuffer(t)?t:V(new f(t,n).toString()),a=u.length;for(o=0;e-r>o;o++)this[o+r]=u[o%a]}return this};var tt=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":24,ieee754:27,isarray:25}],24:[function(t,r,e){"use strict";function n(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,e=t.length;e>r;++r)a[r]=t[r],s[t.charCodeAt(r)]=r;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63}function i(t){var r,e,n,i,o,f,u=t.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===t[u-2]?2:"="===t[u-1]?1:0,f=new c(3*u/4-o),n=o>0?u-4:u;var a=0;for(r=0,e=0;n>r;r+=4,e+=3)i=s[t.charCodeAt(r)]<<18|s[t.charCodeAt(r+1)]<<12|s[t.charCodeAt(r+2)]<<6|s[t.charCodeAt(r+3)],f[a++]=i>>16&255,f[a++]=i>>8&255,f[a++]=255&i;return 2===o?(i=s[t.charCodeAt(r)]<<2|s[t.charCodeAt(r+1)]>>4,f[a++]=255&i):1===o&&(i=s[t.charCodeAt(r)]<<10|s[t.charCodeAt(r+1)]<<4|s[t.charCodeAt(r+2)]>>2,f[a++]=i>>8&255,f[a++]=255&i),f}function o(t){return a[t>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}function f(t,r,e){for(var n,i=[],f=r;e>f;f+=3)n=(t[f]<<16)+(t[f+1]<<8)+t[f+2],i.push(o(n));return i.join("")}function u(t){for(var r,e=t.length,n=e%3,i="",o=[],u=16383,s=0,c=e-n;c>s;s+=u)o.push(f(t,s,s+u>c?c:s+u));return 1===n?(r=t[e-1],i+=a[r>>2],i+=a[r<<4&63],i+="=="):2===n&&(r=(t[e-2]<<8)+t[e-1],i+=a[r>>10],i+=a[r>>4&63],i+=a[r<<2&63],i+="="),o.push(i),o.join("")}e.toByteArray=i,e.fromByteArray=u;var a=[],s=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array;n()},{}],25:[function(t,r,e){var n={}.toString;r.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},{}],26:[function(t,r,e){function n(){return this instanceof n?void 0:new n}!function(t){function e(t){for(var r in s)t[r]=s[r];return t}function n(t,r){return u(this,t).push(r),this}function i(t,r){function e(){o.call(n,t,e),r.apply(this,arguments)}var n=this;return e.originalListener=r,u(n,t).push(e),n}function o(t,r){function e(t){return t!==r&&t.originalListener!==r}var n,i=this;if(arguments.length){if(r){if(n=u(i,t,!0)){if(n=n.filter(e),!n.length)return o.call(i,t);i[a][t]=n}}else if(n=i[a],n&&(delete n[t],!Object.keys(n).length))return o.call(i)}else delete i[a];return i}function f(t,r){function e(t){t.call(o)}function n(t){t.call(o,r)}function i(t){t.apply(o,s)}var o=this,f=u(o,t,!0);if(!f)return!1;var a=arguments.length;if(1===a)f.forEach(e);else if(2===a)f.forEach(n);else{var s=Array.prototype.slice.call(arguments,1);f.forEach(i)}return!!f.length}function u(t,r,e){if(!e||t[a]){var n=t[a]||(t[a]={});return n[r]||(n[r]=[])}}"undefined"!=typeof r&&(r.exports=t);var a="listeners",s={on:n,once:i,off:o,emit:f};e(t.prototype),t.mixin=e}(n)},{}],27:[function(t,r,e){e.read=function(t,r,e,n,i){var o,f,u=8*i-n-1,a=(1<<u)-1,s=a>>1,c=-7,h=e?i-1:0,p=e?-1:1,l=t[r+h];for(h+=p,o=l&(1<<-c)-1,l>>=-c,c+=u;c>0;o=256*o+t[r+h],h+=p,c-=8);for(f=o&(1<<-c)-1,o>>=-c,c+=n;c>0;f=256*f+t[r+h],h+=p,c-=8);if(0===o)o=1-s;else{if(o===a)return f?NaN:(l?-1:1)*(1/0);f+=Math.pow(2,n),o-=s}return(l?-1:1)*f*Math.pow(2,o-n)},e.write=function(t,r,e,n,i,o){var f,u,a,s=8*o-i-1,c=(1<<s)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,l=n?0:o-1,d=n?1:-1,y=0>r||0===r&&0>1/r?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(u=isNaN(r)?1:0,f=c):(f=Math.floor(Math.log(r)/Math.LN2),r*(a=Math.pow(2,-f))<1&&(f--,a*=2),r+=f+h>=1?p/a:p*Math.pow(2,1-h),r*a>=2&&(f++,a/=2),f+h>=c?(u=0,f=c):f+h>=1?(u=(r*a-1)*Math.pow(2,i),f+=h):(u=r*Math.pow(2,h-1)*Math.pow(2,i),f=0));i>=8;t[e+l]=255&u,l+=d,u/=256,i-=8);for(f=f<<i|u,s+=i;s>0;t[e+l]=255&f,l+=d,f/=256,s-=8);t[e+l-d]|=128*y}},{}],28:[function(t,r,e){(function(t){var r,n;!function(e){function i(t,r,e,n,i){if(m&&x&&(r instanceof x&&(r=new m(r)),n instanceof x&&(n=new m(n))),!(r||e||n||y))return void(t.buffer=s(B,0));if(!o(r,e)){var a=y||Array;i=e,n=r,e=0,r=new a(8)}t.buffer=r,t.offset=e|=0,"undefined"!=typeof n&&("string"==typeof n?u(r,e,n,i||10):o(n,i)?f(r,e,n,i):"number"==typeof i?(h(r,e,n),h(r,e+4,i)):n>0?p(r,e,n):0>n?l(r,e,n):f(r,e,B,0))}function o(t,r){var e=t&&t.length;return r|=0,e&&e>=r+8&&"string"!=typeof t[r]}function f(t,r,e,n){r|=0,n|=0;for(var i=0;8>i;i++)t[r++]=255&e[n++]}function u(t,r,e,n){var i=0,o=e.length,f=0,u=0;"-"===e[0]&&i++;for(var a=i;o>i;){var s=parseInt(e[i++],n);if(!(s>=0))break;u=u*n+s,f=f*n+Math.floor(u/P),u%=P}a&&(f=~f,u?u=P-u:f++),h(t,r,f),h(t,r+4,u)}function a(t,r,e,n){var i="",o=c(t,r),f=c(t,r+4),u=n&&2147483648&o;for(u&&(o=~o,f=P-f),e=e||10;;){var a=o%e*P+f;if(o=Math.floor(o/e),f=Math.floor(a/e),i=(a%e).toString(e)+i,!o&&!f)break}return u&&(i="-"+i),i}function s(t,r){return Array.prototype.slice.call(t,r,r+8)}function c(t,r){return t[r++]*R+(t[r++]<<16)+(t[r++]<<8)+t[r]}function h(t,r,e){t[r+3]=255&e,e>>=8,t[r+2]=255&e,e>>=8,t[r+1]=255&e,e>>=8,t[r]=255&e}function p(t,r,e){for(var n=r+7;n>=r;n--)t[n]=255&e,e/=256}function l(t,r,e){e++;for(var n=r+7;n>=r;n--)t[n]=255&-e^255,e/=256}function d(t){return!!t&&"[object Array]"==Object.prototype.toString.call(t)}var y,g=e.Uint64BE=r=function(t,e,n,o){return this instanceof r?i(this,t,e,n,o):new r(t,e,n,o)},v=e.Int64BE=n=function(t,r,e,o){return this instanceof n?i(this,t,r,e,o):new n(t,r,e,o)},w=g.prototype,E=v.prototype,b="undefined",A=b!==typeof t&&t,m=b!==typeof Uint8Array&&Uint8Array,x=b!==typeof ArrayBuffer&&ArrayBuffer,B=[0,0,0,0,0,0,0,0],U=Array.isArray||d,P=4294967296,R=16777216;w.buffer=E.buffer=void 0,w.offset=E.offset=0,w._isUint64BE=E._isInt64BE=!0,g.isUint64BE=function(t){return!(!t||!t._isUint64BE)},v.isInt64BE=function(t){return!(!t||!t._isInt64BE)},w.toNumber=function(){var t=this.buffer,r=this.offset,e=c(t,r),n=c(t,r+4);return e?e*P+n:n},E.toNumber=function(){var t=this.buffer,r=this.offset,e=0|c(t,r),n=c(t,r+4);return e?e*P+n:n},w.toArray=E.toArray=function(t){var r=this.buffer,e=this.offset;return y=null,t!==!1&&0===e&&8===r.length&&U(r)?r:s(r,e)},A&&(w.toBuffer=E.toBuffer=function(r){var e=this.buffer,n=this.offset;if(y=A,r!==!1&&0===n&&8===e.length&&t.isBuffer(e))return e;var i=new A(8);return f(i,0,e,n),i}),m&&(w.toArrayBuffer=E.toArrayBuffer=function(t){var r=this.buffer,e=this.offset,n=r.buffer;if(y=m,t!==!1&&0===e&&n instanceof x&&8===n.byteLength)return n;var i=new m(8);return f(i,0,r,e),i.buffer}),E.toString=function(t){return a(this.buffer,this.offset,t,!0)},w.toString=function(t){return a(this.buffer,this.offset,t,!1)},w.toJSON=w.toNumber,E.toJSON=E.toNumber}("object"==typeof e&&"string"!=typeof e.nodeName?e:this||{})}).call(this,t("buffer").Buffer)},{buffer:23}],29:[function(t,r,e){arguments[4][25][0].apply(e,arguments)},{dup:25}]},{},[1])(1)});

/* file: script/Utils.js */

Math.TAU = Math.PI * 2;
Math.HPI = Math.PI / 2;
Math.QPI = Math.PI / 4;

Utils = {

    arrayCall(array, methodName, a = 0, b = 0, c = 0) {

        for (let i = 0; i < array.length; i++) array[i][methodName](a, b, c);

    },

    arraySet(array, propertyName, value) {

        for (let i = 0; i < array.length; i++) array[i][propertyName] = value;

    },

    pullOne(array, element) {

        let index = array.indexOf(element);

        if (index < 0) return;

        array.splice(index, 1);

    },

    hash: function(string) {

        var hash = 0,
            i, chr;

        if (string.length === 0) return hash;

        for (i = 0; i < string.length; i++) {
            chr = string.charCodeAt(i);
            hash = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }

        return hash;

    },

    dcopy: function(o) {

        return JSON.parse(JSON.stringify(o));

    },

    escapeHTML: function(s) {
        return s.replace(/&/g, '&amp;')
        .replace(/"/g, '&quot;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
    },

    unescapeHTML: function(s) {
        return s.replace('&amp;', '&')
        .replace('&quot;', '"')
        .replace('&lt;', "<")
        .replace('&gt;', ">");
    },

    captureTrace: function() {

        try {

            throw new Error();

        } catch (e) {

            return JSON.stringify(e.stack, null, 2);

        }

    },

    ucfirst: function(str) {

        return str[0].toUpperCase() + str.slice(1);

    },

    dirrow: function(direction, angles) {

        angles = angles || 8;

        var fo = -0.5 * Math.TAU / angles;

        return (Utils.circWrap(direction - fo) / Math.TAU) * angles | 0;

    },

    tryParseJSON: function(json) {

        try {

            return JSON.parse(json);

        } catch (e) {

            return null;

        }

    },

    repeatInterval: function(callback, times, interval) {

        callback();

        var counter = 1;

        if (counter >= times) return;

        var timer = setInterval(function() {

            callback(counter++);

            if (counter >= times) {

                clearInterval(timer);

            };

        }, interval * 1000);

    },

    create: function(prototype, args) {

        var object = Object.create(prototype);

        return this.extend(object, args);

    },

    strTemplate: function(str, obj) {

        return str.replace(/{(\w+)}/g, function(_, k) {
            return obj[k];
        });

    },

    urlTemplate: function(template, data) {

        for (var key in data) {

            var value = encodeURIComponent(data[key]);

            template = template.replace("{" + key + "}", value);

        }

        return template;

    },

    /* extend existing properties */

    existend: function() {

        var result = Utils.extend({}, arguments[0]);

        for (var key in result) {

            for (var i = 1; i < arguments.length; i++) {

                if (!arguments[i]) continue;

                var value = arguments[i][key];

                if (value !== undefined) result[key] = value;

            }

        }

        return result;

    },

    cycle: function(array) {

        array.push(array.shift());

        return array[0];

    },

    distance: function(x1, y1, x2, y2) {

        if (arguments.length > 2) {

            var dx = x1 - x2;
            var dy = y1 - y2;

            return Math.sqrt(dx * dx + dy * dy);

        } else {

            var dx = x1.x - y1.x;
            var dy = x1.y - y1.y;

            return Math.sqrt(dx * dx + dy * dy);

        }

    },

    distance2: function(x1, y1, x2, y2) {

        if (arguments.length > 2) {

            var dx = x1 - x2;
            var dy = y1 - y2;

            return dx * dx + dy * dy;

        } else {

            var dx = x1.x - y1.x;
            var dy = x1.y - y1.y;

            return dx * dx + dy * dy;

        }

    },

    limit: function(value, min, max) {

        return value < min ? min : value > max ? max : value;

    },

    nearest: function(from, entities) {

        var min = -1;
        var result = null;

        for (var i = 0; i < entities.length; i++) {

            var to = entities[i];

            if (from === to) continue;

            var distance = this.distance(from, to);

            if (distance < min || min < 0) {
                min = distance;
                result = to;
            }

        }

        return result;
    },

    sign: function(value) {

        return value == 0 ? 0 : value / Math.abs(value);

    },

    sincos: function(angle, radius) {

        if (arguments.length === 1) {
            var a = Math.random() * 6.28;

            return {
                x: Math.cos(a) * angle,
                y: Math.sin(a) * angle
            };

        } else {

            return {
                x: Math.cos(angle) * radius,
                y: Math.sin(angle) * radius
            };

        }

    },

    ground: function(num, threshold) {

        return (num / threshold | 0) * threshold;

    },

    thresholdFloor: function(num, threshold) {

        return (num / threshold | 0) * threshold;

    },

    thresholdCeil: function(num, threshold) {

        return Math.ceil(num / threshold) * threshold;

    },

    groundAngle: function(direction, angles) {

        angles = angles || 8;

        var fo = -0.5 * Math.TAU / angles;

        return Utils.ground(direction - fo, Math.TAU / angles);

    },

    rotate: function(pointX, pointY, originX, originY, angle) {

        return [
            originX + (pointX - originX) * Math.cos(angle) - (pointY - originY) * Math.sin(angle),
            originY + (pointX - originX) * Math.sin(angle) + (pointY - originY) * Math.cos(angle)
        ];

    },

    pointInRect: function(x, y, rx, ry, rw, rh) {

        return !(x < rx || y < ry || x >= rx + rw || y >= ry + rh);

    },

    pointInEllipse: function(px, py, ex, ey, ew, eh) {

        let dx = px - ex;
        let dy = py - ey;

        return (dx * dx) / (ew * ew) + (dy * dy) / (eh * eh) <= 1;

    },

    rectInRect: function(r1x, r1y, r1w, r1h, r2x, r2y, r2w, r2h) {

        return !(r2x > r1x + r1w ||
            r2x + r2w < r1x ||
            r2y > r1y + r1h ||
            r2y + r2h < r1y);

    },

    pointInRotatedRect: function(pointX, pointY, rectX, rectY, rectWidth, rectHeight, rotation) {

        var x = rectX + (pointX - rectX) * Math.cos(-rotation) - (pointY - rectY) * Math.sin(-rotation);
        var y = rectY + (pointX - rectX) * Math.sin(-rotation) + (pointY - rectY) * Math.cos(-rotation);

        return this.pointInRect(x, y, rectX - rectWidth / 2, rectY - rectHeight / 2, rectWidth, rectHeight);

    },

    quickPointInRange: function(ax, ay, bx, by, range) {

        if (Math.abs(ax - bx) > range) return false;
        if (Math.abs(ay - by) > range) return false;

        return true;

    },

    /* https://github.com/substack/point-in-polygon */

    pointInPolygon: function(x, y, vertices) {

        var inside = false;

        for (var i = 0, j = vertices.length - 1; i < vertices.length; j = i++) {
            var xi = vertices[i][0],
                yi = vertices[i][1];
            var xj = vertices[j][0],
                yj = vertices[j][1];

            var intersect = ((yi > y) != (yj > y)) && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);
            if (intersect) inside = !inside;
        }

        return inside;

    },

    atan2: function(y, x) {

        if (y === 0 && x === 0) return 0;

        var r;

        var ax = Math.abs(x);
        var ay = Math.abs(y);

        var a = Math.min(ax, ay) / Math.max(ax, ay);
        var s = a * a;

        r = ((-0.0464964749 * s + 0.15931422) * s - 0.327622764) * s * a + a

        if (ay > ax) r = 1.57079637 - r;
        if (x < 0) r = 3.14159274 - r;
        if (y < 0) r = -r;

        return r;


    },

    lookAt: function(a, b, c, d) {

        if (arguments.length > 2) {

            var angle = this.atan2(d - b, c - a);
            if (angle < 0) angle = Math.PI * 2 + angle;

        } else {

            var angle = this.atan2(b.y - a.y, b.x - a.x);
            if (angle < 0) angle = Math.PI * 2 + angle;

        }

        return angle;

    },

    atanxy: function(x, y) {

        var angle = Math.atan2(y, x);
        if (angle < 0) angle = Math.PI * 2 + angle;

        return angle;

    },

    moveTo: function(value, target, step) {


        if (value < target) {
            value += step;
            if (value > target) value = target;
        }

        if (value > target) {
            value -= step;
            if (value < target) value = target;
        }

        return value;

    },

    circWrap: function(val) {

        while (val >= Math.PI * 2) val -= Math.PI * 2;
        while (val < 0) val += Math.PI * 2;

        return val;

    },

    wrap: function(value, min, max) {

        if (value < min) {

            return max + (value - min);

        }

        if (value >= max) {

            return min + (value - max);

        }

        return value;

    },

    wrapTo: function(value, target, max, step) {

        if (value === target) return target;

        var result = value;

        var d = this.wrappedDistance(value, target, max);

        if (Math.abs(d) < step) return target;

        result += (d < 0 ? -1 : 1) * step;

        if (result > max) {

            result = result - max;

        } else if (result < 0) {

            result = max + result;

        }

        return result;

    },

    circWrapTo: function(value, target, step) {

        return this.wrapTo(value, target, Math.PI * 2, step);

    },

    circDistance: function(a, b) {

        return this.wrappedDistance(a, b, Math.PI * 2);

    },

    circDistanceAbs: function(a, b) {

        return Math.abs(this.wrappedDistance(a, b, Math.PI * 2));

    },

    circDistanceFactor: function(a, b) {

        return Math.abs(this.wrappedDistance(a, b, Math.PI * 2)) / Math.PI;

    },

    wrappedDistance: function(a, b, max) {

        if (a === b) return 0;
        else if (a < b) {
            var l = -a - max + b;
            var r = b - a;
        } else {
            var l = b - a;
            var r = max - a + b;
        }

        if (Math.abs(l) > Math.abs(r)) return r;
        else return l;

    },

    randomPolygon: function(vertices, scale) {

        var angleStep = Math.PI * 2 / vertices;

        var polygon = [];

        var angleOffset = Math.PI * 2 * Math.random();

        for (var i = 0; i < vertices; i++) {

            var angle = angleOffset + i * angleStep - Math.random() * angleStep * 0.5;
            var r = 0.5 + Math.random() * 0.5;
            var x = Math.cos(angle) * r;
            var y = Math.sin(angle) * r;

            polygon.push([x * scale, y * scale]);

        }

        return polygon;

    },

    seed: function(value) {

        var seed = value;

        for (var i = 0; i < (value % 1000); i++) seed = (seed * 9301 + 49297) % 233280;

        return seed / 233280;

    },

    randomf: function(a, b) {

        return a + (b - a) * Math.random();

    },

    random: function(a, b) {

        if (a === undefined) {
            return Math.random();
        } else if (b !== undefined) {
            return Math.floor(a + Math.random() * Math.abs(b - a + 1));
        } else {
            if (a instanceof Array) return a[(a.length + 1) * Math.random() - 1 | 0];
            else {
                return a[this.random(Object.keys(a))];
            }
        }

    },

    randomSign: function() {

        return Math.random() > 0.5 ? -1 : 1;

    },

    signedRandom: function(max) {

        return Math.random() * max * (Math.random() > 0.5 ? -1 : 1);

    },

    lerp(a, b, factor = 0.5) {

        if (typeof a === "number") {

            return a + (b - a) * factor;

        } else {

            return {
                x: this.lerp(a.x, b.x, factor),
                y: this.lerp(a.y, b.y, factor)
            };

        }

    },


    interpolatePoints: function(ax, ay, bx, by, f) {

        return [f * ax + (1 - f) * bx, f * ay + (1 - f) * by];
    },

    /* http://keith-hair.net/blog/2008/08/05/line-to-circle-intersection-data/ */

    lineCircleIntersection: function(ax, ay, bx, by, cx, cy, r) {

        var result = {
            inside: false,
            tangent: false,
            intersects: false,
            enter: null,
            exit: null
        };

        var a = (bx - ax) * (bx - ax) + (by - ay) * (by - ay);
        var b = 2 * ((bx - ax) * (ax - cx) + (by - ay) * (ay - cy));
        var cc = cx * cx + cy * cy + ax * ax + ay * ay - 2 * (cx * ax + cy * ay) - r * r;
        var deter = b * b - 4 * a * cc;

        result.distance = Math.sqrt(a);

        if (deter <= 0) {
            result.inside = false;
        } else {
            var e = Math.sqrt(deter);
            var u1 = (-b + e) / (2 * a);
            var u2 = (-b - e) / (2 * a);
            if ((u1 < 0 || u1 > 1) && (u2 < 0 || u2 > 1)) {
                if ((u1 < 0 && u2 < 0) || (u1 > 1 && u2 > 1)) {
                    result.inside = false;
                } else {
                    result.inside = true;
                }
            } else {

                if (0 <= u2 && u2 <= 1) {
                    result.enter = this.interpolatePoints(ax, ay, bx, by, 1 - u2);
                }
                if (0 <= u1 && u1 <= 1) {
                    result.exit = this.interpolatePoints(ax, ay, bx, by, 1 - u1);
                }
                result.intersects = true;
                if (result.exit != null && result.enter != null && result.exit[0] == result.enter[0] && result.exit[1] == result.enter[1]) {
                    result.tangent = true;
                }
            }
        }

        return result.intersects ? result : false;

    },

    lineCircleCollision: function(ax, ay, bx, by, cx, cy, r) {

        var result = false;

        var a = (bx - ax) * (bx - ax) + (by - ay) * (by - ay);
        var b = 2 * ((bx - ax) * (ax - cx) + (by - ay) * (ay - cy));
        var cc = cx * cx + cy * cy + ax * ax + ay * ay - 2 * (cx * ax + cy * ay) - r * r;
        var deter = b * b - 4 * a * cc;

        if (deter <= 0) {

        } else {
            var e = Math.sqrt(deter);
            var u1 = (-b + e) / (2 * a);
            var u2 = (-b - e) / (2 * a);

            if ((u1 < 0 || u1 > 1) && (u2 < 0 || u2 > 1)) {

            } else {
                result = true;
            }
        }

        return result;

    },

    repulse: function(a, b, radius) {

        var angle = this.lookAt(b, a);

        a.x = b.x + Math.cos(angle) * radius;
        a.y = b.y + Math.sin(angle) * radius;

    },


    interval: function(object, key, interval) {

        if (!object.throttles) object.throttles = {};
        if (!object.throttles[key]) object.throttles[key] = -interval;

        if (object.lifetime - object.throttles[key] >= interval) {

            object.throttles[key] = object.lifetime;

            return true;

        } else return false;

    },

    intervalRange: function(object, key, min, max) {

        if (!object.throttles) object.throttles = {};
        if (!object.throttles[key]) object.throttles[key] = object.lifetime - max;

        if (object.throttles[key] - object.lifetime <= 0) {

            object.throttles[key] = object.lifetime + Utils.randomf(min, max);

            return true;

        } else return false;

    },

    onceAfter: function(key, wait, object) {

        if (!object.onceAfters) object.onceAfters = {};
        if (!object.onceAfters[key]) object.onceAfters[key] = object.lifetime - wait;

        if (object.lifetime - object.onceAfters[key] >= wait) {
            object.onceAfters[key] = object.lifetime;
            return true;
        } else {
            object.onceAfters[key] = object.lifetime;
            return false;
        }

    },

    /* game specific */

    updateBox: function(e, radius) {

        if (!e.box) e.box = [];

        e.box[0] = e.x - radius;
        e.box[1] = e.y - radius;
        e.box[2] = radius * 2;
        e.box[3] = radius * 2;
    },

    saw: function(t) {

        if (t < 0.5) {
            return t / 0.5;
        } else {
            return 1 - (t - 0.5) / 0.5;
        }

    },


    vecNormalize: function(v) {

        var d = Math.sqrt(v[0] * v[0] + v[1] * v[1]);

        return [v[0] / d, v[1] / d];

    },

    vecDot: function(a, b) {

        return a[0] * b[0] + a[1] * b[1];

    },

    vecSub: function(a, b) {

        return [a[0] - b[0], a[1] - b[1]];

    },

    getDirectionKey: function(direction) {

        if (direction === 0) return "right";
        else if (direction === Math.PI * 0.5) return "down";
        else if (direction === Math.PI * 1.0) return "left";
        else if (direction === Math.PI * 1.5) return "up";

    },

    offsetToDirectionKey: function(ox, oy) {

        if (ox < 0) return "left";
        if (ox > 0) return "right";
        if (oy < 0) return "up";
        if (oy > 0) return "down";

    },

    minValue: function(collection, test) {

        var min = false;

        if (collection instanceof Array) {

            for (var i = 0; i < collection.length; i++) {

                var value = test(collection[i]);

                if (min === false || value < min) min = value;

            }

        } else {

            for (var key in collection) {

                var value = test(collection[key]);

                if (min === false || value < min) min = value;

            }

        }

        return min;

    },

    maxValue: function(collection, test) {

        var max = false;

        if (collection instanceof Array) {

            for (var i = 0; i < collection.length; i++) {

                var value = test(collection[i]);

                if (max === false || value > max) max = value;

            }

        } else {

            for (var key in collection) {

                var value = test(collection[key]);

                if (max === false || value > max) max = value;

            }

        }

        return max;

    },

    darkerCache: {},

    darker: function(color) {

        if (!this.darkerCache[color]) {

            this.darkerCache[color] = cq.color(color).shiftHsl(-0.05, -0.1, -0.2).toHex();

        }

        return this.darkerCache[color];

    },

    /* grid functions */

    gnearest: function(from, entities) {

        var min = -1;
        var result = null;

        for (var i = 0; i < entities.length; i++) {

            var to = entities[i];

            if (from === to) continue;

            var distance = this.distance(from, to);

            if (distance < min || min < 0) {
                min = distance;
                result = to;
            }

        }

        return result;
    },

    gdistance: function(x1, y1, x2, y2) {

        if (arguments.length > 2) {

            var dx = x1 - x2;
            var dy = y1 - y2;

            return Math.sqrt(dx * dx + dy * dy);

        } else {

            var dx = x1.gx - y1.gx;
            var dy = x1.gy - y1.gy;

            return Math.sqrt(dx * dx + dy * dy);

        }

    },

    smhd: function(s = 0, m = 0, h = 0, d = 0) {

        return s * 1000 + m * 60 * 1000 + h * 60 * 60 * 1000 + d * 24 * 60 * 60 * 1000;

    },

    xget: function(url, object, callback) {

        callback = callback || function() {};

        return new Promise(function(resolve, reject) {

            var request = new XMLHttpRequest();

            request.open("GET", url, true);

            request.onreadystatechange = function() {

                if (request.readyState != 4 || request.status != 200) return;

                callback(false, request.responseText);

                resolve(request.responseText);

            };

            request.onerror = function() {
                callback(true);
                reject();
            };

            request.timeout = 5000;

            request.ontimeout = function() {

                callback(true);
                reject();

            }

            request.send();

        });

    },

    xpost: function(url, object, callback) {

        callback = callback || function() {};

        return new Promise(function(resolve, reject) {

            var request = new XMLHttpRequest();

            request.open("POST", url, true);

            request.onreadystatechange = function() {

                if (request.readyState != 4 || request.status != 200) return;

                if (callback) callback(false, request.responseText);

                resolve(request.responseText);

            };

            request.onerror = function() {

                if (callback) callback(true);

                reject();

            };

            request.timeout = 2000;

            request.ontimeout = function() {

                if (callback) callback(true);

                reject();

            }

            /*

            var form_data = new FormData();

            for (var key in object) {

              form_data.append(key, object[key]);

            }

      */

            request.send(JSON.stringify(object));

        });

    },

    nearestPOT(value, pow) {

        pow = pow || 1;

        while (pow < value) {

            pow *= 2;

        }

        return pow;

    },

    timer: function(callback, interval) {

        var lastTick = Date.now();

        var timer = setInterval(function() {

            var dt = (Date.now() - lastTick) / 1000;

            lastTick = Date.now();

            callback(dt);

        }, interval);

        return timer;

    },

    lzwEncode: function(s) {
        var dict = {};
        var data = (s + "").split("");
        var out = [];
        var currChar;
        var phrase = data[0];
        var code = 256;
        for (var i = 1; i < data.length; i++) {
            currChar = data[i];
            if (dict[phrase + currChar] != null) {
                phrase += currChar;
            } else {
                out.push(phrase.length > 1 ? dict[phrase] : phrase.charCodeAt(0));
                dict[phrase + currChar] = code;
                code++;
                phrase = currChar;
            }
        }
        out.push(phrase.length > 1 ? dict[phrase] : phrase.charCodeAt(0));
        for (var i = 0; i < out.length; i++) {
            out[i] = String.fromCharCode(out[i]);
        }
        return out.join("");
    },

    // Decompress an LZW-encoded string
    lzwDecode: function(s) {
        var dict = {};
        var data = (s + "").split("");
        var currChar = data[0];
        var oldPhrase = currChar;
        var out = [currChar];
        var code = 256;
        var phrase;
        for (var i = 1; i < data.length; i++) {
            var currCode = data[i].charCodeAt(0);
            if (currCode < 256) {
                phrase = data[i];
            } else {
                phrase = dict[currCode] ? dict[currCode] : (oldPhrase + currChar);
            }
            out.push(phrase);
            currChar = phrase.charAt(0);
            dict[code] = oldPhrase + currChar;
            code++;
            oldPhrase = phrase;
        }
        return out.join("");

    }

};

_.defaults(Utils, _);

Utils.filterKeys = function(object, filter) {

    var result = [];

    for (var key in object) {

        if (filter(object[key])) result.push(key);

    }

    return result;

};

Utils.filterObject = function(object, filter) {

    var result = {};

    for (var key in object) {

        if (filter(object[key])) result[key] = object[key];

    }

    return result;

};


Utils.filters = {

    hasTags: function() {

        var tags = Array.from(arguments);

        return function(object) {

            if (!object.tags) return false;

            for (var i = 0; i < tags.length; i++) {

                if (object.tags.indexOf(tags[i]) === -1) return false;

            }

            return true;

        }

    }

};

/* file: script/Matrix3.js */

var Matrix3 = {

    translate: function(matrix, x, y) {

        return this.multiply(matrix, this.translation(x, y));

    },

    scale: function(matrix, x, y) {

        return this.multiply(matrix, this.scaling(x, y));

    },

    rotate: function(matrix, x, y) {

        return this.multiply(matrix, this.rotation(x, y));

    },

    invert: function(matrix) {

        let a00 = matrix[0],
            a01 = matrix[1],
            a02 = matrix[2];
        let a10 = matrix[3],
            a11 = matrix[4],
            a12 = matrix[5];
        let a20 = matrix[6],
            a21 = matrix[7],
            a22 = matrix[8];
        let b01 = a22 * a11 - a12 * a21;
        let b11 = -a22 * a10 + a12 * a20;
        let b21 = a21 * a10 - a11 * a20;

        // Calculate the determinant

        let det = a00 * b01 + a01 * b11 + a02 * b21;

        if (!det) {
            return null;
        }

        det = 1.0 / det;

        matrix[0] = b01 * det;
        matrix[1] = (-a22 * a01 + a02 * a21) * det;
        matrix[2] = (a12 * a01 - a02 * a11) * det;
        matrix[3] = b11 * det;
        matrix[4] = (a22 * a00 - a02 * a20) * det;
        matrix[5] = (-a12 * a00 + a02 * a10) * det;
        matrix[6] = b21 * det;
        matrix[7] = (-a21 * a00 + a01 * a20) * det;
        matrix[8] = (a11 * a00 - a01 * a10) * det;

        return matrix;

    },

    create: function() {

        return ([
            1, 0, 0,
            0, 1, 0,
            0, 0, 1
        ]);

    },


    reset: function(matrix) {

        matrix[0] = 1;
        matrix[1] = 0;
        matrix[2] = 0;

        matrix[3] = 0;
        matrix[4] = 1;
        matrix[5] = 0;

        matrix[6] = 0;
        matrix[7] = 0;
        matrix[8] = 1;

        return matrix;

    },

    translation: function(tx, ty) {

        return ([
            1, 0, 0,
            0, 1, 0,
            tx, ty, 1,
        ]);

    },

    rotation: function(angleInRadians) {

        var c = Math.cos(angleInRadians);
        var s = Math.sin(angleInRadians);

        return ([
            c, -s, 0,
            s, c, 0,
            0, 0, 1,
        ]);

    },

    scaling: function(sx, sy) {

        return ([
            sx, 0, 0,
            0, sy, 0,
            0, 0, 1,
        ]);

    },

    projection: function(width, height) {

        // Note: This matrix flips the Y axis so 0 is at the top.

        return ([
            2 / width, 0, 0,
            0, -2 / height, 0, -1, 1, 1
        ]);

    },

    trs: function(tx, ty, r, sx, sy) {

        return [sx * c, -s]

    },

    multiply: function(a, b) {

        var a00 = a[0 * 3 + 0];
        var a01 = a[0 * 3 + 1];
        var a02 = a[0 * 3 + 2];
        var a10 = a[1 * 3 + 0];
        var a11 = a[1 * 3 + 1];
        var a12 = a[1 * 3 + 2];
        var a20 = a[2 * 3 + 0];
        var a21 = a[2 * 3 + 1];
        var a22 = a[2 * 3 + 2];

        var b00 = b[0 * 3 + 0];
        var b01 = b[0 * 3 + 1];
        var b02 = b[0 * 3 + 2];
        var b10 = b[1 * 3 + 0];
        var b11 = b[1 * 3 + 1];
        var b12 = b[1 * 3 + 2];
        var b20 = b[2 * 3 + 0];
        var b21 = b[2 * 3 + 1];
        var b22 = b[2 * 3 + 2];

        a[0 * 3 + 0] = b00 * a00 + b01 * a10 + b02 * a20;
        a[0 * 3 + 1] = b00 * a01 + b01 * a11 + b02 * a21;
        a[0 * 3 + 2] = b00 * a02 + b01 * a12 + b02 * a22;
        a[1 * 3 + 0] = b10 * a00 + b11 * a10 + b12 * a20;
        a[1 * 3 + 1] = b10 * a01 + b11 * a11 + b12 * a21;
        a[1 * 3 + 2] = b10 * a02 + b11 * a12 + b12 * a22;
        a[2 * 3 + 0] = b20 * a00 + b21 * a10 + b22 * a20;
        a[2 * 3 + 1] = b20 * a01 + b21 * a11 + b22 * a21;
        a[2 * 3 + 2] = b20 * a02 + b21 * a12 + b22 * a22;

        return a;

    }

};

/* file: script/modules/BitmapFont.js */

CLIENT.BitmapFont = function(image, ...defs) {

    this.id = ++CLIENT.BitmapFont.id;

    this.regions = Object.create(null);

    let canvas = document.createElement("canvas");
    let ctx = canvas.getContext("2d");

    canvas.width = image.width;
    canvas.height = image.height;

    ctx.drawImage(image, 0, 0);

    for (def of defs) {

        let srcX = def[0];
        let srcY = def[1];
        let srcW = def[2];
        let srcH = def[3];
        let letters = def[4];

        this.height = srcH - 1;
        this.spaceWidth = srcH * 0.5 | 0;

        let pixels = ctx.getImageData(srcX, srcY, srcW, 1).data;
        let letterIndex = 0;
        let letterWidth = 0;
        let letterX = 0;

        for (let x = 0; x < srcW; x++) {

            let separated = true;

            for (let y = 0; y < 1; y++) {

                let pixelIndex = (x + y * srcW) * 4;

                let a = pixels[pixelIndex + 3];

                if (a) {
                    separated = false;
                    break;
                }

            }

            if (!separated && x === srcW - 1) {
                separated = true;
                letterWidth++;
            }

            if (separated) {

                let letter = letters[letterIndex];

                this.regions[letter] = [srcX + letterX, srcY + 1, letterWidth, srcH - 1];

                letterIndex++;
                letterWidth = 0;
                letterX = x + 1;

            } else {

                letterWidth++;

            }

        }

    }

};

CLIENT.BitmapFont.id = 0;

CLIENT.BitmapFont.prototype = {

    constructor: CLIENT.BitmapFont,

    getSize(text) {

        let x = 0;
        let y = 0;
        let width = 0;

        for (var i = 0; i < text.length; i++) {

            let letter = text[i];

            if (letter === "\n") {

                y += this.height + 1;
                x = 0;

            } else if (letter === " ") {

                x += this.spaceWidth;

            } else if (this.regions[letter]) {

                x += 1 + this.regions[letter][2];

            }



            if (width < x) width = x;

        }

        return {
            width: width,
            height: y + this.height + 1
        };

    },

    getRegions(text) {

        let key = font.id + "--" + text;

        let result = [];

        let x = 0;
        let y = 0;

        for (var i = 0; i < text.length; i++) {

            let letter = text[i];

            if (letter === "\n") {

                y += font.height + 1;
                x = 0;

            } else if (letter === " ") {

                x += font.spaceWidth;

                continue;

            }

            if (!font.regions[letter]) continue;

            let sprite = batch.add();
            let region = font.regions[letter];

            result.push({
                src: region,
                dst: [x, y, region[2], region[3]]
            });

            x += 1 + region[2];

        }


        return result;

    }



};

/* file: script/modules/Camera.js */

CLIENT.Camera = function() {

    this.box = [0, 0, 0, 0];

    this.scale = 1.0;

    this.x = 0;
    this.y = 0;
    this.offsetX = 0;
    this.offsetY = 0;
    this.followX = 0;
    this.followY = 0;

    this.center = {
        x: 0,
        y: 0
    };

    this.instant = true;

    this.set(0, 0, 32, 32);

    this.shaking = 0;
    this.shakingPower = 0;

    this.matrix = Matrix3.create()

    this.orgSensor = this.sensor = Math.min(app.width, app.height) / 4;

};

CLIENT.Camera.prototype = {

    shake: function(power, duration) {

        power = power || 12;

        if (power > this.shakingPower || this.shaking <= 0) {

            this.shakingPower = power;

        }

        this.shaking = Math.max(this.shaking, duration || 1.0);

    },

    set: function(x, y, w, h) {

        this.x = x;
        this.y = y;

        this.center.x = x;
        this.center.y = y;

        this.width = w;
        this.height = h;

    },

    jump: function(x, y) {

        if (arguments.length === 0) {

            this.center.x = this.follow.x;
            this.center.y = this.follow.y;

        } else if (arguments.length === 1) {

            this.center.x = x.x;
            this.center.y = x.y;

        } else {

            this.center.x = x;
            this.center.y = y;

        }

        this.x = this.center.x - this.width / 2 / this.scale;
        this.y = this.center.y - this.height / 2 / this.scale;


        this.updateWorldCoords();

    },

    skip: function() {

        this.skipped = true;

    },

    sensor: 100,

    step: function(dt) {

        this.updateWorldCoords();

        var offsetX = 0;
        var offsetY = 0;

        if (this.follow) {

            var followX = this.follow.x;
            var followY = this.follow.y;

            if (this.limiter) {

                // if (Math.abs(followY - this.limiter.y) > (this.height / this.scale) * 0.4) {

                // followY = this.limiter.y + Utils.sign(this.limiter.y - followY) * (this.height / this.scale) * 0.4;

                // }


                followX = Utils.lerp(followX, this.limiter.x, 0.75);
                followY = Utils.lerp(followY, this.limiter.y, 0.75);

            }


            var distance = Utils.distance(this.center.x, this.center.y, followX, followY);

            var speed = Math.max(this.sensor === 0 ? 32 : 0, (distance - this.orgSensor) * 4);

            if (distance > this.sensor) {

                this.sensor = 0;

            }

            if (this.sensor === 0 && distance < 10) {

                this.sensor = this.orgSensor;

            }

            speed = Math.min(speed, 100);

            var angle = Utils.lookAt(this.center.x, this.center.y, followX, followY);

            if (this.skipped || this.instant || distance <= speed * dt) {

                this.skipped = false;

                this.center.x = followX | 0;
                this.center.y = followY | 0;

            } else {


                this.center.x += Math.cos(angle) * speed * dt;
                this.center.y += Math.sin(angle) * speed * dt;

            }


        }

        this.x = this.offsetX + this.center.x - (this.width / this.scale) / 2 + offsetX;
        this.y = this.offsetY + this.center.y - (this.height / this.scale) / 2 + offsetY;

        if (this.shaking > 0) {

            this.shaking -= dt;

            var a = Utils.saw(this.shaking / 1.0) * this.shakingPower;

            this.x += Utils.random(-a, a);
            this.y += Utils.random(-a, a);

        }

        this.updateWorldCoords();

    },

    updateWorldCoords: function() {

        this.wx = this.x;
        this.wy = this.y;
        this.ww = this.width / this.scale;
        this.wh = this.height / this.scale;

        this.box[0] = this.x;
        this.box[1] = this.y;
        this.box[2] = this.ww;
        this.box[3] = this.wh;


    },

    setFollow: function(follow) {

        this.follow = follow;

    },

    inView: function(x, y, w, h) {

        return Utils.rectInRect(x, y, w, h, this.box[0], this.box[1], this.box[2], this.box[3]);

    }

};

/* file: script/modules/Entities.js */

CLIENT.Entities = function(game) {

    this.game = game;

    this.children = [];
    this.groups = {};
    this.id = 0;
    this.dirtyGroups = {};

    this.sidMap = new Map();
    this.inView = [];

};

CLIENT.Entities.prototype = {

    sid: function(sid) {

        return this.sidMap.get(sid);

    },

    all: function(filter, group) {

        var entities = group ? this.groups[group] : this.children;

        return Utils.filter(entities, filter);

    },

    one: function(filter, group) {

        var entities = group ? this.groups[group] : this.children;

        return Utils.find(entities, filter);

    },

    create: function(constructorName, args) {

        var constructor = CLIENT[constructorName];

        if (!constructor.prototype.constructorName) constructor.prototype.constructorName = constructorName;

        args.collection = this;
        args.game = this.game;

        if (constructor.prototype.reset) {

            var entity = app.pool(constructor, args);

        } else {

            var entity = new constructor(args);

        }

        entity.inView = 0;

        if (entity.shared) {

            entity.sid = entity.shared.sid;

            this.sidMap.set(entity.shared.sid, entity);

        }

        return entity;

    },

    add: function(constructorName) {

        var args = {};

        args.box = [0, 0, 0, 0];
        args._remove = false;

        for (var i = 1; i < arguments.length; i++) {

            Object.assign(args, arguments[i]);

        }

        /* create new object */

        args.id = ++this.id;

        if (typeof constructorName === "object") {

            var entity = constructorName;

            entity.game = this.game;
            entity.collection = this;
            entity.box = args.box;
            entity._remove = false;

        } else {

            var entity = this.create(constructorName, args)

        }

        this.children.push(entity);

        this.dirty = true;

        this.last = entity;

        if (entity.groups) {

            for (var i = 0; i < entity.groups.length; i++) this.addToGroup(entity, entity.groups[i]);

        }

        if (entity.shape) this.updateBox(entity);

        return entity;

    },

    createGroup: function(group) {

        if (this.groups[group]) return;

        this.groups[group] = [];
        this.groups[group].entitiesToRemove = [];

    },

    addToGroup: function(entity, group) {

        this.createGroup(group);

        this.groups[group].push(entity);

    },

    removeFromGroup: function(entity, group) {

        this.dirtyGroups[group] = true;
        this.groups[group].entitiesToRemove.push(entity);

        this.dirty = true;

    },

    cleanup: function() {

        this.dirty = false;

        for (var i = 0, len = this.children.length; i < len; i++) {

            var entity = this.children[i];

            if (entity._remove) {

                if (entity.groups) {

                    for (var j = 0; j < entity.groups.length; j++) {

                        this.dirtyGroups[entity.groups[j]] = true;

                    }

                }

                Utils.pullOne(this.inView, entity);

                if (entity.leaveview) entity.leaveview();

                if (entity._destruct) entity._destruct();

                if (entity.sid) {

                    this.sidMap.delete(entity.sid);

                }

                this.children.splice(i--, 1);

                len--;

            }

        }

        /* cleanup groups */

        for (var key in this.dirtyGroups) {

            var group = this.groups[key];

            for (var i = 0, len = group.length; i < len; i++) {

                var entity = group[i];

                if (entity._remove || group.entitiesToRemove.indexOf(entity) > -1) {

                    group.splice(i--, 1);
                    len--;

                }

            }

            group.entitiesToRemove = [];

        }

        this.dirtyGroups = {};

    },

    sortMethod: function(a, b) {

        if (a.zIndex !== b.zIndex) {

            return (a.zIndex | 0) - (b.zIndex | 0);

        }


        // var ay = a.box[1] + a.box[3]; //+ a.z;
        // var by = b.box[1] + b.box[3]; //+ b.z;

        var ay = a.y;
        var by = b.y;

        if (ay !== by) {

            return ay - by;

        }

        if (a.x !== b.x) {

            return a.x - b.x;

        }

        return a.id - b.id;

    },

    sort: function() {

        this.children.sort(this.sortMethod);

    },

    remove: function(entity) {

        entity._remove = true;

        this.dirty = true;

    },

    updateEntity: function(entity, dt) {

        if (entity.shape) {

            entity.prevX = entity.x;
            entity.prevY = entity.y;

        }

        if (entity.lifespan) {

            entity.lifespan -= dt;

            if (entity.lifespan <= 0) {

                entity.lifespan = 0;
                this.remove(entity);

            }

        }

    },

    updateBox: function(entity) {

        if (!entity.shape) {

        } else if (entity.shape === COMMON.RECT) {

            entity.box[0] = entity.x - entity.width * (entity.alignX || 0);
            entity.box[1] = entity.y - entity.height * (entity.alignY || 0);
            entity.box[2] = entity.width;
            entity.box[3] = entity.height;

        } else {

            entity.box[0] = entity.x - entity.radius;
            entity.box[1] = entity.y - entity.radius;
            entity.box[2] = entity.radius * 2;
            entity.box[3] = entity.radius * 2;

        }

        // entity.box[1] -= entity.z | 0;

    },

    step: function(dt) {

        this.inView.length = 0;

        var camera = app.game.camera;

        for (var i = 0; i < this.children.length; i++) {

            var entity = this.children[i];

            var prevInView = entity.inView;

            if (entity.inView > 0) {

                entity.inView -= dt;

                if (entity.inView < 0) entity.inView = 0;

            }

            // if (entity._remove) continue;

            if (entity.box) {

                entity.inView = 2.0 * Utils.rectInRect(entity.box[0], entity.box[1], entity.box[2], entity.box[3], camera.box[0], camera.box[1], camera.box[2], camera.box[3]) || entity.inView;

            } else {

                entity.inView = 1.0;

            }

            if (entity.inView) this.inView.push(entity);

            if (!prevInView && entity.inView) {

                if (entity.enterview) entity.enterview();

            }

            if (prevInView && !entity.inView) {

                if (entity.leaveview) entity.leaveview();

            }

            this.updateEntity(this.children[i], dt);

            if (this.children[i].step) this.children[i].step(dt);

            this.updateBox(this.children[i]);

        }

        if (this.dirty) this.cleanup();

        this.sort();

    },

    render: function() {

        for (var i = 0; i < this.children.length; i++) {

            let entity = this.children[i];

            if (!entity.inView) continue;

            entity.render();

        }

    }

};


class MyApp extends PLAYGROUND.Application {

}

/* file: script/modules/Events.js */

CLIENT.Events = function() {

    this.listeners = {};

};

CLIENT.Events.prototype = {

    on: function(event, callback, context) {

        if (typeof event === "object") {

            var result = {};

            for (var key in event) {

                result[key] = this.on(key, event[key], context)

            }

            return result;

        }

        if (!this.listeners[event]) this.listeners[event] = [];

        var listener = {
            once: false,
            callback: callback,
            context: context
        };

        this.listeners[event].push(listener);

        return listener;
    },

    once: function(event, callback, context) {

        if (typeof event === "object") {
            var result = {};
            for (var key in event) {
                result[key] = this.once(key, event[key], context)
            }
            return result;
        }

        if (!this.listeners[event]) this.listeners[event] = [];

        var listener = {
            once: true,
            callback: callback,
            context: context
        };

        this.listeners[event].push(listener);

        return listener;
    },

    off: function(event, callback) {

        for (var i = 0, len = this.listeners[event].length; i < len; i++) {

            if (this.listeners[event][i]._remove) {

                this.listeners[event].splice(i--, 1);
                len--;

            }

        }

    },

    trigger: function(event, data) {

        if (typeof data === "undefined") data = {};

        data.emitter = this;

        if (this.listeners.event) {

            for (var i = 0, len = this.listeners.event.length; i < len; i++) {

                var listener = this.listeners.event[i];

                listener.callback.call(listener.context, event, data);

            }

        }

        /* or subscribed to  a single event */

        if (this.listeners[event]) {

            for (var i = 0, len = this.listeners[event].length; i < len; i++) {

                var listener = this.listeners[event][i];

                listener.callback.call(listener.context || this, data);

                if (listener.once) {

                    this.listeners[event].splice(i--, 1);
                    len--;

                }

            }

        }

    }

};


/* file: script/modules/FollowingTween.js */

NAMESPACE.FollowingTween = function(context) {

    this.context = context;

    this.tweensMap = new Map;
    this.tweensArray = [];

};

NAMESPACE.FollowingTween.LINEAR = 0;
NAMESPACE.FollowingTween.CIRC = 1;

NAMESPACE.FollowingTween.prototype = {

    to: function(follow, dst, src, offset, duration, easing = "linear", mode = 0) {

        var tween = this.tweensMap.get(dst);

        if (!tween) {

            var tween = {

            };

            this.tweensMap.set(dst, tween)
            this.tweensArray.push(tween);

        }

        tween.follow = follow;
        tween.dst = dst;
        tween.src = src;
        tween.before = this.context[dst];
        tween.offset = offset;
        tween.duration = duration;
        tween.lifetime = 0;
        tween.mode = mode;
        tween.after = 0;
        tween.easing = easing;


    },

    step: function(dt) {

        for (var i = 0; i < this.tweensArray.length; i++) {

            var tween = this.tweensArray[i];

            tween.lifetime += dt;

            tween.after = tween.follow[tween.src] + tween.offset;

            // + tween.offset;

            if (tween.mode === NAMESPACE.FollowingTween.LINEAR) {

                tween.diff = tween.after - tween.before;

            } else if (tween.mode === NAMESPACE.FollowingTween.CIRC) {

                tween.diff = Utils.circDistance(tween.after, tween.before);

            }

            var progress = tween.lifetime / tween.duration;

            if (progress > 1.0) progress = 1.0;

            if (tween.mode === NAMESPACE.FollowingTween.LINEAR) {

                this.context[tween.dst] = tween.before + tween.diff * app.ease(progress, tween.easing);

            } else if (tween.mode === NAMESPACE.FollowingTween.CIRC) {

                this.context[tween.dst] = Utils.circWrapTo(tween.before, tween.after, tween.diff * app.ease(progress, tween.easing));

            }

            if (progress === 1.0) {

                this.tweensMap.delete(tween.dst);
                this.tweensArray.splice(i--, 1);

            }

        }

    }

};

/* file: script/modules/GameActionManager.js */

CLIENT.GameActionManager = function(parent, states) {

    this.parent = parent;

    this.current = {};
    this.states = states;

    this.data = {};
    this.runs = new Set;
    this.timeout = 0;
    this.timeoutArgs = [];

    this.lifetime = 0;
    this.elapsed = 0;
    this.selection = null;

};

CLIENT.GameActionManager.prototype = {

    runOnce: function(timeout) {

        if (!this.runs.has(timeout) && this.elapsed > timeout) {

            this.runs.add(timeout);

            return true;

        }

        return false;

    },

    setTimeout: function(state, timeout, a, b, c) {

        this.timeoutArgs[0] = state;
        this.timeoutArgs[2] = a;
        this.timeoutArgs[3] = b;
        this.timeoutArgs[4] = c;

        this.timeout = this.lifetime + timeout;

    },

    set: function(state, a, b, c) {

        this.timeout = 0;

        if (typeof state === "string") {

            this.key = state;

            state = this.states[state];

        }

        // if (state === this.current) return;

        if (this.current && this.current.leave) this.current.leave(this.parent, this, a, b, c);

        if (this.current && this.current.select && this.selection) {

            if (this.selection.leaveHighlight) this.selection.leaveHighlight();

            this.selection.highlighted = false;
            this.selection = null;

        }

        if (typeof state === "function") state = new state;

        this.lifetime = 0;
        this.elapsed = 0;

        this.current = state;

        this.runs.clear();

        if (this.current && this.current.enter) this.current.enter(this.parent, this, a, b, c);

    },

    step: function(dt) {

        this.lifetime += dt;
        this.elapsed += dt;

        if (this.timeout && this.lifetime >= this.timeout) {

            this.set(this.timeoutArgs[0], this.timeoutArgs[1], this.timeoutArgs[2], this.timeoutArgs[3]);

        }

        if (this.current && this.current.step) this.current.step(this.parent, this, dt);

        if (this.current.select) {

            let prevSelection = this.selection;

            this.selection = this.current.select();

            if (prevSelection !== this.selection) {

                if (prevSelection) {

                    if (prevSelection.leaveHighlight) prevSelection.leaveHighlight();

                    prevSelection.highlighted = false;

                }

                if (this.selection) {

                    this.selection.highlighted = true;

                    if (this.selection.enterHighlight) this.selection.enterHighlight();

                }

            }
        }

    },

    call: function(methodName, a, b, c) {

        if (this.current && this.current[methodName]) this.current[methodName](this.parent, this, a, b, c);

    },

    once: function() {

    }

};

/* file: script/modules/GUI.js */

CLIENT.GUI = function() {

    this.hoveredElement = null;
    this.pressedElement = null;

    this.elements = [];

    this.layerA = new CLIENT.ImageBatch();
    this.layerB = new CLIENT.ImageBatch();
    this.hovered = 0;
    this.hidden = false;

};

CLIENT.GUI.prototype = {

    constructor: CLIENT.GUI,

    add(elementName) {

        let element = new CLIENT["GUI" + elementName](this);

        this.elements.push(element);

        return element;

    },

    remove(element) {

        element._remove = true;

    },

    enterElement(element) {

        if (this.hoveredElement === element) return;

        element.hovered = true;

        this.hovered = 1.0;

        this.hoveredElement = element;

        if (this.hoveredElement.onEnter) this.hoveredElement.onEnter();
        if (this.hoveredElement.tooltip) this.showTooltip(this.hoveredElement);

        this.hoveredElement.trigger("enter");


    },

    leaveElement(element) {

        if (!this.dragging && app.pointer.pressed && this.pressedElement) this.startDrag(this.hoveredElement);

        element.hovered = false;

        if (this.hoveredElement.onLeave) this.hoveredElement.onLeave();
        if (this.hoveredElement.tooltip) this.hideTooltip(this.hoveredElement);

        this.hoveredElement.trigger("leave");

        this.hoveredElement = null;



    },

    showTooltip(element) {

        var tooltipElement = this.add("Text");
        let tooltipSize = app.fonts.default.getSize(element.tooltip);

        if (app.game.layout === 0) {

            tooltipElement.x = element.x + element.width / 2 - tooltipSize.width / 2 | 0;
            tooltipElement.y = element.y - tooltipSize.height - 8;

        } else {

            tooltipElement.x = app.width / 2 - tooltipSize.width / 2 | 0;
            tooltipElement.y = app.height - tooltipSize.height - 32;

        }

        tooltipElement.font = app.fonts.default;
        tooltipElement.text = element.tooltip
        tooltipElement.color.set(0xcbdbfc, 0.8);

        element[Symbol.for("tooltipElement")] = tooltipElement;

        tooltipElement.batch.dissolve = 1.0;

        app.tween(tooltipElement.batch).to({
            dissolve: 0.0
        }, 0.1);

        if (element.subtip) {

            let subtipElement = this.add("Text");
            let subtipSize = app.fonts.small.getSize(element.subtip);

            if (app.game.layout === 0) {

                subtipElement.x = element.x + element.width / 2 - subtipSize.width / 2 | 0;
                subtipElement.y = element.y - subtipSize.height - 8;

            } else {

                subtipElement.x = app.width / 2 - subtipSize.width / 2 | 0;
                subtipElement.y = app.height - subtipSize.height - 32;


            }

            tooltipElement.y -= subtipSize.height + 4;

            subtipElement.font = app.fonts.small;
            subtipElement.text = element.subtip
            subtipElement.color.set(0xf5b743, 0.8);

            element[Symbol.for("subtipElement")] = subtipElement;

            subtipElement.batch.dissolve = 1.0;

            app.tween(subtipElement.batch).to({
                dissolve: 0.0
            }, 0.1);

        }



    },

    hideTooltip(element) {

        let tooltipElement = element[Symbol.for("tooltipElement")];

        app.tween(tooltipElement.batch).to({
            dissolve: 1.0
        }, 0.1).then(function() {

            tooltipElement.gui.remove(tooltipElement);

        });

        let subtipElement = element[Symbol.for("subtipElement")];

        if (subtipElement) {

            app.tween(subtipElement.batch).to({
                dissolve: 1.0
            }, 0.1).then(function() {

                subtipElement.gui.remove(subtipElement);

            });

        }

        // this.remove(tooltipElement);


    },

    pointermove(e) {

        let hoveredElement = null;

        for (let i = this.elements.length - 1; i >= 0; i--) {

            let element = this.elements[i];

            if (element.hidden) continue;

            if (!Utils.pointInRect(e.x, e.y, element.x, element.y, element.width, element.height)) continue;

            hoveredElement = element;

            break;

        }


        if (this.hoveredElement !== hoveredElement) {

            if (this.hoveredElement) this.leaveElement(this.hoveredElement);

            this.enterElement(hoveredElement);

        } else if (this.hoveredElement && !hoveredElement) {

            this.leaveElement(this.hoveredElement);

        }

    },

    startDrag(element) {

        this.pressedElement = null;

        this.draggedElement = element;

        this.dragging = true;

        this.draggedElement.trigger("dragstart");

    },


    endDrag() {


        this.dragging = false;

        this.draggedElement.trigger("dragend");
        this.draggedElement = null;

    },

    pointerdown(e) {

        if (this.hoveredElement) {

            this.pressedElement = this.hoveredElement;

            this.hoveredElement.pressed = true;
            this.hoveredElement.needRefresh = true;

            if (this.pressedElement.onPress) {

                this.pressedElement.onPress(e);

            }

            return true;

        } else {

            return false;

        }

    },

    pointerup(e) {

        if (this.pressedElement) {

            this.pressedElement.pressed = false;
            this.pressedElement.needRefresh = true;

            if (this.pressedElement.onRelease) {

                this.pressedElement.onRelease();

            }

            this.pressedElement.trigger("click", e);

            this.pressedElement = null;

            return true;

        }

        if (this.dragging) {

            this.endDrag();

        }

    },

    step(dt) {

        if (!this.hoveredElement) this.hovered -= dt;

        for (let i = 0; i < this.elements.length; i++) {

            let element = this.elements[i];

            if (element._remove) {

                if (element.destruct) element.destruct();

                this.elements.splice(i--, 1);

            }

        }

    },

    render() {

        if (this.hidden) return;

        this.layerA.render();

        for (let element of this.elements) {

            if (element.hidden) continue;
            if (element.render) element.render();

        }

        this.layerB.render();


    }

};

/* file: script/modules/Gun.js */

CLIENT.Gun = function(parent) {

    this.parent = parent;

    this.sprite = new CLIENT.Sprite;
    this.sprite.set("gun");
    this.sprite.duration = 1.0;
    this.sprite.range = [0, 0];
    this.sprite.scale.x = 0.5;

    this.chargeDuration = 1.0;
    this.soundLoop = null;
    this.time = 0;

    this.running = false;

    this.hideTimeout = 0;

    this.stop();

};

CLIENT.Gun.prototype = {

    start() {

        if (this.running) return;

        this.running = true;

        if (this.soundLoop) this.stop();

        this.soundLoop = app.sound.play("gun_charge").loop();
        this.time = 0;
        this.sprite.range = [1, 8];
        this.sprite.loop = true;
        this.sprite.duration = 1.0;

        app.tween(this.sprite.scale).discard().to({
            x: 1.0,
            y: 1.0
        }, 0.5, "outElastic");

        if (!this.hideTimeout) app.sound.play("gun_show").volume(0.4).rate(1.0);

    },

    stop() {

        if (!this.running) return;

        this.running = false;

        if (this.soundLoop) {

            this.soundLoop.fadeOut(0.5);
            this.soundLoop.rateTo(0, 0.5);
            this.soundLoop = null;

        }

        this.sprite.range = [9, 13];
        this.sprite.loop = false;
        this.sprite.duration = 0.25;
        this.sprite.time = 0;
        this.sprite.timeScale = 1.0;

        this.hideTimeout = 3.0;

        app.tween(this.sprite.scale).discard().to({
            y: 1.75
        }, 0.1, "outBounce").to({
            y: 1.0
        }, 0.1);

        app.sound.play("gun_fire").volume(0.5).rate(0.6)


    },

    step(dt) {

        if (this.hideTimeout && !this.running) {

            this.hideTimeout -= dt;

            if (this.hideTimeout <= 0) {

                this.hideTimeout = 0;

                app.tween(this.sprite.scale).to({
                    x: 0.5,
                }, 0.35, "outElastic");

                app.sound.play("gun_hide").volume(0.4).rate(0.8);

            }

        }

        if (this.soundLoop) {

            this.time += dt;

            let progress = this.time / this.chargeDuration;

            if (progress > 1.0) progress = 1.0;

            this.soundLoop.rate(0.2 + progress * 1.0);

            this.sprite.timeScale = 1.0 + progress * 6;

        }

        this.sprite.step(dt);

    },

    render() {

        let gunOrbit = 8;

        this.sprite.pivot.x = 0.0;

        this.sprite.x = this.parent.x + Math.cos(this.parent.direction) * gunOrbit;
        this.sprite.y = this.parent.y + Math.sin(this.parent.direction) * gunOrbit;

        this.sprite.rotation = this.parent.direction;

        this.sprite.render();

    }

};

/* file: script/modules/ImageBatch.js */

CLIENT.ImageBatch = function() {

    this.x = 0;
    this.y = 0;

    this.width = -1;
    this.height = -1;


    this.scale = {
        x: 1.0,
        y: 1.0
    };

    this.color = app.color(0x000000, 0.0);
    this.alpha = 1.0;
    this.dissolve = 0.0;

    this.index_counter = 0;

    this.elements = [];
    this.uv = null;
    this.mesh = null;

    this.meshBuffer = app.gl.createBuffer();
    this.uvBuffer = app.gl.createBuffer();

    this.needRebuild = false;

    this.texture = app.textures.spritesheet;
    this.matrix = Matrix3.create();
    this.program = app.programs.gui;

};

CLIENT.ImageBatch.prototype = {

    constructor: CLIENT.ImageBatch,

    add(sprite = null, region = null) {

        return this.create(sprite, region);

    },

    create(sprite = null, region = null) {

        this.needRebuild = true;

        let element = new CLIENT.ImageBatchElement(this);

        this.elements.push(element);

        if (sprite) element.setSprite(...sprite);
        if (region) element.setRegion(...region);

        return element;

    },

    clear() {

        this.elements.length = 0;

        this.needRebuild = true;

    },

    remove(element) {

        Utils.pull(this.elements, element);

        this.needRebuild = true;

    },

    removeArray(elements) {

        for (let element of elements) this.remove(element);

    },


    rebuild() {

        let gl = app.gl;

        let mesh = [];
        let uv = [];

        for (var i = 0; i < this.elements.length; i++) {

            let element = this.elements[i];

            let x = element.x;
            let y = element.y;
            let w = element.width;
            let h = element.height;

            mesh.push(
                x + 0, y + 0,
                x + w, y + 0,
                x + w, y + h,
                x + w, y + h,
                x + 0, y + h,
                x + 0, y + 0
            );

            x = element.sprite[0] / this.texture.width;
            y = element.sprite[1] / this.texture.height;
            w = element.sprite[2] / this.texture.width;
            h = element.sprite[3] / this.texture.height;

            uv.push(
                x + 0, y + 0,
                x + w, y + 0,
                x + w, y + h,
                x + w, y + h,
                x + 0, y + h,
                x + 0, y + 0
            );

        }

        gl.bindBuffer(gl.ARRAY_BUFFER, this.meshBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(mesh), gl.STATIC_DRAW);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(uv), gl.STATIC_DRAW);

        this.needRebuild = false;

    },

    render() {

        if (this.dissolve >= 1.0) return;

        if (!this.elements.length) return;

        let gl = app.gl;
        let program = this.program;

        if (this.needRebuild) this.rebuild();

        /* Alpha */

        gl.enable(gl.BLEND);
        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);

        /* Assign shaders */

        gl.useProgram(program.native);

        /* Position */

        gl.enableVertexAttribArray(program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.meshBuffer);
        gl.vertexAttribPointer(program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */


        gl.activeTexture(gl.TEXTURE1);
        gl.bindTexture(gl.TEXTURE_2D, app.textures.palette);

        gl.activeTexture(gl.TEXTURE0);
        gl.bindTexture(gl.TEXTURE_2D, this.texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

        gl.enableVertexAttribArray(program.locations.uv);
        gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);
        gl.vertexAttribPointer(program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        program.set("texture", 0);
        program.set("color", this.color.r, this.color.g, this.color.b, this.color.a * this.alpha);
        program.set("alpha", this.alpha);
        // program.set("translation", this.x / app.width, this.y / app.height);
        program.set("paletteTexture", 1);
        program.set("palette", 0);
        program.set("dissolve", this.dissolve);

        Matrix3.reset(this.matrix);
        Matrix3.translate(this.matrix, this.x | 0, this.y | 0);
        Matrix3.scale(this.matrix, this.scale.x, this.scale.y);

        // Matrix3.scale(this.matrix, 1 / app.game.camera.scale, 1 / app.game.camera.scale);

        program.set("modelMatrix", this.matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, this.elements.length * 6);

    }

};

CLIENT.ImageBatchElement = function(batch) {

    this.batch = batch;

    this.x = 0;
    this.y = 0;
    this.width = 1;
    this.height = 1;
    this.sprite = [0, 0, 1, 1];

};

CLIENT.ImageBatchElement.prototype = {

    constructor: CLIENT.ImageBatchElement,

    remove() {

        this.batch.remove(this);

    },

    setSprite(x, y, w, h) {

        this.sprite[0] = x;
        this.sprite[1] = y;
        this.sprite[2] = w;
        this.sprite[3] = h;

        this.batch.needRebuild = true;

    },

    setRegion(x, y, w, h) {

        if (!w) w = this.sprite[2];
        if (!h) h = this.sprite[3];

        this.x = x;
        this.y = y;
        this.width = w;
        this.height = h;

        this.batch.needRebuild = true;

    },

    setPosition(x, y) {

        this.x = x;
        this.y = y;

        this.batch.needRebuild = true;

    }


};

/* file: script/modules/QuickChat.js */

CLIENT.QuickChat = function() {

    let template = `
      <div class="absolute center quickChat">
        <input type=text maxlength=32 class="full-width">
        <p>hit ENTER to send or ESC to CANCEL</p>
      </div>
    `;

    this.$element = $(template).appendTo("body");
    this.$element.hide();

    this.$input = this.$element.find("input");
    this.$input.on("change keyup", this.validate.bind(this));

};

CLIENT.QuickChat.prototype = {


    validate() {

        let $input = this.$input;

        let val = $input.val();

        val = COMMON.validateChatCharacters(val);

        $input.val(val);

    },

    show() {

        this.$input.val("");
        this.$element.show();
        this.$input.focus();

    },

    hide() {

        this.$element.hide();

    },

    send() {

        this.validate();
        let text = this.$input.val();

        app.game.send("quick_chat", {
            text: text
        });

    }


};

/* file: script/modules/Selector.js */

CLIENT.SelectorFirefly = function(args) {

    Object.assign(this, args);

};

CLIENT.SelectorFirefly.prototype = {

    render() {

    },

    step() {

    }

};

CLIENT.Selector = function(game) {

    this.game = game;

    this.lifetime = 0;

    this.fireflies = [];

    this.selected = null;

};

CLIENT.Selector.prototype = {

    step(dt) {

        if (this.selected) {

            this.fireflies.push({
                lifetime: Math.random(),
                duration: 2 + Math.random() * 2,
                follow: this.selected
            });

        }

    },

    render() {

        for (var i = 0; i < this.fireflies.length; i++) {

            let firefly = this.fireflies[i];

            let x = firefly.follow.x + Math.cos(firefly.lifetime) * 32;
            let y = firefly.follow.y + Math.sin(firefly.lifetime) * 16 - lifetime * 16;

            firefly.lifetime += app.elapsed;

            if (firefly.lifetime > firefly.duration) this.fireflies.splice(i--, 1);

            app.painter.reset();
            app.painter.color(0xffffff);
            app.painter.fillCircle(x, y, 2);

        }

    }

};

/* file: script/modules/State.js */

CLIENT.State = function(parent, states) {

    this.parent = parent;

    this.current = {};
    this.states = states;

    this.data = {};
    this.runs = new Set;
    this.timeout = 0;
    this.timeoutArgs = [];

    this.lifetime = 0;
    this.elapsed = 0;

};

CLIENT.State.prototype = {

    runOnce: function(timeout) {

        if (!this.runs.has(timeout) && this.elapsed > timeout) {

            this.runs.add(timeout);

            return true;

        }

        return false;

    },

    setTimeout: function(state, timeout, a, b, c) {

        this.timeoutArgs[0] = state;
        this.timeoutArgs[2] = a;
        this.timeoutArgs[3] = b;
        this.timeoutArgs[4] = c;

        this.timeout = this.lifetime + timeout;

    },

    set: function(state, a, b, c) {

        this.timeout = 0;

        this.prev = this.key;

        if (typeof state === "string") {

            this.key = state;

            state = this.states[state];

        }

        // if (state === this.current) return;

        if (this.current && this.current.leave) this.current.leave(this.parent, this, a, b, c);

        if (typeof state === "function") state = new state;

        this.lifetime = 0;
        this.elapsed = 0;

        this.current = state;

        this.runs.clear();

        if (this.current && this.current.enter) this.current.enter(this.parent, this, a, b, c);

    },

    step: function(dt) {

        this.lifetime += dt;
        this.elapsed += dt;

        if (this.timeout && this.lifetime >= this.timeout) {

            this.set(this.timeoutArgs[0], this.timeoutArgs[1], this.timeoutArgs[2], this.timeoutArgs[3]);

        }

        if (this.current && this.current.step) this.current.step(this.parent, this, dt);

    },

    call: function(methodName, a, b, c) {

        if (this.current && this.current[methodName]) this.current[methodName](this.parent, this, a, b, c);

    },

    once: function() {

    },

    back() {

        this.set(this.prev);

    }

};

/* file: script/modules/Tween.js */

NAMESPACE.Tween = function(context) {

    this.context = context;

    this.tweensMap = new Map;
    this.tweensArray = [];

    this.easing = "linear";

};

NAMESPACE.Tween.LINEAR = 0;
NAMESPACE.Tween.CIRC = 1;

NAMESPACE.Tween.prototype = {

    to: function(property, value, duration, mode = 0) {

        if (!duration) {

            this.context[property] = value;

            return;

        }

        var tween = this.tweensMap.get(property);

        if (!tween) {

            var tween = {

            };

            this.tweensMap.set(property, tween)
            this.tweensArray.push(tween);

        }

        tween.property = property;
        tween.before = this.context[property];
        tween.after = value;
        tween.duration = duration;
        tween.lifetime = 0;
        tween.mode = mode;

        if (tween.mode === NAMESPACE.Tween.LINEAR) {

            tween.diff = value - tween.before;

        } else if (tween.mode === NAMESPACE.Tween.CIRC) {

            tween.diff = Utils.circDistance(value, tween.before);

        }

    },

    step: function(dt) {

        for (var i = 0; i < this.tweensArray.length; i++) {

            var tween = this.tweensArray[i];

            tween.lifetime += dt;

            var progress = tween.lifetime / tween.duration;

            if (progress > 1.0) progress = 1.0;

            if (tween.mode === NAMESPACE.Tween.LINEAR) {

                this.context[tween.property] = tween.before + tween.diff * app.ease(progress, this.easing);

            } else if (tween.mode === NAMESPACE.Tween.CIRC) {

                this.context[tween.property] = Utils.circWrapTo(tween.before, tween.after, tween.diff * app.ease(progress, this.easing));

            }

            if (progress === 1.0) {

                this.tweensMap.delete(tween.property);
                this.tweensArray.splice(i--, 1);

            }

        }

    }

};

/* file: script/entities/Animal.js */

NAMESPACE.Animal = function(args) {

    this.lifetime = Math.random();
    this.fallDirection = 0;

    this.speed = 1.0;

    this.x = Math.random() * 100;
    this.y = Math.random() * 100;
    this.z = 0;
    this.i = 0;
    this.ox = 0;
    this.oy = 0;
    this.force = 0;
    this.forceDirection = 0;
    this.direction = Math.random() * 6;

    this.destinationDistance = 0;

    this.dead = false;

    this.destination = {};
    this.lookAt = null;

    Object.assign(this, args);

    this.tween = new CLIENT.FollowingTween(this);

    this.group = this.collection.sid(this.shared.group_sid);

    this.inX = Utils.random(-16, 16);
    this.inY = Utils.random(-16, 16);

    if (this.group) {

        this.x = this.group.x + Utils.random(-16, 16);
        this.y = this.group.y + Utils.random(-16, 16);

        this.group.addMember(this);

    } else {

        this.x = args.shared.x + Utils.random(-COMMON.TRIBE_RADIUS * 0.5, COMMON.TRIBE_RADIUS * 0.5);
        this.y = args.shared.y + Utils.random(-COMMON.TRIBE_RADIUS * 0.5, COMMON.TRIBE_RADIUS * 0.5);

    }

    this.state = new CLIENT.State(this, CLIENT.Animal.Rabbit);

    this.sprite = new CLIENT.Sprite;
    this.sprite.set("rabbit/run");
    this.sprite.loop = true;

    this.random = Math.random();

    this.task = 0;
    this.detail = 0;

    this.destination.x = this.x;
    this.destination.y = this.y;

    this.moveGrass = true;

    this.sin = Math.sin(this.random * 6.28);
    this.cos = Math.cos(this.random * 6.28);

    this.palette = Utils.random(0, 2);

    if (this.palette > 0) this.palette += COMMON.ANIMAL_PALETTE - 1;

    this.sprite.palette = this.palette;

    this.update(this.shared);

};

NAMESPACE.Animal.prototype = {

    constructor: NAMESPACE.Animal,

    zIndex: 1,

    radius: 8,
    collisionRadius: 1,

    shape: COMMON.CIRCLE,

    systemLight: 12,
    systemShadow: 5,

    tooltip: "A minion with a bow\ncan hunt down animals.",

    groups: ["interactive"],

    _destruct: function() {

    },

    enterview() {

        this.updateTask();

    },

    getScore() {

        return 1;

    },

    handleHit(damage, projectile) {


        if (this.inView) {

            app.sound.play("animal/rabbit/pain").rate(6.0).rrate(0.1).gpan(this);

        }

        /*
        if (this.state.key !== "run") {

          this.sprite.set("rabbit/alert");
          this.sprite.loop = false;
          this.sprite.duration = 0.25;

        }

        */

        this.hitLifespan = 0.4;

        let blood = this.collection.add("Sprite");

        blood.follow = this;
        blood.set("fx/blood_1");
        blood.duration = 0.5;
        blood.rotation = Math.random() * 6.28;
        blood.scale.x = 0.35;
        blood.scale.y = 0.35;

    },

    die() {

        this.state.set("dead");

        this.dead = true;

        if (this.inView) app.sound.play("animal/rabbit/death").rate(4.0).rrate(0.1).gpan(this);

    },

    get groupInView() {

        return true;

        return (this.group && this.group.inView) || this.inView;

    },

    update(data) {

        if (data.remove) {

            if (this.groupInView) {

                this.lifespan = 5.0;

                app.tween(this.sprite).delay(3.0).to({
                    creation: 1.0
                }, 2.0);

            } else {

                this.collection.remove(this);

            }

        }

        if (data.health !== undefined) {

            if (data.health < this.shared.health) {



            }

            if (data.health <= 0) this.die();

        }

        if (data.status !== undefined) {

            if (data.status & COMMON.STATUS.LOOTED) {

                // this.setKind("corpse");

            }

        }

        if (data.x !== undefined && !this.inView) this.x = data.x;
        if (data.y !== undefined && !this.inView) this.y = data.y;

        if (!this.dead && data.occupation !== undefined) {

            this.task = data.occupation % 100;
            this.detail = data.occupation / 100 % 10000000 | 0;

            this.updateTask();

        }

        Object.assign(this.shared, data);

    },

    updateTask() {

        if (this.task === COMMON.TASKS.RUN) {

            this.state.set("run");

        } else if (this.task === COMMON.TASKS.FIGHT) {

        } else if (this.task === COMMON.TASKS.EAT) {

            this.state.set("eat");

        } else if (this.task === COMMON.TASKS.RECOVER) {

            this.state.set("recover");

        } else {

            this.state.set("idle");

        }

    },

    step(dt) {

        if (!this.inView) {

            // && (!this.groupInView || !Utils.quickPointInRange(this.group.x, this.group.y, this.x, this.y, COMMON.TRIBE_RADIUS))

            if (this.group) {

                this.x = this.group.x;
                this.y = this.group.y;

                this.destination.x = this.x;
                this.destination.y = this.y;

            }

            return;

        }


        this.lifetime += dt;

        this.state.step(app.elapsed);

        if (this.force) {

            this.force = Utils.moveTo(this.force, 0, 200 * dt);

            this.x += Math.cos(this.forceDirection) * this.force * dt;
            this.y += Math.sin(this.forceDirection) * this.force * dt;

        }

        if (this.hitLifespan > 0.0) this.hitLifespan -= dt;

        this.tween.step(dt);


        if (!this.dead) {

            this.processTask(dt);

            let distance = Utils.distance(this, this.destination);

            this.destinationDistance = distance;

            if (distance > 1) {

                if (!this.inView) this.speed = 1.0;

                let destinationAngle = Utils.lookAt(this, this.destination);

                this.x += Math.cos(destinationAngle) * (distance + 8) * dt * this.speed;
                this.y += Math.sin(destinationAngle) * (distance + 8) * dt * this.speed;

            }

            if (this.lookAt) {

                if (typeof this.lookAt === "number") {

                    this.direction = Utils.circWrapTo(this.direction, this.lookAt, 6 * app.elapsed);

                } else {

                    this.direction = Utils.circWrapTo(this.direction, Utils.lookAt(this, this.lookAt), 6 * app.elapsed);

                }

            }

            CLIENT.Animal.Rabbit.movement(this);

        }

    },

    processTask(dt) {

        if (this.task === COMMON.TASKS.RUN) {

            this.destination.x = this.group.x + this.inX;
            this.destination.y = this.group.y + this.inY;

            this.lookAt = this.destination;

        } else if (this.task === COMMON.TASKS.LOOT) {

        } else {

            // this.x = this.group.x;
            // this.y = this.group.y;

        }

    },

    render() {

        let row = Utils.dirrow(this.direction, 16);

        if (this.hitLifespan > 0.0) {

            if (app.lifetime % 0.1 < 0.05) this.sprite.color.set(0xffffff, 1.0);
            else this.sprite.color.set(0, 0);

        } else {

            this.sprite.color.set(0, 0);

        }

        this.sprite.step(app.elapsed);

        this.sprite.x = this.x + this.ox;
        this.sprite.y = this.y - this.z + this.oy - 6;
        this.sprite.row = row;

        this.sprite.render();


        /*
        if (this.task === COMMON.TASKS.RUN) {
          app.painter.reset();
          app.painter.color(0xaaff00);
          app.painter.alpha(0.25);
          app.painter.fillCircle(this.x, this.y, 10)
        }


        if (this.task === COMMON.TASKS.EAT) {
          app.painter.reset();
          app.painter.alpha(0.25);

          app.painter.color(0x00aaff);
          app.painter.fillCircle(this.x, this.y, 10)
        }

        */

    }

};

/* file: script/entities/Animal.Rabbit.js */

CLIENT.Animal.Rabbit = {};

CLIENT.Animal.Rabbit.movement = function(rabbit) {

    if (rabbit.destinationDistance > 2) {

        rabbit.speed = (rabbit.sprite.frame >= 1 && rabbit.sprite.frame < 6) ? 0.5 * (5 - rabbit.sprite.frame) : 0.0;
        rabbit.sprite.z = rabbit.speed * 2;

    } else rabbit.sprite.z = 0.0;

};

CLIENT.Animal.Rabbit.run = {

    enter(rabbit, manager) {

        rabbit.speed = 1.0;

        rabbit.sprite.set("rabbit/run");
        rabbit.sprite.loop = true;
        rabbit.sprite.duration = 0.5;
        rabbit.sprite.delay = Math.random();

    },

    step(rabbit) {


    }

};


CLIENT.Animal.Rabbit.eat = {

    enter(rabbit, manager) {

        manager.data.meadow = rabbit.collection.sid(rabbit.detail);
        manager.data.grass = null;
        manager.data.change_grass_timeout = Utils.random(5, 16);
        manager.data.delay = Math.random() * 2.0;

    },

    leastEaten(o) {

        return o.temp.eaten;

    },

    step(rabbit, manager, dt) {

        let data = manager.data;

        if (data.delay > 0) return data.delay -= dt;

        if (!data.meadow) return;

        if (data.grass && data.grass._remove) data.grass = null;
        if (data.grass && data.grass.creation) data.grass = null;

        if (Utils.interval(rabbit, "change_grass", manager.data.change_grass_timeout)) {

            manager.data.change_grass_timeout = Utils.random(5, 16);
            data.grass = null;

        }

        if (!data.grass && data.meadow.grass.length) {

            data.grass = Utils.random(data.meadow.grass);

            // Utils.minBy(data.meadow.grass, this.leastEaten);
        }

        if (data.grass) {

            rabbit.destination.x = data.grass.x + rabbit.sin * 8;
            rabbit.destination.y = data.grass.y + rabbit.cos * 8;
            rabbit.lookAt = data.grass;

            if (rabbit.destinationDistance > 2 && rabbit.sprite.key !== "rabbit/run") {

                rabbit.sprite.set("rabbit/run");
                rabbit.sprite.loop = true;
                rabbit.sprite.duration = 0.5;

            }

            if (rabbit.destinationDistance <= 2 && rabbit.sprite.key !== "rabbit/idle") {

                rabbit.sprite.set("rabbit/idle");
                rabbit.sprite.loop = true;
                rabbit.sprite.duration = 1.0;

            }

            if (rabbit.destinationDistance <= 2) {

                data.grass.temp.eaten = 1.0;
                data.grass.offsetX = Math.sin(app.lifetime * 2);
                data.grass.offsetY = Math.cos(app.lifetime * 4);

            }

        }

    }

};


CLIENT.Animal.Rabbit.idle = {

    enter(rabbit, manager) {

        manager.data.moveCooldown = Math.random() * 5.0;
        manager.data.alertCooldown = 1.0 + Math.random() * 5.0;
        manager.data.rotationTimeout = Math.random() * 2.0;
        manager.data.lifetime = 0.0;

        rabbit.sprite.set("rabbit/run");
        rabbit.sprite.loop = true;
        rabbit.sprite.duration = 5.5;
    },

    step(rabbit, manager, dt) {

        if (manager.data.delay > 0) {

            manager.data.delay -= dt;

            return;

        }

        manager.data.lifetime += dt;

        if (Utils.interval(manager.data, "think", 0.1)) {

            if (Utils.interval(manager.data, "change_position", manager.data.moveCooldown)) {

                manager.data.moveCooldown = 3.0 + Math.random() * 8.0;
                manager.data.alertCooldown = 1.0 + Math.random() * 10.0;

                if (rabbit.group) {

                    rabbit.destination.x = rabbit.group.x + Utils.random(-50, 50);
                    rabbit.destination.y = rabbit.group.y + Utils.random(-50, 50);

                }

                return;

            }

            if (rabbit.destinationDistance > 2) {

                rabbit.lookAt = rabbit.destination;

                if (rabbit.sprite.key !== "rabbit/run") {
                    rabbit.sprite.set("rabbit/run");
                    rabbit.sprite.loop = true;
                    rabbit.sprite.duration = 0.5;
                }

            } else {

                if (Utils.interval(manager.data, "alert", manager.data.alertCooldown)) {

                    manager.data.delay = 1.0 + Math.random() * 3.0;
                    manager.data.alertCooldown = manager.data.delay + 1.0 + Math.random() * 10.0;

                    rabbit.sprite.set("rabbit/alert");
                    rabbit.sprite.duration = 0.25;

                } else if (rabbit.sprite.key !== "rabbit/idle") {

                    rabbit.sprite.set("rabbit/idle");
                    rabbit.sprite.loop = true;
                    rabbit.sprite.duration = 1.0;
                    manager.data.delay = 1.0;

                }

                if (Utils.interval(manager.data, "rotation_timeout", manager.data.rotationTimeout)) {

                    manager.data.rotationTimeout = 0.5 + Math.random() * 2.0;

                    rabbit.lookAt = Math.random() * 6.28;

                }

            }

        }

    }

};

CLIENT.Animal.Rabbit.dead = {

    enter(rabbit) {

        rabbit.zIndex = 0;

        rabbit.sprite.set("rabbit/death");
        rabbit.sprite.loop = false;
        rabbit.sprite.duration = 0.5;

        rabbit.force = Utils.random(100, 180);
        rabbit.forceDirection = rabbit.fallDirection;

    },

    step(rabbit, manager) {

        if (manager.elapsed < 0.5) {

            if (Math.random() > 0.5) {

                let blood = rabbit.collection.add("Sprite");

                blood.x = rabbit.x;
                blood.y = rabbit.y;
                blood.set("fx/blood_1");
                blood.duration = Utils.randomf(0.25, 1.0);
                blood.rotation = Math.random() * 6.28;

                let bloodScale = Utils.randomf(0.05, 0.2);

                blood.scale.x = bloodScale;
                blood.scale.y = bloodScale;

                app.tween(blood).to({
                    offsetY: -20 * Math.random()
                }, blood.duration * 0.3).to({
                    offsetY: 0
                }, blood.duration * 0.3);

            }

        }

    }

};

/* file: script/entities/Arrow.js */

CLIENT.Arrow = function(args) {

    this.x = 0;
    this.y = 0;
    this.z = 10;
    this.delay = 0;
    this.miss = false;
    this.straight = false;

    this.lifetime = 0;
    this.direction = 0;
    this.duration = 1.0;
    this.target = null;

    Object.assign(this, args);

    this.sprite = new CLIENT.Sprite;
    this.sprite.set("arrow");
    this.sprite.scale.x = 0.5;
    this.sprite.scale.y = 0.5;

    this.shadow = new CLIENT.Sprite;
    this.shadow.set("arrow");
    this.shadow.scale.x = 0.5;
    this.shadow.scale.y = 0.5;
    this.shadow.color = 0x000000;

    this.scale = 1.0;

    this.tween = new CLIENT.FollowingTween(this);
    this.targetOffsetX = 0;
    this.targetOffsetY = 0;



};

CLIENT.Arrow.prototype = {

    zIndex: 3,

    stretchMod: 5.0,

    run() {

        if (this.miss) {

            this.targetOffsetX = Utils.random(-16, 16);
            this.targetOffsetY = Utils.random(-16, 16);

        }

        this.tween.to(this.target, "x", "x", this.targetOffsetX, this.duration, "linear");
        this.tween.to(this.target, "y", "y", this.targetOffsetY, this.duration, "linear");

        if (!this.straight) {

            app.tween(this).to({
                z: this.duration * 20
            }, this.duration * 0.5, "outSine").to({
                z: 0
            }, this.duration * 0.5, "inSine");

            this.sprite.duration = this.duration;

        } else {

            this.sprite.duration = 0.01;

        }



    },

    shape: COMMON.CIRCLE,

    _destruct: function() {


    },

    step: function(dt) {

        if (this.delay > 0) return this.delay -= dt;

        if (this.hasHit) {

            // this.x = this.target.x;
            // this.y = this.target.y;

        } else {

            this.tween.step(dt);

        }

        this.lifetime += dt;


        if (this.lifetime > this.duration && !this.hasHit) {

            this.hasHit = true;

            if (!this.miss) {

                app.sound.play("bow/hit").rrate(0.1).gpan(this);

                if (this.target.handleHit) {

                    this.target.fallDirection = this.direction;
                    this.target.handleHit(0, this);



                }

            }

            let debris = this.collection.add("Sprite");

            debris.set("fx/debris");

            debris.scale.x = 0.3;
            debris.scale.y = 0.1;
            debris.rotation = this.direction - Math.HPI;
            debris.x = this.x;
            debris.y = this.y;
            debris.duration = 0.5;
            // debris.color = this.bullet.color;


            if (this.miss) {
                app.sound.play("weapon/arrow_miss").gpan(this).rate(1.5).rrate(0.3);
                // app.sound.play("weapon/arrow_rattle").gpan(this).rrate(0.2);
            }

            if (this.miss) {

                this.lifespan = 5.0;

            } else {

                this.collection.remove(this);

            }

        }


    },

    render: function(dt) {

        if (this.delay > 0) return this.delay -= dt;

        if (!this.hasHit) this.direction = Utils.lookAt(this.x, this.y, this.target.x + this.targetOffsetX, this.target.y + this.targetOffsetY);

        this.shadow.row = Utils.dirrow(this.direction, 16);
        this.shadow.x = this.x;
        this.shadow.y = this.y;
        this.shadow.alpha = 0.25;

        this.shadow.step(app.elapsed);
        this.shadow.render();

        this.sprite.row = Utils.dirrow(this.direction, 16);
        this.sprite.x = this.x;
        this.sprite.y = this.y - this.z;

        this.scale = 0.5 + this.z * 0.01;

        this.sprite.scale.x = this.scale;
        this.sprite.scale.y = this.scale;

        this.sprite.step(app.elapsed);
        this.sprite.render();

    }

};

/* file: script/entities/Bird.js */

CLIENT.Bird = function(args) {

    this.x = 0;
    this.y = 0;
    this.z = 40;
    this.speed = 64;
    this.delay = 0.0;
    this.key = "pigeon";
    this.lifetime = 0.0;
    this.flaptime = 0.0;

    this.direction = Math.random() * 6.28;

    Object.assign(this, args)

};

CLIENT.Bird.prototype = {

    constructor: CLIENT.Bird,

    shape: COMMON.CIRCLE,

    radius: 4,

    zIndex: 5,

    leaveview() {

        // this.lifespan = 2.0;

    },

    run() {

        app.sound.play("bird/takeoff").delay(0.25).gpan(this);
        app.sound.play("bird/" + this.key).rrate(0.2).gpan(this);

    },

    step(dt) {

        if (this.delay > 0) {

            this.delay -= dt;

            if (this.delay <= 0) this.run();

            return;

        }

        let flapmod = 1.0 + Math.max(0, 1.0 - this.lifetime / 1.0) * 6.0;

        this.flaptime += dt * this.speed * 0.3 * flapmod;

        this.lifetime += dt;

        this.x += Math.cos(this.direction) * this.speed * dt;
        this.y += Math.sin(this.direction) * this.speed * dt;

    },

    render() {

        if (this.delay > 0) return;


        let frame = this.flaptime;
        let row = Utils.dirrow(this.direction, 16);

        app.painter.reset();
        app.painter.alpha(0.25);
        app.painter.color(0x000000);
        app.painter.drawSprite("bird", this.x, this.y, frame, row);
        app.painter.color(this.key === "crow" ? 0x222034 : -1);
        app.painter.alpha(1.0);
        app.painter.drawSprite("bird", this.x, this.y - this.z, frame, row);

    }

}

/* file: script/entities/Bubble.js */

CLIENT.Bubble = function(args) {

    this.x = 0;
    this.y = 0;

    this.stretch = 0;

    Object.assign(this, args);

    this.image = new CLIENT.Image;
    this.image.setTexture("bubble");
    this.image.blendDst = app.gl.ONE;
    this.image.zIndex = 3;

    this.lifetime = 0;

    this.tween = new CLIENT.Tween(this);

    this.x = this.shared.x;
    this.y = this.shared.y;

    this.update(this.shared);


};

CLIENT.Bubble.prototype = {

    zIndex: 3,

    shape: COMMON.CIRCLE,

    radius: 16,

    update(data) {

        Object.assign(this.shared, data);

        if (data.x !== undefined) this.tween.to("x", data.x, COMMON.TWEEN_DURATION);
        if (data.y !== undefined) this.tween.to("y", data.y, COMMON.TWEEN_DURATION);

        if (data.remove) this.lifespan = COMMON.TWEEN_DURATION;

    },

    step(dt) {

        if (this.stretch > 0) this.stretch -= dt * 2.0;

        let s = 0.3 + (this.shared.size / 2) * 0.7;

        this.image.scale.x = s + Math.sin(app.lifetime * 30) * (0.1 + this.stretch);
        this.image.scale.y = s + Math.cos(app.lifetime * 30) * (0.1 + this.stretch);

        this.tween.step(dt);

    },

    render() {

        this.image.x = this.x;
        this.image.y = this.y;

        this.image.render();

    }

};

/* file: script/entities/Building.js */

CLIENT.Building = function(args) {

    this.x = 0;
    this.y = 0;
    this.lifetime = 0;

    Object.assign(this, args);

    this.update(this.shared);

};

CLIENT.Building.prototype = {

    sprite: [144, 94, 59, 56],

    zIndex: 1,

    shape: COMMON.CIRCLE,
    radius: 30,
    collisionRadius: 30,
    interactiveRadius: 30,

    heavy: true,

    groups: ["obstacle", "interactive"],

    tooltip: "building",

    clickable: true,

    get def() {

        return COMMON.items[this.shared.key]

    },

    pointerup() {

        if (this.def.trade) {

            let trade = this.def.trade;

            if (this.game.playerData.resources[trade[0]] < trade[1]) {
                return this.game.errorMessage(`Not enough ${trade[0]}`);

            }

            app.sound.play("action/purchase");

            this.game.action.set("snap");

            if (trade[0] === "gold")
                this.game.fxCoin();
            else
                this.game.fxToss(trade[0]);


            this.game.send("interact", {
                entity_sid: this.sid
            })

        }

    },

    enterview() {

        if (this.shared.key === "windmill") {

            this.soundLoop = app.sound.play("building/windmill_loop").loop().rate(0.8).volume(0.4);

        }
        if (!this.circle) {

            this.circle = this.collection.add("Circle");
            this.circle.program = app.programs.meadow;
            this.circle.x = this.x;
            this.circle.y = this.y + 32;
            this.circle.radius = 60;
            this.circle.scale.y = 0.75;
            this.circle.zIndex = -2;
            this.circle.texture = app.textures.spritesheet;
            this.circle.color.set(0x7e7d4e);

        }

    },

    leaveview() {

        if (this.soundLoop) {

            this.soundLoop.fadeOut(0.5);
            this.soundLoop = null;

        }

    },

    step(dt) {

        this.lifetime += dt;

        if (this.shared.key === "windmill" && this.inView && Utils.interval(this, "woof", 1.7)) {

            app.sound.play("building/windmill_sail").gpan(this).volume(0.5);

        }

        if (this.soundLoop) this.soundLoop.gpan(this);

    },

    update(data) {

        Object.assign(this.shared, data);

        this.x = this.shared.x;
        this.y = this.shared.y;

    },

    windmill() {

        app.painter.reset();

        // app.painter.drawImageRegion(app.textures.spritesheet, ...this.sprite, this.x, this.y);

        app.painter.drawImageRegion(app.textures.spritesheet, 57, 96, 23, 19, this.x - 28, this.y + 4);


        app.painter.color(0x000000);
        app.painter.alpha(0.25);
        app.painter.rotate(Math.PI * 0.25);
        app.painter.align(0.4, 0.6);
        app.painter.drawSprite("building/windmill", this.x, this.y, app.lifetime * 6.0);
        app.painter.reset();
        app.painter.drawSprite("building/windmill", this.x, this.y, app.lifetime * 6.0);
        app.painter.drawSprite("building/windmill_flour", this.x - 12, this.y + 14, app.lifetime * 8.0);

        /*
    app.painter.range(2, 7);
    app.painter.drawSprite("tribesman/male/sit", this.x + 4, this.y + 20, app.lifetime * 3.0, 3);
    app.painter.drawSprite("tribesman/axe/sit", this.x + 4, this.y + 20, app.lifetime * 3.0, 3);
    app.painter.range();
    app.painter.color(0x9badb7);
    app.painter.drawSprite("fx/smoke_column", this.x, this.y - 38, app.lifetime * 10.0);
    */

        // app.painter.range(2, 7);

        app.painter.drawSprite("tribesman/male/operate_ground", this.x + 16, this.y + 17, app.lifetime * 3.0, 3);
        app.painter.drawSprite("tribesman/scythe/operate_ground", this.x + 16, this.y + 17, app.lifetime * 3.0, 3);
        app.painter.drawImageRegion(app.textures.spritesheet, 72, 56, 17, 18, this.x + 8, this.y + 28);

    },

    lumberjack() {

        app.painter.reset();

        // app.painter.drawImageRegion(app.textures.spritesheet, ...this.sprite, this.x, this.y);

        app.painter.color(0x000000);
        app.painter.alpha(0.25);
        app.painter.rotate(Math.PI * 0.25);
        app.painter.align(0.4, 0.6);
        app.painter.drawSprite("building/lumberjack", this.x, this.y, app.lifetime * 6.0);

        app.painter.reset();
        app.painter.drawSprite("building/lumberjack", this.x, this.y - 6, app.lifetime * 6.0);

        app.painter.drawImageRegion(app.textures.spritesheet, 57, 76, 23, 19, this.x - 28, this.y + 16);

        app.painter.range(2, 7);
        app.painter.drawSprite("tribesman/male/sit", this.x + 4, this.y + 20, app.lifetime * 3.0, 3);
        app.painter.drawSprite("tribesman/axe/sit", this.x + 4, this.y + 20, app.lifetime * 3.0, 3);
        app.painter.range();
        app.painter.color(0x9badb7);
        app.painter.drawSprite("fx/smoke_column", this.x, this.y - 38, app.lifetime * 10.0);


    },

    render() {

        this[this.shared.key]();

    }

};

/* file: script/entities/Bullet.js */

CLIENT.Bullet = function(args) {

    this.x = 0;
    this.y = 0;
    this.ex = 0;
    this.ey = 0;

    Object.assign(this, {

        damage: 1.0,
        radius: 3,
        innerRadius: 3,
        width: 0.25,
        length: 1.0,
        range: 600,
        dyingMod: 1.0,
        mining: 0.0

    }, args);

    this.bullet = this.bullets[Utils.random(1, 6)];

    this.image = new CLIENT.Image;
    this.image.setTexture("spritesheet");
    this.image.setRegion(...this.bullet.sprite);

    this.lifetime = 0;
    this.direction = 0;
    this.distance = 0;
    this.duration = 1.0;
    this.finalDuration = 1.0;

    this.tween = new CLIENT.FollowingTween(this);
};

CLIENT.Bullet.prototype = {

    zIndex: 3,

    stretchMod: 5.0,


    bullets: {

        "1": {
            color: 0xffc400,
            sprite: [182, 9, 6, 25]
        },
        "2": {
            color: 0x86e423,
            sprite: [191, 9, 6, 25]
        },
        "3": {
            color: 0x36dbff,
            sprite: [200, 9, 6, 25]
        },
        "4": {
            color: 0xbe3dff,
            sprite: [209, 9, 6, 25]
        },
        "5": {
            color: 0x36dbff,
            sprite: [183, 40, 10, 16]
        },
        "6": {
            color: 0xff6900,
            sprite: [201, 42, 19, 22]
        }
    },

    // sprite: [5, 33, 32, 7],
    // sprite: [1, 44, 90, 12],

    run() {

        this.distance = Utils.distance(this, this.target);

        this.finalDuration = this.duration * 1.25;

        let rx = Utils.random(-8, 8);
        let ry = Utils.random(-8, 8);

        this.direction = Utils.lookAt(this, this.target);

        this.x = this.x + Math.cos(this.direction) * 16;
        this.y = this.y + Math.sin(this.direction) * 16;
        this.ex = this.x + Math.cos(this.direction - Math.PI) * 16;
        this.ey = this.y + Math.sin(this.direction - Math.PI) * 16;

        this.tween.to(this.target, "x", "x", 0, this.duration, "inSine");
        this.tween.to(this.target, "y", "y", 0, this.duration, "inSine");
        this.tween.to(this.target, "ex", "x", 0, this.finalDuration, "inSine");
        this.tween.to(this.target, "ey", "y", 0, this.finalDuration, "inSine");

        let muzzle = this.collection.add("Sprite");

        muzzle.set("fx/muzzle");

        muzzle.rotation = this.direction - Math.HPI;
        muzzle.x = this.x;
        muzzle.y = this.y;
        muzzle.duration = 0.25;
        muzzle.color = this.bullet.color;


    },

    shape: COMMON.CIRCLE,

    _destruct: function() {


    },

    step: function(dt) {

        this.tween.step(dt);

        this.lifetime += dt;

        if (this.lifetime > this.finalDuration) {

            this.collection.remove(this);

        }

        if (this.lifetime > this.duration && !this.hasHit) {

            this.hasHit = true;

            let debris = this.collection.add("Sprite");

            debris.set("fx/debris");

            debris.scale.x = 0.5;
            debris.scale.y = 0.2;
            debris.rotation = this.direction - Math.HPI;
            debris.x = this.x;
            debris.y = this.y;
            debris.duration = 0.5;
            debris.color = this.bullet.color;

        }

        if (this.hasHit) {

            this.x = this.target.x;
            this.y = this.target.y;

        }

    },

    render: function(dt) {

        this.radius = this.bullet.sprite[3];

        let len = Utils.distance(this.x, this.y, this.ex, this.ey);

        this.image.scale.x = 0.25 + (this.lifetime / this.duration) * 0.25;
        this.image.scale.y = len / this.bullet.sprite[3];
        this.image.rotation = Utils.lookAt(this.ex, this.ey, this.x, this.y) + Math.HPI;
        this.image.x = this.x;
        this.image.y = this.y;
        this.image.pivot.y = 0.0;
        this.image.pivot.x = 0.5;
        this.image.render();

    }

};

/* file: script/entities/Campfire.js */

CLIENT.Campfire = function(args) {

    this.x = 0;
    this.y = 0;

    this.putDown();

    Object.assign(this, args);

    this.update(this.shared);

    this.sprite = new CLIENT.Sprite();
    this.sprite.set("campfire");
    this.sprite.loop = true;
    this.sprite.duration = 2.0;
    this.sprite.scale.x = 0.6;
    this.sprite.scale.y = 0.75;

    this.sprite.pivot.y = 1.0;

    this.image = new CLIENT.Image();
    this.image.setTexture("spritesheet");
    this.image.setRegion(0, 0, 17, 14);

    this.image.creation = 1.0;

    app.tween(this.image).to({
        creation: 0.0
    }, 0.5);


    this.clickable = true;

};

CLIENT.Campfire.prototype = {

    constructor: CLIENT.Campfire,

    shape: COMMON.CIRCLE,

    heavy: true,

    zIndex: 1,

    radius: 20,
    collisionRadius: 20,

    groups: ["obstacle", "interactive"],

    systemLight: 32,
    systemShadow: 8,

    pointerup() {

        let game = this.game;

        game.cursor.set("snap");
        game.cursor.duration = 0.25;

        app.sound.play("snap")

        game.send("lightCampfire", {
            sid: this.sid
        });

    },

    enterview() {

    },

    leaveview() {

    },

    update(data) {

        if (data.x !== undefined) this.x = data.x;
        if (data.y !== undefined) this.y = data.y;

        if (data.remove) {

            this.collection.remove(this);

        }

        if (data.state !== undefined) {

            if (data.state && !this.shared.state) {

                this.lightUp();

            }

            if (!data.state && this.shared.state) {

                this.putDown();

            }

        }

        Object.assign(this.shared, data);

    },

    lightUp() {

        this.clickable = false;

        if (this.inView) app.sound.play("flame").volume(0.5).fadeOut(1.0).rate(1.6).gpan(this);

        this.sprite.scale.x = 0.1;
        this.sprite.scale.y = 0.25;

        app.tween(this.sprite.scale).to({
            x: 0.6,
            y: 0.75
        }, 1.0);

        this.tooltip = "Come closer and sit by the campfire";



    },

    putDown() {

        this.tooltip = "Light it up";

        this.clickable = true;

    },

    step(dt) {

    },

    render() {

        this.image.x = this.x;
        this.image.y = this.y;
        this.image.render();

        this.sprite.step(app.elapsed);

        this.sprite.x = this.x;
        this.sprite.y = this.y;

        if (this.shared.state) this.sprite.render();

    }

};

/* file: script/entities/Circle.js */

NAMESPACE.Circle = function(args) {

    this.texture = null;

    this.x = 0;
    this.y = 0;
    this.radius = 1;

    this.lifetime = 0;
    this.alpha = 1.0;

    this.random = Math.random();

    this.color = app.color(0xffffff, 1.0);

    this.blendSrc = app.gl.SRC_ALPHA;
    this.blendDst = app.gl.ONE_MINUS_SRC_ALPHA;

    this.modelMatrix = Matrix3.create();

    this.scale = {
        x: 1.0,
        y: 1.0
    };

    this.program = app.programs.circle;

    this.folow = null;

    this.special = 0;
    Object.assign(this, args);

};

Object.assign(NAMESPACE.Circle.prototype, {

    zIndex: -1,

    shape: COMMON.CIRCLE,

    step(dt) {

        this.lifetime += dt;

        if (this.follow) {

            this.x = this.follow.x;
            this.y = this.follow.y;

            if (this.follow._remove) this.collection.remove(this);

            if (this.special === 1 && !this.follow.systemLight) this.collection.remove(this);
            if (this.special === 2 && !this.follow.systemShadow) this.collection.remove(this);

        }

    },

    render() {

        if (this.follow && this.follow.hidden) return;

        let gl = app.gl;

        /* Alpha */

        gl.enable(gl.BLEND);
        // gl.blendFunc(this.blendSrc, this.blendDst);
        // gl.blendFunc(gl.ONE, gl.ONE);
        // gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);
        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);
        // gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);


        /* Assign shaders */

        gl.useProgram(this.program.native);

        /* Position */

        gl.enableVertexAttribArray(this.program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(this.program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        if (this.texture) {

            gl.activeTexture(gl.TEXTURE0);

            gl.bindTexture(gl.TEXTURE_2D, this.texture);

            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

            this.program.set("texture", 0);

        }

        gl.enableVertexAttribArray(this.program.locations.uv);

        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(this.program.locations.uv, 2, gl.FLOAT, false, 0, 0);
        let radius = this.radius;
        // + Math.sin(app.lifetime * 10) | 0
        if (this.color === 0) radius = this.radius;
        this.program.set("radius", radius);
        this.program.set("color", this.color.r, this.color.g, this.color.b, this.color.a * this.alpha);

        var matrix = Matrix3.create();

        Matrix3.translate(matrix, this.x, this.y);
        Matrix3.translate(matrix, (-radius) * this.scale.x | 0, (-radius) * this.scale.y | 0);
        if (this.scale.x !== 1.0 || this.scale.y !== 1.0) Matrix3.scale(matrix, this.scale.x, this.scale.y);

        this.program.set("modelMatrix", matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    }

});

/* file: script/entities/Cloud.js */

CLIENT.Cloud = function(args) {


    this.raining = false;
    this.x = 0;
    this.y = 0;
    this.z = 64;
    this.target = null;

    this.tween = new CLIENT.Tween(this);

    Object.assign(this, args);

    this.update(this.shared);

    this.x = this.shared.sharedX;
    this.y = this.shared.sharedY;

    this.soundLoop = null;

};

CLIENT.Cloud.prototype = {

    zIndex: 4,

    shape: COMMON.CIRCLE,

    radius: 50,

    constructor: CLIENT.Cloud,

    enterview() {

    },

    leaveview() {

        this.stopSoundLoop();

    },


    stopSoundLoop() {

        if (this.soundLoop) {

            this.soundLoop.fadeOut(1);

            this.soundLoop = false;

        }

    },

    update(data) {

        if (this.inView) {

            if (data.sharedX !== undefined) this.tween.to("x", data.sharedX, 1.0);
            if (data.sharedY !== undefined) this.tween.to("y", data.sharedY, 1.0);

        }

        if (data.target_sid !== undefined) this.target = this.collection.sid(this.shared.target_sid);

        Object.assign(this.shared, data);

        if (!this.inView) {
            this.x = this.shared.sharedX;
            this.y = this.shared.sharedY;
        }


    },

    render() {

        app.painter.reset();
        app.painter.rotate(2.5);
        app.painter.color(0x000000);
        app.painter.alpha(0.25);
        app.painter.drawSprite("cloud", this.x, this.y, app.lifetime * 10);
        app.painter.color(0, 0);
        app.painter.alpha(0.8);
        app.painter.drawSprite("cloud", this.x, this.y - this.z, app.lifetime * 10);

        let prevRaining = this.raining;

        this.raining = this.target && Utils.quickPointInRange(this.x, this.y, this.target.x, this.target.y, 64);

        if (this.raining && !prevRaining) {

            this.soundLoop = app.sound.play("ambient/rain").fadeIn(1.0).loop().rrate(0.5).volume(0.0);

        }

        if (prevRaining && !this.raining) {
            this.stopSoundLoop();
        }

        if (this.raining) {

            let raindrop = this.collection.add("Sprite");

            raindrop.set("fx/raindrop");
            raindrop.duration = 0.5;
            raindrop.blendDst = app.gl.ONE;
            raindrop.color.set(Utils.random([0x639bff, 0xcbdbfc]));
            raindrop.alpha = 0.5;
            // raindrop.range = [0, 8];
            // raindrop.rotation = 0.5;
            raindrop.z = this.z;
            // raindrop.range = [4, 10];
            raindrop.x = this.x + Utils.random(-32, 32);
            raindrop.y = this.y + Utils.random(-32, 32);
            raindrop.zIndex = this.zIndex;

            app.tween(raindrop).to({
                z: 0,
                rotation: Utils.randomf(-0.5, 0.5)
            }, 0.1);

            if (this.soundLoop) this.soundLoop.volume(0.3);

        }

    },

    step(dt) {

        this.tween.step(dt);

        if (this.soundLoop) this.soundLoop.gpan(this);

    }

};

/* file: script/entities/Collectible.js */

CLIENT.Collectible = function(args) {

    this.hidden = false;

    this.x = 0;
    this.y = 0;
    this.z = 0;
    this.scale = 1.0;

    this.random = Math.random();

    Object.assign(this, args);

    this.update(this.shared);

    this.def = COMMON.items[this.shared.key];

    this.moveGrass = true;

    if (this.shared.key === "chest") {

        this.groups = ["radar"];
        this.radar = {
            color: 0xffe000,
            size: 1
        }

    }

};

CLIENT.Collectible.prototype = {

    constructor: CLIENT.Collectible,

    shape: COMMON.CIRCLE,

    heavy: true,

    zIndex: 1,

    radius: 1,

    systemShadow: 5,

    beingCollected(by) {

        app.sound.play("action/collect").gpan(this);

        // if (this.def.score && by.group === app.game.player) app.game.score(this.def.score, this.x, this.y);

    },

    enterview() {

        this.image = new CLIENT.Image();
        this.image.setTexture("spritesheet");
        this.image.setRegion(...this.def.sprite);

        app.tween(this).to({
            z: 30
        }, 0.25, "outSine").to({
            z: 0
        }, 0.35, "outBounce");

        app.tween(this).to({
            x: this.x + Math.cos(this.random * Math.TAU) * 32,
            y: this.y + Math.sin(this.random * Math.TAU) * 32
        }, 0.6);

    },

    leaveview() {

    },

    update(data) {

        if (data.x !== undefined) this.x = data.x;
        if (data.y !== undefined) this.y = data.y;

        if (data.from !== undefined) {

            let from = this.collection.sid(data.from);

            if (from) {

                this.x = from.x;
                this.y = from.y;

            }

        }

        Object.assign(this.shared, data);

        if (data.remove) this.lifespan = 2.0;

    },

    blink() {

        let debris = this.collection.add("Sprite");

        debris.set("fx/blink");
        debris.follow = this;
        debris.duration = 0.25;
        debris.scale.x = 0.5;
        debris.scale.y = 0.5;
        debris.z = this.z;
        debris.zIndex = 1;

    },

    step(dt) {

    },

    render() {

        this.image.x = this.x;
        this.image.y = this.y - this.z;
        this.image.scale.x = this.image.scale.y = (1.0 + this.z * 0.02) * this.scale;
        this.image.render();

        this.zIndex = (this.z > 0) * 1.0;

    }

};

/* file: script/entities/Fleet.js */

CLIENT.Tribe = function(args) {

    this.x = 0;
    this.y = 0;

    Object.assign(this, args);

    this.tween = new CLIENT.Tween(this);

    this.update(this.shared);

};

CLIENT.Tribe.prototype = {

    constructor: CLIENT.Tribe,

    shape: COMMON.CIRCLE,

    radius: 100,

    enterview() {

    },

    leaveview() {

    },

    addMember(ship) {

        this.ships.push(ship);

    },

    update(data) {

        if (this.inView) {

            if (data.x !== undefined) this.tween.to("x", data.x, COMMON.TWEEN_DURATION);
            if (data.y !== undefined) this.tween.to("y", data.y, COMMON.TWEEN_DURATION);

        } else {

            if (data.x !== undefined) this.x = data.x;
            if (data.y !== undefined) this.y = data.y;

        }

        Object.assign(this.shared, data);

    },

    step(dt) {

        this.tween.step(dt);

    },

    render() {

    }

};

/* file: script/entities/FloatingText.js */

CLIENT.FloatingText = function(args) {

    this.x = 0;
    this.y = 0;
    this.z = 0;

    this.font = "fat";

    this.delay = 0.00001;

    this.duration = 1.5;

    this.lifetime = 0;
    this.text = "";
    this.colors = [];
    this.color = 0xffffff;

    Object.assign(this, args);

};

CLIENT.FloatingText.prototype = {

    constructor: CLIENT.FloatingText,

    shape: COMMON.CIRCLE,

    radius: 1,
    zIndex: 20,

    run() {

        this.lifespan = this.duration;

    },

    step(dt) {

        if (this.delay >= 0) {

            this.delay -= dt;

            if (this.delay <= 0) this.run();
            else return;

        }

        this.z += dt * 16;

    },

    render() {

        if (this.delay > 0) return;

        app.painter.reset();

        let eased = app.ease(1.0 - this.lifespan / this.duration, "inExpo");

        app.painter.scale(1.0 + eased, 1.0 - eased);

        if (this.colors.length) {

            let progress = app.lifetime % 0.5 / 0.5;

            app.painter.color(this.colors[this.colors.length * progress | 0]);

        } else {

            app.painter.color(this.color);

        }

        app.painter.font(this.font);

        app.painter.fillText(String(this.text), this.x, this.y - this.z);


    }

};

/* file: script/entities/Foreground.js */

NAMESPACE.Foreground = function(args) {

    this.x = 0;
    this.y = 0;
    this.width = 0;
    this.height = 0;

    this.zoom = 1.0;

    this.options = null;
    this.ready = false;
    this.rotation = 0.0;
    this.lifetime = 0;
    this.scale = 1.0;
    this.alpha = 1.0;

    this.repeatX = 1.0;
    this.repeatY = 1.0;
    this.repeatOffsetX = 0.0;
    this.repeatOffsetY = 0.0;

    this.blendSrc = app.gl.SRC_ALPHA;
    this.blendDst = app.gl.ONE;

    this.needUpdateUV = false;

    Object.assign(this, args);

    this.setup();

    let gl = app.gl;

    if (!NAMESPACE.Foreground.prototype.uvBuffer) {

        let uvBuffer = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, uvBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([
            0.0, 0.0,
            1.0, 0.0,
            1.0, 1.0,
            1.0, 1.0,
            0.0, 1.0,
            0.0, 0.0
        ]), gl.STATIC_DRAW);

        NAMESPACE.Foreground.prototype.uvBuffer = uvBuffer;

    }

};

Object.assign(NAMESPACE.Foreground.prototype, {

    zIndex: 10,

    setTexture(key) {

        if (typeof key === "string") {

            this.src = key;

            this.ready = false;

            if (!app.textures[key]) {

                app.loadTexture(key).then(() => {

                    this.run(app.textures[this.src]);

            });

            } else {

                this.run(app.textures[this.src]);

            }

        } else {

            this.run(key);

        }

    },

    meshArray: new Float32Array([
        0.0, 0.0,
        1.0, 0.0,
        1.0, 1.0,
        1.0, 1.0,
        0.0, 1.0,
        0.0, 0.0
    ]),

    run(texture) {

        this.texture = texture;

        this.ready = true;

    },

    setup() {

        let gl = app.gl;

        let program = this.program = app.programs.foreground;

        /* Mesh */

        this.modelMatrix = Matrix3.create();
        this.positionBuffer = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, this.meshArray, gl.STATIC_DRAW);

    },


    step(dt) {

        this.lifetime += dt;

        this.box[0] = this.x;
        this.box[1] = this.y;
        this.box[2] = this.width;
        this.box[3] = this.height;

    },

    render() {

        if (!this.ready) return;

        let gl = app.gl;

        /* Alpha */

        gl.enable(gl.BLEND);
        gl.blendFunc(this.blendSrc, this.blendDst);

        /* Assign shaders */

        gl.useProgram(this.program.native);

        /* Position */

        gl.enableVertexAttribArray(this.program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);
        gl.vertexAttribPointer(this.program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        gl.activeTexture(gl.TEXTURE0);
        gl.enableVertexAttribArray(this.program.locations.uv);
        gl.bindTexture(gl.TEXTURE_2D, this.texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);


        gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);
        gl.vertexAttribPointer(this.program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        this.program.set("time", app.lifetime);
        this.program.set("alpha", this.alpha);

        this.program.set("width", this.width);
        this.program.set("height", this.height);

        this.program.set("repeatX", (this.width / this.texture.width) / this.zoom);
        this.program.set("repeatY", (this.height / this.texture.height) / this.zoom);

        this.program.set("repeatOffsetX", this.repeatOffsetX / this.texture.width);
        this.program.set("repeatOffsetY", this.repeatOffsetY / this.texture.height);

        this.program.set("texture", 0);

        var matrix = Matrix3.create();

        Matrix3.translate(matrix, this.x, this.y);
        if (this.rotation) Matrix3.rotate(matrix, -this.rotation);
        // Matrix3.translate(matrix, (-width / 2) * this.scale | 0, (-height / 2) * this.scale | 0);
        if (this.scale !== 1.0) Matrix3.scale(matrix, this.scale, this.scale);

        this.program.set("modelMatrix", matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    }

});

/* file: script/entities/Generic.js */

CLIENT.Generic = function(args) {

    this.x = 0;
    this.y = 0;

    Object.assign(this, args);

    this.soundLoop = null;


};

CLIENT.Generic.prototype = {


    groups: ["obstacle"],

    shape: COMMON.CIRCLE,
    radius: 100,
    collisionRadius: 24,
    heavy: true,

    enterview() {

        this.soundLoop = app.sound.play("ambient/stream").gpan(this).loop().rate(0.7).volume(0.5);

    },

    leaveview() {

        if (this.soundLoop) {
            this.soundLoop.fadeOut(0.5);
            this.soundLoop = null;
        }
    },

    render() {

        if (this.soundLoop) this.soundLoop.gpan(this);

        app.painter.reset();
        app.painter.drawSprite("waterfall", this.x, this.y, app.lifetime * 5.0);
        app.painter.alpha(0.35);
        app.painter.drawSprite("waterfall", this.x, this.y, app.lifetime * 5.0 - 1);
        app.painter.alpha(0.2);
        app.painter.drawSprite("waterfall", this.x, this.y, app.lifetime * 5.0 - 2);

    }

};

/* file: script/entities/Grass.js */

CLIENT.Grass = function(args) {

    this.x = 0;
    this.y = 0;
    this.z = 0;
    this.offsetX = 0;
    this.offsetY = 0;
    this.creation = 0;

    Object.assign(this, args);

    this.temp = {};

};


CLIENT.Grass.prototype = {

    constructor: CLIENT.Grass,

    shape: COMMON.CIRCLE,

    radius: 8,

    groups: ["interactive"],

    tooltip: "You can try your luck mowing the grass with a scythe.\nRemember though it is food for many animals.",


    step() {

    },

    render() {

        app.painter.reset();
        app.painter.creation(this.creation);
        app.painter.drawImageRegion(app.textures.spritesheet, 53, 49, 17, 15, this.x + this.offsetX, this.y + this.offsetY);

    }


};

/* file: script/entities/Grid.js */

NAMESPACE.MapEdge = function() {

    this.x = 0;
    this.y = 0;
    this.width = -1;
    this.height = -1;

    this.options = null;
    this.rotation = 0.0;
    this.lifetime = 0;
    this.scale = 1.0;

    this.random = Math.random();

    this.repeatX = 1.0;
    this.repeatY = 1.0;
    this.repeatOffsetX = 0.0;
    this.repeatOffsetY = 0.0;

    this.blendSrc = app.gl.SRC_ALPHA;
    this.blendDst = app.gl.ONE_MINUS_SRC_ALPHA;

    this.needUpdateUV = false;

    this.setup();

    let gl = app.gl;

    let countX = 10;
    let countY = 10;
    let stepX = 1.0 / countX;
    let stepY = 1.0 / countY;

    this.numVertices = (countX * countY) * 6;

    if (!NAMESPACE.MapEdge.prototype.uvBuffer) {

        let array = [];

        let uvBuffer = gl.createBuffer();

        for (let x = 0; x < countX; x++) {
            for (let y = 0; y < countY; y++) {

                array.push(
                    x * stepX, y * stepY,
                    x * stepX + stepX, y * stepY,
                    x * stepX + stepX, y * stepY + stepY,
                    x * stepX + stepX, y * stepY + stepY,
                    x * stepX, y * stepY + stepY,
                    x * stepX, y * stepY
                );

            }
        }

        gl.bindBuffer(gl.ARRAY_BUFFER, uvBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(array), gl.STATIC_DRAW);

        NAMESPACE.MapEdge.prototype.positionBuffer = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, NAMESPACE.MapEdge.prototype.positionBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(array), gl.STATIC_DRAW);

        NAMESPACE.MapEdge.prototype.uvBuffer = uvBuffer;

    }


};

Object.assign(NAMESPACE.MapEdge.prototype, {

    positionBuffer: null,

    zIndex: 0,

    meshArray: new Float32Array([
        0.0, 0.0,
        1.0, 0.0,
        1.0, 1.0,
        1.0, 1.0,
        0.0, 1.0,
        0.0, 0.0
    ]),

    setup() {

        let gl = app.gl;

        let program = this.program = app.programs.map_edge;

        /* Mesh */

        this.modelMatrix = Matrix3.create();

    },


    step(dt) {

        this.lifetime += dt;

    },

    setTexture(key) {

        this.texture = app.textures[key];

    },

    render() {

        let gl = app.gl;

        /* Alpha */


        gl.enable(gl.BLEND);
        gl.blendFunc(this.blendSrc, this.blendDst);

        /* Assign shaders */

        gl.useProgram(this.program.native);

        /* Position */

        gl.enableVertexAttribArray(this.program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);
        gl.vertexAttribPointer(this.program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        gl.enableVertexAttribArray(this.program.locations.uv);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);
        gl.vertexAttribPointer(this.program.locations.uv, 2, gl.FLOAT, false, 0, 0);


        this.program.set("texture", 0);

        gl.activeTexture(gl.TEXTURE0);
        gl.bindTexture(gl.TEXTURE_2D, this.texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);

        let width = this.width;

        if (this.width < 0) {

            width = this.texture.width;

        }

        let height = this.height;

        if (this.height < 0) {

            height = this.texture.height;

        }

        this.program.set("width", width);
        this.program.set("height", height);

        this.program.set("repeatX", this.repeatX);
        this.program.set("repeatY", this.repeatY);

        this.program.set("repeatOffsetX", this.repeatOffsetX / this.texture.width);
        this.program.set("repeatOffsetY", this.repeatOffsetY / this.texture.height);

        this.program.set("time", app.lifetime + this.random);

        var matrix = Matrix3.create();

        Matrix3.translate(matrix, this.x, this.y);
        if (this.rotation) Matrix3.rotate(matrix, -this.rotation);
        // Matrix3.translate(matrix, (-width / 2) * this.scale | 0, (-height / 2) * this.scale | 0);
        if (this.scale !== 1.0) Matrix3.scale(matrix, this.scale, this.scale);

        this.program.set("modelMatrix", matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, this.numVertices);

    }

});

/* file: script/entities/Herd.js */

CLIENT.Herd = function(args) {

    this.x = 0;
    this.y = 0;

    this.lifetime = 0;

    Object.assign(this, args);

    this.tween = new CLIENT.Tween(this);
    this.members = [];

    this.moving = 0.0;
    this.palette = 0;

    this.update(this.shared);

};

CLIENT.Herd.prototype = {

    zIndex: -1,

    constructor: CLIENT.Herd,

    shape: COMMON.CIRCLE,

    radius: 100,

    groups: [],

    pointerup() {

        this.enterview();

    },

    enterview() {

    },

    leaveview() {

    },

    addMember(member) {

        member.i = this.members.length;

        this.members.push(member);

    },

    update(data) {

        if (data.x !== undefined) {

            this.tween.to("x", data.x, this.inView * COMMON.TWEEN_DURATION);
            this.moving = 1.0;

        }

        if (data.y !== undefined) {

            this.tween.to("y", data.y, this.inView * COMMON.TWEEN_DURATION);
            this.moving = 1.0;

        }

        if (data.remove) this.collection.remove(this);

        Object.assign(this.shared, data);

    },

    step(dt) {


        this.lifetime += dt;

        if (this.moving > 0) this.moving -= dt;

        // if (this.inView && Utils.interval(this, "checkVisibility", 1.0)) this.checkVisibility();

        this.tween.step(dt);

    },

    checkVisibility() {

        for (let m of this.members) {

            if (m.inView) continue;

            m.x = this.shared.x + Utils.random(-16, 16);
            m.y = this.shared.y + Utils.random(-16, 16);

            m.updateTask();

        }

    },

    render() {

        // app.painter.reset();
        // app.painter.color(0xff0000);
        // app.painter.fillText(this.inView ? "YES" : "NO", this.x, this.y)
        // app.painter.fillCircle(this.x, this.y, 2)

    }

};

/* file: script/entities/Image.js */

NAMESPACE.Image = function(args) {

    this.x = 0;
    this.y = 0;
    this.z = 0;

    this.offsetX = 0;
    this.offsetY = 0;

    this.follow = null;

    this.width = -1;
    this.height = -1;

    this.options = null;
    this.ready = false;
    this.rotation = 0.0;
    this.lifetime = 0;
    this.color = app.color(0x000000, 0.0);
    this.alpha = 1.0;
    this.creation = 0.0;

    this.scale = {
        x: 1.0,
        y: 1.0
    };

    this.pivot = {
        x: 0.5,
        y: 0.5
    };

    this.region = null;
    this.a = 1.0;

    this.blendSrc = app.gl.SRC_ALPHA;
    this.blendDst = app.gl.ONE_MINUS_SRC_ALPHA;
    this.random = Math.random();

    this.setup();

    let gl = app.gl;

    this.temp = {};

    Object.assign(this, args);

};

Object.assign(NAMESPACE.Image.prototype, {

    zIndex: 0,

    radius: 100,

    shape: COMMON.CIRCLE,

    setTexture(key) {

        if (this.src === key) return;

        if (typeof key === "string") {

            this.src = key;

            this.ready = false;

            if (!app.textures[key]) {

                app.loadTexture(key).then(() => {

                    this.run(app.textures[this.src]);

            });

            } else {

                this.run(app.textures[this.src]);

            }

        } else {

            this.run(key);

        }

    },

    meshArray: new Float32Array([
        0.0, 0.0,
        1.0, 0.0,
        1.0, 1.0,
        1.0, 1.0,
        0.0, 1.0,
        0.0, 0.0
    ]),

    setRegion(x, y, w, h) {

        this.region = [x, y, w, h];

        this.radius = Math.max(w, h) / 2;

    },

    run(texture) {

        this.texture = texture;

        this.ready = true;


    },

    setup() {

        let gl = app.gl;

        let program = this.program = app.programs.image;

        /* Mesh */

        this.modelMatrix = Matrix3.create();

    },


    step(dt) {

        if (this.follow) {

            this.x = this.follow.x;
            this.y = this.follow.y;

        }

        this.lifetime += dt;

    },

    render() {

        if (!this.ready) return;

        let gl = app.gl;

        /* Alpha */

        gl.enable(gl.BLEND);
        // gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);
        gl.blendFunc(this.blendSrc, this.blendDst);

        /* Assign shaders */

        gl.useProgram(this.program.native);

        /* Position */

        gl.enableVertexAttribArray(this.program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(this.program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        gl.enableVertexAttribArray(this.program.locations.uv);
        gl.bindTexture(gl.TEXTURE_2D, this.texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(this.program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        let width = this.width;

        if (this.width < 0) {

            if (this.region) width = this.region[2];
            else width = this.texture.width;

        }

        let height = this.height;

        if (this.height < 0) {

            if (this.region) height = this.region[3];
            else height = this.texture.height;

        }

        this.program.set("width", width);
        this.program.set("height", height);
        this.program.set("color", this.color.r, this.color.g, this.color.b, this.color.a);
        this.program.set("alpha", this.alpha);
        this.program.set("creation", this.creation);


        if (this.region) {

            this.program.set("tx", this.region[0] / this.texture.width);
            this.program.set("ty", this.region[1] / this.texture.height);
            this.program.set("tw", this.region[2] / this.texture.width);
            this.program.set("th", this.region[3] / this.texture.height);

        } else {

            this.program.set("tx", 0.0);
            this.program.set("ty", 0.0);
            this.program.set("tw", 1.0);
            this.program.set("th", 1.0);

        }

        this.program.set("texture", 0);

        var matrix = Matrix3.create();

        Matrix3.translate(matrix, this.x + this.offsetX | 0, this.y + this.offsetY - this.z | 0);

        if (this.rotation) Matrix3.rotate(matrix, -this.rotation);

        Matrix3.translate(matrix, (-width * this.pivot.x) * this.scale.x | 0, (-height * this.pivot.y) * this.scale.y | 0);

        if (this.scale.x !== 1.0 || this.scale.y !== 1.0) Matrix3.scale(matrix, this.scale.x, this.scale.y);

        this.program.set("modelMatrix", matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    }

});

/* file: script/entities/MapEdge.js */

NAMESPACE.MapEdge = function(args) {

    this.x = 0;
    this.y = 0;
    this.width = -1;
    this.height = -1;

    this.options = null;
    this.rotation = 0.0;
    this.lifetime = 0;
    this.scale = 1.0;
    this.flip = false;

    this.random = Math.random();

    this.repeatX = 1.0;
    this.repeatY = 1.0;
    this.repeatOffsetX = 0.0;
    this.repeatOffsetY = 0.0;

    this.blendSrc = app.gl.SRC_ALPHA;
    this.blendDst = app.gl.ONE_MINUS_SRC_ALPHA;

    this.needUpdateUV = false;

    Object.assign(this, args);

    this.setup();

    let gl = app.gl;

    if (!NAMESPACE.MapEdge.prototype.uvBuffer) {

        let array = new Float32Array([
            0.0, 0.0,
            1.0, 0.0,
            1.0, 1.0,
            1.0, 1.0,
            0.0, 1.0,
            0.0, 0.0
        ]);

        let uvBuffer = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, uvBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, array, gl.STATIC_DRAW);

        NAMESPACE.MapEdge.prototype.uvBuffer = uvBuffer;

        let positionBuffer = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, array, gl.STATIC_DRAW);

        NAMESPACE.MapEdge.prototype.positionBuffer = positionBuffer;

    }

};

Object.assign(NAMESPACE.MapEdge.prototype, {

    positionBuffer: null,
    uvBuffer: null,

    zIndex: 2,

    meshArray: new Float32Array([
        0.0, 0.0,
        1.0, 0.0,
        1.0, 1.0,
        1.0, 1.0,
        0.0, 1.0,
        0.0, 0.0
    ]),

    setup() {

        let gl = app.gl;

        let program = this.program = app.programs.map_edge;

        /* Mesh */

        this.modelMatrix = Matrix3.create();

    },


    step(dt) {

        this.lifetime += dt;

        this.box[0] = this.x;
        this.box[1] = this.y;
        this.box[2] = this.width;
        this.box[3] = this.height;

    },

    setTexture(key) {

        this.texture = app.textures[key];

    },

    render() {

        let gl = app.gl;

        /* Alpha */


        gl.enable(gl.BLEND);
        gl.blendFunc(this.blendSrc, this.blendDst);

        /* Assign shaders */

        gl.useProgram(this.program.native);

        /* Position */

        gl.enableVertexAttribArray(this.program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);
        gl.vertexAttribPointer(this.program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        gl.enableVertexAttribArray(this.program.locations.uv);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);
        gl.vertexAttribPointer(this.program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        this.program.set("texture", 0);

        gl.activeTexture(gl.TEXTURE0);
        gl.bindTexture(gl.TEXTURE_2D, this.texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);


        if (this.width < 0) {

            this.width = this.texture.width;

        }


        if (this.height < 0) {

            this.height = this.texture.height;

        }

        let width = this.width;
        let height = this.height;

        this.program.set("width", width);
        this.program.set("height", height);
        this.program.set("flip", this.flip);

        this.program.set("repeatX", this.width / this.texture.width);
        this.program.set("repeatY", this.height / this.texture.height);

        this.program.set("repeatOffsetX", this.repeatOffsetX / this.texture.width);
        this.program.set("repeatOffsetY", this.repeatOffsetY / this.texture.height);

        this.program.set("time", app.lifetime + this.random);

        var matrix = Matrix3.create();

        Matrix3.translate(matrix, this.x, this.y);
        if (this.rotation) Matrix3.rotate(matrix, -this.rotation);
        // Matrix3.translate(matrix, (-width / 2) * this.scale | 0, (-height / 2) * this.scale | 0);
        if (this.scale !== 1.0) Matrix3.scale(matrix, this.scale, this.scale);

        this.program.set("modelMatrix", matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    }

});

/* file: script/entities/Meadow.js */

CLIENT.Meadow = function(args) {

    this.x = 0;
    this.y = 0;

    this.lifetime = 0.0;

    Object.assign(this, args);

    this.circle = null;
    this.updateEntitiesTimeout = 0.0;

    this.entities = [];

    this.grass = [];

    this.update(args.shared);

};


CLIENT.Meadow.prototype = {

    zIndex: 0,

    shape: COMMON.CIRCLE,
    radius: 80,

    groups: ["meadows"],

    enterview() {

        if (!this.circle) {

            this.circle = this.collection.add("Circle");
            this.circle.program = app.programs.meadow;
            this.circle.x = this.x;
            this.circle.y = this.y;
            this.circle.radius = this.radius;
            this.circle.scale.y = 0.75;
            this.circle.zIndex = -2;
            this.circle.texture = app.textures.spritesheet;
            this.circle.color.set(0x638538);

        }

        this.updateGrass();

    },

    leaveview() {

    },

    _pos: {
        x: 0,
        y: 0
    },

    rpos() {

        let r = Math.random();
        let rx = Utils.random(32, this.radius);
        let ry = Utils.random(32, this.radius * 0.75);

        this._pos.x = this.x + Math.cos(r * 6.14) * rx;
        this._pos.y = this.y + Math.sin(r * 6.14) * ry;

        return this._pos;

    },

    updateGrass() {

        if (this.shared.grass > this.grass.length) {


            let count = this.shared.grass - this.grass.length;

            while (count--) {

                let grass = this.collection.add("Grass");

                grass.creation = 1.0;
                grass.temp.eaten = 0;

                Object.assign(grass, this.rpos());

                app.tween(grass).to({
                    creation: 0.0
                }, 1.0);

                this.grass.push(grass);


            }

        }

        if (this.shared.grass < this.grass.length) {

            let count = this.grass.length - this.shared.grass;

            while (count--) {

                let grass = Utils.maxBy(this.grass, this.mostEaten);

                this.removeGrass(grass);



            }

        }

    },

    removeObject(context) {

        context.collection.remove(context);

    },

    removeGrass(grass) {

        let index = this.grass.indexOf(grass);

        if (index > -1) this.grass.splice(index, 1);

        app.tween(grass).to({
            creation: 1.0
        }, 0.5).then(this.removeObject);

        if (grass.temp.eaten > 1.0) {

            let leaves = this.collection.add("Sprite");

            leaves.set("fx/leaves");

            leaves.rotation = Math.random() * 6.28;

            leaves.scale.x = 0.5;
            leaves.scale.y = 0.5;

            leaves.x = grass.x;
            leaves.y = grass.y + 4;
            leaves.z = 6;

            leaves.duration = 1.0;

            leaves.color = app.color(0x6abe30);

            leaves.shadow = true;

        }

    },

    mostEaten(o) {

        return o.temp.eaten;

    },

    step(dt) {

        if (!this.inView) return;

        this.lifetime += dt;

        if ((this.updateEntitiesTimeout -= dt) <= 0) {

            this.updateEntitiesTimeout = 0.25;
            this.updateEntities();

        }

        for (let grass of this.grass) {

            grass.temp.eaten -= dt;

        }

    },

    update(data) {

        Object.assign(this.shared, data);

        this.x = this.shared.x;
        this.y = this.shared.y;
        this.radius = this.shared.radius;

        if (data.grass !== undefined && this.inView) this.updateGrass();

    },

    updateEntities() {

        let entities = this.collection.inView;

        for (let entity of this.entities) {

            entity.inGrass = false;

        }

        this.entities.length = 0;

        for (let entity of entities) {

            if (!entity.moveGrass) continue;

            if (!Utils.pointInEllipse(entity.x, entity.y, this.x, this.y, this.radius * 0.9, this.radius * 0.9 * 0.75)) continue;

            entity.inGrass = true;

            this.entities.push(entity);

        }

    },

    render() {

        if (!this.circle) return;

        for (var i = 0; i < this.entities.length; i++) {

            let entity = this.entities[i];

            if (entity.z > 0) continue;

            app.painter.reset();
            app.painter.values.rotation = Math.sin(entity.y * 0.1 + entity.x * 0.025) * 0.25;
            app.painter.drawImageRegion(app.textures.spritesheet, 53, 38, 17, 6, entity.x + (entity.ox | 0), entity.y + (entity.oy | 0), 17, 6);

        }

    }


};

/* file: script/entities/Monster.js */

NAMESPACE.Monster = function(args) {

    this.lifetime = Math.random();

    this.speed = 1.0;

    this.x = Math.random() * 100;
    this.y = Math.random() * 100;
    this.z = 0;
    this.ox = 0;
    this.oy = 0;
    this.force = 0;
    this.forceDirection = 0;
    this.direction = Math.random() * 6;
    this.health = 10;

    this.destinationDistance = 0;

    this.dead = false;

    this.destination = {
        x: 0,
        y: 0
    };

    this.lookAt = null;

    Object.assign(this, args);

    this.sprite = new CLIENT.Sprite;
    this.sprite.prefix = "ogre/";
    this.sprite.set("run");
    this.sprite.loop = true;

    this.random = Math.random();

    this.state = new CLIENT.State(this, CLIENT.Monster.Ogre);

    this.x = this.destination.x = this.shared.x;
    this.y = this.destination.y = this.shared.y;

    this.moveGrass = true;

    this.sin = Math.sin(this.random * 6.28);
    this.cos = Math.cos(this.random * 6.28);

    this.update(this.shared);

    this.baseX = this.x;
    this.baseY = this.y;

    this.sprite.creation = 1.0;

    app.tween(this.sprite).to({
        creation: 0.0
    }, 2.0);

};

Object.assign(NAMESPACE.Monster.prototype, {

    zIndex: 1,

    radius: 8,
    collisionRadius: 8,

    ignorePointer: true,

    shape: COMMON.CIRCLE,

    systemShadow: 10,

    groups: ["movable"],

    update(data) {

        if (data.health < this.shared.health && this.inView) {

            app.sound.play("human/hit_flesh").rrate(0.2).gpan(this);
            app.sound.play("weapon/hit").rrate(0.2).gpan(this);

            if (data.health > 0) {

                app.sound.play("ogre/pain_" + Utils.random(1, 3)).rrate(0.2).gpan(this);

            } else {

                app.sound.play("ogre/death").rrate(0.1).gpan(this);

            }

            this.hitLifespan = 0.5;

            let blood = this.collection.add("Sprite");

            blood.set("fx/blood_1");
            blood.follow = this;
            blood.duration = 0.6;
            blood.rotation = Math.random() * 6.28;
            blood.scale.x = 1.0;
            blood.scale.y = 1.0;

        }

        if (!this.dead && data.occupation !== undefined) {


            this.task = data.occupation % 100;
            this.detail = data.occupation / 100 % 10000000 | 0;

            this.state.set("idle");

        }

        if (data.remove) {

            if (this.inView) {

                this.lifespan = 5.0;

                app.tween(this.sprite).delay(3.0).to({
                    creation: 1.0
                }, 2.0);

            } else {

                this.collection.remove(this);

            }

        }

        Object.assign(this.shared, data);

    },


    step(dt) {

        this.lifetime += dt;

        if (this.force) {

            this.force = Utils.moveTo(this.force, 0, 200 * dt);

            this.x += Math.cos(this.forceDirection) * this.force * dt;
            this.y += Math.sin(this.forceDirection) * this.force * dt;

        }

        if (this.hitLifespan > 0.0) this.hitLifespan -= dt;

        if (this.shared.health > 0) {
            let distance = Utils.distance(this, this.destination);

            this.destinationDistance = distance;

            if (distance > 1) {

                let destinationAngle = Utils.lookAt(this, this.destination);

                this.x += Math.cos(destinationAngle) * (distance + 48) * dt * this.speed;
                this.y += Math.sin(destinationAngle) * (distance + 48) * dt * this.speed;

            }

            if (this.lookAt) {

                if (typeof this.lookAt === "number") {

                    this.direction = Utils.circWrapTo(this.direction, this.lookAt, 6 * app.elapsed);

                } else {

                    this.direction = Utils.circWrapTo(this.direction, Utils.lookAt(this, this.lookAt), 6 * app.elapsed);

                }

            }

        }

        this.state.step(dt);


    },


    render() {

        if (!this.sprite.data) return;

        let row = Utils.dirrow(this.direction, this.sprite.data.rows);

        if (this.hitLifespan > 0.0) {

            this.sprite.color.set(0xffffff, 1.0);

        } else {

            this.sprite.color.set(0, 0);

        }

        this.sprite.step(app.elapsed);

        this.sprite.x = this.x + this.ox;
        this.sprite.y = this.y - this.z + this.oy - 6;
        this.sprite.row = row;

        this.sprite.render();

    }

});

/* file: script/entities/Monster.Ogre.js */

CLIENT.Monster.Ogre = {

    idle: {

        enter(monster, manager) {

            monster.sprite.set("run");
            monster.sprite.loop = true;

            if (monster.task === COMMON.TASKS.FIGHT) manager.set("fight");
            else if (monster.task === COMMON.TASKS.DIE) manager.set("dead");

        },

        leave(monster) {

            monster.sprite.paused = false;

        },

        step(monster, manager) {

            if (monster.destinationDistance > 2) {

                monster.sprite.paused = false;

            } else {

                monster.sprite.paused = true;

            }

            if (Utils.interval(monster, "random_movement", 2.0)) {

                monster.destination.x = monster.baseX + Utils.random(-50, 50);
                monster.destination.y = monster.baseY + Utils.random(-50, 50);
                monster.lookAt = monster.destination;
                monster.speed = 0.25;

            }

        }

    },

    fight: {

        enter(monster, manager) {

            manager.data.target = monster.collection.sid(monster.detail);

        },

        step(monster, manager) {

            if (!manager.data.target) return;

            monster.destination.x = manager.data.target.x + monster.sin * 24;
            monster.destination.y = manager.data.target.y + monster.cos * 24;
            monster.lookAt = manager.data.target;

        }

    },

    dead: {

        enter(monster, manager) {

            monster.sprite.set("death");
            monster.sprite.duration = 2.0;

        }

    },

    attack: {

        enter(monster, manager) {

            monster.sprite.set("attack");
            monster.sprite.duration = 1.0;

        },

        step(monster, manager) {

            if (manager.runOnce(0.5)) {

                app.sound.play("impact/ground_medium").gpan(monster);

                app.game.fxRocks(monster.x + Math.cos(monster.direction) * 16, monster.y + Math.sin(monster.direction) * 16, 6);

                app.game.fxCameraStomp();

            }

            if (manager.runOnce(1.25)) manager.set("idle");

        }

    }

};

/* file: script/entities/Mushroom.js */

CLIENT.Mushroom = function(args) {

    this.x = 0;
    this.y = 0;
    this.z = 0;
    this.def = null;
    this.scale = 1.0;
    this.lifetime = 0;
    this.creation = 0.0;

    Object.assign(this, args);

    this.update(this.shared);

    this.interactive = true;
    this.clickable = true;

    this.parent = this.collection.sid(this.shared.parent_sid);

    if (this.parent) {

        Object.assign(this, this.parent.rpos());

    }

};

CLIENT.Mushroom.prototype = {

    shape: COMMON.CIRCLE,

    radius: 8,

    constructor: CLIENT.Mushroom,

    interactiveIndex: 2,

    systemShadow: 4,

    groups: ["interactive"],

    tooltip: "mushroom",

    appear() {

        this.creation = 1.0;

        app.tween(this).to({
            creation: 0.0
        }, 1.0);

    },

    enterview() {

        if (this.lifetime < 0.5) {

            this.appear();

        }

    },

    beingCollected() {

        app.sound.play("human/eat_2").gpan(this);

    },

    pointerup() {

        this.game.order(this);

        this.game.action.set("snap");

    },

    update(data) {

        if (data.key !== undefined) {

            this.def = COMMON.items["mushroom_" + data.key];

        }

        if (data.remove) this.lifespan = 2.0;

        Object.assign(this.shared, data);

    },

    blink() {

        let debris = this.collection.add("Sprite");

        debris.set("fx/blink");
        debris.follow = this;
        debris.duration = 0.25;
        debris.scale.x = 0.5;
        debris.scale.y = 0.5;
        debris.z = this.z;
        debris.zIndex = 1;

    },

    step(dt) {

        this.lifetime += dt;

    },

    render() {

        app.painter.reset();
        app.painter.scale(this.scale, this.scale);

        app.painter.align(0.5, 0.9);
        app.painter.creation(this.creation);
        app.painter.drawImageRegion(app.textures.spritesheet, ...this.def.sprite, this.x, this.y - this.z);

        if (this.game.hovered === this) {

            app.painter.alpha(Utils.saw(4 * app.lifetime % 1.0));
            app.painter.color(0xffff00);
            app.painter.drawImageRegion(app.textures.spritesheet, ...this.def.sprite, this.x, this.y - this.z);


        }
        // app.painter.color(0xaa0000);
        // app.painter.textAlign("center");
        // app.painter.fillText(String(this.shared.key), this.x, this.y - 16);

    }

}

/* file: script/entities/Net.js */

CLIENT.Net = function(args) {

    this.x = 0;
    this.y = 0;
    this.direction = 0;
    this.lifetime = Math.random() * 10;
    this.partner = null;

    Object.assign(this, args);

    this.image = new CLIENT.Image();
    this.image.setTexture("net");
    this.image.setRegion(0, 0, 256, 64);

};


CLIENT.Net.prototype = {

    constructor: CLIENT.Net,

    shape: COMMON.CIRCLE,

    radius: 10,

    zIndex: 1,

    step(dt) {

        this.lifetime += dt;

        /* Need to update here so the view box can get updated */

        this.updatePosition();

    },

    updatePosition() {

        let distance = Utils.distance(this.a, this.b);

        this.image.width = distance;
        this.image.height = 20;

        Utils.limit(1 - distance / 150, 0.5, 1.0) * 32;

        this.radius = distance / 2;

        this.x = this.a.x + (this.b.x - this.a.x) * 0.5;
        this.y = this.a.y + (this.b.y - this.a.y) * 0.5;

    },

    render() {

        if (this.image.ready) {

            /* Need to update here also or the position may be one step late */

            this.updatePosition();

            this.image.x = this.x;
            this.image.y = this.y;

            this.image.rotation = Utils.lookAt(this.a, this.b)
            // this.sprite.x = this.x;
            // this.sprite.y = this.y;

            this.image.render();

        }

    }

};

/* file: script/entities/Polygon.js */

NAMESPACE.Polygon = function() {

    this.x = 0;
    this.y = 0;

    this.options = null;
    this.ready = false;
    this.rotation = 0.0;
    this.lifetime = 0;
    this.scale = 1.0;
    this.pivot = {
        x: 0,
        y: 0
    }

    this.needUpdateUV = false;

    this.setup();

};

Object.assign(NAMESPACE.Polygon.prototype, {

    zIndex: 0,

    checkUpdates() {

        if (this.needUpdateUV) this.updateUV();

    },

    setTexture(key) {

        this.src = key;

        this.ready = false;

        if (!app.sprites[key]) {

            app.loadTexture(key).then(() => {

                this.run();

        });

        } else {

            this.run();

        }

    },

    setVertices(vertices) {

        let gl = app.gl;

        let indices = earcut(vertices);

        this.indices = indices;

        this.meshArray = new Float32Array(vertices);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, this.meshArray, gl.STATIC_DRAW);

        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.positionIndexBuffer);
        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);

    },

    setUV(map) {

        this.uvMap = map;

        if (this.ready) {

            this.updateUV();

        } else this.needUpdateUV = true;

    },

    updateUV() {

        if (!this.meshArray) return;

        let gl = app.gl;

        let map = this.uvMap;

        let uvArray = new Float32Array(this.meshArray.length);

        for (var i = 0; i < map.length; i += 2) {

            uvArray[i] = map[i] / this.texture.width;
            uvArray[i + 1] = map[i + 1] / this.texture.height;

        }

        // Set Texcoords

        gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, uvArray, gl.STATIC_DRAW);

        this.needUpdateUV = false;

    },

    run() {

        this.texture = app.textures[this.src];

        this.ready = true;

        this.checkUpdates();

    },

    setup() {

        let gl = app.gl;

        this.program = app.programs.polygon;

        /* Mesh */

        this.positionBuffer = gl.createBuffer();
        this.positionIndexBuffer = gl.createBuffer();
        this.uvBuffer = gl.createBuffer();

    },

    step(dt) {

        this.lifetime += dt;

    },

    render() {

        if (!this.ready) return;

        this.checkUpdates();

        let gl = app.gl;

        /* Alpha */

        gl.enable(gl.BLEND);
        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);

        /* Assign shaders */

        gl.useProgram(this.program.native);

        /* Position */

        gl.enableVertexAttribArray(this.program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);
        gl.vertexAttribPointer(this.program.locations.position, 2, gl.FLOAT, false, 0, 0);
        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.positionIndexBuffer);

        /* Texturing */

        gl.enableVertexAttribArray(this.program.locations.uv);
        gl.bindTexture(gl.TEXTURE_2D, this.texture);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);
        gl.vertexAttribPointer(this.program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        this.program.set("texture", 0);
        this.program.set("rgba", 1.0, 1.0, 1.0, 1.0);

        var matrix = Matrix3.create();

        Matrix3.translate(matrix, this.x, this.y);
        if (this.rotation) Matrix3.rotate(matrix, this.rotation);
        Matrix3.translate(matrix, this.pivot.x, -this.pivot.y);
        if (this.scale !== 1.0) Matrix3.scale(matrix, this.scale, this.scale);

        this.program.set("modelMatrix", matrix);

        /* Draw */
        gl.drawElements(gl.TRIANGLES, this.indices.length, gl.UNSIGNED_SHORT, 0);

        // gl.drawArrays(gl.TRIANGLES, 0, 4);

    }

});


/* file: script/entities/Rectangle.js */

NAMESPACE.Rectangle = function(args) {

    this.x = 0;
    this.y = 0;
    this.width = -1;
    this.height = -1;

    this.options = null;
    this.rotation = 0.0;
    this.lifetime = 0;
    this.scale = 1.0;

    this.random = Math.random();

    this.repeat = false;
    this.repeatX = 1.0;
    this.repeatY = 1.0;
    this.repeatOffsetX = 0.0;
    this.repeatOffsetY = 0.0;

    this.blendSrc = app.gl.SRC_ALPHA;
    this.blendDst = app.gl.ONE_MINUS_SRC_ALPHA;

    this.needUpdateUV = false;

    Object.assign(this, args);

    this.setup();

    let gl = app.gl;

    if (!NAMESPACE.Rectangle.prototype.uvBuffer) {

        let array = new Float32Array([
            0.0, 0.0,
            1.0, 0.0,
            1.0, 1.0,
            1.0, 1.0,
            0.0, 1.0,
            0.0, 0.0
        ]);

        let uvBuffer = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, uvBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, array, gl.STATIC_DRAW);

        NAMESPACE.Rectangle.prototype.uvBuffer = uvBuffer;

        let positionBuffer = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, array, gl.STATIC_DRAW);

        NAMESPACE.Rectangle.prototype.positionBuffer = positionBuffer;

    }

};

Object.assign(NAMESPACE.Rectangle.prototype, {

    positionBuffer: null,
    uvBuffer: null,

    zIndex: 0,

    meshArray: new Float32Array([
        0.0, 0.0,
        1.0, 0.0,
        1.0, 1.0,
        1.0, 1.0,
        0.0, 1.0,
        0.0, 0.0
    ]),

    setup() {

        let gl = app.gl;

        let program = this.program = app.programs.map_edge;

        /* Mesh */

        this.modelMatrix = Matrix3.create();

    },


    step(dt) {

        this.lifetime += dt;

        this.box[0] = this.x;
        this.box[1] = this.y;
        this.box[2] = this.width;
        this.box[3] = this.height;

    },

    setTexture(key) {

        this.texture = app.textures[key];

    },

    render() {

        let gl = app.gl;

        /* Alpha */

        gl.enable(gl.BLEND);
        gl.blendFunc(this.blendSrc, this.blendDst);

        /* Assign shaders */

        gl.useProgram(this.program.native);

        /* Position */

        gl.enableVertexAttribArray(this.program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);
        gl.vertexAttribPointer(this.program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        gl.enableVertexAttribArray(this.program.locations.uv);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);
        gl.vertexAttribPointer(this.program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        this.program.set("texture", 0);

        gl.activeTexture(gl.TEXTURE0);
        gl.bindTexture(gl.TEXTURE_2D, this.texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);

        if (this.texture) {

            if (this.width < 0) {

                this.width = this.texture.width;

            }

            if (this.height < 0) {

                this.height = this.texture.height;

            }

        }

        let width = this.width;
        let height = this.height;

        this.program.set("width", width);
        this.program.set("height", height);



        this.program.set("repeatX", this.width / this.texture.width);
        this.program.set("repeatY", this.height / this.texture.height);

        this.program.set("repeatOffsetX", this.repeatOffsetX / this.texture.width);
        this.program.set("repeatOffsetY", this.repeatOffsetY / this.texture.height);

        this.program.set("time", app.lifetime + this.random);

        var matrix = Matrix3.create();

        Matrix3.translate(matrix, this.x, this.y);

        if (this.rotation) Matrix3.rotate(matrix, -this.rotation);

        // Matrix3.translate(matrix, (-width / 2) * this.scale | 0, (-height / 2) * this.scale | 0);

        if (this.scale !== 1.0) Matrix3.scale(matrix, this.scale, this.scale);

        this.program.set("modelMatrix", matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    }

});

/* file: script/entities/Rocks.js */

CLIENT.Rocks = function(args) {

    this.x = 0;
    this.y = 0;
    this.hitLifespan = 0;

    this.minePosition = {};

    Object.assign(this, args);

    this.rocks = [];

    this.rocks.sort(this.sortCallback);

    this.update(this.shared);

    this.parent = this.collection.sid(this.shared.parent_sid);

    if (this.parent) {

        Object.assign(this, this.parent.rpos());

    }

}

CLIENT.Rocks.prototype = {

    radius: 20,

    shape: COMMON.CIRCLE,

    constructor: CLIENT.Rocks,

    tooltip: "rocks",

    groups: ["interactive"],

    zIndex: 2,

    sprites: [
        [146, 2, 25, 31],
        [178, 5, 18, 25],
        [149, 36, 17, 26],
        [169, 37, 11, 18],
        [183, 33, 9, 33],
        [196, 33, 13, 33],
        [149, 69, 13, 20],
        [166, 70, 16, 18],
        [187, 68, 14, 22]
    ],

    enterview() {

        this.updateRocks();

    },

    leaveview() {

        this.removeRocks();

    },

    destruct() {

    },

    updateRocks() {

        let count = this.shared.count;

        if (count > this.rocks.length) {

            let len = count - this.rocks.length;

            for (let i = 0; i < len; i++) {

                this.addRock();

            }

        }

        if (count < this.rocks.length) {

            let len = this.rocks.length - count;

            while (len-- > 0) this.killRock();

        }

        let first = this.rocks[0];

        if (first) {

            this.minePosition = {
                x: first.x,
                y: first.y
            };

        }

    },

    removeRocks() {

        while (this.rocks.length) {

            let rock = this.rocks.shift();

            rock.collection.remove(rock);

        }

    },

    mine() {

        let first = this.rocks[0];

        if (!first) return;

        this.debris(first.x, first.y, 5, 0.25);

        app.sound.play("action/mine_" + Utils.random(1, 2)).gpan(this).rrate(0.1);

        let blink = this.collection.add("Sprite");

        blink.set("fx/blink");
        blink.follow = first;
        blink.duration = 0.25;
        blink.scale.x = 0.5;
        blink.scale.y = 0.5;
        blink.zIndex = 2;

        this.hitLifespan = 0.3;

    },

    debris(x, y, count = 5, scale = 0.5) {

        for (var i = 0; i < count; i++) {

            let debris = this.collection.add("Sprite");

            let duration = Utils.randomf(0.5, 1.5);

            debris.set("fx/stone");

            debris.shadow = true;
            debris.scale.x = scale;
            debris.scale.y = scale;
            debris.x = x + Utils.random(-8, 8);
            debris.y = y + Utils.random(-8, 8);;
            debris.z = 8;
            debris.shadow = true;
            debris.loop = true;
            debris.duration = duration * 0.3;

            app.tween(debris).to({
                z: 30
            }, duration * 0.5, "inSine").to({
                z: 0
            }, duration * 0.5, "outBounce");

            app.tween(debris).to({
                x: debris.x + Utils.random(-50, 50),
                y: debris.y + Utils.random(-50, 50)
            }, duration);

            app.tween(debris.scale).delay(duration * 0.5).to({
                x: 0,
                y: 0,
            }, duration * 0.5);


            debris.lifespan = duration;

        }

    },

    update(data) {

        Object.assign(this.shared, data);

        if (data.remove) {

            this.lifespan = 1.0;

        }

        if (data.count !== undefined) {

            if (this.inView) this.updateRocks();

        }

    },

    addRock() {

        let rock = this.collection.add("Image");

        rock.setTexture(app.textures.spritesheet);
        rock.x = this.x + Utils.random(-this.radius, this.radius);
        rock.y = this.y + Utils.random(-this.radius, this.radius);
        rock.zIndex = 1;
        rock.pivot.y = 0.3;

        let sprite = Utils.random(this.sprites);

        rock.setRegion(...sprite);

        rock.duration = 1.0 + Math.random() * 2.0;

        rock.region[3] = 0;

        app.tween(rock.region).delay(rock.duration * 0.25).to({
            3: sprite[3]
        }, rock.duration * 0.75);

        rock.radius = 2;

        this.rocks.push(rock);

    },

    killRock() {

        let rock = this.rocks.shift();

        rock.collection.remove(rock);

        app.sound.play("explosion/rock").gpan(this).rrate(0.1);

        this.debris(rock.x, rock.y, 8, 0.5);

    },

    sortCallback(a, b) {

        return (a.y - b.y) || (a.x - b.x);

    },

    step() {

    },

    render() {

        app.painter.reset();
        app.painter.align(0.5, 1.0);

        for (let rock of this.rocks) {

            if (rock.lifetime <= rock.duration) {

                let progress = rock.lifetime / rock.duration;

                // rock.creation = 1.0 - progress;
                rock.scale.x = progress;
                rock.scale.y = progress;

                app.painter.scale(progress * rock.region[2] / 32, 2.0 * Utils.saw(progress));
                app.painter.drawSprite("fx/earthline", rock.x, rock.y + 8, app.lifetime * 10);
                rock.offsetX = Math.sin(app.lifetime * 40 + rock.random * 40) * 2.0 | 0;

            }

        }

        if (this.hitLifespan > 0) {

            this.hitLifespan -= app.elapsed;

            let first = this.rocks[0];

            if (first) {

                first.offsetX = Utils.random(-1, 1);
                // first.oy = Utils.random(-1, 1);
            }

        }


    }

}

/* file: script/entities/ShipData.js */

CLIENT.ShipData = function(args) {

    Object.assign(this, args);

    this.fleet = this.collection.sid(this.shared.fleet_sid);

    this.fleet.addShip(this);

    this.update(this.shared);

};

CLIENT.ShipData.prototype = {

    constructor: CLIENT.ShipData,

    update(data) {

    }

};

/* file: script/entities/Sprite.js */

NAMESPACE.Sprite = function(args) {

    this.auto = true;
    this.region = [0, 0, 0, 0];

    this.delay = 0.0;
    this.alpha = 1.0;
    this.shadow = false;
    this.x = 0;
    this.y = 0;
    this.z = 0;

    this.frame = -1;

    this.key = "";
    this.prefix = "";
    this.fullKey = "";

    this.random = Math.random();

    this.blendDst = app.gl.ONE_MINUS_SRC_ALPHA;
    this.inverse = false;
    this.a = 1.0;
    this.data = null;
    this.options = null;
    this.row = 0;
    this.ready = false;
    this.rotation = 0.0;
    this.lifetime = 0;
    this.lifespan = 0.0;
    this.time = 0;
    this.progress = 0.0;
    this.timeScale = 1.0;
    this.scale = {
        x: 1.0,
        y: 1.0
    };
    this.pivot = {
        x: 0.5,
        y: 0.5
    };

    this.trim = [0, 0];
    this.loop = false;
    this.duration = 1.0;
    this.easing = false;
    this.color = app.color(0x000000, 0.0);

    this.range = null;
    this.paused = false;
    this.offsetX = 0;
    this.offsetY = 0;
    this.dissolve = -1.0;
    this.creation = 0.0;

    this.follow = null;
    this.palette = -1.0;
    this.hidden = false;

    Object.assign(this, args);

    this.setup();

};

NAMESPACE.Sprite.prototype = {

    zIndex: 3,

    shape: COMMON.CIRCLE,

    radius: 10,

    set(key) {

        this.progress = 0.0;

        this.range = null;
        this.inverse = false;
        this.loop = false;

        this.key = key;

        this.ready = false;

        let fullKey = this.prefix + key;

        this.fullKey = fullKey;

        if (!app.sprites[this.prefix + key]) {

            app.loadSprite(this.prefix + key).then(() => {

                if (this.prefix + this.key === fullKey) this.run();

        });

        } else {

            this.run();

        }

    },

    meshArray: new Float32Array([
        0.0, 0.0,
        1.0, 0.0,
        1.0, 1.0,
        1.0, 1.0,
        0.0, 1.0,
        0.0, 0.0
    ]),

    uvArray: new Float32Array([
        0.0, 0.0,
        1.0, 0.0,
        1.0, 1.0,
        1.0, 1.0,
        0.0, 1.0,
        0.0, 0.0
    ]),

    run() {

        this.time = 0;
        this.data = app.sprites[this.prefix + this.key];
        this.texture = app.textures["sprites/" + this.prefix + this.key];

        if (this.texture.paletteReady && this.palette < 0) this.palette = 0;

        this.setFrame(0);

        this.ready = true;

    },

    setFrame(index) {

        // if (this.frame === index) return;

        let gl = app.gl;

        this.frame = index;
        this.absFrame = this.row * this.data.frames + this.frame;

        if (this.data.regions) {

            var regionIndex = this.absFrame * 4;

            this.region[0] = this.data.regions[regionIndex + 0];
            this.region[1] = this.data.regions[regionIndex + 1];
            this.region[2] = this.data.regions[regionIndex + 2];
            this.region[3] = this.data.regions[regionIndex + 3];

            var trimIndex = this.absFrame * 2;

            if (this.data.trim) {

                this.trim[0] = this.data.trim[trimIndex + 0];
                this.trim[1] = this.data.trim[trimIndex + 1];

            } else {

                this.trim[0] = 0;
                this.trim[1] = 0;

            }

        } else {

            let cols = this.data.cols || (this.texture.width / this.data.width | 0);

            if (this.data.rows) {

                var x = this.frame % this.data.frames;
                var y = this.row + this.frame / this.data.frames | 0;

            } else {

                var x = this.frame % cols;
                var y = this.frame / cols | 0;

            }

            this.region[0] = x * this.data.width;
            this.region[1] = y * this.data.height;
            this.region[2] = this.data.width;
            this.region[3] = this.data.height;

            this.trim[0] = 0;
            this.trim[1] = 0;

        }

        this.needMatrixUpdate = true;

    },

    play() {

    },

    setup() {

        let gl = app.gl;

        let program = this.program = app.programs.sprite;

        /* Mesh */

        this.modelMatrix = Matrix3.create();
        this.positionBuffer = gl.createBuffer();
        this.uvBuffer = gl.createBuffer();


    },

    step(dt) {

        if (this.delay > 0) {

            this.delay -= dt;

            return;

        }


        if (!this.paused) {

            this.lifetime += dt;
            this.time += dt * this.timeScale;

        }

        if (!this.ready) return;

        if (this.follow) {

            this.x = this.follow.x;
            this.y = this.follow.y;

        }

        let progress;

        progress = this.time / this.duration;

        if (this.loop) {

            this.time = this.time % this.duration;

            progress = progress % 1.0;

        } else {

            if (progress > 1.0) progress = 1.0;

        }

        this.progress = progress;

        if (this.easing) progress = app.ease(progress, this.easing);

        let frame;

        // if (this.easing) frame = (this.data.frames + 1) * progress | 0;

        this.progress = progress;

        if (this.range) {

            let frames = this.range[1] - this.range[0];

            if (!this.loop && progress >= 1.0) frame = this.range[0] + frames;
            else {
                frame = (frames + 1) * progress;
                frame = frame % (frames + 1);
                frame = this.range[0] + frame | 0;
            }

        } else {

            if (!this.loop && progress >= 1.0) frame = this.data.frames - 1;
            else {
                frame = this.data.frames * progress;
                if (this.loop) frame = frame % this.data.frames;
                frame = frame | 0;

            }

        }

        if (this.inverse) frame = (this.data.frames - 1) - frame;

        this.setFrame(frame);

        if (this.auto && !this.lifespan && this.time > this.duration && this.collection && !this.loop) this.collection.remove(this);

    },

    pause() {

        this.paused = true;

    },

    unpause() {

        this.paused = false;

    },

    hide() {

        this.hidden = true;

    },

    show() {

        this.hidden = false;

    },

    restart() {

        this.time = 0;
        this.progress = 0;
        if (this.ready) this.setFrame(0);

    },

    render() {

        if (this.delay > 0) return;

        if (this.hidden) return;

        if (!this.ready) return;


        let gl = app.gl;

        /* Alpha */

        gl.enable(gl.BLEND);
        gl.blendFunc(gl.SRC_ALPHA, this.blendDst);

        /* Assign shaders */

        gl.useProgram(this.program.native);

        /* Position */

        gl.enableVertexAttribArray(this.program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(this.program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        gl.activeTexture(gl.TEXTURE1);
        gl.bindTexture(gl.TEXTURE_2D, app.textures.palette);

        gl.activeTexture(gl.TEXTURE0);
        gl.bindTexture(gl.TEXTURE_2D, this.texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

        gl.enableVertexAttribArray(this.program.locations.uv);
        gl.bindBuffer(gl.ARRAY_BUFFER, app.quad);
        gl.vertexAttribPointer(this.program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        this.program.set("texture", 0);
        this.program.set("paletteTexture", 1);
        this.program.set("palette", this.palette);
        this.program.set("dissolve", this.dissolve);
        this.program.set("creation", this.creation);


        this.program.set("rw", this.region[2]);
        this.program.set("rh", this.region[3]);

        this.program.set("alpha", this.alpha);
        this.program.set("tx", this.region[0] / this.texture.width);
        this.program.set("ty", this.region[1] / this.texture.height);
        this.program.set("tw", this.region[2] / this.texture.width);
        this.program.set("th", this.region[3] / this.texture.height);
        this.program.set("color", this.color.r, this.color.g, this.color.b, this.color.a);

        var matrix = this.modelMatrix;

        if (true || this.needMatrixUpdate) this.updateMatrix();

        this.program.set("modelMatrix", this.modelMatrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

        if (this.shadow) {

            let z = this.z;

            this.z = 0;

            this.updateMatrix();

            this.program.set("color", 0x000000);
            this.program.set("alpha", 0.25);
            // this.program.set("creation", 0.0);
            this.program.set("modelMatrix", this.modelMatrix);

            gl.drawArrays(gl.TRIANGLES, 0, 6);

            this.z = z;

        }

    },

    updateMatrix() {

        let matrix = this.modelMatrix;

        Matrix3.reset(matrix);
        Matrix3.translate(matrix, this.x + this.offsetX | 0, this.y + this.offsetY - this.z | 0);
        Matrix3.rotate(matrix, -this.rotation);
        Matrix3.translate(matrix, this.trim[0] * this.scale.x - this.scale.x * this.data.width * this.pivot.x | 0, this.trim[1] * this.scale.y - this.scale.y * this.data.height * this.pivot.y | 0);
        if (this.scale.x !== 1.0 || this.scale.y !== 1.0) Matrix3.scale(matrix, this.scale.x, this.scale.y);

        this.needMatrixUpdate = false;

    }

};


PLAYGROUND.Application.prototype.spritePromises = {};
PLAYGROUND.Application.prototype.loadSprite = function(key) {

    var app = this;

    if (app.spritePromises[key]) return app.spritePromises[key];

    if (!app.sprites) app.sprites = {};

    if (app.sprites[key]) return;

    this.loader.add();

    var json_url = app.rewriteURL("sprites/" + key + ".json");

    var path = key.split("/");

    path.pop();
    path = path.join("/");

    var promise = new Promise(function(resolve, reject) {

        return app.request(json_url).then(function(request) {

            var raw = request.responseText;
            var json = JSON.parse(raw);

            // app.sprites[key] = json;

            var url = json.src ? json.src : (key + ".png");

            let textureOptions = {};

            if (json.usePalette) textureOptions.usePalette = true;

            var result = app.loadTexture("<sprites/" + url + "> sprites/" + key, textureOptions);

            result.then(function(texture) {

                json.texture = texture;

                app.insertAsset(json, app.sprites, key);

                app.loader.success("sprite " + key);

                resolve();

            });


            return result;

        });

    });

    app.spritePromises[key] = promise;

    return promise;

};

/* file: script/entities/Text.js */

CLIENT.Text = function(args) {

    this.x = 0;
    this.y = 0;

    Object.assign(this, args);

    this.image = new CLIENT.Image;

    this.colorsCycle = null;
    this.colorsCycleInterval = 0.2;
    this.colorsCycleTimestamp = -1.0;
    this.colorsCycleIndex = 0;

};

CLIENT.Text.prototype = {

    constructor: CLIENT.Text,

    set text(text) {

        this._text = text;

        this.refresh();

    },

    get text() {

        return this._text;

    },

    setColorCycle(colors, interval = 0.2) {

        this.colorsCycle = colors;
        this.colorsCycleInterval = interval;
        this.colorsCycleTimestamp = -interval;
        this.colorsCycleIndex = 0;

    },

    refresh() {

        let canvas = app.tempCanvas;
        let ctx = app.tempCanvas.ctx;

        let fontSize = 16;

        ctx.font = fontSize + "px 'generic'";

        let width = ctx.measureText(this.text).width;
        let height = fontSize * 2;

        canvas.width = Utils.nearestPOT(width);
        canvas.height = Utils.nearestPOT(height);

        ctx.font = fontSize + "px 'generic'";
        ctx.fillStyle = "#fff";
        ctx.textBaseline = "middle";
        // ctx.fillText(this.text, 0.5, (height / 2 | 0) + 0.5);
        ctx.fillText(this.text, 0.0, (height / 2 | 0) + 0.5);

        this.image.setTexture(app.textureFromCanvas(canvas));
        this.image.setRegion(0, 0, width, height);

        canvas.style.position = "absolute";
        canvas.style.zIndex = "1";

    },

    step() {

    },

    render() {

        this.image.x = this.x;
        this.image.y = this.y;
        this.image.scale = 0.5;

        if (this.colorsCycle) {

            if (app.lifetime - this.colorsCycleTimestamp > this.colorsCycleInterval) {

                this.colorsCycleIndex = (this.colorsCycleIndex + 1) % this.colorsCycle.length;
                this.colorsCycleTimestamp = app.lifetime;

                let color = this.colorsCycle[this.colorsCycleIndex];

                this.image.r = color[0];
                this.image.g = color[1];
                this.image.b = color[2];

            }

        }

        this.image.render();

    }

};

/* file: script/entities/TilingImage.js */

NAMESPACE.TilingImage = function() {

    this.x = 0;
    this.y = 0;
    this.width = -1;
    this.height = -1;

    this.options = null;
    this.ready = false;
    this.rotation = 0.0;
    this.lifetime = 0;
    this.scale = 1.0;
    this.alpha = 1.0;

    this.repeatX = 1.0;
    this.repeatY = 1.0;
    this.repeatOffsetX = 0.0;
    this.repeatOffsetY = 0.0;

    this.blendSrc = app.gl.SRC_ALPHA;
    this.blendDst = app.gl.ONE_MINUS_SRC_ALPHA;

    this.needUpdateUV = false;

    this.setup();

    let gl = app.gl;

    if (!NAMESPACE.TilingImage.prototype.uvBuffer) {

        let uvBuffer = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, uvBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([
            0.0, 0.0,
            1.0, 0.0,
            1.0, 1.0,
            1.0, 1.0,
            0.0, 1.0,
            0.0, 0.0
        ]), gl.STATIC_DRAW);

        NAMESPACE.TilingImage.prototype.uvBuffer = uvBuffer;

    }

};

Object.assign(NAMESPACE.TilingImage.prototype, {

    zIndex: 0,

    setTexture(key) {

        if (typeof key === "string") {

            this.src = key;

            this.ready = false;

            if (!app.textures[key]) {

                app.loadTexture(key).then(() => {

                    this.run(app.textures[this.src]);

            });

            } else {

                this.run(app.textures[this.src]);

            }

        } else {

            this.run(key);

        }

    },

    meshArray: new Float32Array([
        0.0, 0.0,
        1.0, 0.0,
        1.0, 1.0,
        1.0, 1.0,
        0.0, 1.0,
        0.0, 0.0
    ]),

    run(texture) {

        this.texture = texture;

        this.ready = true;


    },

    setup() {

        let gl = app.gl;

        let program = this.program = app.programs.tiling_image;

        /* Mesh */

        this.modelMatrix = Matrix3.create();
        this.positionBuffer = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, this.meshArray, gl.STATIC_DRAW);

    },


    step(dt) {

        this.lifetime += dt;

    },

    render() {

        if (!this.ready) return;

        let gl = app.gl;

        /* Alpha */


        gl.enable(gl.BLEND);
        gl.blendFunc(this.blendSrc, this.blendDst);

        /* Assign shaders */

        gl.useProgram(this.program.native);

        /* Position */

        gl.enableVertexAttribArray(this.program.locations.position);

        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);
        gl.vertexAttribPointer(this.program.locations.position, 2, gl.FLOAT, false, 0, 0);

        /* Texturing */

        gl.activeTexture(gl.TEXTURE0);
        gl.enableVertexAttribArray(this.program.locations.uv);
        gl.bindTexture(gl.TEXTURE_2D, this.texture);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);


        gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);
        gl.vertexAttribPointer(this.program.locations.uv, 2, gl.FLOAT, false, 0, 0);

        let width = this.width;

        if (this.width < 0) {

            width = this.texture.width;

        }

        let height = this.height;

        if (this.height < 0) {

            height = this.texture.height;

        }

        this.program.set("alpha", this.alpha);

        this.program.set("width", width);
        this.program.set("height", height);

        this.program.set("repeatX", this.repeatX);
        this.program.set("repeatY", this.repeatY);

        this.program.set("repeatOffsetX", this.repeatOffsetX / this.texture.width);
        this.program.set("repeatOffsetY", this.repeatOffsetY / this.texture.height);


        this.program.set("texture", 0);

        var matrix = Matrix3.create();

        Matrix3.translate(matrix, this.x, this.y);
        if (this.rotation) Matrix3.rotate(matrix, -this.rotation);
        // Matrix3.translate(matrix, (-width / 2) * this.scale | 0, (-height / 2) * this.scale | 0);
        if (this.scale !== 1.0) Matrix3.scale(matrix, this.scale, this.scale);

        this.program.set("modelMatrix", matrix);

        /* Draw */

        gl.drawArrays(gl.TRIANGLES, 0, 6);

    }

});

/* file: script/entities/Totem.js */

CLIENT.Totem = function(args) {

    this.x = 0;
    this.y = 0;
    this.z = 0;

    Object.assign(this, args);

    this.tween = new CLIENT.Tween(this);

    this.interactive = true;
    this.clickable = true;

    this.lifetime = 0.0;
    this.liftLifespan = 0.0;
    this.lifted = false;
    this.z = 50;
    this.put();

    this.level = 0;
    this.prev = 0;

};

CLIENT.Totem.prototype = {

    zIndex: 1,

    constructor: CLIENT.Totem,

    shape: COMMON.CIRCLE,

    radius: 4,
    interactiveRadius: 16,
    interactiveIndex: 3,

    groups: ["interactive"],

    systemShadow: 8,

    tooltip: "totem",

    lift() {

        this.lifted = true;

        if (this.player) {

            app.sound.play("organic/rock_debris").rate(0.75).rrate(0.2);

            this.zIndex = 1.1;

        }

        this.liftLifespan = 0.5;

        app.tween(this).discard().to({
            z: 24 + (PLAYGROUND.MOBILE ? -COMMON.MOBILE_CURSOR_OFFSET : 0)
        }, 0.1);

    },

    put() {

        this.lifted = false;

        app.tween(this).to({
            z: 0
        }, 0.5, "outBounce");

        let debris = this.collection.add("Sprite");

        let scale = 0.5;

        debris.delay = 0.2;
        debris.set("fx/dust");
        debris.scale.x = scale;
        debris.scale.y = scale;
        debris.x = this.x;
        debris.y = this.y;
        debris.zIndex = 0;
        debris.duration = 1.0;

        if (this.inView && this.player) {

            app.sound.play("impact/ground_medium").delay(debris.delay).gpan(this).volume(0.25);

            app.game.fxCameraStomp();

        }

    },

    pointerdown() {

        if (!this.player) return;

        if (!PLAYGROUND.MOBILE) this.game.action.set("moveTotem", this);

    },

    dragstart() {

        if (!this.player) return;

        if (PLAYGROUND.MOBILE) this.game.action.set("moveTotem", this);

    },

    enterview() {

    },

    leaveview() {

    },

    debris() {

        let debris = this.collection.add("Sprite");

        let duration = this.z * 0.02;

        debris.set("fx/stone");

        let scale = Utils.randomf(0.1, 0.25);

        debris.shadow = true;
        debris.scale.x = scale;
        debris.scale.y = scale;
        debris.x = this.x + Utils.random(-8, 8);
        debris.y = this.y + Utils.random(-8, 8);
        debris.z = this.z;
        debris.shadow = true;
        debris.loop = true;
        debris.duration = duration * 0.3;

        app.tween(debris).to({
            z: 0
        }, duration, "outBounce");

        app.tween(debris.scale).delay(duration * 0.5).to({
            x: 0,
            y: 0,
        }, duration);


        debris.lifespan = duration;

    },

    step(dt) {

        if (this.group === this.game.player) {

            this.interactiveIndex = 10;

            this.x = this.group.tx | 0;
            this.y = this.group.ty | 0;

        } else {

            this.x = this.group.x | 0;
            this.y = this.group.y | 0;

        }

        this.tween.step(dt);

        this.lifetime += dt;

        if (this.liftLifespan > 0) {

            this.liftLifespan -= dt;

            if (Utils.interval(this, "lifted", (0.5 - this.liftLifespan) * 0.2)) this.debris();


        }


    },

    setLevel(level) {

        this.levelChange = 1.0;
        this.prev = this.level;
        this.level = level;

    },

    render() {

        if (!this.group) return;

        if (!this.player) {

            this.x = this.group.x;
            this.y = this.group.y;

            let lift = this.group.x !== this.group.shared.x || this.group.y !== this.group.shared.y;

            if (lift && !this.lifted) this.lift();
            if (!lift && this.lifted) this.put();

        }



        app.painter.reset();

        if (this.group.shared.name) {

            app.painter.color(this.group.color);
            app.painter.font("small_shadeless");
            app.painter.fillText(this.group.shared.name, this.x, this.y - 32 - this.z);
            app.painter.color(-1);

        }

        app.painter.palette(this.group.palette);
        app.painter.align(0.5, 0.8);

        if (this.lifespan) {

            app.painter.creation(2.0 - this.lifespan);

        }

        app.painter.drawSprite("totem", this.x | 0, this.y - this.z | 0);

        app.painter.reset();

        if (this.levelChange > 0) {

            this.levelChange = Math.max(0, this.levelChange - app.elapsed);
            app.painter.creation(1.0 - this.levelChange);
            app.painter.drawImageRegion(app.textures.leaderboards, (this.prev % 8) * 15, (this.prev / 8 | 0) * 16, 15, 16, this.x, this.y - this.z - 16);

        }

        app.painter.creation(this.levelChange);
        app.painter.drawImageRegion(app.textures.leaderboards, (this.level % 8) * 15, (this.level / 8 | 0) * 16, 15, 16, this.x, this.y - this.z - 16);

        app.painter.reset();

        if (!this.player && this.z > 0) {
            app.painter.drawSprite("cursor/grip", this.x + 4, this.y - this.z, 4, 48);
            app.painter.alpha(0.25);
            app.painter.color(this.group.color);
            app.painter.drawSprite("cursor/grip", this.x + 4, this.y - this.z, 4, 48);
        }

    }

};

/* file: script/entities/Trail.js */

CLIENT.Trail = function() {

    this.follow = null;

};

Object.assign(CLIENT.Trail.prototype, {

    create() {

        this.lastX = this.follow.position.x;
        this.lastZ = this.follow.position.z;

        var material = app.materials.trail.clone();

        // material.blending = THREE.AdditiveBlending;

        material.side = THREE.DoubleSide;
        material.depthWrite = false;

        /*
        var material = new THREE.MeshBasicMaterial({
          color: 0x0000ff,
          side: THREE.DoubleSide
        });
        */

        // this.geometry = new THREE.Geometry();
        this.geometry = new THREE.PlaneGeometry(2, 2, 1, 6);

        var mesh = new THREE.Mesh(this.geometry, material);

        CLIENT.Game.scene.add(mesh);

        this.mesh = mesh;

        this.mesh.position.y = 0.0;

    },

    step(dt) {

        let dx = this.mesh.position.x - this.follow.position.x;
        let dz = this.mesh.position.z - this.follow.position.z;

        this.mesh.position.x = this.follow.position.x;
        this.mesh.position.z = this.follow.position.z;

        this.geometry.verticesNeedUpdate = true;

        this.geometry.vertices[0].x = 0;
        this.geometry.vertices[0].z = 0;
        this.geometry.vertices[0].y = 0;
        this.geometry.vertices[1].x = 0;
        this.geometry.vertices[1].z = 0;
        this.geometry.vertices[1].y = 0;

        let angle = Utils.atan2(dz, dx);
        let r = 1.0;


        this.geometry.vertices[0].x += Math.cos(angle - Math.HPI) * r;
        this.geometry.vertices[0].z += Math.sin(angle - Math.HPI) * r;

        this.geometry.vertices[1].x += Math.cos(angle + Math.HPI) * r;
        this.geometry.vertices[1].z += Math.sin(angle + Math.HPI) * r;


        this.geometry.vertices[0].y -= this.follow.roll * r;
        this.geometry.vertices[1].y += this.follow.roll * r;


        for (var i = 2; i < this.geometry.vertices.length; i++) {

            this.geometry.vertices[i].x += dx;
            this.geometry.vertices[i].z += dz;

        }

        if (!Utils.interval(this, "trail", 0.15)) return;

        // this.mesh.quaternion.copy(CLIENT.Game.camera.quaternion);

        for (var i = this.geometry.vertices.length - 1; i > 1; i--) {

            this.geometry.vertices[i].copy(this.geometry.vertices[i - 2]);

        }

        for (var i = this.geometry.vertices.length - 1; i > 1; i--) {

            this.geometry.vertices[i].x = Utils.lerp(this.geometry.vertices[i].x, this.geometry.vertices[i - 1].x, 0.075);
            this.geometry.vertices[i].z = Utils.lerp(this.geometry.vertices[i].z, this.geometry.vertices[i - 1].z, 0.075);

        }

    },

    xstep(dt) {

        let dx = this.mesh.position.x - this.follow.position.x;
        let dz = this.mesh.position.z - this.follow.position.z;

        this.mesh.position.x = this.follow.position.x;
        this.mesh.position.z = this.follow.position.z;

        let next = this.follow.position;

        let cx = Utils.lerp(this.geometry.vertices[0].x, this.geometry.vertices[1].x, 0.5);
        let cz = Utils.lerp(this.geometry.vertices[0].z, this.geometry.vertices[1].z, 0.5);

        this.geometry.vertices[0].copy(next);
        this.geometry.vertices[1].copy(next);

        let angle = Utils.atan2(cz - next.z, cx - next.x);
        let r = 1.0;

        this.geometry.vertices[0].x += Math.cos(angle - Math.HPI) * r;
        this.geometry.vertices[0].z += Math.sin(angle - Math.HPI) * r;

        this.geometry.vertices[1].x += Math.cos(angle + Math.HPI) * r;
        this.geometry.vertices[1].z += Math.sin(angle + Math.HPI) * r;

        this.geometry.vertices[0].y -= this.follow.roll * r;
        this.geometry.vertices[1].y += this.follow.roll * r;


        this.geometry.verticesNeedUpdate = true;

        return
        if (!Utils.interval(this, "trail", 0.1)) return;


        // this.mesh.quaternion.copy(CLIENT.Game.camera.quaternion);

        for (var i = this.geometry.vertices.length - 1; i > 1; i--) {

            this.geometry.vertices[i].copy(this.geometry.vertices[i - 2]);

        }

    }

});

/* file: script/entities/Tree.js */

CLIENT.Tree = function(args) {

    this.x = 0;
    this.y = 0;

    Object.assign(this, args);

    this.parent = this.collection.sid(this.shared.parent_sid);

    if (this.parent) {

        Object.assign(this, this.parent.rpos());

    }

    this.type = Utils.random(1, 5);
    this.sprite = new CLIENT.Sprite();
    this.sprite.set("tree/" + this.type);
    this.sprite.loop = false;
    this.sprite.duration = 1.0;

    this.dead = false;

    this.hitLifespan = 0.0;

    this.row = Utils.random(0, 3);

    this.sprite.range = [this.row * 6, this.row * 6];
    this.direction = Math.HPI * this.row + Math.QPI;

    this.center = {
        x: this.x + Math.cos(this.direction) * 16,
        y: this.y + Math.sin(this.direction) * 16
    }

    this.leaves = [];

    for (var i = 0; i < 6; i++) {

        let debris = this.collection.add("Sprite");

        debris.set("fx/leaves");

        debris.rotation = debris.random * 6.28;

        let scale = 0.5 + Math.random() * 0.5;
        debris.shadow = true;

        debris.scale.x = scale;
        debris.scale.y = scale;

        debris.x = this.x + Utils.random(-20, 20);
        debris.y = this.y;

        debris.z = Utils.random(10, 30);

        debris.color.set(Utils.random(this.leavesColors));

        debris.shadow = true;
        debris.loop = true;
        debris.range = [3, 3];

        this.leaves.push(debris);

    }

    this.lifetime = 0;


    this.update(this.shared);

};

CLIENT.Tree.prototype = {

    constructor: CLIENT.Tree,

    shape: COMMON.CIRCLE,

    heavy: true,

    zIndex: 1,

    radius: 8,
    collisionRadius: 8,

    groups: ["obstacle", "interactive"],

    tooltip: "tree",

    leavesColors: [0xd77bba, 0xd9a066, 0xaa8163, 0xd95763],

    // leavesColors: [0x37946e, 0x6abe30, 0x99e550, 0xfbf236],

    appear() {

        for (let i = 0; i < this.leaves.length; i++) {

            let leaf = this.leaves[i];

            leaf.creation = 1.0;

            app.tween(leaf).delay(1.0 + i * Math.random() * 0.25).to({
                creation: 0.0
            }, 0.5 + Math.random());

        }

        this.sprite.creation = 1.0;

        app.tween(this.sprite).to({
            creation: 0.0
        }, 1.0);

    },

    onHit() {

        if (this.inView) {

            this.hitLifespan = 0.15;

            app.sound.play("tree/chop").rate(0.6).gpan(this);

            let debris = this.collection.add("Sprite");

            debris.set("fx/debris");

            debris.scale.x = 0.3;
            debris.scale.y = 0.3;

            if (this.shared.state === COMMON.TREE_FALLEN) {

                debris.x = this.center.x;
                debris.y = this.center.y + 16;

            } else {

                debris.x = this.x;
                debris.y = this.y + 16;

            }

            debris.duration = 0.5;
            debris.color.set(0xd9a066);

        }


    },

    freeLeaves() {

        if (!this.leaves) return;

        for (let leaf of this.leaves) {

            leaf.range = [3, 16];
            leaf.restart();
            leaf.loop = false;

        }

        this.leaves.length = 0;

    },


    poof() {

        this.freeLeaves();

        if (!this.inView) return;

        if (Math.random() > 0.6) {

            let birdType = Math.random() > 0.75 ? "crow" : "pigeon";
            let count = Utils.random(1, 5);

            for (var i = 0; i < count; i++) {

                let bird = this.collection.add("Bird");

                bird.x = this.x;
                bird.y = this.y;
                bird.z = 24;
                bird.delay = Math.random() * 0.5;
                bird.key = birdType;

                app.tween(bird).to({
                    z: Utils.random(32, 64)
                }, 2.0);

                bird.speed = Utils.random(50, 80);

            }

        }


        let count = 10;

        for (var i = 0; i < count; i++) {

            let debris = this.collection.add("Sprite");

            debris.set("fx/leaves");

            let scale = 0.2 + Math.random() * 0.5;

            debris.rotation = Math.random() * 6.28;

            debris.scale.x = 0;
            debris.scale.y = 0;

            let range = (i / count) * 40;

            debris.x = this.x + Math.cos(this.direction) * range + Utils.random(-10, 10);
            debris.y = this.y + Math.sin(this.direction) * range;

            debris.duration = 2.0;

            debris.color.set(Utils.random(this.leavesColors));

            debris.delay = (i / count);
            debris.shadow = true;

            app.tween(debris.scale).delay(debris.delay).to({
                x: scale,
                y: scale
            }, 0.25);

            app.tween(debris).delay(debris.delay).to({
                z: 10 + Utils.random(0, 20),
            }, 0.25, "outQuad").to({
                z: 0
            }, 1.0, "inQuad")

        }

        app.sound.play("tree/fall");

    },

    enterview() {

        if (this.lifetime < 0.5) {

            this.appear();

        }

    },

    leaveview() {

    },

    update(data) {

        if (data.x !== undefined) this.x = data.x;
        if (data.y !== undefined) this.y = data.y;

        if (data.state !== undefined) {

            if (data.state === COMMON.TREE_FALLING) {

                if (this.zIndex) {

                    this.poof();

                }

                this.sprite.range = [this.row * 6, this.row * 6 + 5];
                this.sprite.restart();
                this.sprite.duration = 1.0;
                this.zIndex = 0;

                this.dead = true;

            } else if (data.state === COMMON.TREE_FALLEN) {

                this.freeLeaves();

            }

        }

        if (data.remove) {

            app.tween(this.sprite).to({

                creation: 1.0

            }, 2.0);

            this.lifespan = 2.0;

        }

        Object.assign(this.shared, data);

    },

    step(dt) {

        this.lifetime += dt;

        if (this.hitLifespan > 0.0) {

            this.hitLifespan -= dt;

            for (let leaf of this.leaves) {

                leaf.rotation = leaf.random * 6.28 + Math.sin(app.lifetime * 100 * this.hitLifespan * leaf.random) * 0.2;

            }

        }

    },

    render() {

        this.sprite.step(app.elapsed);

        this.sprite.x = this.x;
        this.sprite.y = this.y - 8;

        if (this.hitLifespan > 0.0) {

            this.sprite.x += Utils.random(-1, 1);
            this.sprite.y += Utils.random(-1, 1);

            for (let leaf of this.leaves) {
                // leaf.offsetX = Utils.random(-1, 1);
                // leaf.offsetY = Utils.random(-1, 1);
            }


        }

        this.sprite.render();

    }

};

/* file: script/entities/Tribe.js */

ppp = 0;

tnames = [
    "Wilds", "Wanderers", "Atlanteans", "Elves", "Swamplings", "Barbarians"
];

tcolors = [0xd9a066, 0xac3232, 0x639bff, 0x6abe30, 0x37946e, 0xeec39a];

CLIENT.Tribe = function(args) {

    this.tx = 0;
    this.ty = 0;

    this.x = 0;
    this.y = 0;

    this.level = 0;

    Object.assign(this, args);

    this.tween = new CLIENT.Tween(this);
    this.members = [];

    this.palette = ppp;


    ppp = (ppp + 1) % 4;

    this.update(this.shared);

    this.updateAbilities();

    this.tx = this.x = this.shared.x;
    this.ty = this.y = this.shared.y;

    this.palette = this.shared.team;

    this.setTeam(this.shared.team);

    if (this.shared.team !== 5) {

        this.totem = this.collection.add("Totem");
        this.totem.group = this;

    }

    this.words = [];
    this.wordTimeout = 0.0;
    this.wordMemberIndex = 0;

};

CLIENT.Tribe.prototype = {

    zIndex: 1,

    constructor: CLIENT.Tribe,

    shape: COMMON.CIRCLE,

    radius: 4,

    groups: ["tribes"],

    enterview() {



    },

    leaveview() {


    },

    updateAbilities() {

        this.canHunt = false;
        this.canMine = false;
        this.canLumber = false;

        for (let member of this.members) {

            this.canHunt = this.canHunt || member.weaponDef.ranged;
            this.canMine = this.canMine || member.weaponDef.mine;
            this.canLumber = this.canLumber || member.weaponDef.lumber;

        }

    },

    setTeam(team) {

        this.team = team;

        this.palette = team;

        this.color = [
            0xaa6622,
            0xcc2244,
            0x44aaff,
            0x88cc00,
            0x6abe30,
            0xd9a066,
            0xffffff
        ][this.palette];


        for (let member of this.members) member.setTeam(this.team);

    },

    addMember(tribesman) {

        tribesman.i = this.members.length;

        this.members.push(tribesman);

        if (app.game.player === this) app.game.updatePrices();

        tribesman.team = this.team;

        this.updateAbilities();

    },

    removeMember(tribesman) {

        Utils.pull(this.members, tribesman);

        tribesman.group = null;

        if (app.game.player === this) app.game.updatePrices();

        this.updateAbilities();

    },

    checkVisibility() {

        for (let m of this.members) {

            if (m.inView) continue;

            m.x = this.shared.x + Utils.random(-16, 16);
            m.y = this.shared.y + Utils.random(-16, 16);

            m.updateTask();

        }

    },

    update(data) {

        if (data.remove) {

            if (this.totem) {

                this.totem.lifespan = 2.0;

            }

            if (this.inView) {

                for (let tribe of this.collection.groups.tribes) {

                    if (tribe.inView && tribe !== this && tribe.team !== this.team) tribe.hooray();

                }

            }

            if (this === app.game.player) app.game.gameover();

            this.lifespan = 5.0;

        }

        if (this.inView) {

            if (data.x !== undefined) this.tween.to("x", data.x, COMMON.TWEEN_DURATION * 2.0);
            if (data.y !== undefined) this.tween.to("y", data.y, COMMON.TWEEN_DURATION * 2.0);

        } else {

            if (data.x !== undefined) this.x = data.x;
            if (data.y !== undefined) this.y = data.y;

        }

        if (data.team !== undefined) this.setTeam(data.team);


        Object.assign(this.shared, data);

    },

    step(dt) {

        this.tween.step(dt);

        // if (this.inView && Utils.interval(this, "checkVisibility", 1.0)) this.checkVisibility();

        if (this.words.length && this.wordTimeout <= 0) {

            this.wordTimeout = 0.35;

            /*
            this.wordMemberIndex = (this.wordMemberIndex + 1) % this.members.length;

            let member = this.members[this.wordMemberIndex];

            if (!member) {
              this.words.length = 0;
              return;
            }
            */

            this.collection.add("FloatingText", {
                x: this.totem.x,
                y: this.totem.y - 40,
                font: "small",
                text: this.words.shift(),
                color: this.color,
                duration: 2.5
            });

        } else {

            this.wordTimeout -= dt;

        }

    },

    hooray() {

        for (let member of this.members) {

            member.hooray(Math.random());

        }

    },

    setPalette(palette) {

        this.palette = palette;

        for (let t of this.members) {

            t.bodySprite.palette = t.group.palette;
            t.helmetSprite.palette = t.group.palette;
            t.legsSprite.palette = t.group.palette;

            for (let s of t.sprites) {
                s.creation = 1.0;
                app.tween(s).to({
                    creation: 0.0
                }, 0.5);
            }
            t.legsSprite.creation = 1.0;
            app.tween(t.legsSprite).to({
                creation: 0.0
            }, 0.5);


            if (palette === 5) t.helmetSprite.palette = 0;

        }

    },

    say(text) {

        let words = text.split(" ");

        this.words = words;

    },

    render() {

        return;

        app.painter.reset()
        app.painter.drawImageRegion(app.textures.spritesheet_p, 0, 0, 21, 22, this.x, this.y);

        app.painter.reset()
        app.painter.scale(4.0, 3.0);
        app.painter.drawImageRegion(app.textures.palette, 0, this.palette, 12, 1, this.x, this.y - 70, 12, 1);

        app.painter.reset()
        app.painter.color(0x000000);
        app.painter.fillText(tnames[this.palette], this.x, this.y - 63);
        app.painter.color(tcolors[this.palette]);
        app.painter.fillText(tnames[this.palette], this.x, this.y - 64);

    }

};

/* file: script/entities/Tribesman.js */

NAMESPACE.Tribesman = function(args) {

    this.team = 0;
    this.fallDirection = 0;

    this.lifetime = Math.random();

    this.maxHealth = 1;

    this.shieldHit = 0.0;

    this.x = Math.random() * 100;
    this.y = Math.random() * 100;
    this.z = 0;
    this.i = 0;
    this.ox = 0;
    this.oy = 0;
    this.force = 0;
    this.forceDirection = 0;

    this.destinationDistance = 0;

    this.dead = false;

    this.destination = {};
    this.lookAt = null;

    this.weapon = 0;
    this.helmet = 0;
    this.shield = 0;

    this.weaponDef = {};
    this.helmetDef = {};
    this.shieldDef = {};

    Object.assign(this, args);

    this.tween = new CLIENT.FollowingTween(this);

    this.group = this.collection.sid(this.shared.group_sid);

    if (this.group) this.group.addMember(this);

    this.state = new CLIENT.State(this, CLIENT.Tribesman.States);

    this.direction = this.lookAt = Math.random() * 6.0;
    this.sprites = [];

    this.sprites.push(this.bodySprite = new CLIENT.Sprite);
    this.sprites.push(this.weaponSprite = new CLIENT.Sprite);
    this.sprites.push(this.shieldSprite = new CLIENT.Sprite);
    this.sprites.push(this.helmetSprite = new CLIENT.Sprite);
    // this.sprites.push(this.ears = new CLIENT.Sprite);


    this.helmet = 0;
    this.weapon = 0;
    this.shield = 0;

    this.setKind("human");

    // this.ears.prefix = `tribesman/elf_ears/`;
    this.weaponSprite.prefix = `tribesman/axe/`;
    this.helmetSprite.prefix = `tribesman/hood/`;
    this.shieldSprite.prefix = "tribesman/wooden_shield/";

    this.bodySprite.set("run");
    this.weaponSprite.set("run");
    this.shieldSprite.set("run");
    this.helmetSprite.set("run");

    this.random = Math.random();
    this.random2 = Math.random();

    this.sin = Math.sin(this.random * Math.TAU);
    this.cos = Math.cos(this.random * Math.TAU);

    for (let sprite of this.sprites) {

        sprite.loop = true;
        sprite.time = this.random;

    }

    this.legsSprite = new CLIENT.Sprite;
    this.legsSprite.set("tribesman/male/legs_run");
    this.legsSprite.loop = true;
    this.legsSprite.time = this.random;

    this.task = 0;
    this.detail = 0;

    if (this.group && this.group === this.game.player && this.game.nextTribesmanPosition) {

        this.shared.x = this.game.nextTribesmanPosition.x;
        this.shared.y = this.game.nextTribesmanPosition.y;

    }

    this.update(this.shared);

    this.destination.x = this.x = this.shared.x;
    this.destination.y = this.y = this.shared.y;

    this.needRefreshSprites = true;

    this.basePoint = {
        x: Math.cos(this.random * 6.28) * COMMON.TRIBE_RADIUS,
        y: Math.sin(this.random * 6.28) * COMMON.TRIBE_RADIUS
    };

    this.moveGrass = true;
    this.isKing = false;

    this.updateMaxHealth();

    this.scaleX = 1.0;
    this.scaleY = 1.0;

    this.setTeam(this.team);


};

NAMESPACE.Tribesman.prototype = {

    constructor: NAMESPACE.Tribesman,

    zIndex: 1,

    radius: 16,
    collisionRadius: 1,

    shape: COMMON.CIRCLE,

    systemLight: 16,
    systemShadow: 5,

    groups: ["tribesman", "movable"],

    _destruct: function() {

    },

    enterview() {

        this.updateTask();

    },

    enterHighlight() {

    },

    leaveHighlight() {

    },

    setTeam(team) {

        this.team = team;

        this.bodySprite.palette = this.team;
        this.helmetSprite.palette = this.team;
        this.legsSprite.palette = this.team;

        if (this.group && this.group.palette === 5) this.helmetSprite.palette = 0;


    },

    set timeScale(scale) {

        Utils.arraySet(this.sprites, "timeScale", scale);

    },

    get timeScale() {

        return this.bodySprite ? this.bodySprite.timeScale : 1.0;

    },

    updateMaxHealth() {

        this.maxHealth = COMMON.getMaxHealth(this);

    },

    hit(damage, projectile) {


    },

    hooray(delay = 0) {

        if (!this.inView) return;

        app.tween(this).delay(delay).to({
            z: 20
        }, 0.25, "outSine").to({
            z: 0
        }, 0.5, "outBounce");

        if (this.team === app.game.player.team) app.sound.play("human/hooray_" + Utils.random(3, 5)).delay(delay).gpan(this).rate(1.25).rrate(0.2);
        else app.sound.play("human/hooray_" + Utils.random(1, 4)).delay(delay).gpan(this).rate(1.5).rrate(0.2);

        setTimeout(() => {

            Utils.arrayCall(this.sprites, "set", "roll");
        Utils.arraySet(this.sprites, "duration", 1.0);

    }, delay * 1000);

    },

    poke() {

        let duration = 1.5;

        app.tween(this).to({
            scaleY: 1.25,
            scaleX: 0.75
        }, duration * 0.25, "outSine").to({
            scaleY: 1.0,
            scaleX: 1.0
        }, duration * 0.5, "outElastic");

    },

    refreshSprites() {

        this.needRefreshSprites = false;

        let loop = this.bodySprite.loop;
        let time = this.bodySprite.time;
        if (this.weapon) {

            let key = COMMON.itemsByIndex[this.weapon].key;
            this.weaponSprite.show();
            this.weaponSprite.prefix = `tribesman/${key}/`;
            this.weaponSprite.set(this.bodySprite.key);
            this.weaponSprite.loop = loop;
            this.weaponSprite.time = time;

            this.weaponSprite.offsetY = -30;

            app.tween(this.weaponSprite).to({
                offsetY: 0.0
            }, 0.5, "outBounce");

        } else this.weaponSprite.hide();

        if (this.helmet) {

            let key = COMMON.itemsByIndex[this.helmet].key;

            this.helmetSprite.show();
            this.helmetSprite.prefix = `tribesman/${key}/`;
            this.helmetSprite.set(this.bodySprite.key);
            this.helmetSprite.loop = loop;
            this.helmetSprite.time = time;

            if (this.helmet === COMMON.itemsByKey.crown.index) this.isKing = true;

            this.helmetSprite.offsetY = -30;

            app.tween(this.helmetSprite).to({
                offsetY: 0.0
            }, 0.5, "outBounce");

            this.updateMaxHealth();

        } else this.helmetSprite.hide();

        if (this.shield) {

            let key = COMMON.itemsByIndex[this.shield].key;

            this.shieldSprite.show();
            this.shieldSprite.prefix = `tribesman/${key}/`;
            this.shieldSprite.set(this.bodySprite.key);
            this.shieldSprite.loop = loop;
            this.shieldSprite.time = time;

            this.shieldSprite.offsetY = -30;

            app.tween(this.shieldSprite).to({
                offsetY: 0.0
            }, 0.5, "outBounce");

        } else this.shieldSprite.hide();

    },

    get groupInView() {

        return (this.group && this.group.inView) || this.inView;

    },

    die() {

        this.systemLight = false;

        this.state.set("dead");

        this.dead = true;

    },

    setKind(kind) {

        if (kind === "human") kind = Math.random() > 0.5 ? "female" : "male";

        this.bodySprite.prefix = `tribesman/${kind}/`;

        if (this.bodySprite.key) this.bodySprite.set(this.bodySprite.key);

    },

    updateTask() {

        if (this.task === COMMON.TASKS.FIGHT) {

            this.game.emote(this);

        } else if (this.task === COMMON.TASKS.CAMP) {

            this.state.set("camp");

        } else if (this.task === COMMON.TASKS.MINE) {

            this.lookAt = this.destination;

            this.state.set("mine");

        } else if (this.task === COMMON.TASKS.HARVEST) {

            let meadow = this.collection.sid(this.detail);

            if (meadow) {

                let grass = Utils.minBy(meadow.grass, this.getGrassEaten);

                if (grass) {

                    grass.temp.eaten = 0.1;

                    this.lookAt = grass;
                    this.destination.x = grass.x + this.sin * 16;
                    this.destination.y = grass.y + this.cos * 16;

                }

            }

        } else if (this.task === COMMON.TASKS.BIRTH) {

            this.state.set("birth");

        } else if (this.task === COMMON.TASKS.LOOT) {

            this.state.set("loot");

        } else if (this.task === COMMON.TASKS.RECOVER) {

            this.state.set("recover");

        } else if (this.task === COMMON.TASKS.COLLECT) {

            this.state.set("collect");

        } else if (this.task === COMMON.TASKS.PANIC) {

            this.state.set("panic");

        } else if (this.task === COMMON.TASKS.DIE) {

            this.die();

        } else {

            this.state.set("idle");

        }

    },

    update(data) {

        if (data.group_sid !== undefined) {

            if (!data.group_sid && this.group) this.group.removeMember(this);

        }

        if (data.x !== undefined && !this.groupInView) this.x = data.x;
        if (data.y !== undefined && !this.groupInView) this.y = data.y;

        if (data.equipment !== undefined) {

            this.weapon = COMMON.itemsByIndex[data.equipment % 256].index;
            this.shield = COMMON.itemsByIndex[(data.equipment / 256 | 0) % 256].index;
            this.helmet = COMMON.itemsByIndex[(data.equipment / 65536 | 0) % 256].index;

            this.weaponDef = COMMON.itemsByIndex[this.weapon];
            this.helmetDef = COMMON.itemsByIndex[this.helmet];
            this.shieldDef = COMMON.itemsByIndex[this.shield];

            this.needRefreshSprites = true;

            if (this.group) this.group.updateAbilities();

        }

        if (data.remove) {

            if (this.groupInView) {

                this.lifespan = 5.0;

                app.tween(this.bodySprite).delay(3.0).to({
                    creation: 1.0
                }, 2.0);

                app.tween(this.legsSprite).delay(3.0).to({
                    creation: 1.0
                }, 2.0);

            } else {

                this.collection.remove(this);

            }

        }

        if (data.health !== undefined) {

            if (data.health <= 0) this.die();

            if (data.health < this.shared.health) {

                if (data.health > 0) {

                    if (this.inView) {

                        app.sound.play("human/pain_" + Utils.random(1, 3)).rate(3.0).gpan(this);
                        app.sound.play("weapon/hit").rrate(0.2).gpan(this);
                        app.sound.play("human/hit_flesh").rrate(0.2).gpan(this);

                    }

                } else {

                    if (this.inView) {

                        app.sound.play("human/hit_flesh").rrate(0.2).gpan(this);
                        app.sound.play("human/death_" + Utils.random(1, 3)).rate(2.0).rrate(0.1).gpan(this);

                    }

                }

                this.hitLifespan = 0.5;

                if (this.inView) {

                    let blood = this.collection.add("Sprite");

                    blood.set("fx/blood_1");
                    blood.follow = this;
                    blood.duration = 0.6;
                    blood.rotation = Math.random() * 6.28;
                    blood.scale.x = 0.5;
                    blood.scale.y = 0.5;

                }


                // Utils.arraySet(this.sprites, "loop", false);
                // Utils.arraySet(this.sprites, "duration", 0.5);
                // Utils.arrayCall(this.sprites, "set", "block");

                // this.force = 150;
                // this.forceDirection = this.direction - Math.PI;

            }

        }

        if (data.status !== undefined) {

            if (data.status & COMMON.STATUS.LOOTED) {

                this.setKind("corpse");

                Utils.arrayCall(this.sprites, "set", "fall_back");
                Utils.arraySet(this.sprites, "duration", 1.0);
                Utils.arraySet(this.sprites, "loop", false);
                Utils.arraySet(this.sprites, "range", [0, 8]);

                this.bodySprite.time = this.bodySprite.duration * 0.6;

                app.tween(this.weaponSprite).to({
                    dissolve: 1.0
                }, 1.0);

                app.tween(this.shieldSprite).to({
                    dissolve: 1.0
                }, 1.0);

                app.tween(this.helmetSprite).to({
                    dissolve: 1.0
                }, 1.0);

                // this.weaponSprite.hide();
                // this.shieldSprite.hide();
                // this.helmetSprite.hide();
            }

        }

        if (data.occupation !== undefined) {

            this.task = data.occupation % 100;
            this.detail = data.occupation / 100 % 10000000 | 0;

            if (this.groupInView) this.updateTask();

        }

        Object.assign(this.shared, data);

    },

    getGrassEaten(g) {

        return g.temp.eaten;

    },

    getScore() {

        return Math.ceil(COMMON.getTribesmanScore(this) * 0.25);

    },

    run(texture) {

        this.texture = texture;

        this.ready = true;

    },

    step(dt) {

        if (this.shared.health <= 0 && !this.dead) this.die();

        if (this.group) {

            this.basePoint.x = this.group.x + this.cos * 50;
            this.basePoint.y = this.group.y + this.sin * 50;

        } else {

            this.basePoint.x = this.x;
            this.basePoint.y = this.y;

        }

        if (!this.inView) {

            if (this.group && !Utils.quickPointInRange(this.group.x, this.group.y, this.x, this.y, COMMON.TRIBE_RADIUS)) {

                this.x = this.group.x;
                this.y = this.group.y;

            }

            this.destination.x = this.x;
            this.destination.y = this.y;

            return;

        }

        this.state.step(app.elapsed);

        this.lifetime += dt;

        if (this.force) {

            this.force = Utils.moveTo(this.force, 0, 200 * dt);

            this.x += Math.cos(this.forceDirection) * this.force * dt;
            this.y += Math.sin(this.forceDirection) * this.force * dt;

        }

        if (this.hitLifespan > 0.0) this.hitLifespan -= dt;

        this.tween.step(dt);

        if (!this.dead) {

            this.processTask(dt);

            let distance = Utils.distance(this, this.destination);

            this.destinationDistance = distance;

            if (distance > 2 && !this.state.current.cantMove) {

                if (this.group && this.group === app.game.player && Utils.interval(this, "footstep", 0.5)) {

                    if (this.inGrass) {

                        app.sound.play("human/footstep_grass").volume(0.35).gpan(this).rate(1.0).rrate(0.1);

                    } else {

                        app.sound.play("human/footstep_b_" + Utils.random(1, 2)).volume(0.35).gpan(this).rrate(0.1);

                    }

                }

                let destinationAngle = Utils.lookAt(this, this.destination);

                if (this.task === COMMON.TASKS.CAMP) distance *= this.random;

                let speed = distance + 32;

                this.x += Math.cos(destinationAngle) * (speed) * dt;
                this.y += Math.sin(destinationAngle) * (speed) * dt;

                this.legsSprite.unpause();

            } else {

                this.legsSprite.restart();
                // this.legsSprite.pause();

            }

            if (this.lookAt) {

                if (typeof this.lookAt === "number") {

                    this.direction = Utils.circWrapTo(this.direction, this.lookAt, 6 * app.elapsed);

                } else {

                    this.direction = Utils.circWrapTo(this.direction, Utils.lookAt(this, this.lookAt), 6 * app.elapsed);

                }

            }

        }



    },

    processTask(dt) {

        if (this.game.pointer.alert) return;

        if (this.task === COMMON.TASKS.FIGHT) {

            let target = this.collection.sid(this.detail);

            if (!target) return;

            let angle = Utils.lookAt(target, this.group);

            if (target.weaponDef && target.weaponDef.melee) {

                let dir = Utils.lookAt(this.basePoint, target.basePoint ? target.basePoint : target) - Math.PI;

                if (target.detail === this.sid && this.id > target.id) {

                    // this.destination.x = this.basePoint.x + (target.basePoint.x - this.basePoint.x) * 0.5 - Math.cos(dir) * 8;
                    // this.destination.y = this.basePoint.y + (target.basePoint.y - this.basePoint.y) * 0.5 - Math.sin(dir) * 8;

                    this.destination.x = Utils.lerp(this.basePoint.x, target.group ? target.group.x : this.basePoint.x);
                    // + (target.basePoint.x - this.basePoint.x) * 0.5 - Math.cos(dir) * 16;
                    this.destination.y = Utils.lerp(this.basePoint.y, target.group ? target.group.y : this.basePoint.y);
                    // + (target.basePoint.y - this.basePoint.y) * 0.5 - Math.sin(dir) * 16;

                    // this.destination.x = target.x + Math.cos(angle + this.random * 6) * 24;
                    // this.destination.y = target.y + Math.sin(angle + this.random * 6) * 24;


                } else {

                    this.destination.x = target.x + this.cos * 24;
                    this.destination.y = target.y + this.sin * 24;

                }

                if (Utils.distance(this, this.group) > 100) {

                    let gangle = Utils.lookAt(this.group, this);

                    // this.x = this.group.x + Math.cos(gangle) * 200;
                    // this.y = this.group.y + Math.sin(gangle) * 200;

                }

                // this.destination.x = target.x + Math.cos(angle + this.random * 6) * 24;
                // this.destination.y = target.y + Math.sin(angle + this.random * 6) * 24;



            } else {

                this.destination.x = target.x + this.cos * 24;
                this.destination.y = target.y + this.sin * 24;

            }

            this.lookAt = target;

        } else if (this.task === COMMON.TASKS.CAMP) {

            let target = this.collection.sid(this.detail);

            if (!target) return;

            let s = Math.TAU / this.group.members.length;

            this.destination.x = target.x + Math.cos(s * this.i + this.random * 2) * (24 + this.random * 12);
            this.destination.y = target.y + Math.sin(s * this.i + this.random * 2) * (24 + this.random * 12);

            this.lookAt = target;

        } else if (this.task === COMMON.TASKS.MINE) {

            let target = this.collection.sid(this.detail);

            if (!target) return;

            let angle = this.random * 6.28;

            this.destination.x = target.minePosition.x + Math.cos(angle - Math.PI) * 16;
            this.destination.y = target.minePosition.y + Math.sin(angle - Math.PI) * 16;

            this.lookAt = target.minePosition;

        } else if (this.task === COMMON.TASKS.LUMBER) {

            let target = this.collection.sid(this.detail);

            if (!target) return;

            let angle = this.random * 6.28;

            if (target.shared.state === COMMON.TREE_FALLING) {

                angle = Utils.lookAt(this, target);

                this.destination.x = target.x + Math.cos(angle - Math.PI) * 80;
                this.destination.y = target.y + Math.sin(angle - Math.PI) * 80;
                this.lookAt = target;

            } else if (target.shared.state === COMMON.TREE_FALLEN) {

                this.destination.x = target.center.x + Math.cos(angle) * (target.radius + this.radius);
                this.destination.y = target.center.y + Math.sin(angle) * (target.radius + this.radius);
                this.lookAt = target.center;

            } else {

                this.lookAt = target;
                this.destination.x = target.x + Math.cos(angle) * (target.radius + this.radius);
                this.destination.y = target.y + Math.sin(angle) * (target.radius + this.radius);

            }


        } else if (this.task === COMMON.TASKS.LOOT) {

            let target = this.collection.sid(this.detail);

            if (!target) return;

            let angle = Utils.lookAt(target, this);

            this.destination.x = target.x + Math.cos(angle) * 4;
            this.destination.y = target.y + Math.sin(angle) * 4;

            this.lookAt = target;

        } else if (this.task === COMMON.TASKS.COLLECT) {

            let target = this.collection.sid(this.detail);

            if (target && !this.state.data.crouching) {

                let angle = Utils.lookAt(target, this);

                this.destination.x = target.x + Math.cos(angle) * 4;
                this.destination.y = target.y + Math.sin(angle) * 4;

                this.lookAt = this.destination;

            }

        } else if (this.task === COMMON.TASKS.HUNT) {

            let target = this.collection.sid(this.detail);

            if (!target) return;

            let angle = Utils.lookAt(target.group ? target.group : target, this.group);

            // this.destination.x = this.group.x + Math.cos(angle + (this.random - 0.5) * 1.0) * 50;
            // this.destination.y = this.group.y + Math.sin(angle + (this.random - 0.5) * 1.0) * 50;
            this.destination.x = this.group.x + Math.cos(this.random * 6.28) * 24;
            this.destination.y = this.group.y + Math.sin(this.random * 6.28) * 24;

            this.lookAt = target;

        } else if (this.task === COMMON.TASKS.LEAD || this.helmet === COMMON.itemsByKey.crown.index) {

            this.destination.x = this.group.shared.x;
            this.destination.y = this.group.shared.y;

            this.lookAt = this.group.shared;

        } else if (this.task === COMMON.TASKS.IDLE) {

            this.destination.x = this.basePoint.x;
            this.destination.y = this.basePoint.y;

            this.destination.x = this.group.x + this.sin * 32;
            this.destination.y = this.group.y + this.cos * 32;

            if (this.group.shared.x !== this.group.x) {

                this.lookAt = Utils.lookAt(this.group, this.group.shared);

            } else {

                this.lookAt = this.group;

            }

        } else if (this.task === COMMON.TASKS.PANIC) {

            if (Utils.intervalRange(this, "panic", 0.25, 1.0)) {

                this.destination.x = this.basePoint.x + Utils.random(-COMMON.TRIBE_RADIUS, COMMON.TRIBE_RADIUS);
                this.destination.y = this.basePoint.y + Utils.random(-COMMON.TRIBE_RADIUS, COMMON.TRIBE_RADIUS);
                this.lookAt = this.destination;

            }

        }

    },

    legsY: [0, 0, 0.12697569202151154, 0.5555609039391696, 0.9148130001424937, 1.0, 1.0, 0.8774320490518326, 0.6621635047624876, 0.3537538161691129, 0.04154450834523172, 0, 0, 0.29563636715257974, 0.8015852396513293, 1, 1, 0.839389527701953, 0.4204586086644027, 0, 0],

    render() {

        if (this.needRefreshSprites) this.refreshSprites();

        let oy = this.legsY[this.legsSprite.frame] * 3 | 0;

        if (this.legsSprite.hidden) oy = 0;

        let row = Utils.dirrow(this.direction);

        this.legsSprite.x = this.x + this.ox;
        this.legsSprite.y = this.y - this.z - 4 + this.oy;
        this.legsSprite.row = row;

        this.legsSprite.step(app.elapsed);
        this.legsSprite.render();


        if (this.hitLifespan > 0.0) {

            this.bodySprite.color.set(0xffffff, 1.0);
            this.legsSprite.color.set(0xffffff, 1.0);
            this.helmetSprite.color.set(0xffffff, 1.0);

        } else {

            this.bodySprite.color.set(0x000000, 0.0);
            this.legsSprite.color.set(0x000000, 0.0);
            this.helmetSprite.color.set(0x000000, 0.0);

        }

        if (this.shieldHit > 0.0) {

            this.shieldHit -= app.elapsed;
            this.shieldSprite.color.set(0xffffff);


        } else {

            this.shieldSprite.color.set(0, 0);

        }

        for (let sprite of this.sprites) {

            sprite.step(app.elapsed);
            sprite.x = this.legsSprite.x;
            sprite.y = this.legsSprite.y - oy;
            sprite.row = row;

            // sprite.y -= oy * 1.0 | 0;
            sprite.scale.x = this.scaleX;
            sprite.scale.y = this.scaleY;

            sprite.render();

        }

        if (this.highlighted) {

            app.painter.reset();
            app.painter.drawImageRegion(app.textures.spritesheet, 22, 75, 9, 6, this.x, this.y - this.z - 20 + Math.sin(app.lifetime * 10.0) * 3 | 0, 9, 6);
            app.painter.color(0xffff00);
            app.painter.alpha(0.5);
            app.painter.drawSprite(this.bodySprite.fullKey, this.bodySprite.x, this.bodySprite.y, this.bodySprite.frame, this.bodySprite.row);
        }

        if (this.state.key === "camp" || app.keyboard.keys.shift) {


        }

        if (this.shared.health > 0) this.renderHealth();


        // app.painter.reset();
        // app.painter.color(0xffffff);
        // app.painter.font("small");
        // app.painter.fillText(String(this.detail), this.x, this.y - 20);


    },

    renderHealth() {

        if (!app.game.player) return;

        app.painter.reset();

        let widthA = this.maxHealth * 2 + 1;
        let widthB = this.shared.health * 2;

        let x = this.x - widthA / 2 | 0;
        let y = this.y + 6;

        app.painter.reset();
        app.painter.align(0, 0);

        app.painter.drawImageRegion(app.textures.spritesheet, 22, 82, widthA, 4, x, y, widthA, 4);

        if (this.group === this.game.player) {

            app.painter.drawImageRegion(app.textures.spritesheet, 22, 126, widthB, 4, x, y, widthB, 4);

        } else if (this.team === this.game.player.team) {

            app.painter.drawImageRegion(app.textures.spritesheet, 22, 131, widthB, 4, x, y, widthB, 4);

        } else {

            app.painter.drawImageRegion(app.textures.spritesheet, 22, 87, widthB, 4, x, y, widthB, 4);

        }

    }

};

/* file: script/entities/Tribesman.States.js */

CLIENT.Tribesman.States = {};

CLIENT.Tribesman.States.idle = {

    enter(tribesman, manager) {

        if (tribesman.inView) {

            Utils.arrayCall(tribesman.sprites, "set", "run");
            Utils.arraySet(tribesman.sprites, "duration", 1.0);
            Utils.arraySet(tribesman.sprites, "range", false);
            Utils.arraySet(tribesman.sprites, "loop", true);
            tribesman.legsSprite.show();
            tribesman.lookAt = tribesman.group;

        }

        manager.data.state = "none";

    },

    step(tribesman, manager) {

        let state = "none";

        if (tribesman.group === app.game.player && tribesman.game.pointer.alert && COMMON.canEquip(tribesman, tribesman.game.action.data.equipment)) {

            state = "reaching";

        } else {

            state = "idle";

        }

        if (manager.data.state !== state) {

            manager.data.state = state;

            if (state === "reaching") {

            } else if (state === "idle") {

            }

        }

        if (!tribesman.game.pointer.alert && manager.data.reaching) {

            this.enter(tribesman, manager);

            manager.data.reaching = false;

        }

        if (tribesman.game.pointer.alert && !manager.data.reaching && COMMON.canEquip(tribesman, tribesman.game.action.data.equipment)) {

            Utils.arrayCall(tribesman.sprites, "set", "reach");
            Utils.arraySet(tribesman.sprites, "range", [0, 1]);
            Utils.arraySet(tribesman.sprites, "duration", 0.25);
            tribesman.legsSprite.show();
            tribesman.lookAt = tribesman.game.pointer;

            manager.data.crouching = false;
            manager.data.reaching = true;

        } else if (!tribesman.game.pointer.alert && manager.data.reaching) {

            manager.data.reaching = false;

            manager.set("idle");

        }

    }

};

CLIENT.Tribesman.States.panic = {

    enter(tribesman, manager) {


        Utils.arrayCall(tribesman.sprites, "set", "growl");
        Utils.arraySet(tribesman.sprites, "duration", 1.0);
        Utils.arraySet(tribesman.sprites, "range", false);
        Utils.arraySet(tribesman.sprites, "loop", true);
        tribesman.legsSprite.show();
        tribesman.lookAt = tribesman.destination;

    }

};


CLIENT.Tribesman.States.birth = {

    enter(tribesman) {


        Utils.arrayCall(tribesman.sprites, "set", "roll");
        Utils.arraySet(tribesman.sprites, "duration", 1.5);
        Utils.arraySet(tribesman.sprites, "loop", 0.5);
        tribesman.legsSprite.hide();

        tribesman.z = 32;

        app.tween(tribesman).to({
            z: 0
        }, 2.0, "outBounce");

        // }

    },

    step(tribesman, manager) {

        if (manager.elapsed > 3.0) manager.set("idle");

        if (manager.runOnce(0.8)) {

            app.sound.play("human/pain_1").gpan(tribesman).rate(1.5).rrate(0.1);
            app.sound.play("impact/ground").gpan(tribesman);

            let debris = tribesman.collection.add("Sprite");

            debris.set("fx/debris");
            debris.scale.x = 0.25;
            debris.scale.y = 0.25;
            debris.x = tribesman.x;
            debris.y = tribesman.y - 8;
            debris.duration = 0.5;
            debris.rotation = Math.PI;


        }

        if (manager.runOnce(1.5)) {

            app.sound.play("impact/ground").gpan(tribesman).delay(0.5).volume(0.6);

            Utils.arrayCall(tribesman.sprites, "set", "fall_front");
            Utils.arraySet(tribesman.sprites, "duration", 1.5);
            Utils.arraySet(tribesman.sprites, "loop", false);

        }
    }

};

CLIENT.Tribesman.States.recover = {

    cantMove: true,

    enter(tribesman) {

    }

};


CLIENT.Tribesman.States.shoot = {

    enter(tribesman, manager, args) {

        Utils.arrayCall(tribesman.sprites, "set", "charge_bow");
        Utils.arraySet(tribesman.sprites, "duration", 0.5);
        Utils.arraySet(tribesman.sprites, "range", false);
        Utils.arraySet(tribesman.sprites, "loop", false);

        app.sound.play("bow/pull").rate(1.2).volume(0.45).gpan(tribesman);

        manager.data.shoot = false;

        let target = tribesman.collection.sid(tribesman.detail);

        let distance = Utils.distance(tribesman, target);
        manager.data.flightDuration = 0.1 + Math.min(0.9, distance / 100);

        manager.data.miss = args.miss || 0;
        manager.data.count = args.count || 0;

        if (args.shock) {

            manager.data.flightDuration = Math.min(0.5, distance / 300);

        }

        manager.data.shock = args.shock;

    },

    step(tribesman, manager) {

        if (manager.elapsed > 2.0 - manager.data.flightDuration && !manager.data.shoot) {

            manager.data.shoot = true;

            for (var i = 0; i < manager.data.count; i++) {

                let delay = i * 0.2;
                let arrow = tribesman.collection.add("Arrow");
                let target = tribesman.collection.sid(tribesman.detail);

                if (manager.data.shock) arrow.straight = true;

                arrow.sprite.palette = tribesman.group.palette;

                arrow.x = tribesman.x;
                arrow.y = tribesman.y;
                arrow.delay = delay;
                arrow.miss = false;

                if (i < manager.data.miss) {

                    arrow.miss = true;

                }

                arrow.duration = manager.data.flightDuration + delay;

                arrow.target = target;

                arrow.run();

            }

            app.sound.play("bow/shoot").rate(manager.data.shock ? 1.5 : 1.0).gpan(tribesman);

            if (manager.data.shock) {

                app.sound.play("bow/shock_arrow").rate(2.8).rrate(0.1).gpan(tribesman);

            }

            Utils.arrayCall(tribesman.sprites, "set", "attack_bow");
            Utils.arraySet(tribesman.sprites, "duration", 0.5);
            Utils.arraySet(tribesman.sprites, "range", false);
            Utils.arraySet(tribesman.sprites, "loop", false);



        }

    }

};

CLIENT.Tribesman.States.chop = {

    enter(tribesman, manager) {

        if (tribesman.inView) {

            let target = tribesman.collection.sid(tribesman.detail);

            manager.data.target = target;

            tribesman.force = 55;
            tribesman.forceDirection = tribesman.direction;

            app.sound.play("weapon/whoosh_" + Utils.random(1, 3)).gpan(tribesman);

            Utils.arrayCall(tribesman.sprites, "set", target.shared.state === COMMON.TREE_FALLEN ? "attack_vertical" : "attack_horizontal");
            Utils.arraySet(tribesman.sprites, "loop", false);
            Utils.arraySet(tribesman.sprites, "duration", 0.3);

            let slash = tribesman.collection.add("Sprite");

            slash.set(target.shared.state === COMMON.TREE_FALLEN ? "slash/vertical" : "slash/horizontal");

            slash.follow = tribesman;
            slash.row = Utils.dirrow(tribesman.direction, 16);
            slash.offsetY = -8;
            slash.duration = 0.25;

            manager.data.hit = false;

        }

    },

    step(tribesman, manager) {

        if (manager.elapsed > 0.15 && !manager.data.hit) {

            tribesman.force = 100;
            tribesman.forceDirection = tribesman.direction - Math.PI;

            manager.data.hit = true;

            if (manager.data.target.onHit) manager.data.target.onHit();

        };

        if (manager.elapsed > 0.5) manager.set("idle");

    }

};

CLIENT.Tribesman.States.harvest = {

    enter(tribesman, manager) {

        if (tribesman.inView) {

            let target = tribesman.lookAt;

            if (target._remove) return;
            if (!target) return;
            if (!target.temp) return;

            target.temp.eaten = 2.0;

            app.sound.play("action/harvest").rate(1.0).rrate(0.2).gpan(tribesman);
            app.sound.play("impact/grass").rate(0.5).gpan(tribesman);

            Utils.arrayCall(tribesman.sprites, "set", "spin");
            Utils.arraySet(tribesman.sprites, "loop", false);
            Utils.arraySet(tribesman.sprites, "duration", 0.4);

            let slash = tribesman.collection.add("Sprite");

            slash.set("slash/spin");

            slash.follow = tribesman;
            slash.row = Utils.dirrow(tribesman.direction, 16);
            slash.offsetY = -8;
            slash.duration = 0.4;

            manager.data.hit = false;

        }

    }

};

CLIENT.Tribesman.States.mine = {

    enter(tribesman, manager) {

        if (tribesman.inView) {

            let target = tribesman.collection.sid(tribesman.detail);

            manager.data.target = target;

            if (!target) manager.set("idle");

            tribesman.force = 55;
            tribesman.forceDirection = tribesman.direction;

            app.sound.play("weapon/whoosh_" + Utils.random(1, 3)).gpan(tribesman);

            Utils.arrayCall(tribesman.sprites, "set", "attack_vertical");
            Utils.arraySet(tribesman.sprites, "loop", false);
            Utils.arraySet(tribesman.sprites, "duration", 0.3);

            let slash = tribesman.collection.add("Sprite");

            slash.set("slash/vertical");

            slash.follow = tribesman;
            slash.row = Utils.dirrow(tribesman.direction, 16);
            slash.offsetY = -8;
            slash.duration = 0.25;

            manager.data.hit = false;

        }

    },

    step(tribesman, manager) {

        if (manager.elapsed > 0.15 && !manager.data.hit) {

            tribesman.force = 100;
            tribesman.forceDirection = tribesman.direction - Math.PI;

            manager.data.hit = true;

            let target = manager.data.target;

            if (target) target.mine();

        };

        if (manager.elapsed > 0.5) manager.set("idle");

    }

};


CLIENT.Tribesman.States.block = {

    enter(tribesman, manager) {

        Utils.arrayCall(tribesman.sprites, "set", "block");
        Utils.arraySet(tribesman.sprites, "loop", false);
        // Utils.arraySet(tribesman.sprites, "range", [7, 7]);
        Utils.arraySet(tribesman.sprites, "duration", 0.5);

        tribesman.force = 100;
        tribesman.forceDirection = tribesman.direction - Math.PI;

        tribesman.shieldHit = 0.5;

        app.sound.play("weapon/shield_block").gpan(tribesman);

    }

};

CLIENT.Tribesman.States.hurt = {

    enter(tribesman, manager) {

        Utils.arrayCall(tribesman.sprites, "set", "stunned");
        Utils.arraySet(tribesman.sprites, "loop", true);
        // Utils.arraySet(tribesman.sprites, "range", [7, 7]);
        Utils.arraySet(tribesman.sprites, "duration", 1.0);

        tribesman.force = 100;
        tribesman.forceDirection = tribesman.direction - Math.PI;

    },

    step(tribesman, manager) {

        if (manager.elapsed > 1.0) manager.set("idle");

    }

};

CLIENT.Tribesman.States.fallBack = {

    enter(tribesman, manager) {

        Utils.arrayCall(tribesman.sprites, "set", "fall_back");
        Utils.arraySet(tribesman.sprites, "loop", false);
        // Utils.arraySet(tribesman.sprites, "range", [7, 7]);
        Utils.arraySet(tribesman.sprites, "duration", 2.0);

        tribesman.force = 150;
        tribesman.forceDirection = tribesman.direction - Math.PI;

    },

    step(tribesman, manager) {

        if (manager.elapsed > 2.0) manager.set("idle");

    }

};

CLIENT.Tribesman.States.attack = {

    moves: ["attack_horizontal", "attack_vertical", "spin", "kick", "spear_attack"],
    slashes: ["horizontal", "vertical", "spin", "vertical", "vertical"],

    enter(tribesman, manager) {

        if (tribesman.inView) {

            manager.data.target = tribesman.target;

            app.sound.play("human/attack_" + Utils.random(1, 3)).rate(2.0).rrate(0.5).gpan(tribesman);

            tribesman.force = 75;
            tribesman.forceDirection = tribesman.direction;

            app.sound.play("weapon/whoosh_" + Utils.random(1, 3)).gpan(tribesman);

            let moveIndex = Utils.random(0, 3);

            if (tribesman.weaponDef.backstab) moveIndex = 4;

            Utils.arrayCall(tribesman.sprites, "set", this.moves[moveIndex]);
            Utils.arraySet(tribesman.sprites, "loop", false);
            Utils.arraySet(tribesman.sprites, "duration", 0.25);

            let slash = tribesman.collection.add("Sprite");

            slash.set("slash/" + this.slashes[moveIndex]);

            slash.follow = tribesman;
            slash.row = Utils.dirrow(tribesman.direction, 16);
            slash.offsetY = -8;
            slash.duration = 0.15;
            slash.blendDst = app.gl.ONE;

            if (Math.random() > 0.5) {

                app.tween(tribesman).to({
                    z: 10
                }, 0.3).to({
                    z: 0
                }, 0.7, "outBounce");
            }

        }

    },

    step(tribesman, manager) {

        if (manager.runOnce(0.15)) {

            if (manager.data.target && manager.data.target.handleHit) {

                manager.data.target.handleHit(0, tribesman);
                manager.data.target.fallDirection = Utils.lookAt(tribesman, manager.data.target);

            }

        }

        if (manager.elapsed > 0.5) manager.set("idle");

    }

};

CLIENT.Tribesman.States.loot = {

    enter(tribesman, manager) {

        manager.data.crouching = false;

    },

    step(tribesman, manager) {

        if (!manager.data.crouching && (tribesman.destinationDistance < 2)) {

            manager.data.crouching = true;

            Utils.arrayCall(tribesman.sprites, "set", "operate_ground");
            Utils.arraySet(tribesman.sprites, "loop", true);
            Utils.arraySet(tribesman.sprites, "duration", 0.5);

            let target = tribesman.collection.sid(tribesman.detail);

            if (target.team === tribesman.team) app.sound.play("human/cry_" + Utils.random(1, 4)).gpan(tribesman).rate(1.4);

            tribesman.legsSprite.hide();

        }

        if (manager.elapsed > 1.0 && Utils.interval(tribesman, "loot", 0.2)) {

            let target = tribesman.collection.sid(tribesman.detail);

            target.oy = Utils.random(-2, 0);

            app.sound.play("action/loot_" + Utils.random(1, 3)).rrate(0.2).volume(Utils.randomf(0.3, 0.8)).gpan(tribesman);

        }

    },



    leave(tribesman) {

        Utils.arrayCall(tribesman.sprites, "set", "operate_ground");
        Utils.arraySet(tribesman.sprites, "loop", false);
        Utils.arraySet(tribesman.sprites, "duration", 0.5);
        Utils.arraySet(tribesman.sprites, "range", [7, 9]);

    }

};

CLIENT.Tribesman.States.collect = {

    enter(tribesman, manager) {

        manager.data.crouching = false;
        manager.data.collected = false;
        manager.data.collectible = tribesman.collection.sid(tribesman.detail);

    },

    step(tribesman, manager) {

        if (!manager.data.collectible) return;

        if (manager.data.collectible._remove) return manager.set("idle");

        if (!manager.data.crouching && tribesman.destinationDistance < 2) {

            Utils.arrayCall(tribesman.sprites, "set", "operate_ground");
            Utils.arraySet(tribesman.sprites, "loop", true);
            Utils.arraySet(tribesman.sprites, "duration", 2.0);

        }

        if (manager.elapsed > 1.5 && !manager.data.collected) {

            app.sound.play("action/throw").rate(1.5).gpan(tribesman);

            Utils.arrayCall(tribesman.sprites, "set", "operate_ground");
            Utils.arraySet(tribesman.sprites, "loop", false);
            Utils.arraySet(tribesman.sprites, "duration", 0.2);

            manager.data.crouching = true;

            tribesman.legsSprite.hide();

            manager.data.collected = true;

            let target = manager.data.collectible;

            let duration = 0.5;

            if (tribesman.group === app.game.player && target.shared.key === "chest") app.game.score(1, target.x, target.y);

            app.tween(target).to({
                z: 20
            }, duration * 0.5).to({
                z: 6,
                scale: 0.0,
            }, duration * 0.5);

            app.tween(target).to({
                x: target.x + Math.cos(tribesman.direction - Math.PI) * 8,
                y: target.y + Math.sin(tribesman.direction - Math.PI) * 8
            }, duration).once("finished", function() {

                target.blink();

                target.hidden = true;

                if (target.beingCollected) target.beingCollected(tribesman);

            });


        }

    },

    leave(tribesman) {
        /*
        Utils.arrayCall(tribesman.sprites, "set", "operate_ground");
        Utils.arraySet(tribesman.sprites, "loop", false);
        Utils.arraySet(tribesman.sprites, "duration", 0.5);
        Utils.arraySet(tribesman.sprites, "range", [7, 9]);
    */
    }

};

CLIENT.Tribesman.States.camp = {

    enter(tribesman, manager) {

        manager.data.crouching = false;

    },

    step(tribesman, manager) {

        if (tribesman.game.pointer.alert && COMMON.canEquip(tribesman, tribesman.game.action.data.equipment)) {

            if (!manager.data.reaching) {

                Utils.arrayCall(tribesman.sprites, "set", "reach");
                Utils.arraySet(tribesman.sprites, "range", [0, 1]);
                Utils.arraySet(tribesman.sprites, "duration", 0.25);
                tribesman.legsSprite.show();
                tribesman.lookAt = tribesman.game.pointer;

                manager.data.crouching = false;
                manager.data.reaching = true;

            }


            return;

        } else {

            manager.data.reaching = false;

        }


        if (!manager.data.crouching && tribesman.destinationDistance < 2) {

            manager.data.crouching = true;

            Utils.arrayCall(tribesman.sprites, "set", "sit");
            Utils.arraySet(tribesman.sprites, "loop", false);
            Utils.arraySet(tribesman.sprites, "duration", 1.0);
            Utils.arraySet(tribesman.sprites, "range", [0, 2]);
            tribesman.legsSprite.hide();

        } else if (manager.data.crouching && tribesman.bodySprite.progress >= 1.0 && !tribesman.loop) {

            Utils.arrayCall(tribesman.sprites, "set", "sit");
            Utils.arraySet(tribesman.sprites, "loop", true);
            Utils.arraySet(tribesman.sprites, "duration", 1.5);
            Utils.arraySet(tribesman.sprites, "range", [2, 7]);

        }

        if (tribesman.destinationDistance > 3) {

            if (manager.data.crouching) {

                Utils.arraySet(tribesman.sprites, "range", [2, 10]);
                Utils.arraySet(tribesman.sprites, "loop", false);
                Utils.arraySet(tribesman.sprites, "time", tribesman.bodySprite.time * 0.5 / tribesman.bodySprite.duration);
                Utils.arraySet(tribesman.sprites, "duration", 0.5);
                manager.data.crouching = false;

            } else if (tribesman.bodySprite.key === "sit" && tribesman.bodySprite.progress >= 1.0) {

                Utils.arrayCall(tribesman.sprites, "set", "run");
                Utils.arraySet(tribesman.sprites, "duration", 1.0);
                Utils.arraySet(tribesman.sprites, "range", false);
                Utils.arraySet(tribesman.sprites, "loop", true);
                tribesman.legsSprite.show();

            }



        }

    },

    leave(tribesman) {

        Utils.arrayCall(tribesman.sprites, "set", "sit");
        Utils.arraySet(tribesman.sprites, "loop", false);
        Utils.arraySet(tribesman.sprites, "duration", 0.5);
        Utils.arraySet(tribesman.sprites, "range", [8, 11]);

    }

};

CLIENT.Tribesman.States.dead = {

    enter(tribesman) {

        // tribesman.setKind("corpse");

        tribesman.dead = true;

        // if (tribesman.inView) {
        tribesman.zIndex = 0;

        tribesman.force = Utils.random(100, 180);
        tribesman.forceDirection = tribesman.fallDirection;

        if (Math.random() > 0.5) {

            Utils.arrayCall(tribesman.sprites, "set", "fall_back");

        } else {

            Utils.arrayCall(tribesman.sprites, "set", "fall_front");

            app.tween(tribesman).to({
                direction: tribesman.forceDirection + "rad"
            }, 0.5);

        }

        Utils.arraySet(tribesman.sprites, "duration", 1.0);
        Utils.arraySet(tribesman.sprites, "loop", false);
        Utils.arraySet(tribesman.sprites, "range", [0, 8]);

        tribesman.legsSprite.hide();

        if (Math.random() > 0.5) {

            app.tween(tribesman).to({
                z: 10
            }, 0.3).to({
                z: 0
            }, 0.7, "outBounce");

        }

        // }

    },

    step(tribesman, manager) {

        if (manager.elapsed < 0.5) {

            if (Math.random() > 0.5) {

                let blood = tribesman.collection.add("Sprite");

                blood.x = tribesman.x;
                blood.y = tribesman.y;
                blood.set("fx/blood_1");
                blood.duration = Utils.randomf(0.25, 1.0);
                blood.rotation = Math.random() * 6.28;

                let bloodScale = Utils.randomf(0.1, 0.3);

                blood.scale.x = bloodScale;
                blood.scale.y = bloodScale;

                app.tween(blood).to({
                    offsetY: -20 * Math.random()
                }, blood.duration * 0.3).to({
                    offsetY: 0
                }, blood.duration * 0.3);

            }

        }

    }



};

/* file: script/dom/Help.js */

CLIENT.HelpWindow = function() {

    this.$element = $(this.template);

    this.$element.appendTo(document.body);

    this.$element.find(".close").on("click touchstart", this.closeClick.bind(this));

    this.$element.css("marginTop", "-64px");

    this.$element.animate({
        "marginTop": "0px"
    }, 1000);

    this.$element.find("iframe").css({
        "height": Math.max(640, window.innerHeight * 0.8 | 0) + "px",
        "border": "none",
        "marginBottom": "8px"
    });

    app.fitElementIntoWindow(this.$element);


};

CLIENT.HelpWindow.prototype = {

    template: `
  <div class="absolute border-window center text-align-center">
    <iframe src="/tutorial/" width=900 height=640></iframe>
    <div>
      <a class="button close">CLOSE</a>
    </div>

  </div>`,

    closeClick() {

        this.hide();

    },

    hide() {

        this.$element.remove();

    }


};

/* file: script/dom/RespawnWindow.js */

CLIENT.RespawnWindow = function() {

    this.$element = $(this.template);

    this.$element.appendTo(document.body);

    this.$element.find(".respawn").on("click touchstart", this.respawnClick.bind(this));
    this.$element.find(".help").on("click touchstart", this.helpClick.bind(this));

    this.$element.css("marginTop", "-64px");
    this.$element.animate({
        "marginTop": "0px"
    }, 1000);

};

CLIENT.RespawnWindow.prototype = {

    template: `
  <div class="absolute border-window center text-align-center">
    <h2>YOUR SCORE</h2>
    <h1 class="score">2048</h1>
    <h3>YOUR BEST</h3>
    <h2 class="best">2048</h2>
    <a class="button respawn">RESPAWN</a>
    <a class="button help">HELP</a>
    <p><a href="https://wanderers.userecho.com/" target="_blank">Post your ideas or bugs.</a></p>
  </div>`,

    helpClick() {

        new CLIENT.HelpWindow();

    },

    respawnClick() {

        app.adResume = function() {

            app.game.send("respawn");

            // window.location = window.location;

        };

        app.requestAd();

        this.hide();

        // gdApi.showBanner();

    },

    setScore(score) {

        let best = localStorage.getItem("hiscore") | 0;

        this.$element.find(".score").html(score);

        if (score > best) localStorage.setItem("hiscore", score);

        this.$element.find(".best").html(best);


    },

    hide() {

        this.$element.remove();

    }


};

/* file: script/manipulators/debris.js */

CLIENT.Manipulators.debris = function(object, data, dt) {

    let duration = 2.0;
    let mod = 1.0 - object.lifetime / duration;

    object.rotation += dt * 40 * mod;

    data.rotation = (data.rotation || 0) + dt * 3;

    object.x += Math.cos(data.rotation) * 50 * dt;
    object.y += Math.sin(data.rotation) * 50 * dt;

    let scale = 1.5 * mod;

    object.scale.x = scale;
    object.scale.y = scale;

    if (object.lifetime > duration) object.collection.remove(object);

    if (Utils.interval(object, "debris", 0.05)) {

        let tail = object.collection.add("Sprite");

        tail.set("explosion/small");

        tail.scale.x = 0.2 + Math.random() * 0.1;
        tail.scale.y = 0.2 + Math.random() * 0.1;
        tail.x = object.x + Utils.random(-4, 4) * mod;
        tail.y = object.y + Utils.random(-4, 4) * mod;
        tail.duration = 0.25;

        tail.scale.x *= mod;
        tail.scale.y *= mod;

        if (Math.random() > 0.8) tail.color = 0xffffaa;
        else if (Math.random() > 0.6) tail.color = 0xaaaaaa;

    }


};

/* file: script/manipulators/follow.js */

CLIENT.Manipulators.follow = function(object, data, dt) {

    object.x = data.follow.x;
    object.y = data.follow.y;

};

/* file: script/manipulators/force.js */

CLIENT.Manipulators.force = function(object, data, dt) {

    object.x += Math.cos(data.direction) * data.force * dt;
    object.y += Math.sin(data.direction) * data.force * dt;

    data.force = Utils.moveTo(data.force, 0, data.damping * dt);

};

/* file: script/manipulators/pickup.js */

CLIENT.Manipulators.pickup = function(object, data, dt) {

    if (!data.created) {

        data.tween = app.tween(object).to({
            x: object.x +Utils.random(-16, 16),
            y: object.y - 150
        }, 0.35, "outQuad");

        data.lifetime = 0;
        data.created = true;
        data.speed = 16;
        data.row = object.row;

    }

    data.row += dt * 48;
    data.lifetime += dt;

    let scale = 1.0 + Math.max(-0.25, Utils.saw(data.lifetime / 0.7));

    object.scale.x = scale;
    object.scale.y = scale;

    object.row = (data.row | 0) % object.data.rows;

    if (data.tween.finished) {

        data.speed += 512 * dt;

        let angle = Utils.lookAt(object, data.target);

        let distance = Utils.distance(object, data.target);

        object.x += Math.cos(angle) * (data.speed) * dt;
        object.y += Math.sin(angle) * (data.speed) * dt;

        if (distance < data.target.radius) {

            object.collection.remove(object);
            app.sound.play("collect").rrate(0.1);

            let blink = object.collection.add("Sprite");

            blink.set("fx/blink");
            blink.x = object.x;
            blink.y = object.y;
            blink.duration = 0.3;
            blink.zIndex = 3;

            return true;

        }

    }

};

/* file: script/gui/ActionButton.js */

CLIENT.GUIActionButton = function(gui) {

    CLIENT.Events.call(this);

    this.disabled = false;
    this.sprite = null;
    this.palette = -1.0;

    this.tokensPosition = "bottom";

    this.spriteScale = 1.0;
    this.spriteAlignY = 0.5;
    this.spriteRow = 0;
    this.spritePalette = -1;
    this.hoverTime = 0;

    this.properties = {
        x: 0,
        y: 0,
        hidden: false
    };

    this.width = 20;
    this.height = 22;

    this.gui = gui;

    this.icon = null;

    this.needRefresh = true;

    this.hovered = false;
    this.pressed = false;

    this.cost = 0;
    this._cost = -1;

    this.resource = "wood";
    this.tokens = [];
    this.overlay = null;

};

CLIENT.GUIActionButton.prototype = {

    constructor: CLIENT.GUIActionButton,

    set x(x) {

        this.properties.x = x;
        this.needRefresh = true;

    },

    get x() {

        return this.properties.x;

    },

    set y(y) {

        this.properties.y = y;
        this.needRefresh = true;

    },

    get y() {

        return this.properties.y;

    },

    set hidden(hidden) {

        this.properties.hidden = hidden;

        if (hidden) this.hide();

        this.needRefresh = true;

    },

    get hidden() {

        return this.properties.hidden;

    },

    destruct() {

        this.hide();

    },

    hide() {

        if (this.a) this.a.remove();
        if (this.b) this.b.remove();

        for (let token of this.tokens) {

            this.gui.layerA.remove(token);


        }
        this.tokens.length = 0;

        if (this.overlay) this.overlay.remove();

        this.a = null;
        this.b = null;
        this.overlay = null;

    },


    onEnter() {

        this.needRefresh = true;
        this.hoverTime = 0;

    },

    onLeave() {

        this.needRefresh = true;

    },

    onPress() {

        if (this.disabled) return false;

        app.sound.play("button_down");

        return true;

    },

    onRelease() {

        if (this.disabled) return false;

        app.sound.play("button_up");

        return true;

    },

    refresh() {

        if (this.hidden) return;

        let gui = this.gui;

        this.needRefresh = false;

        if (!this.a) this.a = gui.layerA.create();
        if (!this.b) this.b = gui.layerA.create();

        if (!this.hovered || this.disabled) this.a.setSprite(0, 38, 20, 22);

        else this.a.setSprite(0, 61, 20, 22);

        if (this.icon) {

            this.b.setSprite(...this.icon);

        }

        this.a.setRegion(this.x, this.y, 20, 22);

        let oy = this.hovered * -1;

        if (this.icon) {

            this.b.setRegion(this.x + this.width * 0.5 - this.icon[2] * 0.5 | 0, this.y + this.height * 0.5 - this.icon[3] * 0.5 + oy | 0, this.icon[2], this.icon[3]);

        }

        if (this.pressed && !this.disabled) {
            this.a.y += 2;
            this.a.height -= 2;
            this.b.y += 2;
            this.b.height -= 2;

            this.a.x++;
            this.b.x++;
            this.a.width -= 2;
            this.b.width -= 2;
        }

        if (this._cost !== this.cost) {

            this.updateTokens();

        }

        if (this.disabled && !this.overlay) {

            this.overlay = this.gui.layerB.create();
            this.overlay.setSprite(1, 108, 18, 18);

        }

        if (!this.disabled && this.overlay) {

            this.gui.layerB.remove(this.overlay);

            this.overlay = null;

        }

        if (this.overlay) {

            this.overlay.setRegion(this.x + 1, this.y + 1, 18, 18);

        }

    },

    updateTokens() {

        for (let token of this.tokens) {

            this.gui.layerA.remove(token);

        }

        this.tokens.length = 0;

        if (this.cost <= 0) return;

        let def = COMMON.itemsByKey[this.resource];

        let tw = this.cost * 3;


        for (let i = 0; i < this.cost; i++) {

            let token = this.gui.layerA.add();

            token.setSprite(def.token[0] - 1, def.token[1] - 1, 4, 4);

            if (this.tokensPosition === "bottom") {

                token.setRegion(this.x + this.width * 0.5 - tw * 0.5 + i * 3 | 0, this.y + this.height + 2, 4, 4);

            } else if (this.tokensPosition === "right") {

                token.setRegion(this.x + this.width + 2, this.y + this.height * 0.5 - tw * 0.5 + i * 3 | 0, 4, 4);

            } else if (this.tokensPosition === "left") {

                token.setRegion(this.x - 6, this.y + this.height * 0.5 - tw * 0.5 + i * 3 | 0, 4, 4);

            }

            this.tokens.push(token);

        }



    },

    step() {

    },

    render() {

        if (this.needRefresh) this.refresh();

        if (this.hovered && !this.disabled) this.hoverTime += app.elapsed;

        if (this.sprite) {

            app.painter.reset();
            app.painter.palette(this.palette);

            app.painter.values.align.y = this.spriteAlignY;

            app.painter.values.scale.x = this.spriteScale;
            app.painter.values.scale.y = this.spriteScale;

            if (this.hovered && !this.disabled) {

                app.painter.values.scale.x = 1.25 * this.spriteScale;
                app.painter.values.scale.y = 1.25 * this.spriteScale;
            }

            if (this.pressed && !this.disabled) {

                app.painter.values.scale.x = 0.75 * this.spriteScale;
                app.painter.values.scale.y = 0.75 * this.spriteScale;

            }

            app.painter.palette(this.spritePalette);
            app.painter.drawSprite(this.sprite, this.x + this.width / 2, this.y + this.height / 2, this.hovered ? 4 + this.hoverTime * 12.0 : 4, this.spriteRow);

        }

        if (this.icon) {
            // app.painter.reset();
            // app.painter.drawImageRegion(app.textures.spritesheet, ...this.icon, this.x + this.width / 2, this.y + this.height / 2);
        }

        if (this.hovered && this.hoveredIcon) {

            app.painter.reset();
            app.painter.drawImageRegion(app.textures.spritesheet, ...this.hoveredIcon, this.x + this.width / 2, this.y - 12);

        }

    }

};

Object.assign(CLIENT.GUIActionButton.prototype, CLIENT.Events.prototype);

/* file: script/gui/Element.js */

CLIENT.GUIElement = function(gui) {

    CLIENT.Events.call(this);

    this.properties = {
        x: 0,
        y: 0
    };

    this.gui = gui;

};

CLIENT.GUIElement.prototype = {

    set x(x) {

        this.properties.x = x;
        this.needRefresh = true;

    },

    get x() {

        return this.properties.x;

    },

    set y(y) {

        this.properties.y = y;
        this.needRefresh = true;

    },

    get y() {

        return this.properties.y;

    },

    render() {

        if (this.needRefresh) this.refresh();

    }

};

Object.assign(CLIENT.GUIElement.prototype, CLIENT.Events.prototype);

/* file: script/gui/ExperienceBottle.js */

CLIENT.GUIExperienceBottle = class extends CLIENT.GUIElement {

    constructor(gui) {

        super(gui);

        this.shelf = this.gui.layerA.create();
        this.bottle = this.gui.layerA.create();
        this.bottleOverlay = this.gui.layerA.create();
        this.rightEdge = this.gui.layerA.create();
        this.exp = 0;
        this.progress = 0;

        this.buttons = [];

        this.levels = 0;
        this.level = 0;

    }

    hideInventions() {

        for (let button of this.buttons) {

            this.gui.remove(button);

        }

        this.buttons.length = 0;
        this.needRefresh = true;

    }

    showInventions() {

        this.hideInventions();

        for (let def of COMMON.tags.invention) {

            if (app.game.inventions.indexOf(def.key) > -1) continue;
            if (def.require && app.game.inventions.indexOf(def.require) < 0) continue;

            let button = this.gui.add("ActionButton");

            button.palette = 0;

            if (!def.icon) {

                button.sprite = `tribesman/${def.key}/turntable`;

            }

            if (def.icon) {

                button.icon = def.icon;

            }

            button.action = "invent";
            button.key = def.key;
            button.tooltip = def.tooltip;
            button.subtip = def.subtip;
            button.hoveredIcon = [169, 140, 13, 17];

            button.on(PLAYGROUND.MOBILE ? "dragstart" : "click", app.game.onActionButtonClick.bind(app.game, button));

            this.buttons.push(button);

        }

        this.refresh();

        for (let i = 0; i < this.buttons.length; i++) {

            let button = this.buttons[i];

            let y = button.y;

            button.y += 50;

            app.tween(button).to({
                y: y
            }, 0.2 + i * 0.2, "outElastic")

        }

    }

    setProgress(progress) {

        this.progress = progress;
        this.needRefresh = true;

    }

    render() {

        super.render();

        if (this.levels) {

            app.painter.reset();

            app.painter.drawSprite("gui/exp_coord", this.x + 17, this.y + 11, app.lifetime * 10);

        }

    }

    refresh() {

        this.needRefresh = false;

        this.bottle.setSprite(145, 94, 36, 38);
        this.bottle.setRegion(this.x, this.y);

        let x = 0;

        for (let button of this.buttons) {

            button.y = this.y + 9;
            button.x = this.x + 31 + x;

            x += 24;

        }

        this.shelf.setSprite(202, 100, 2, 28);
        this.rightEdge.setSprite(205, 100, 4, 28);

        if (this.buttons.length) {

            this.shelf.setRegion(this.x + 36, this.y + 6, this.buttons.length * 23 + 3);
            this.rightEdge.setRegion(this.x + this.buttons[this.buttons.length - 1].x + 13, this.y + 6);

        } else {

            this.shelf.setRegion(this.x + 36, this.y + 6, 8);
            this.rightEdge.setRegion(this.x + 36 + 8, this.y + 6);

        }

        if (this.level >= COMMON.MAX_LEVEL) {

            this.bottleOverlay.setSprite(213, 104, 20, 19);
            this.bottleOverlay.setRegion(this.x, this.y + 28 - 19, 20, 19);

        } else {

            this.bottleOverlay.setSprite(145, 140 + 19 - 19 * this.progress, 20, 19 * this.progress);
            this.bottleOverlay.setRegion(this.x, this.y + 28 - 19 * this.progress, 20, 19 * this.progress);

        }

    }

};

/* file: script/gui/Resources.js */

CLIENT.GUIResources = function(gui) {

    this.gui = gui;

    CLIENT.Events.call(this);

    this.properties = {
        x: 0,
        y: 0
    };

    this.width = 72;
    this.height = 36;

    this.imageBatch = this.gui.layerA;
    // new CLIENT.ImageBatch();

    this.needRefresh = true;

    this.hovered = false;
    this.pressed = false;

    this.tokens = [];

    this.count = {
        "food": 3,
        "wood": 4,
        "gold": 5
    };

    this.refresh();
    this.refreshText();


};

CLIENT.GUIResources.prototype = {

    constructor: CLIENT.GUIResources,

    set x(x) {

        this.properties.x = x;
        this.needRefresh = true;

    },

    get x() {

        return this.properties.x;

    },

    set y(y) {

        this.properties.y = y;
        this.needRefresh = true;

    },

    get y() {

        return this.properties.y;

    },

    onEnter() {

        this.needRefresh = true;

    },

    onLeave() {

        this.needRefresh = true;

    },

    refresh() {

        this.needRefresh = false;

        if (!this.created) {

            this.created = true;

            this.foodIcon = this.imageBatch.add(COMMON.items.food.sprite, [0, 0]);
            this.woodIcon = this.imageBatch.add(COMMON.items.wood.sprite, [24, 0]);
            this.goldIcon = this.imageBatch.add(COMMON.items.gold.sprite, [48, 0]);

            this.foodText = this.gui.add("Text");
            this.woodText = this.gui.add("Text");
            this.goldText = this.gui.add("Text");

            this.foodText.text = "24";
            this.woodText.text = "24";
            this.goldText.text = "24";

            this.foodText.font = app.fonts.fat;
            this.woodText.font = app.fonts.fat;
            this.goldText.font = app.fonts.fat;


            this.foodText.color.set(0xd95763);
            this.woodText.color.set(0xd9a066);
            this.goldText.color.set(0xfbf236);

        }

        this.foodIcon.setPosition(this.x + 0, this.y);
        this.woodIcon.setPosition(this.x + 24, this.y);
        this.goldIcon.setPosition(this.x + 48, this.y);


        this.foodText.x = this.x + 0 + 10;
        this.woodText.x = this.x + 24 + 10;
        this.goldText.x = this.x + 48 + 10;

        this.foodText.y = this.y - 1;
        this.woodText.y = this.y - 1;
        this.goldText.y = this.y - 1;

    },

    resourceY: {
        "food": 3,
        "wood": 14,
        "gold": 25
    },

    resourceX: {
        "food": 3,
        "wood": 14,
        "gold": 25
    },

    refreshText() {

        this.foodText.text = String(this.count.food);
        this.woodText.text = String(this.count.wood);
        this.goldText.text = String(this.count.gold);

    },

    step() {

    },

    render() {

        if (this.needRefresh) this.refresh();

        app.painter.reset();

    }

};

Object.assign(CLIENT.GUIResources.prototype, CLIENT.Events.prototype);

/* file: script/gui/Text.js */

CLIENT.GUIText = function(gui) {

    CLIENT.Events.call(this);

    this.gui = gui;

    this.textUpdated = false;
    this.font = app.fonts.default;
    this.text = "";
    this.x = 0;
    this.y = 0;
    this.width = 1;
    this.height = 1;
    this.batch = new CLIENT.ImageBatch();
    this.batch.alpha = 1.0;
    this.batch.program = app.programs.text;

};

CLIENT.GUIText.prototype = {

    constructor: CLIENT.GUIText,

    get color() {

        return this.batch.color;

    },

    set text(text) {

        if (this._text === text) return;

        this._text = text;

        this.textUpdated = true;

    },

    get text() {

        return this._text;

    },

    updateText() {

        let text = this.text;

        this.textUpdated = false;

        this.batch.clear();

        let x = 0;
        let y = 0;

        for (var i = 0; i < text.length; i++) {

            let letter = text[i];


            if (letter === "\n") {

                y += this.font.height + 1;
                x = 0;

            } else if (letter === " ") {

                x += this.font.spaceWidth;

                continue;

            }

            if (!this.font.regions[letter]) continue;

            let sprite = this.batch.add();
            let region = this.font.regions[letter];

            sprite.setSprite(region[0], region[1], region[2], region[3]);
            sprite.setRegion(x, y, region[2], region[3]);

            x += 1 + region[2];

        }

    },

    render() {

        if (this.textUpdated) this.updateText();

        let color = this.color.num;
        let a = this.color.a;

        this.batch.x = this.x;
        this.batch.y = this.y;

        this.color.set(0x111111);
        this.batch.y++;
        this.batch.render();

        this.color.set(color, a);
        this.batch.y--;

        this.batch.render();

    }

};

Object.assign(CLIENT.GUIText.prototype, CLIENT.Events.prototype);

/* file: script/Lobby.js */

CLIENT.Lobby = {

    template: `

  <div class="absolute center text-align-center lobby">
    <img src="style/menu.gif">
    <div class="absolute center border-window mainMenu">
      <p>Enter your tribe name or just press start.</p>
      <input maxlength="12" class="tribeName" type="text" placeholder="Tribe name"></input>
      <p><a class="button start">start</a> or <a class="button tutorial">tutorial</a></p>
    </div>
    <a class="showMainMenu"><img src="style/buttons/start.png"></a>

    <div class="footer">
      <a href="/presskit/" target="_blank">Presskit</a>
    </div>

  </div>`,

    enter() {

        this.$element = $(this.template);

        this.$element.appendTo(document.body);

        this.$element.find(".start").on("click touchstart", this.start.bind(this));
        this.$element.find(".tutorial").on("click touchstart", this.tutorial.bind(this));
        this.$element.find(".showMainMenu").on("click touchstart", this.menuClick.bind(this));
        this.$element.find(".mainMenu").hide();
        this.$element.find(".tribeName").on("change keyup", this.validateTribeName.bind(this));
        this.$element.find(".tribeName").val(localStorage.getItem("tribeName"))


    },

    leave() {

        this.$element.remove();

    },

    validateTribeName() {

        let $input = this.$element.find(".tribeName");

        let val = $input.val();

        val = val.replace(/[^a-zA-Z0-9_]/g, '');

        $input.val(val);

        localStorage.setItem("tribeName", val);

    },

    menuClick() {

        this.$element.find(".mainMenu").show();

    },

    start() {

        if (this.startClicked) return;

        this.startClicked = true;

        app.sound.play("empty");

        app.adResume = () => {

            CLIENT.Game.tribeName = this.$element.find(".tribeName").val();

            app.setState(CLIENT.Game);

        };

        app.requestAd();

    },

    tutorial() {

        new CLIENT.HelpWindow();

    },


    render() {

        app.gl.clearColor(0.34, 0.33, 0.32, 1.0);
        app.gl.clear(app.gl.COLOR_BUFFER_BIT);
    }

};

/* file: script/Game.js */

CLIENT.Game = {

    palette: 0,

    enter() {

        this.inputMode = "default";
        this.quickChat = new CLIENT.QuickChat;

        this.nextTribesmanPosition = null;

        this.pointer = {
            x: 0,
            y: 0,
            alert: null,
            entity: null
        };

        this.cursorDirection = 0;
        this.cursorFinalDirection = 0;

        this.manipulators = [];

        // this.socket = new WebSocket("ws://192.168.0.100:1337");
        // this.socket = new WebSocket("ws://145.239.93.148:1337");

        if ($_HASH['server']) {

            this.socket = new WebSocket($_HASH['server']);

        } else {

            this.socket = new WebSocket(`wss://${this.server_url}.wanderers.io`);

        }

        this.socket.binaryType = "arraybuffer";

        this.socket.addEventListener("open", this.onconnect.bind(this));
        this.socket.addEventListener("message", this.onmessage.bind(this));
        this.socket.addEventListener("close", this.ondisconnect.bind(this));

        this.timeouts = [];

        this.gui = new CLIENT.GUI();
        this.guiElements = {};

        this.cursor = new CLIENT.Sprite();
        this.cursor.prefix = "cursor/";
        this.cursor.set("point");

        this.action = new CLIENT.GameActionManager(this, CLIENT.Game.Actions);
        this.action.set("none");

        this.selector = new CLIENT.Selector(this);

        this.tooltip = this.gui.add("Text");
        this.tooltip.font = app.fonts.default;
        this.showTooltip("test");
        this.hideTooltip();

        this.orders = [];
        this.clearOrderTimeout = COMMON.CLEAR_ORDER_INTERVAL;

    },

    updateBorder() {

        this.left = +Infinity;
        this.top = +Infinity;
        this.right = -Infinity;
        this.bottom = -Infinity;

        for (let meadow of this.entities.groups.meadows) {

            if (meadow.x < this.left) this.left = meadow.x;
            if (meadow.x > this.right) this.right = meadow.x;
            if (meadow.y < this.top) this.top = meadow.y;
            if (meadow.y > this.bottom) this.bottom = meadow.y;

        }

        this.left -= COMMON.BORDER;
        this.top -= COMMON.BORDER;
        this.right += COMMON.BORDER;
        this.bottom += COMMON.BORDER;

        this.width = Math.abs(this.left - this.right);
        this.height = Math.abs(this.top - this.bottom);

    },


    updateMapTexture() {

        this.updateBorder();

        let mapWidth = 64;
        let mapHeight = 64;
        let scaleX = mapWidth / this.width;
        let scaleY = mapHeight / this.height;

        this.mapScaleX = scaleX;
        this.mapScaleY = scaleY;

        let map = cq(mapWidth, mapHeight);

        map.fillStyle("#638538");
        map.smoothing = false;

        for (let meadow of this.entities.groups.meadows) {

            let x = meadow.x - this.left;
            let y = meadow.y - this.top;

            map.save();
            map.translate(x * scaleX, y * scaleY);
            // map.scale(1.0, 0.75);
            map.fillCircle(0, 0, 1 + meadow.radius * scaleX | 0);
            map.restore();

        }

        for (let entity of this.entities.children) {

            let color = false;

            if (!color) continue;

            if (entity.constructorName === "Tree") color = "#d9a066";
            else if (entity.constructorName === "Rocks") color = "#9badb7";


            let x = entity.x - this.left;
            let y = entity.y - this.top;

            map.save();
            map.translate(x * scaleX | 0, y * scaleY | 0);
            map.fillStyle(color);
            map.fillRect(-1, -1, 2, 2);
            map.restore();

        }

        let gl = app.gl;

        let texture = app.gl.createTexture();

        gl.bindTexture(gl.TEXTURE_2D, texture);
        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, map.canvas);

        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);

        gl.generateMipmap(gl.TEXTURE_2D);

        texture.width = map.width;
        texture.height = map.height;

        this.mapTexture = texture;

    },

    order(what) {

        let id = what.sid;

        if (this.orders.indexOf(id) > -1) return;

        this.clearOrderTimeout = COMMON.CLEAR_ORDER_INTERVAL;

        this.send("order", id);

        this.orders.push(id);

    },


    createButtons() {

        this.buttons = [];

        this.experienceBottle = this.gui.add("ExperienceBottle");

        var resources = this.gui.add("Resources");

        this.guiResources = resources;

        this.guiResources.on("click", function(e) {

            let resource = ["food", "wood", "gold"][(e.x - app.game.guiResources.x) / 24 | 0];

            app.game.send("drop", {
                key: resource
            });

        });

        var button = this.gui.add("ActionButton");

        // button.icon = [43, 3, 13, 15];
        button.sprite = "campfire";
        button.spriteScale = 0.5;
        button.spriteAlignY = 0.85;
        button.cost = 2;
        button.resource = "wood";
        button.key = "campfire";
        button.tooltip = "Start a campfire"
        button.subtip = "Heal 1 HP for 1 food"

        this.guiElements.campfire = button;

        button.on(PLAYGROUND.MOBILE ? "dragstart" : "click", () => {

            this.action.set("place_campfire");

    });

        this.buttons.push(button);

        var button = this.gui.add("ActionButton");

        button.sprite = "tribesman/tribesman";

        // button.spriteAlignY = 0.85;
        button.cost = 2;
        button.spriteRow = 2;
        button.key = "recruit";

        this.buttons.recruit = button;

        button.resource = "food";
        button.tooltip = "Recruit new member;";
        button.subtip = "get an unequipped minion";
        button.action = "recruit";
        button.palette = 0;

        this.guiElements.recruit = button;

        button.on("enter", function() {

            this.sprite = "tribesman/male/roll";

        });

        button.on("leave", function() {

            this.sprite = "tribesman/tribesman";

        });

        button.on(PLAYGROUND.MOBILE ? "dragstart" : "click", this.onActionButtonClick.bind(this, button));

        this.buttons.push(button);

        /* Equipment buttons */

        let equipment = ["axe", "bow", "hammer", "sword", "scythe", "dagger", "wooden_shield", "reinforced_shield", "steel_shield", "hood", "viking_helmet", "legion_helmet"];

        for (let key of equipment) {

            let def = COMMON.items[key];

            let button = this.gui.add("ActionButton");

            button.palette = 0;

            let spriteKey = def.sprite || key;

            button.sprite = `tribesman/${spriteKey}/turntable`;
            button.def = def;
            button.cost = def.cost;
            button.resource = def.resource;
            button.action = "equip";
            button.key = key;
            button.tooltip = def.tooltip;
            button.subtip = def.subtip;



            if (def.palette) button.spritePalette = def.palette;

            button.on(PLAYGROUND.MOBILE ? "dragstart" : "click", this.onActionButtonClick.bind(this, button));

            this.buttons.push(button);

            this.buttons[key] = button;


        }

        this.arrangeButtons();

    },

    layout: 1,

    arrangeButtons() {

        this.guiResources.x = app.width / 2 - 36 | 0;
        this.guiResources.y = 8;

        this.experienceBottle.x = 8;
        this.experienceBottle.y = app.height - 38;

        if (this.layout === 0) {

            var x = app.width / 2 - (this.buttons.length * 24 / 2);
            var y = app.height - 48;

            for (let button of this.buttons) {

                button.x = x;
                button.y = y;
                button.tokensPosition = "right";

                x += 24;

            }

        } else {

            var x = 4;
            var y = app.height / 2 - (8 * 24 / 2) | 0;

            for (let i = 0; i < 8; i++) {

                let button = this.buttons[i];

                button.hidden = this.inventions.indexOf(button.key) === -1;

                button.x = x;
                button.y = y;
                button.tokensPosition = "right";

                y += 24;

            }

            var x = app.width - 24;
            var y = app.height / 2 - (6 * 24 / 2) | 0;

            for (let i = 8; i < 14; i++) {

                let button = this.buttons[i];

                button.hidden = this.inventions.indexOf(button.key) === -1;

                button.x = x;
                button.y = y;
                button.tokensPosition = "left";

                y += 24;

            }

        }

    },

    updateButtons() {

        for (let button of this.buttons) this.updateButton(button);

    },

    updateButton(button) {

        let disabled = button.disabled;

        if (!button.cost) button.disabled = false;

        else if (this.playerData.resources[button.resource] < button.cost) {

            button.disabled = true;
            button.disabledReason = "Not enough " + button.resource;

        } else {

            button.disabled = false;

        }

        button.needRefresh = true;

    },

    onActionButtonClick(button) {

        if (button.disabled) {

            app.sound.play("gui/disabled_click");

            if (button.disabledReason) {

                this.showTooltip(button.disabledReason);

                this.tooltip.color.set(0xdd4400);
                this.tooltipLifespan = 3.0;

            }

            return;

        }

        if (button.action === "invent") {

            this.send("invent", {
                key: button.key
            });

            app.sound.play("gui/invent");

            this.inventions.push(button.key);

            let next = Utils.find(this.buttons, (b) => b.key === button.key);

            if (next) {


                this.arrangeButtons();

                let x = next.x;
                let y = next.y;

                next.x = button.x;
                next.y = button.y;

                let duration = Utils.distance(x, y, next.x, next.y) / 400;

                app.tween(next).to({
                    x: x - Utils.sign(x - app.width / 2) * 32
                }, duration * 0.25).to({
                    y: y
                }, duration * 0.25).to({
                    x: x
                }, 0.4, "outBounce");

            }

            button.gui.remove(button);

            this.experienceBottle.levels--;

            if (this.experienceBottle.levels > 0) {

                this.experienceBottle.showInventions();

            } else {

                this.experienceBottle.hideInventions();

            }

        } else if (button.action === "recruit") {

            this.action.set("recruit");

        } else if (button.action === "equip") {

            this.action.set("equip", button.key);

        }

    },


    sortInteractive(a, b) {

        return (b.interactiveIndex | 0) - (a.interactiveIndex | 0);

    },

    getEntityAtCursor() {

        this.entities.groups.interactive.sort(this.sortInteractive);

        for (let entity of this.entities.groups.interactive) {

            if (!entity.inView) continue;

            let radius = entity.interactiveRadius || entity.radius;

            if (Utils.pointInRect(this.pointer.x, this.pointer.y, entity.x - radius, entity.y - radius, radius * 2, radius * 2)) {

                return entity;

            }

        }

        return null;

    },

    inspect(x, y) {

        for (let entity of this.entities.children) {

            let radius = entity.radius;

            if (Utils.pointInRect(x, y, entity.x - radius, entity.y - radius, radius * 2, radius * 2)) {

                console.log("-- local inspector --");
                console.log(entity);

                if (entity.sid) this.send("inspect", {
                    sid: entity.sid
                });

            }

        }

        return null;

    },

    create: function() {

        this.sharer = new CLIENT.Sharer(app.data.shared);

        this.camera = new CLIENT.Camera();


        this.viewMatrix = Matrix3.create();

    },

    start(data) {

        this.inventions = ["campfire", "recruit", "axe", "bow"];

        this.playerData = {

            resources: {
                food: 0,
                wood: 0,
                gold: 0
            }

        };

        this.speed = data.speed;

        this.ready = true;

        this.request_id = 1;
        this.privateData = {
            totemX: 0,
            totemY: 0,
            score: 0,
            level: 0,
            exp: 0
        };

        this.sharer.setKeys(data.sharedKeys);

        this.lifetime = 0;

        this.entities = new CLIENT.Entities(this);
        this.entities.createGroup("tribesman");
        this.entities.createGroup("interactive");
        this.entities.createGroup("movable");
        this.entities.createGroup("obstacle");
        this.entities.createGroup("radar");

        for (var i = 0; i < data.entities.length; i++) {

            var encoded = data.entities[i];

            if (!encoded) continue;

            var constructorName = this.sharer.getKey(encoded[1]);
            var decoded = this.sharer.decode(constructorName, encoded);

            if (!constructorName) continue;

            this.entities.add(constructorName, {
                shared: decoded
            });


        }

        this.resize();
        /*
        let sprites = [
          [3, 2, 20, 17],
          [25, 0, 18, 21],
          [47, 0, 24, 33]
        ];

        for (var i = 0; i <= sprites.length; i++) {
          let ship = this.entities.add("Ship");

          ship.x = 600 + i * 40;
          ship.y = 320;
          ship.setTexture("spritesheet");
          ship.region = sprites[i];
          ship.damage = i * 0.25;
          ship.damage = i * 0.25;
          // ship.random = 0.5;

        }

        */


        this.createButtons();

        this.entities.add("Generic", {
            x: 1000,
            y: 1000
        })
    },

    send: function(message, data) {

        if (app.data.shared[message]) {

            data = this.sharer.encode(message, data);
            message = this.sharer.getKeyIndex(message);

        }

        var packet = msgpack.encode([message, data]);

        this.socket.send(packet);

        return;

        var packet = [message, data];

        this.socket.send(JSON.stringify(packet));

    },

    manipulate(object, func, data) {

        let entry = Object.create(null);

        entry.object = object;
        entry.func = func;
        entry.data = data;

        this.manipulators.push(entry);

    },

    handleMessage: function(message, data) {

        if (typeof message === "number") message = this.sharer.getKey(message);

        if (app.data.shared[message]) data = this.sharer.decode(message, data, true);

        if (CLIENT.GameMessageHandler[message]) {

            CLIENT.GameMessageHandler[message](this, data);

        }

    },

    timeout() {

        let timeout = arguments[arguments.length - 1];

        this.timeouts.push(Array.from(arguments));

    },

    updateSharedEntity: function(data) {

        if (!this.entities) return;

        var sid = data[1];

        var entity = this.entities.sid(sid);

        if (!entity) {

            var cname = this.sharer.getKey(data[2]);

            var changes = this.sharer.decode(cname, data, true);

            entity = this.entities.add(cname, {

                shared: changes

            });

        } else {

            var changes = this.sharer.decode(entity.constructorName, data, true);

            entity.update(changes);

        }

    },

    onmessage: function(event) {

        var packet = msgpack.decode(new Uint8Array(event.data));

        var message = packet[0];
        var data = packet[1];

        this.handleMessage(message, data);

    },

    onconnect: function() {

        this.send("hello", {
            name: this.tribeName
        });

    },

    ondisconnect: function() {

        $(`<div class="absolute border-window center text-align-center">
    <h2>SERVER IS DEAD</h2>
    <p>Please reload the game in a minute.</p>
    <p>I am probably updating something</p>
    <p>Sorry if you have lost your tribe :(</p>
  </div>`).appendTo(document.body);

    },

    parseQueue: function(queue) {

        while (queue.length) {

            var packet = queue.shift();

            var message = packet[0];
            var data = packet[1];

            this.handleMessage(message, data);

        }

    },

    hit(entity) {

        entity.hitLifespan = 0.3;

        let blood = entity.collection.add("Sprite");

        blood.x = entity.x;
        blood.y = entity.y;
        blood.set("blood_1");
        blood.duration = 0.5;
        blood.color.set(0xcc5500);
        blood.zIndex = 3;

        app.sound.play("pain_quick").gpan(entity).rate(1.2).volume(0.4);
        // app.sound.play("hit").gpan(entity).rate(1.2).volume(0.4);

    },


    render() {


        if (!this.ready) return;

        this.camera.step(app.elapsed);

        let gl = app.gl;

        var projectionMatrix = Matrix3.projection(app.canvas.width, app.canvas.height);

        this.projectionMatrix = projectionMatrix;

        gl.clearColor(0.34, 0.33, 0.32, 1.0);
        // gl.clearColor(0.13, 0.12, 0.20, 1.0);

        // gl.clearColor(0, 0, 0, 1.0);
        // gl.colorMask(1.0, 1.0, 1.0, 1.0);
        // gl.clearColor(0.0, 0.0, 0.0, 0.0);
        gl.clear(gl.COLOR_BUFFER_BIT);



        Matrix3.reset(this.viewMatrix);
        Matrix3.reset(this.camera.matrix);

        // this.camera.x = -app.width / 2;
        // this.camera.y = -app.height / 2;
        Matrix3.multiply(this.viewMatrix, projectionMatrix);

        for (var key in app.programs) {

            let program = app.programs[key];

            gl.useProgram(program.native);

            program.set("viewMatrix", this.viewMatrix);

        }

        Matrix3.reset(this.viewMatrix);
        Matrix3.reset(this.camera.matrix);

        Matrix3.scale(this.camera.matrix, this.camera.scale, this.camera.scale);
        Matrix3.translate(this.camera.matrix, -this.camera.x, -this.camera.y);
        // Matrix3.rotate(this.camera.matrix, -app.lifetime * 0.2)
        // Matrix3.translate(this.camera.matrix, -app.width / 2, -app.height / 2);

        Matrix3.multiply(this.viewMatrix, projectionMatrix);
        Matrix3.multiply(this.viewMatrix, this.camera.matrix);

        for (var key in app.programs) {

            let program = app.programs[key];

            gl.useProgram(program.native);

            program.set("viewMatrix", this.viewMatrix);

        }



        for (var i = 0; i < this.entities.inView.length; i++) {

            let entity = this.entities.inView[i];

            if (entity.systemLight) {

                app.painter.reset();

                app.painter.alpha(1.0);
                app.painter.color(0x808080);
                app.painter.values.scale.y = 0.75;
                app.painter.fillCircle(entity.x | 0, entity.y | 0, entity.systemLight);

            }


        }

        for (var i = 0; i < this.entities.children.length; i++) {

            let entity = this.entities.children[i];

            if (!entity.inView) continue;

            if (entity.systemShadow) {

                app.painter.reset();
                app.painter.color(0x000000);
                app.painter.values.alpha = 0.25;
                app.painter.values.scale.y = 0.75;
                app.painter.fillCircle(entity.x | 0, entity.y | 0, entity.systemShadow);

            }

            entity.render();

        }

        app.painter.reset();

        for (var i = 0; i < this.orders.length; i++) {

            let sid = this.orders[i];

            let entity = this.entities.sid(sid);

            if (!entity || !entity.inView) continue;

            app.painter.drawImageRegion(app.textures.spritesheet, 32, 75, 7, 6, entity.x, entity.box[1] - 8);

        }

        // this.entities.render();

        Matrix3.reset(this.viewMatrix);
        Matrix3.reset(this.camera.matrix);

        // this.camera.x = -app.width / 2;
        // this.camera.y = -app.height / 2;
        Matrix3.multiply(this.viewMatrix, projectionMatrix);

        for (var key in app.programs) {

            let program = app.programs[key];

            gl.useProgram(program.native);

            program.set("viewMatrix", this.viewMatrix);

        }

        // this.foreground.render();

        this.renderMap();

        this.selector.render();

        this.gui.render();

        this.action.call("render");

        this.cursorDirection = Utils.circWrapTo(this.cursorDirection, this.cursorFinalDirection, 12 * app.elapsed);

        this.cursor.row = Utils.dirrow(this.cursorDirection, 64);

        this.cursor.step(app.elapsed);
        this.cursor.x = app.pointer.x;
        this.cursor.y = app.pointer.y + (PLAYGROUND.MOBILE ? COMMON.MOBILE_CURSOR_OFFSET : 0);

        if (!PLAYGROUND.MOBILE || (this.cursor.key !== "point" && this.cursor.key !== "thump")) {

            this.cursor.render();

        }

        app.painter.reset();

        if (this.scoreLifespan > 0) {

            this.scoreLifespan -= app.elapsed;

            let progress = app.lifetime % 0.5 / 0.5;

            app.painter.color(this.SCORE_COLORS[this.SCORE_COLORS.length * progress | 0]);


        } else {

            app.painter.color(0xffffff);
        }

        app.painter.textAlign("right");
        app.painter.font(app.fonts.fat);
        app.painter.fillText(String(this.privateData.score), app.width - 4, 4);

        // this.camera.step(app.elapsed);

    },

    renderMap() {

        if (!this.player) return;

        if (!this.mapTexture) this.updateMapTexture();

        let scaleX = 0.5;
        let scaleY = 0.5;
        let mapRadius = this.mapTexture.width / 2;

        app.painter.reset();
        app.painter.scale(1.0, 0.75)
        // app.painter.align(0, 0);
        app.painter.translate(app.width - 40, app.height - 40);
        app.painter.color(0x000000, 0.5);
        app.painter.fillCircle(0, 0, mapRadius);
        app.painter.color(0, 0);
        app.painter.drawImage(this.mapTexture, 0, 0);
        app.painter.color(0xffffff);


        app.painter.color(0, 0);
        app.painter.scale(1.0, 1.0)
        app.painter.drawImageRegion(app.textures.spritesheet, 67, 118, 72, 65, 0, 0);

        app.painter.reset();
        app.painter.translate(app.width - 40, app.height - 40);
        app.painter.color(0xffffff);
        app.painter.fillCircle((this.camera.center.x - this.left) * this.mapScaleX - mapRadius, (this.camera.center.y - this.top) * this.mapScaleY * 0.75 - mapRadius * 0.75, 1);

        for (let tribe of this.entities.groups.tribes) {

            if (tribe === this.player) continue;

            let r = Math.ceil((tribe.members.length + 1) / 2);



            app.painter.color(tribe.team === this.player.team ? 0x99e550 : 0xff0000);
            app.painter.fillRect(
                (tribe.x - this.left) * this.mapScaleX - mapRadius - r / 2 | 0,
                (tribe.y - this.top) * this.mapScaleY * 0.75 - mapRadius * 0.75 - r / 2 | 0,
                r, r);

        }

        for (let entity of this.entities.groups.radar) {

            app.painter.color(entity.radar.color);
            // app.painter.fillCircle((entity.x - this.left) * this.mapScaleX - mapRadius, (entity.y - this.top) * this.mapScaleY * 0.75 - mapRadius * 0.75, 1);
            app.painter.fillRect((entity.x - this.left) * this.mapScaleX - mapRadius, (entity.y - this.top) * this.mapScaleY * 0.75 - mapRadius * 0.75, 1, 1);

        }


    },

    addScore(score) {

        if (score <= 0) return;

        this.scoreLifespan = 2.0;

        if (this.privateData.level >= COMMON.MAX_LEVEL) return;

        var nextLevelExp = 0;

        while (score--) {

            nextLevelExp = COMMON.levelToExp(this.privateData.level + 1);

            this.privateData.exp++;

            if (this.privateData.exp >= nextLevelExp) {

                this.privateData.exp = 0;

                this.levelUp();

            }

        }

        this.experienceBottle.setProgress(this.privateData.exp / nextLevelExp);

    },

    levelUp() {

        app.sound.play("gui/levelup")

        this.privateData.level++;

        this.experienceBottle.levels++;
        this.experienceBottle.level = this.privateData.level;
        this.experienceBottle.showInventions();

    },

    score(score, x, y) {

        app.sound.play("gui/score").volume(0.5).rate(1.4);

        this.entities.add("FloatingText", {
            x,
            y,
            text: score,
            colors: this.SCORE_COLORS,
        });

    },

    SCORE_COLORS: [0xffffff, 0x639bff, 0xfbf236, 0xe51f1f],

    step(dt) {

        app.elapsed *= this.speed;

        if (!this.ready) return;

        dt *= this.speed;

        this.lifetime += dt;

        this.entities.step(dt);

        for (let i = 0; i < this.manipulators.length; i++) {

            let manipulator = this.manipulators[i];

            let result = manipulator.object._remove || manipulator.func(manipulator.object, manipulator.data, dt);

            if (result) this.manipulators.splice(i--, 1);

        }

        if (app.mouse.left && Utils.interval(this, "setDirection", COMMON.SHARE_INTERVAL)) {

            if (this.camera.follow) {

                let px = app.pointer.x + this.camera.x;
                let py = app.pointer.y + this.camera.y;

                // let speedFactor = Math.max(0, (Utils.distance(this.camera.follow.x, this.camera.follow.y, px, py) - 20) / 120);

                this.send("setDirection", Utils.lookAt(this.camera.follow.x, this.camera.follow.y, px, py));
                // this.send("setSpeed", speedFactor);

            }

        }


        this.updatePointerPosition();


        for (let i = 0; i < this.timeouts.length; i++) {

            let timeout = this.timeouts[i];

            if ((timeout[timeout.length - 1] -= dt) <= 0) {

                timeout[0](timeout[1], timeout[2], timeout[3]);

                this.timeouts.splice(i--, 1);

            }

        }

        this.checkCollisions();

        if (app.keyboard.keys.f) {

            // this.send("addFleet");

        }

        this.action.step(dt);
        this.gui.step(dt);

        if (Utils.interval(this, "hover", 0.1)) {


            this.updatePointer();

        }

        if (this.inputMode !== "chat") {

            if (app.keyboard.keys.dash) {

                this.camera.scale -= (0.2 + 0.5 * this.camera.scale) * dt;
                this.camera.jump();

            }

            if (app.keyboard.keys.equal) {

                this.camera.scale += (0.2 + 0.5 * this.camera.scale) * dt;
                this.camera.jump();

            }

        }
        // this.cursor.scale.x = this.cursor.scale.y = 0.5 + app.pointer.y / app.height;

        this.selector.step(dt);

        // this.tooltip.x = app.pointer.x - this.tooltip.size.width / 2 | 0;
        // this.tooltip.y = app.pointer.y - this.tooltip.size.height - 24;
        this.tooltip.x = app.width / 2 - this.tooltip.size.width / 2 | 0;
        this.tooltip.y = app.height - this.tooltip.size.height - 32;


        // if (this.hovered && this.hovered.tooltip && this.tooltip.text !== this.hovered.tooltip) this.showTooltip(this.hovered.tooltip, this.hovered);


        if (this.clearOrderTimeout > 0.0) {

            this.clearOrderTimeout -= dt;

            if (this.clearOrderTimeout <= 0) {

                this.orders.shift();
                this.clearOrderTimeout = COMMON.CLEAR_ORDER_INTERVAL;

            }

        }

        if (this.tooltipLifespan > 0) {

            this.tooltipLifespan -= dt;

            if (this.tooltipLifespan <= 0) this.hideTooltip();

        }

        if (this.raining) {

            let raindrop = this.entities.add("Sprite");

            raindrop.set("fx/raindrop");
            raindrop.duration = 0.5;
            raindrop.blendDst = app.gl.ONE;
            raindrop.color.set(Utils.random([0x639bff, 0xcbdbfc]));
            raindrop.alpha = 0.5;
            // raindrop.range = [0, 8];
            // raindrop.rotation = 0.5;
            // raindrop.range = [4, 10];
            raindrop.x = this.camera.x + Utils.random(0, this.camera.box[2]);
            raindrop.y = this.camera.y + Utils.random(0, this.camera.box[3]);
            raindrop.z = Utils.random(50, 150);
            raindrop.zIndex = 5;

            app.tween(raindrop).to({
                z: 0,
                rotation: Utils.randomf(-0.5, 0.5)
            }, 0.1);

        }

        if (this.player && this.player.members.length >= COMMON.MAX_POPULATION) {

            this.buttons.recruit.hidden = true;

        } else {

            this.buttons.recruit.hidden = false;

        }

        if (Utils.interval(this, "updateLeaderboards", 5.0)) this.updateLeaderboards();

    },


    updateLeaderboards() {

        let tribes = Utils.filter(this.entities.groups.tribes, this.notBarbarian);

        tribes.sort(function(a, b) {

            return b.shared.score - a.shared.score;

        });

        tribes = tribes.slice(0, 11);

        for (let i = 0; i < tribes.length; i++) {

            let totem = tribes[i].totem;

            if (totem) totem.setLevel(tribes.length - i);

        }

    },

    setPlayer(entity) {

        this.experienceBottle.levels = 0;
        this.experienceBottle.level = 0;
        this.experienceBottle.hideInventions();

        this.privateData.level = 0;

        this.inventions = ["campfire", "recruit", "axe", "bow"];

        if (this.music) this.music.fadeOut(1.0);

        this.music = app.music.play("music/one").loop().volume(0.5);

        this.player = entity;
        this.camera.follow = entity;
        this.camera.limiter = entity;

        this.totem = entity.totem;
        this.totem.player = true;
        this.totem.group = this.player;

        this.camera.setFollow(this.totem);

        this.privateData.totemX = this.totem.x = this.player.x;
        this.privateData.totemY = this.totem.y = this.player.y;

        this.updatePrices();

        this.arrangeButtons();

    },

    updatePointer() {

        let prev = this.hovered;

        this.hovered = this.getEntityAtCursor();

        if (this.action.current.tooltips === false) {

            this.hideTooltip();

        } else if (this.hovered !== prev) {

            if (prev && prev.tooltip) this.hideTooltip();
            if (this.hovered && this.hovered.tooltip) this.showTooltip(this.hovered.tooltip, this.hovered);

        }

    },

    hideTooltip() {

        if (!this.tooltipShown) return;
        this.tooltipShown = false;

        app.tween(this.tooltip.batch).to({
            dissolve: 1.0
        }, 0.1);

    },

    showTooltip(text, subject) {

        this.tooltipShown = true;

        if (CLIENT.Game.Tooltips[text]) {

            text = CLIENT.Game.Tooltips[text](subject);

        }

        if (!text) return;

        this.tooltipLifespan = 0.0;

        this.tooltip.batch.dissolve = 1.0;

        app.tween(this.tooltip.batch).to({
            dissolve: 0.0
        }, 0.1);

        this.tooltip.font = app.fonts.default;
        this.tooltip.size = this.tooltip.font.getSize(text);

        this.tooltip.text = text
        this.tooltip.color.set(0xcbdbfc, 0.75);

    },

    collisionRadius: 50,

    checkCollisions() {

        let collision = true;

        while (collision) {

            collision = false;

            let entitiesA = this.entities.groups.movable;
            let entitiesB = this.entities.groups.obstacle;

            for (let i = 0; i < entitiesA.length; i++) {

                let a = entitiesA[i];

                if (!a.inView) continue;
                if (a.dead) continue;
                if (a.force) continue;
                if (a.z) continue;
                if (a.ignorePointer) continue;

                if (Utils.distance(a.x, a.y, this.pointer.x, this.pointer.y) < 20) {

                    if (this.pointer.alert) {

                        // if (a.state && a.state.key !== "reach") a.state.set("reach");

                    } else {

                        let angle = Utils.lookAt(this.pointer.x, this.pointer.y, a.x, a.y);

                        // a.force = 150;
                        // a.forceDirection = angle;

                        a.x = this.pointer.x + Math.cos(angle) * 20;
                        a.y = this.pointer.y + Math.sin(angle) * 20;

                    }

                }

                for (let j = 0; j < entitiesB.length; j++) {

                    let b = entitiesB[j];

                    if (a.group === b.group) continue;

                    if (!b.heavy) continue;
                    if (b.dead) continue;
                    if (b.force) continue;

                    let collisionRadius = a.collisionRadius + b.collisionRadius;
                    if (Utils.distance(a, b) < collisionRadius) {

                        let ax = a.x;
                        let ay = a.y;

                        let angle = Utils.lookAt(a, b);

                        /*

            a.x = b.x + Math.cos(angle + Math.PI) * 16;
            a.y = b.y + Math.sin(angle + Math.PI) * 16;

            b.x = ax + Math.cos(angle) * 16;
            b.y = ay + Math.sin(angle) * 16;
            */

                        let x = a.x + (b.x - a.x) * 0.5;
                        let y = a.y + (b.y - a.y) * 0.5;

                        // collision = true;

                        if (!a.heavy) {

                            a.x = x + Math.cos(angle + Math.PI) * collisionRadius * 0.5;
                            a.y = y + Math.sin(angle + Math.PI) * collisionRadius * 0.5;

                        }

                        if (!b.heavy) {

                            b.x = x + Math.cos(angle) * collisionRadius * 0.5;
                            b.y = y + Math.sin(angle) * collisionRadius * 0.5;

                        }


                    }

                }
            }

        }

    },


    xcheckCollisions() {

        let collision = true;

        let px = app.pointer.x + this.camera.x;
        let py = app.pointer.y + this.camera.y;

        while (collision) {

            collision = false;

            let entities = this.entities.groups.collidable;

            for (let i = 0; i < entities.length; i++) {

                let a = entities[i];

                if (!a.inView) continue;
                if (a.dead) continue;
                if (a.force) continue;
                if (a.heavy) continue;

                if (Utils.distance(a.x, a.y, px, py) > 20) continue;

                let angle = Utils.lookAt(px, py, a.x, a.y);

                // a.force = 150;
                // a.forceDirection = angle;

                a.x = px + Math.cos(angle) * 20;
                a.y = py + Math.sin(angle) * 20;


            }
        }


    },

    updatePrices() {

        this.guiElements.recruit.cost = this.player.members.length;
        this.guiElements.campfire.cost = this.player.members.length;

        this.updateButton(this.guiElements.campfire);
        this.updateButton(this.guiElements.recruit);

        for (let button of this.buttons) {

            if (!button.def) continue;

            if (button.def.scaleCost) {

                button.cost = this.player.members.length - 1;

            }

            this.updateButton(button);
        }

    },

    resize() {

        if (this.camera) {

            this.camera.set(0, 0, app.width, app.height);
            this.camera.skip();

        }
        if (this.experienceBottle) {

            this.arrangeButtons();

        }

    },

    keymap: {


    },

    keydown(e) {

        if (this.inputMode === "chat") {

            switch (e.key) {

                case "enter":
                    this.quickChat.send();
                    this.quickChat.hide();
                    this.inputMode = "default";
                    break;

                case "escape":
                    this.quickChat.hide();
                    this.inputMode = "default";

                    break;

            }

        } else {

            let input = this.keymap[e.key]

            if (input) this.send("press", input);

            switch (e.key) {

                case "enter":
                    this.inputMode = "chat";
                    this.quickChat.show();
                    break;

            }

        }


    },

    keyup(e) {

        if (this.inputMode === "chat") {

        } else {
            let input = this.keymap[e.key]

            if (input) this.send("release", input);

        }

    },

    emote(entity, emote) {

        let image = this.entities.add("Image");

        image.follow = entity;
        image.offsetY = -10;
        image.setTexture(app.textures.spritesheet);
        image.setRegion(51, 72, 2, 9);
        image.lifespan = 3.0;

        app.tween(image).to({
            offsetY: -24
        }, 0.5, "outElastic");

        app.tween(image.scale).delay(2.0).to({
            y: 0.0
        }, 0.6, "outBounce");

    },


    updatePointerPosition() {

        this.pointer.x = this.camera.x + app.pointer.x / this.camera.scale;
        this.pointer.y = this.camera.y + app.pointer.y / this.camera.scale;

    },
    pointermove(e) {

        this.updatePointerPosition();

        this.gui.pointermove(e);

        this.action.call("pointermove", e);

        if (this.pointer.pressedEntity && this.pointer.pressedEntity.dragstart && !this.pointer.dragging) {

            if (Utils.distance(this.pointer.dragX, this.pointer.dragY, this.pointer.x, this.pointer.y) > 16) {

                this.pointer.pressedEntity.dragstart();
                this.pointer.dragging = true;
                this.pointer.pressedEntity = null;

            }

        }

    },

    pointerdown(e) {

        if (app.keyboard.keys['o']) {

            this.send("ogre", {
                x: this.pointer.x,
                y: this.pointer.y
            });

        }

        if (e.button === "xright") {
            this.entities.add("Generic", {
                x: this.pointer.x,
                y: this.pointer.y
            })
        }

        if (app.keyboard.keys.shift) {
            this.inspect(this.pointer.x, this.pointer.y);
            return;
        }


        this.pointermove(e);

        this.pointer.dragX = this.pointer.x;
        this.pointer.dragY = this.pointer.y;

        this.pointer.pressedEntity = this.getEntityAtCursor();

        this.updatePointer();

        if (this.gui.pointerdown(e)) {

            this.cursor.set("press");
            this.cursor.duration = 0.05;
            this.cursor.inverse = false;

        } else {

            this.action.call("pointerdown", e);

        }

    },

    pointerup(e) {

        if (app.keyboard.keys.shift) {
            return;
        }


        // this.camera.follow.gun.stop();
        if (this.gui.pointerup(e)) {

            if (this.cursor.key === "press") {

                this.cursor.set("press");
                this.cursor.duration = 0.15;
                this.cursor.inverse = true;

            }

            return;

        } else {

            this.action.call("pointerup", e);

        }

        this.send("release", e.button === "left" ? "gun" : "move");


        this.pointer.pressedEntity = null;
        this.pointer.dragging = false;

    },

    errorMessage(text) {

        app.sound.play("gui/disabled_click");

        this.showTooltip(text);

        this.tooltip.color.set(0xdd4400, 0.8);
        this.tooltipLifespan = 3.0;

    },

    fxRocks(x, y, count = 5, scale = 0.5) {


        for (var i = 0; i < count; i++) {

            let debris = this.entities.add("Sprite");

            let duration = Utils.randomf(0.5, 1.5);

            debris.set("fx/stone");

            debris.shadow = true;
            debris.scale.x = scale;
            debris.scale.y = scale;
            debris.x = x + Utils.random(-8, 8);
            debris.y = y + Utils.random(-8, 8);;
            debris.z = 8;
            debris.shadow = true;
            debris.loop = true;
            debris.duration = duration * 0.3;

            app.tween(debris).to({
                z: 30
            }, duration * 0.5, "inSine").to({
                z: 0
            }, duration * 0.5, "outBounce");

            app.tween(debris).to({
                x: debris.x + Utils.random(-50, 50),
                y: debris.y + Utils.random(-50, 50)
            }, duration);

            app.tween(debris.scale).delay(duration * 0.5).to({
                x: 0,
                y: 0,
            }, duration * 0.5);

            debris.lifespan = duration;

        }

    },

    fxCoin() {

        let coin = this.entities.add("Sprite");

        coin.set("fx/coin");

        coin.rotation = -Math.HPI;
        coin.x = this.pointer.x;
        coin.y = this.pointer.y;
        coin.duration = 0.4;
        coin.loop = true;
        // coin.range = [3, 9];

        app.tween(coin).to({
            offsetY: -40
        }, 0.35, "outSine").to({
            offsetY: -16
        }, 0.35, "inSine");

        app.tween(coin.scale).delay(0.35).to({
            y: 0,
            x: 0
        }, 0.5);

        coin.lifespan = 2.0;

    },

    fxToss(key) {

        let def = COMMON.items[key];

        let image = this.entities.add("Image");
        image.setTexture("spritesheet");
        image.setRegion(...def.sprite);
        image.scale.x = 2.0;
        image.scale.y = 2.0;

        app.tween(image).to({
            offsetY: -40
        }, 0.35, "outSine").to({
            offsetY: -16
        }, 0.35, "inSine");

        image.x = this.pointer.x;
        image.y = this.pointer.y;

        app.tween(image.scale).delay(0.35).to({
            y: 0,
            x: 0
        }, 0.5);

        image.lifespan = 2.0;

    },

    fxCameraStomp() {

        app.tween(this.camera).delay(0.2).to({
            offsetY: 6
        }, 0.3, "outBounce").to({
            offsetY: 0
        }, 0.2)

    },

    gameover() {

        gtag('event', 'gameover');

        this.music.fadeOut(0.25);

        this.music = app.music.play("music/gameover").loop();

        this.respawnWindow = new CLIENT.RespawnWindow();

        this.respawnWindow.setScore(this.privateData.score);

    }

};

/* file: script/Game.Actions.js */

CLIENT.Game.Actions = {};

CLIENT.Game.Actions.none = {

    interact(game, manager, e) {

        game.hovered.interact();

        manager.data.hovered = null;
        manager.data.delay = 0.25;
        manager.data.state = 0;

    },

    pointerdown(game, manager, e) {

        if (game.hovered && game.hovered.pointerdown) {

            game.hovered.pointerdown();

            manager.data.delay = 0.25;
            manager.data.state = 0;

            // this.interact(game, manager, e);

        } else if (!game.hovered) {

            /*
            if (PLAYGROUND.MOBILE && !e.double) return;

            manager.data.state = 0;

            game.cursor.set("thump");
            manager.data.delay = game.cursor.duration = 0.5;
            game.cursor.inverse = false;

            app.sound.play("thump");

            */

        }

    },

    pointerup(game, manager, e) {

        if (game.hovered && game.hovered.pointerup) {

            // this.interact(game, manager, e);

            game.hovered.pointerup();
            manager.data.delay = 0.25;
            manager.data.state = 0;


        }

    },

    step(game, manager, dt) {

        if (manager.data.delay > 0) {

            manager.data.delay -= dt;

            return;

        }

        let STATE_GUI = 1;
        let STATE_INTERACT = 2;

        let state = 0;

        if (game.gui.hoveredElement) state = STATE_GUI;
        else if (game.hovered && game.hovered.clickable) state = STATE_INTERACT;
        else state = 0;

        if (manager.data.state !== state) {

            switch (state) {

                case STATE_INTERACT:

                    game.cursor.set("interact");
                    game.cursor.loop = true;
                    game.cursor.duration = 0.5;

                    break;

                default:

                    game.cursor.set("point");

                    break;

            }

            manager.data.state = state;

        }

        switch (state) {


            default:

                game.cursorFinalDirection = Utils.lookAt((app.width / 2 - app.pointer.x), app.height, 0, 0);

                break;

        }

    }

};

CLIENT.Game.Actions.snap = {

    enter(game, manager) {

        app.sound.play("snap")

        game.cursor.set("snap");
        game.cursor.duration = 0.25;

        manager.set("none");

        manager.data.delay = 0.25;

    },

    step(game, manager) {

        if (manager.elapsed > 0.25) {


        }

    }

};

CLIENT.Game.Actions.moveTotem = {

    moving: 0,

    tooltips: false,

    enter(game, manager, totem) {

        manager.data.totem = totem;

        game.cursor.set("grip");
        game.cursor.range = [0, 4];
        game.cursor.duration = 0.25;

        this.moving = 0;

        manager.data.totem.lift();

        app.tween(game.cursor).discard().to({
            z: 24,
            offsetX: 4
        }, 0.1);

        totem.zIndex = 5;

    },

    leave(game, manager) {

    },

    step(game, manager, dt) {

        if (this.moving > 0) {

            this.moving -= dt;

            if (this.moving < 0) {

                // this.soundLoop.fadeOut(0.25);

            }

            /*
                let debris = game.entities.add("Sprite");

                let scale = Utils.randomf(0.25, 0.4);

                debris.set("fx/dust");
                debris.scale.x = scale;
                debris.scale.y = scale;
                debris.x = game.pointer.x + Utils.random(-4, 4);
                debris.y = game.pointer.y + Utils.random(-4, 4);;
                debris.zIndex = 0;
                debris.duration = 1.0;
        */

        }

        if (this.soundLoop) this.soundLoop.gpan(game.pointer);

        game.cursorFinalDirection = Math.PI * 1.5;

        game.player.tx = game.pointer.x;
        game.player.ty = game.pointer.y;

        if (Utils.interval(game, "move", 0.1)) {

            game.send("move", {
                x: game.pointer.x,
                y: game.pointer.y
            });

        }

    },

    pointermove(game, manager) {

        let totem = manager.data.totem;



        if (this.moving <= 0) {

            // if (!this.soundLoop) this.soundLoop = app.sound.play("action/move_stone").rate(2.0).loop();

            // this.soundLoop.fadeIn(0.25);

        }

        this.moving = 0.25;

    },

    pointerup(game, manager) {

        manager.set("none");

        if (this.soundLoop) {
            this.soundLoop.fadeOut(0.25);
            this.soundLoop = null;
        }

        manager.data.totem.put();

        app.tween(game.cursor).discard().to({
            z: 0,
            offsetX: 0
        }, 0.5);

        game.cursor.set("grip");
        game.cursor.range = [4, 6];
        manager.data.delay = 0.25;
        manager.data.totem.zIndex = 1;

        game.send("move", {
            x: game.pointer.x,
            y: game.pointer.y
        });
    },

    render(game, manager) {


    }


},

    CLIENT.Game.Actions.place_campfire = {

        oy: PLAYGROUND.MOBILE ? -32 : 0,

        enter(game, manager) {

            manager.data.campfire = new CLIENT.Image;
            manager.data.campfire.setTexture("spritesheet");
            manager.data.campfire.setRegion(0, 0, 17, 14);

            game.cursor.set("place");
            game.cursor.range = [0, 2];
            game.cursor.duration = 0.25;
            manager.data.leaving = false;

        },

        render(game, manager) {

            if (manager.data.leaving) return;

            let campfire = manager.data.campfire;

            campfire.x = app.pointer.x;
            campfire.y = app.pointer.y + this.oy;
            campfire.render();

        },

        leave(game, manager) {

            manager.data.campfire = null;

        },

        step(game, manager, dt) {

            // game.cursorFinalDirection = Utils.lookAt(app.pointer.x, 0, app.width / 2, app.height) - Math.HPI;
            game.cursorFinalDirection = Utils.lookAt(app.pointer.x, app.height, app.width / 2, 0);
            game.cursorFinalDirection = Utils.lookAt(app.width * 0.1, app.pointer.y, 0, app.height / 2);

            if (manager.data.leaving > 0) {

                manager.data.leaving -= dt;

                if (manager.data.leaving <= 0) {

                    manager.set("none");

                }

            }

        },

        pointerup(game, manager) {

            manager.data.leaving = 0.25;
            game.cursor.set("place");
            game.cursor.duration = 0.25;
            game.cursor.range = [2, 5];

            app.game.send("placeCampfire", {
                x: game.pointer.x,
                y: game.pointer.y
            });

        }

    };

CLIENT.Game.Actions.recruit = {

    enter(game, manager) {

        gtag('event', 'action_recruit');

        game.cursor.set("place");
        game.cursor.range = [0, 2];
        game.cursor.duration = 0.25;
        manager.data.leaving = false;

    },

    leave(game) {

        game.cursor.rotation = 0;

    },

    oy: PLAYGROUND.MOBILE ? -32 : 0,

    render(game, manager) {

        if (manager.data.leaving) return;

        let row = 2 + (Utils.saw((app.lifetime * 2.0) % 1.0) - 0.5) * 4.0;


        app.painter.reset();
        app.painter.color(0x000000);
        app.painter.values.alpha = 0.25;
        app.painter.values.scale.y = 0.75;
        app.painter.values.scale.x = 1.25;
        app.painter.drawSprite(`tribesman/male/legs_run`, app.pointer.x, app.pointer.y + 3 + this.oy, app.lifetime * 16, row);
        app.painter.drawSprite(`tribesman/male/stunned`, app.pointer.x, app.pointer.y + 32 + this.oy, app.lifetime * 16, row);

        app.painter.reset();
        // app.painter.values.rotation = Math.sin(app.lifetime * 2) * 0.25 + Math.PI;
        app.painter.palette(0);
        app.painter.drawSprite(`tribesman/male/legs_run`, app.pointer.x, app.pointer.y + this.oy, app.lifetime * 16, row);
        app.painter.drawSprite(`tribesman/male/stunned`, app.pointer.x, app.pointer.y + this.oy, app.lifetime * 16, row);

        game.cursor.rotation = -row * 0.1;

    },

    step(game, manager, dt) {

        // game.cursorFinalDirection = Utils.lookAt(app.pointer.x, 0, app.width / 2, app.height) - Math.HPI;
        game.cursorFinalDirection = Utils.lookAt(app.pointer.x, app.height, app.width / 2, 0);
        game.cursorFinalDirection = Utils.lookAt(app.width * 0.1, app.pointer.y, 0, app.height / 2);

        if (manager.data.leaving > 0) {

            manager.data.leaving -= dt;

            if (manager.data.leaving <= 0) {

                manager.set("none");

            }

        }

    },

    pointerup(game, manager) {

        manager.data.leaving = 0.25;
        game.cursor.set("place");
        game.cursor.duration = 0.25;
        game.cursor.range = [2, 5];

        app.game.send("recruit");

        app.game.nextTribesmanPosition = {
            x: game.pointer.x,
            y: game.pointer.y + 32 + this.oy
        };

    }

};


CLIENT.Game.Actions.equip = {

    inRange(x, y) {

        if (PLAYGROUND.MOBILE) {

            return Utils.quickPointInRange(x, y, app.game.pointer.x, app.game.pointer.y, 40);

        } else {

            return Utils.pointInRect(x, y, app.game.pointer.x - 16, app.game.pointer.y, 32, 32);

        }

    },

    select() {

        let pool = Utils.filter(app.game.player.members, (tribesman) => {

            if (!COMMON.canEquip(tribesman, app.game.action.data.equipment)) return false;

        if (!this.inRange(tribesman.x, tribesman.y)) return;

        // if (Utils.distance(tribesman, app.game.pointer) > 20) return false;

        return true;

    });

        if (!pool.length) return;

        return Utils.nearest(app.game.pointer, pool)

    },

    enter(game, manager, equipment) {

        gtag('event', 'action_equip');

        manager.data.equipment = equipment;

        game.cursor.set("place");
        game.cursor.range = [0, 2];
        game.cursor.duration = 0.25;
        game.pointer.alert = "cursorReach";

        manager.data.leaving = false;

    },

    leave() {

        tribesman.game.pointer.alert = false;

    },

    render(game, manager) {

        if (manager.data.leaving) return;

        let key = manager.data.equipment;

        let oy = 0;

        if (PLAYGROUND.MOBILE) oy = -32;

        app.painter.reset();
        app.painter.color(0x000000);
        app.painter.values.alpha = 0.25;
        // app.painter.values.rotation = Math.sin(app.lifetime * 2) * 0.25 + Math.PI;
        app.painter.values.rotation = -1.0;
        app.painter.values.align.y = 0.6;
        app.painter.drawSprite(`tribesman/${key}/turntable`, app.pointer.x, app.pointer.y + 4 + oy, 4 + Math.sin(app.lifetime * 2) * 2.0);

        app.painter.reset();
        // app.painter.values.rotation = Math.sin(app.lifetime * 2) * 0.25 + Math.PI;
        app.painter.drawSprite(`tribesman/${key}/turntable`, app.pointer.x, app.pointer.y + oy, 4 + Math.sin(app.lifetime * 2) * 2.0);

    },

    leave(game, manager) {

        manager.data.campfire = null;
        game.pointer.alert = null;

    },

    step(game, manager, dt) {

        // game.cursorFinalDirection = Utils.lookAt(app.pointer.x, 0, app.width / 2, app.height) - Math.HPI;
        game.cursorFinalDirection = Utils.lookAt(app.pointer.x, app.height, app.width / 2, 0);
        game.cursorFinalDirection = Utils.lookAt(app.width * 0.1, app.pointer.y, 0, app.height / 2);

        if (manager.data.leaving > 0) {

            manager.data.leaving -= dt;

            if (manager.data.leaving <= 0) {

                manager.set("none");

            }

        }

    },

    pointerup(game, manager) {

        manager.data.leaving = 0.25;
        game.cursor.set("place");
        game.cursor.duration = 0.25;
        game.cursor.range = [2, 5];

        if (manager.selection) {

            if (manager.selection.hooray) manager.selection.hooray();

            app.game.send("equip", {
                key: app.game.action.data.equipment,
                target: manager.selection.sid
            });

        }

    }

};

/* file: script/Game.Tooltips.js */

CLIENT.Game.Tooltips = {

    totem(subject) {

        return subject.player ? "This is how your minions imagine you." : "Other god totem";

    },

    building(subject) {

        if (subject.shared.key === "windmill") return "Are you hungry? I can sell you a loaf of bread for a coin.";
        else if (subject.shared.key === "lumberjack") return "Ahoy! Short on wood? 2 pieces of gold for a plank";

    },

    mushroom(subject) {

        return "I am not sure if it is edible...";

    },

    rocks(subject) {

        if (app.game.player.canMine) {

            return "These rocks are almost as old as me.";

        } else {

            return "If we had a hammer...";

        }

    },

    tree(subject) {

        if (app.game.player.canLumber) {

            return "A Tree. A home for many.";

        } else {

            return "A Tree. A home for many.";

        }

    },



};

/* file: script/Game.MessageHandler.js */

CLIENT.GameMessageHandler = {

    inspect(game, data) {
        console.log("-- inspect --");
        console.log(data.constructorName);
        console.log(data);
    },

    console(game, data) {
        console.log(data.text);
    },

    die(game, data) {

        let entity = game.entities.sid(data.entity_sid);

        if (!entity) return;

        let killer = game.entities.sid(data.killer_sid);

        if (!killer) return;

        if (entity.getScore && killer.group && killer.group === game.player) {

            game.score(entity.getScore(), entity.x, entity.y - 16);

        }


    },

    quick_chat(game, data) {

        let entity = game.entities.sid(data.entity_sid);

        if (!entity) return;
        if (!entity.inView) return;

        entity.say(data.text);

    },

    poison(game, data) {

        let entity = game.entities.sid(data.entity);

        if (!entity) return;
        if (!entity.inView) return;

        let debris = game.entities.add("Sprite");

        debris.set("fx/poison");
        debris.follow = entity;
        debris.duration = 1.5;
        debris.zIndex = 3;
        debris.offsetY = -16;

        app.sound.play("human/poisoned").rate(1.5).gpan(entity);

        if (entity.group === game.player) {

            game.showTooltip("This one was poisonous. I should finally learn all the mushrooms.");

            game.tooltip.color.set(0xdd4400, 0.8);
            game.tooltipLifespan = 3.0;
        }


    },

    eat(game, data) {

        let entity = game.entities.sid(data.entity);
        let campfire = game.entities.sid(data.campfire);

        if (!campfire || !entity) return;
        if (!campfire.inView) return;
        // if (!campfire.inView) return;

        let food = COMMON.items.food;
        let image = game.entities.add("Image");

        image.setTexture("spritesheet");
        image.setRegion(...food.sprite);
        image.x = campfire.x;
        image.y = campfire.y;
        image.systemShadow = 4;
        image.zIndex = 1;

        app.tween(image).to({
            z: 30
        }, 0.25, "outSine").to({
            z: 0
        }, 0.35, "inSine");

        app.tween(image).to({
            x: entity.x,
            y: entity.y,
            rotation: 6.14
        }, 0.6);

        image.lifespan = 0.6;

        app.sound.play("human/eat_" + Utils.random(1, 3)).delay(0.6).gpan(entity).rrate(0.1);

        let debris = game.entities.add("Sprite");

        debris.set("fx/blink");
        debris.follow = image;
        debris.duration = 0.25;
        debris.scale.x = 0.5;
        debris.scale.y = 0.5;
        debris.zIndex = 2;
        debris.delay = 0.6;

        app.tween(entity).to({
            timeScale: 1.0
        }, 1.0);

    },

    resources(game, data) {

        Object.assign(game.guiResources.count, data);

        game.playerData.resources = data;

        game.guiResources.refreshText();

        game.updateButtons();

    },

    attack(game, data) {

        let attacker = game.entities.sid(data.attacker);

        if (attacker.inView) {

            attacker.state.set("attack");

        }

    },

    block(game, data) {

        let defender = game.entities.sid(data.defender);

        if (!defender.inView) return;

        if (defender) {

            defender.state.set("block");

        }

        let attacker = game.entities.sid(data.attacker);

        if (attacker) {

            attacker.state.set(Math.random() > 0.5 ? "fallBack" : "hurt");

        }

    },

    chop(game, data) {

        let attacker = game.entities.sid(data.attacker);

        if (attacker.inView) {

            attacker.state.set("chop");

        }

    },

    harvest(game, data) {

        let attacker = game.entities.sid(data.attacker);

        if (attacker.inView) {

            attacker.state.set("harvest");

        }

    },

    mine(game, data) {

        let attacker = game.entities.sid(data.attacker);

        if (attacker.inView) {

            attacker.state.set("mine");

        }

    },

    shoot(game, data) {

        let attacker = game.entities.sid(data.attacker);

        if (attacker.inView) {

            attacker.state.set("shoot", data);

        }

    },

    hit(game, data) {

        let entity = game.entities.sid(data.entity);

        if (!entity) return;

        entity.onHit(data);

    },

    fire(game, data) {

        let attacker = game.entities.sid(data.attacker);
        let defender = game.entities.sid(data.defender);

        if (!attacker || !defender) return;

        let bullet = game.entities.add("Bullet");

        bullet.x = bullet.ex = attacker.x;
        bullet.y = bullet.ey = attacker.y;
        bullet.target = defender;
        bullet.duration = data.duration;

        bullet.run();

    },

    update(game, data) {

        if (data.sharedKeys) {

            game.sharer.setKeys(data.sharedKeys);

        }

        data.entities.forEach(game.updateSharedEntity, game);

        game.parseQueue(data.queue);

    },

    snapshot(game, data) {

        game.start(data);

    },

    setPlayer(game, data) {

        let player = game.entities.sid(data);

        game.setPlayer(player);

    },

    speed(game, data) {

        game.speed = data;

        document.title = data;

    },

    fx(game, data) {

        let entity = game.entities.sid(data.entity_sid);

        if (!entity || !entity.inView) return;

        app.sound.play("fish/piranha_bite").gpan(entity).rate(2.5).rrate(0.1);
        app.sound.play("fish/piranha_miss").gpan(entity).rate(1.4).rrate(0.3).volume(0.6);

        let bubble = entity.collection.add("Sprite");

        bubble.set("fx/bubble");
        bubble.x = entity.x;
        bubble.y = entity.y;
        bubble.duration = 1.0;
        bubble.scale.x = 2.0;
        bubble.scale.y = 2.0;

    },

    private_data(game, data) {

        if (data.score !== undefined) game.addScore(data.score - game.privateData.score);

        Object.assign(game.privateData, data);



    }

};

/* file: script/fx/debris.js */

CLIENT.Game.fxDebris = function(x, y) {

    let debris = this.entities.add("Image");

    debris.setTexture("spritesheet");
    debris.setRegion(...Utils.random(app.data.debris));
    debris.x = x;
    debris.y = y;

    this.manipulate(debris, CLIENT.Manipulators.debris, {});

    this.manipulate(debris, CLIENT.Manipulators.force, {
        direction: Math.random() * Math.TAU,
        force: Utils.random(200, 300),
        damping: 250
    });

};

/* file: script/fx/spark.js */

CLIENT.Game.fxSpark = function(object, type) {

    let spark = this.entities.add("Sprite");

    spark.x = object.x;
    spark.y = object.y;
    spark.set("spark/" + type)
    spark.duration = 0.5;

    this.manipulate(spark, CLIENT.Manipulators.follow, {
        follow: object
    });

};

/* file: script/main.js */

var $_GET = {};

window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m, key, value) {

    $_GET[key] = value;

});

// if ($_GET.length === 0 && Math.random() > 0.95) window.location = "http://mechar.io?ref=wildsiolocation";

var $_HASH = {};

window.location.hash.replace(/[#&]+([^=&]+)=([^&]*)/gi, function(m, key, value) {

    $_HASH[key] = value;

});

var app = new PLAYGROUND.Application({

    sprites: {},

    shouldUsePalette(url) {

        return url.indexOf("tribesman/") > -1 || url.indexOf("rabbit/") > -1;

    },

    fitElementIntoWindow(element) {

        let $element = $(element);

        setTimeout(function() {

            if ($element.outerHeight() > window.innerHeight) {

                var scale = window.innerHeight / ($element.outerHeight() + 32);

                $element.css("transform", `translate(-50%, -50%) scale(${scale})`);

            }

        }, 1000);

    },

    create() {

        this.mouse.releaseButtonsWhenOffscreen = false;

        if (!window.gtag) window.gtag = function() {};

        this.paths.rewriteURL = window.REWRITE_URL ? window.REWRITE_URL : {};
        this.dataSource = window.JSONS || {};


        this.tempCanvas = document.createElement("canvas");
        this.tempCanvas.ctx = this.tempCanvas.getContext("2d");

        this.canvas = document.createElement("canvas");

        this.canvas.width = window.innerWidth / 2 | 0;
        this.canvas.height = window.innerHeight / 2 | 0;
        this.canvas.classList.toggle("main", true);

        document.body.appendChild(this.canvas);

        this.gl = this.canvas.getContext('webgl', {
            alpha: false,
            antialias: false,
            premultipliedAlpha: false,
            depth: false,
            stencil: false
        });

        let gl = this.gl;

        this.painter = new PLAYGROUND.Painter(this);

        // gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, false);
        // gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);
        // gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);

        gl.disable(gl.DEPTH_TEST);

        this.loadData("<common/data/shared.json> shared");
        this.loadData("<common/data/ships.json> ships");

        this.loadProgram("sprite", "sprite_vertex", "sprite_fragment");
        this.loadProgram("polygon", "polygon_vertex", "polygon_fragment");
        this.loadProgram("background", "background_vertex", "background_fragment");
        this.loadProgram("foreground", "foreground_vertex", "foreground_fragment");
        this.loadProgram("tiling_image", "tiling_image_vertex", "tiling_image_fragment");
        this.loadProgram("map_edge", "map_edge_vertex", "map_edge_fragment");
        this.loadProgram("surface", "surface_vertex", "surface_fragment");
        this.loadProgram("atmosphere", "atmosphere_vertex", "atmosphere_fragment");
        this.loadProgram("ship", "ship_vertex", "ship_fragment");
        this.loadProgram("gui", "gui_vertex", "gui_fragment");
        this.loadProgram("text", "gui_vertex", "text_fragment");
        this.loadProgram("circle", "circle_vertex", "circle_fragment");
        this.loadProgram("meadow", "circle_vertex", "meadow_fragment");
        this.loadProgram("rect", "rect_vertex", "rect_fragment");

        this.paletteMap = {};

        for (let i = 0; i < cq.palettes.db32.length; i++) {

            let color = cq.palettes.db32[i];

            this.paletteMap[color] = cq.color([i * 256 / 32, 0, 0]).toHex();

        }

        this.loadTexture("leaderboards");
        this.loadTexture("spritesheet");
        this.loadTexture("spritesheet_p");
        this.loadTexture("palette");
        this.loadTexture("bg1");
        this.loadTexture("checkerboard");
        this.loadTexture("planet1");
        this.loadTexture("grid");
        this.loadTexture("map_edge");
        this.loadTexture("map_edge_vegetation");
        this.loadTexture("water/water1");

        this.loadImage("<textures/spritesheet.png> spritesheet");

        this.loadData("debris");

        this.sound = this.audio.channel("sound");

        if (this.sound.compressor) {

            app.sound.compressor.threshold.value = -10;
            app.sound.compressor.knee.value = 10;

        }

        this.music = this.audio.channel("music");
        this.music.compressorEnabled = false;
        this.music.route();

        /* Init gl helpers */

        this.initNGon(4);
        this.initNGon(8);
        this.initNGon(16);
        this.initNGon(24);
        this.initNGon(32);

        {

            let vertices = new Float32Array([0.0, 0.0,
                1.0, 0.0,
                1.0, 1.0,
                1.0, 1.0,
                0.0, 1.0,
                0.0, 0.0
            ]);

            let meshBuffer = gl.createBuffer();

            gl.bindBuffer(gl.ARRAY_BUFFER, meshBuffer);
            gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);

            this.quad = meshBuffer;

        }

    },

    adPauseGame() {

        if (app.sound.reconnect) {

            app.sound.disconnect();
            app.music.disconnect();

        }

    },

    adResumeGame() {

        if (app.sound.reconnect) {

            app.sound.reconnect();
            app.music.reconnect();

        }

        if (app.adResume) app.adResume();

    },

    requestAd() {

        this.adResumeGame();

    },

    initNGon(sides) {

        let gl = this.gl;

        if (!this.ngons) this.ngons = Object.create(null);

        let temp = [];

        let angleStep = Math.TAU / sides;

        for (var i = 0; i < sides; i++) {

            temp.push(
                0.5 + Math.cos(i * angleStep) * 0.5,
                0.5 + Math.sin(i * angleStep) * 0.5
            );

        }

        let vertices = new Float32Array(temp);

        let meshBuffer = gl.createBuffer();
        let indicesBuffer = gl.createBuffer();

        let indices = new Uint16Array(earcut(temp));

        indicesBuffer.count = indices.length;

        gl.bindBuffer(gl.ARRAY_BUFFER, meshBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);

        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indicesBuffer);
        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, indices, gl.STATIC_DRAW);

        this.ngons[sides] = {
            mesh: meshBuffer,
            indices: indicesBuffer
        };


    },

    resize() {

        let scale = 1;

        if (window.innerHeight < 480) {

            scale = window.innerHeight / 216;

        } else {

            scale = Math.max(1, Math.ceil(window.innerWidth / 639));
            scale = Math.min(scale, 3);

        }

        var ww = window.innerWidth;
        var wh = window.innerHeight;

        if (app.forceScale) scale = app.forceScale;
        var vs = window.innerWidth / scale;

        var s = 1.0;
        var w = 0;
        var h = 0;

        if (ww > wh) {

            s = vs / ww;
            w = vs;
            h = wh * s;

        } else {

            s = vs / wh;
            w = ww * s;
            h = vs;

        }


        if (this.canvas) {

            this.canvas.width = w;
            this.canvas.height = h;
            this.canvas.style.transform = "scale(" + (1 / s) + ")";
            this.canvas.style.transformOrigin = "left top";

            this.width = w;
            this.height = h;
            this.scale = 1 / s;

            this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);

            this.pixelWidth = 1.0 / this.width;
            this.pixelHeight = 1.0 / this.height;

        }

    },

    ready() {

        this.fonts = {};

        this.fonts.default = new CLIENT.BitmapFont(this.images.spritesheet, [0, 231, 222, 11, "AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTt()[]?"], [0, 243, 194, 11, "UuVvWwXxYyZz0123456789.,|!\"/-+_%*❤🛡"]);
        this.fonts.small = new CLIENT.BitmapFont(this.images.spritesheet, [0, 191, 101, 8, "abcdefghijklmnopqrstuvwxyz"], [0, 201, 180, 8, "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.,!?()[]/:'"]);
        this.fonts.fat = new CLIENT.BitmapFont(this.images.spritesheet, [0, 220, 55, 9, "0123456789"]);
        this.fonts.small_shadeless = new CLIENT.BitmapFont(this.images.spritesheet, [0, 255, 101, 8, "abcdefghijklmnopqrstuvwxyz"], [0, 265, 173, 8, "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.,!?()[]/"]);

        this.game = CLIENT.Game;

        fetch("client/server").then(function(response) {

            return response.text()

        }).then((url) => {

            if (!url) {

        } else {

            CLIENT.Game.server_url = url;

            this.setState(CLIENT.Lobby);

        }

    });



    },

    pointerdown(e) {

    },

    pointermove(e) {

    },

    step(dt) {

    },

    prerender() {


    }

});

PLAYGROUND.Application.prototype.promises = {};

SoundOnDemand.Sound.prototype.gpan = function(o) {

    var distX = (o.x - app.game.camera.center.x) / (app.width * 0.5);
    var distY = Math.abs((o.y - app.game.camera.center.y) /
        (app.width * 0.5));

    var pan = distX;
    // var vol = this.current.volume * (1 - Math.max(Math.abs(distX), distY));
    // .volume(vol);

    this.pan(pan || 0);

    return this;

}