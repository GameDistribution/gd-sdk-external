<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gamedistribution.com</title>
    <style media="all">
        html, body {
            height: 100%
        }

        body {
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
<script type="application/javascript">

    (function() {
        var referrer = getParentDomain();
        var body = document.body || document.getElementsByTagName('body')[0];
        var gameFrame = document.createElement('iframe');
        gameFrame.onload = function() {
            // Create connection with partner, for sending postMessage data.
            // Make sure to set your full proper domain url.
            var domain = 'http://play-staging.plinga.de';
            var gameFrameContent = gameFrame.contentWindow;

            // Send the referrer domain to the partner, so it's available to them.
            gameFrameContent.postMessage({
                referrer: referrer,
            }, domain);

            // Load the Gamedistribution.com SDK.
            var settings = {
                gameId: '2272513fdcc344a6a5bb90089976ace5', // Your gameId which is unique for each one of your games; can be found at your Gamedistribution.com account.
                userId: '46FF1E87-9DC1-4E1C-8E32-7B34FFEE11DD-s1', // Your userId which can be found at your Gamedistribution.com account.
                resumeGame: function() { // Callback function for resuming your game after banner closed
                    // Invoke the resume game method in the game through postMessage API.
                    gameFrameContent.postMessage('resume', domain);
                },
                pauseGame: function() { // Callback function for pausing your game when an advertisement starts.
                    // Invoke the pause game method in the game through postMessage API.
                    gameFrameContent.postMessage('pause', domain);
                },
                onEvent: function(event) {
                    // Used when new SDK will be released. Will be notified about this release by email.
                },
                onInit: function(data) {
                    console.log('Init: ', data);
                },
                onError: function(data) {
                    console.log('Error: ', data);
                },
            };
            (function(i, s, o, g, r, a, m) {
                i['GameDistribution'] = r;
                i[r] = i[r] || function() {
                    (i[r].q = i[r].q || []).push(arguments);
                };
                i[r].l = 1 * new Date();
                a = s.createElement(o);
                m = s.getElementsByTagName(o)[0];
                a.async = 1;
                a.src = g;
                m.parentNode.insertBefore(a, m);
            })(window, document, 'script',
                '//html5.api.gamedistribution.com/libs/gd/api.js',
                'gdApi');

            gdApi(settings);
        };
        gameFrame.style.display = 'block';
        gameFrame.style.width = '100%';
        gameFrame.style.height = '100%';
        gameFrame.style.margin = 0;
        gameFrame.style.padding = 0;
        gameFrame.style.border = 0;
        gameFrame.src = 'http://play-staging.plinga.de/game/iframe/23/9/?referrer=' +
            referrer;
        body.appendChild(gameFrame);
    }());

    function getParentDomain() {
        // Get the referrer domain without subdomain.
        var i = 0;
        var domain = (window.location !== window.parent.location)
            ? document.referrer.split('/')[2]
            : document.location.host;
        const p = domain.split('.');
        const s = '_gd' + (new Date()).getTime();
        while (i < (p.length - 1) &&
        document.cookie.indexOf(s + '=' + s) === -1) {
            domain = p.slice(-1 - (++i)).join('.');
            document.cookie = s + '=' + s + ';domain=' + domain + ';';
        }
        document.cookie = s +
            '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=' +
            domain + ';';
        return domain;
    }
</script>
</body>
</html>